// ==UserScript==
// @name         wxmp-history-url
// @namespace    http://tampermonkey.net/
// @version      0.1.1
// @description  打开任意公众号文章，即可获取该公众号主页（历史消息）页面地址
// @author       xplee
// @match        https://mp.weixin.qq.com/*
// @exclude      https://mp.weixin.qq.com/cgi-bin/*
// @icon         data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAIAAABMXPacAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAALC9JREFUeJztfQl8lPWZ/y6ZeyJWPGptu2qr1n/bbWu73d1e/93aVrfdrUeP7f6bzDtXCKcCSsETlVoKWhCxHlhFBatQaxW1WiuZ95hcBBJCSCAJkIQj5L4mx8y85/95nt87CJmQyZBJQvbTX9/GIZnjnd/ze+7v8zx/Z0yfpRq6Zj7U6aGGD+AnPNYN85pu6++m+gbGtnTzB+60Dov2XDM3Hf5HtMGfdE2nNU0IYOC203/w0nS2/5oOXGGo9AvzWQnmmDZrehBAP8kCQAfYbZUuDQhAXIAcgdTQ6OH0EkTTgwBs4eYbhsLkjKYpCQ4wdPidrBuKZqjEG9OJAucSAej0JvbvlE2kX/fI/RV9Te93Vb/UXPirI9sX1r/oqX7mv/au+96eNTdW/eaWfY979m9cXP/yb479+bXOMrGv9tBQy4A6xJjj9PfTT/uEqSbWVBJAZ7tDgkU1VA2Fiy6TFoWHCp5tpUeLvNm+e/nBbTfteewzpctnFc6zi77Rr5lC8MqixV+ueOCm6g2/PrT9rz1VUS2qIdvgO2umDgH5hbRWSYpN4TonOADUKUgP3AmZLtSw+nGla8nBVz8evsPC+6xSbpaUYw3nOkTOxXMOwTsKAWyC14bP8dkF7wzeYw37P1O2YlXTmxGlBxlMMWQZ5ZhsxPEfU02BKSOATsswTLsSWUCHzdePxtrf6Nx104F1lwgLrILfwQdcgh+20oGP/XY+YBUCNvjNmQngEP0OIeAI+d2hAFxOfBVnEQKfKFk2p+7FcF91rxrB468xva1MrRiaOg5gcpiMGvSpNK1HjbzYLH6n/NeXSPOdgs8qcE7R6+A9tjBnhZ0VgrCzsL9WibNJo3GAXfTahVy7yAHZgFQ2EWiQ4xA88E8n77uiaNEtVevDfQcYAXTToZuyNUUEQJ/KPP7w7Y8PdT7TvOPTxUthi218rl0AARKwSgHcd94L59cR8uIFkodnD0bTAQ66rKLXInltIufkOasEr/IBD1kFn4P3uUIBh5R356EtZZE6RdOnVg9PFgGYpNWB4UHWq/idVVUjxXsweuKG8jWzpHmwZSdPt7nFAu4au2wg3JEDULzYxdFEEL0qYEfBRU8DPsDf4ztY6YGLx6c5Q75rS5Y/fyzUJw+g/kl40CgN2fnQTcN3QtfkcQBstkx2jkKSB6z4VjnydEtoVtFCx6gyPeOXkw9kgXwDnpDybHzedeUPFPbsj2tKHC0jTdHNoBNzr/UJ9iomiQDAAKpOdqZixOkfHUoPV/nMheICG5o0uZNJAFDmoAxATLkLOBfyB3dt0S8ea3x3CLiSnAQWZ1IZDSZYQE0SAUjyaKqMPquqK1s7Sr5Ucq8NNG2YxPrkcsCMsM8lBrLosU3yWAUwVVFPeKqfrhlspiCHjj41kz//Owig4+HC2E3MiG3tKP544W0uHqx1vw1EAVo7syeTAHbJZy/w2qSgMwT6AEwjzhbGO3GF/V/f/csDQ80xOPgqemwyC3RP5Jo0JUy8rBivtJZ+lF8Imw67YBPBsQK73j9DyJlMAljBm0OzKmCT8izIfEHcfTC9+ICbD3xj90P1kQ7VdE6mLQeghaNRUAHjxfhAldV3uysvkua4QmChByf1yKdzgQH27+UrD0VbdDKEJjq7MHEEMIgAGovcg/x5v7PymrL7wAIBS9w5qiE/xRfar8EfVW9oirZT8OiUMN4EWEQTJoLAz1Q1GX4omqKpUm/NReEFWUKOO4QyJ0uaVLMnrcsmoSdhFwLf3P3wUbkTbdKJtEQnigCkxsie0I2yyMF/Lv8lnHp3CAjgQ3dUHD2WMJWXA+NOXhcGnXz59ZtO5YCJWBPGAWDwaGhEtEQjX9/1kF3wWNDsAfsP7G6vPTSpdmeaBPBTEDDHJeSCeba9Y5eqkjKeGD6YQCtI1dUBNbr00KsY4RG9FE6AC4PJttFjCeluGTq3PkcIji04WRwG78C9EDFq5BQCVhaEELxO0Y+6h/ezsAQ6gILPJfizefglh5JH9DtCoJ8w1IHGMcZQ/V/d9UBNpEkliaph/DrDZJhAHaDo2sbmgovEBW40uify2DKVLgVsuN0BKx9whkDVB5DeuI8eG+9xAZ0KwNCkQBNYATzFl0AbCT4bkgQ1kz0ElPBZ8FX4VkgPYFbe9609q3vkfpWFzzPNBhNIgH4lenXRUtgFa0bP+8gX7GkIN8sCNBCCLj4PtKgFWc1rFYAh/HACKFEDToDfgjrWT3kCvDcgA5x0q+RD70TItUsep+CBrUcWQVcRI7Lrj74XAxdZowRORtfEKWGtPHIE/B3gfVs4aJtIrYsCTULHIkvIdcA+FnBWOrmws1Y+aC8AP8vrFoOXFM+/rHjhJ0pv/0zZ3d+qXJ1T+0yg7lmu5qkfVa3/StmKTxbfcUF4frYAlPNbUGCiWHNiIBZDVf9WvurgQIumyUqmdfJEEUA24jdVbbBKuTbJC6anYyKZAAhgAXEfgsMLUtt7RdEd39n9qzn7n3+y+f3Cnpr9fU3tQ5EoRjkp95PAspgYIrTW0GPRdUXRlRall++u/d0x6c7arTdXPX7t7uVuEcQRfoRn/7OKHtemCwfs7D3owtPkdfJeyiBOrBTCNCTvvSQ8L1D3XLjnwPF4dxx1kBmBxTCUprHkm86C/bqqMXQR7T+LU5H3iH+jSJDapw5UDRx7qVn4ac36i4vmfESYE+o7FFcz7BpnjABkqWkMN9ijRH5Ys84hZWzTHUxnipyT5PIMKeDEGGquNexx8dwnCxfcULnqueMFzfEu3LyMnlEkiqzHdKW8//j2E3uG9Ggm3z2DBCAkA7pdimEUdFddXrTENip2Ic0DDrYKcBLo1YBDyAN6UOKMu6j4dn/tC+HuA62xLnbK4TaUjGaxkDHoXAFXKIqMejijK4MiSFWZr6JpubUbT1o+aHuMmxJWSmCBLrGjTZVjk/xfLL334UN/6o336gYJF43yPOZuZTSNyECPmhFD0upapt2xDBJAY0CTPqX/0vAiZptnZPfhsoTRicuSOEqye/61dMXOgcMxTcGcMjhIhqzpYJ5gCB+leea+Ei6SaTppcFLh5yoBdFJi4H5tai10hFBeMwJkRASB/Q6G/EfEvM+X3vPE0Q864/20GZpKB57BS3QGdzMyjjJB0arS8TeFbEZXBgmAuzCkxXz7N6JnP06ZAxJM4Gxhj03wOPmgm/e7QsEVTa/v629S9JOmuM7obto1eiKLq5lwahPxg78gDK9JKoNCzOrJiz3LrPfQTdOUHpkVCCp7b8QRZJq9MiqC8Ay2RXtvqFgFuzbONK8T9C2hshyI7fE7CwI3Vjx6TO5EZ1QbScZ/WDeQ4AAkCRmaGhPdVMTB8HgMAaybkHb2H4aE0M36D82EpRgJ/J5BWXoGic/oyhwB6OSVdNdfWXyHXRxvnt1dgCAqdwijBWBl3tXwWtSI6bKmnSyMOe2TTZyvnsilawhVZzyJuaDWeM+B/uYdXdWvtBc9evStpY2v+A88++O9G36wZ+2NVet+tO8Jb/XGRbWbHz3y9uY28b2uiopIU7vSF2P2lEJvgflhRrcM80DmCICOjfFKa9glzrYRoGpcIkjyWyXOwXMfk27/Q0dJRBmCLx8nOaJqSRSgpZtlGgSDJtzR0VjHiy3CgkNbvlux6ku77r24eKFTCoK/5sKEhA8RjBTwsWGC2gt2LYuYXhye89mypd+uWu2ve2FLa0mXHlHBr6e9Vxi4OqMrk1YQ3NtdDb+3SpRyGV/SkUXWbti7pnygHjEtmmkMamYRWDILmAceyFPTc3Rd4zvXld7vFIMO0eviPWyjyZsLWHm/BcNEeKF/TgFqG4/hTwQC8wjmBb+absALeuiy8IKfVD/1x47ShqETKrnNmdsxXBlUwsCoxs+q1jkETwbCn5L3+vJfHxxqQTuTrA/F0JgoGFEBkCDXmIyu6j32yLF3Plf6CwdGN/0OfrYDIaFe8xIIWsoTj8KFyQAMjhJwkZJF9FdXCH9ppRy9i/deJM7954qVaxvfa4l1ZWrH2MpgKALYXv/s7mX0nX1ppVww4oh7MccW8jtFkDy+uQdePBHvYKEzPU18mk5Vk7Kulvc35te98MXd99glkjYmuhR+wid6HKIHhQ8FOVLfJJEN2OKCovyVjW9WDjSxT2GKnuHoEF6fzJ2pViZDEbBTlxUtsJD8ScsMJXnFvFzgnuDNex9rkTsxnU8GT9oEwJ1BawUORFSNVQ8cfaDxjauL77KInFvkbCEEhGULs10hqjMAYzdVqJxyZ5RQw5ir1y0GPl92/yttO4fUGCUJwMxSFJ0CAXLaUMYMiiAtrqtOwW9BVIHXnp4OQGmQXZDjKuC89Zuagc2Z52kQXDZtqQsEUMjixPiESjwUUSKrm7Z/eed98FmWQh+phIBVClLKbGzeInAAYrN9DskHDoorxH27YlVlf1MMyY3qCY6/kn6BYOY4QNcGNRnhnpKP4J5pSfwAyQHuquKlZZFD6N6aYWEtbmjplrCQVYqvp+ABQjNk0iRRZeiNrrIv77nfHfa5BS5LAv1MCa8x3CpGdomzGXNbJXB0OOCkW6o3lEUaSBahtDyLOGAmOSAiR21k4ZmqbOwEwHoY72WFi19okczSJT3hzeqJjgRp3ImJcFYJkwfyQUUyUNRCVQ8OHXuw4bUL+LmoAAr9jgL/WNQVC62z0Ba4h0C5LJCZId8FvP8LJfeFI7UUiU3UHKazMhmK6JMHkU/HFIfwOphKZMEiweuS8rY0hwlKhBWSmvFhuWqiF0QayyTZMMcpkXSBTyjqq726ZJnzA86FwFB2D2YxiDUlMcQAWRkcUCVL9FkkzyVF84v7D8mapic8aeNk/WeqO8+gI2YM6kME+gD2DKQ6Vl4nnqaA3TSBAjnVT8Y0hOcroEomuCxFoZI0vrv6+oo1xKxYAoXCE2gQAgcwkI72AiMVo+XfKH5Q6qvDgCzCQRIQ9zF4zpkkgGIo54tzLODBFoxBqjIwiMRZeM/NleuOR9tYPk1F/M0EI5I1hYwkY9AYXFj/4qzCBQ6CBjkl9MBdY7j5Uy8nH3SCH1fIXVq0cGffIZnFksgVZ7WYo69MhqPBU7qycMmMMJZfjX7ThFVhyW7OGc4v6jugm/cNN61kOOc0wr1iYIfMW7Vdiaw98V72B/lOAXxgjzOdrWeXpRA52IUFbrnfKvvlnoFGlWWgFQwCpvwuGfQDMHXxvYpVsLNONGlGt+1Qejolv7vA+9O9vwXjQTYTOppmpGf1n83SWZGarIKngDWDytb2kqvDy9ERMSFyaVzAxPYQZwVxKgXBRvryrntb4x2UxgEXIXUKP6OOmK5y+5+0h/wOMYUYtSHnIlDQKQbL+2uZta+xYLFmFkZM5EIgBOh75iyAvAZ/7Y3u0kuEuSCCslOxb5IIynMiK4N1lAeafEZh7pLaV/pjUZRFmpoSUZqCAKZFyEoVdK1HGexRBkbsSMLMxw1H/2KTPKSKR71vwe/m/Q4pcP+hP1DJ3ri2c9wLy6dk1djeWX5VyTIbGhGcHfsjBAhJl15SDwTATCm4smk7SlNMl6ZYYyCAYdpTsq6807lnV/chFvcd/kwi06ttxS605PwpHDEqmL68eInQWy1PQhlKioXpxphmdGu9DzW8Rg0RvBbBBxcCddMM6yJzh/xfCt/bEu+h9EWKzz4jAfTESvzbiGqDX9+9cktrOJHkG/584LfCnppPliyxiCnD0V6L6L2tfsuQPKjoU9srgG4e0SwotXvlrh9WPe4OBUEWYdz0LCo4JThbQQcfeKDpjZgqnz0BTr6SieW4rqxtegcM3qVHtiJjJVmKLFvXGuv4dsWjY6lAuqhwYVusk6Vwp7hhycnKYM2IG+qxaNsP9z5ul2ZTxwSvNe3EBmcL+bIF7yXFt7/VXjkOPyDhVbNEa83g8X8tf9DCc9/f80jcUJLflsB+uqzHF9b83hlKEWKEA7KkdjMGCRisZ2p7XFEiE7MZKuYf4WbKIw2XSosxSBfy2FMZFMN1cgFnlXzZIUxl37h3HXbGGXWdWQQZTAypDL764MHXUThKwYv5BUP6YDJnUewLTZm3u6vJU8f4u5NkkQkNFz8ME3125z27Iw0axS1H4KbJXWbbOQYrMhg8VHu1vfDSotuyeS4rTauU4ASYksKaET7wx7ZS7cOWdyN80TMSAG8F7eQ4HOx+eejywsU2OAskE8v7m5LfiTwbTB32qIOXSrdTSQyGRd0I6fGzND0SRvLCzeXXbIqospbAHZxbjSYprtmlDi6q32IPgXv1YRhuTEqYjpqN8geuAu/N+9a2xnoSwIoRxFEKEUSdBbR1x963itx5QvDvJS84WfcdfHOEd9IwdU0aVV1Y96KrwO8KgbcFegzTgVigEmI1Q0CJOXv6DyYQIilqrz6VuTV2ErAUdJfa+4Vd92HQ9OTOjoUGFIq3UY4BdOGF4fnb2gqVD8Fjww/bmQlA9VAgGNvk3hvL12SFc51UuQD2+0171xtJWRICDbA9Vd9tL7+kaJGVsn0WVAZ+RwGXFQaz2gOW9Vd3/1LBOL+p/Exk1TlDAApaowEJwndzq2A7Bd83JhoQAYgGSDlgoJ9Urcd0GaGXjSTrcTQOUCjTXtC574rwIlDuFoz8+Z0h32dKlyY7YirpMtI4+gm55/ry1bZwnrvAnyWATY39kmaEA1bM9wYfPvK2oWoJKOmE94NJdzGIHPKAYvTKvXYh/9R9T0kAzBywfJTAiqI8FwhzOtXekzHqYWs0JaxTc6WVR9+yhX3ZBX6UazzWQTgLAx3x/uH3TdSVKaQm69rapu2OUAAIwEoS3aCaEIjg/WTxIrG3hiwO82YmAO43rkVYRMTJ4WFStfyDLziBd8cMcqXUP/EBT6lZRMT4X2gJY7pMTz63ozliDGmiXVd+P5Z/in4r3QSYNGCfvdAumkGzk5DhU7IQ8P/mePsl4YVUiUihdiqHc4jcv5Wvbo726PoUWz6jL/Y9WKeOot7aq0uX2nkwbPLQlEiVQP4wGUVtGynlyXE1Tw1oQ4jxTVqjhSKAAFVDzYSQAQfP5CwrmTf/Vfloq9rHCMAAAcNeCxJvReNrdqQWaiQwyCjvmPtQ41sqQ3RMkwVOz92Ht1HNHvBBbtrFblh/6b2u+K7qyDGGsh72/ilE0ONHPoC3QGNGDCBEieQaOBqXFS0O9exjMEDNGCGDAptcFTlKbeAw94JZDiSAX+iuNpixPV2WbjQMNbvFueehDZ1r49NzC7DmMuydxc99o2M3tSgd/sVHU8IdSu9/VvwG62kFD5ach/0WMm+BFUCe/Hf1E4YWJwqMZMkTju2WfY9lSUHYejcPGtjzsfCimB4bIZB0Di+dgEn5B19yoFXDpQ70Jl2Ywee9iw69jODZNKwgzSiNHP4/u5Zjw0fJQ+XkPotE8gQsetF7fnhufbRZNlikOik0hA6E/kHXvmvFpdawF3SAU/LetHcds4anz/mnKJGmv9dV+Q/hhRbwb9MUQWiAhPzWsO+blb+iqFc6ZujzLWE3xWOt2FQv4AS3UERlgF05wwijnFP94oAa0xGTNIJrrBqIbdvYvAMtAVAGIc+aI2/LhpE+yGEqFzsxXXLkln3rrVS1kC4BSBtz54tzZE1RkkJDo1lBSw9uYa1DMC54ekwKAzs8d03RUrG3TjuDTQN0kXVjUI79YO+jNjH3fGn269h5RFPS0cCT74gN3wcmY3X98WMf2LH/BJemCEI70IVGoLczHlHT0AGG8b2K1QgPDvnRgz0drOHC6gmfLeTnDj+fKEw5bakML01g/tLIgc+VLL+i9M7iSB0FvZSx+15TTgAzWGroDbFmBFoXeNLkAGpTEULA4OH+1jSsIMVQPxFebEF8fcDODyc7BTURT3ieENgXOZIc0FSZ8lI1Gfu1yptPSN+sWFPXf1zRWSezs92NSV+sDo1A2rGvlD14Fgkyi4Q98mySt6K3MQ0rqFPvdwizkeOEoD3JD7QhsioABpZb9Hj3P9crR5JvnE3VYcVVUS32557KnliEAd+mlQ6gqhuqDll2aCsDk6VzeS2Y2MkHC0roqU22v89IgPL+Bmrj6J0hBsGVcPLDCIBBIYwUCtxMafajx94fft/mTRsqQ5oA6RUsr0OqIFdkfqcmaumGiXHT9Hc7Ky4Oz0+TAJwNkXdzHELuOx2VybGIMxLgva5yN5/nwOStn9VcDFfCrNIKmEPyXV60uCnWiekAjRW1sVkuZlhCM4uIT+b+prhheXpLp29ExUkH+o5ft+u+dDkAWw9hAynuT+1lyYHfMxLg5VbRQZKLqnkCKTtv3Fy5/ni8m+oTNUWdTkIm5dIYQ2tanzp0a9X69AiAoWksCYHzuq2tNDlFfEYCPNP8gUVE6Q+OGPYYTvVJ2eG8Bxvf1KmzmjJS2G/aLrMCjVraaL+ofzVNDkgUYIm+V9pK0jBD1x99b4YUdFKti20M/jeW7/D+33cWKXFFU6eVr5Vi6SZokpLFr3XsSpcAdtSU6M8SB4xZBG049hfqDYPerw2Bqyk+xgbWqui5Zufywkh9cmRiOi8WjECnBghQ2X8kXQKQqYI5+j91pKMDnjr+V5sQdKIS9tkoDpGC0XiQV5xbCPys+ul4KizGtFqUHNMMRoBmpffsCODifds7diU7TGckwObmIpvosVIZLcVgU3iArhCrbc+xCP7bal7qjPWSva9qI1VWj32dA57w8HWZtBD7sCHuJuDCcznqTC1sX+qjEF5OQU91sgd6RgL8qaMChxtQqxiC56UggI3K2Gw4OicwS1ywvO5VODKqSoMbxjEq6hwkwD/uutsZ4mhOEBiX3tEhaATPQQXgELmSvoPJ23BGApT0HQIXzkKZSCfYo0IKAlgRkofaxokE9zrFwKK6LdTgRVew5ut/j1a4Ye8aEMgOAjjhmRt1phY2LuWZLeSvG2xJQwk3Rjtc2AcVR6xgJ+tUUUALze3KxlZNPmynJ+VeJM5+vW2nCo4vyqHpE/1JtX62b4OTLA70T7EabnTB4CMnwOsMBTvifWkQQNbli6U5dioHdKJ8TxUHZ1GqEGeRkObwE+hxQXjeiobXItoIUMbpu/Jrn0cXVcjFzo2pupATPjPgCHEXSAsUbQRlOFo+4Cs777aFPFbqEZm6eJMUAGokiaIU2IQZNXN24ZwHDm/tiPVQWAtj1OrE1yClvdj9MJAYiUvWE0c1RnApb697yUYFbq6QN3VJOiIBAyAe/qlshYJSYOwZMSB13bNO6vyMWN80YfJOZALfeTsCNKvL/3/3/Ko80hAlqK+e8fa/41vUSYu6o2P8XMVkhaJRKSvDLA2/2cX1m7GaDNvbnDJz7sznEkuRef8djb830iIAfOzjze+6hTwrSvb0mm8k1LLXGg44ECQasAo5X9n94MsnSuArYrAo47s4nkVV7gqrq6Npc2i/GeZ87uTozZza50AJ27AkDzEfo2cICKPomxmavbldIlKOmQDwsW90lM0S51swFu23pEsApDzrrxBwF6DKcorBL5aueLtztzxiCnkKF266wXpeqrrWONjeJkcSDaBGAJJ4DzyDBRAYp/FZpZSzEDAZeXnREnACVH2EuuFRCKAf6G++buf99BnBdGvVXNian7PyWIoExLNS30mnwF1YNP/3rUXnlKec6N+nNURbHz7y1n/sWtcY7dRZ3Yg2QlDrlpr1btGXhXgn5oWNToAAWPM3Vqxujvdo5pjK09YoOkDrV4durnoMWxcKQYeQXjLaRuBs7PrFoBwoMbHfMCiuW6ufUM8lClDJtrK79/D1FWvchXk/rFrTpwyAWIrT6U/m1ev3rHIKHiAA9p4D12dUAlBfLu6Ow5tRragjwGBHRcZp+jPNoovncJT1+Ka+wO5bwxxoctDnV5UuTekWmL0kGeZXT8BQGWpzLB1JdLPHHtJZY11kqPXZKa39VILLRtV4RV+jf/+Ts6R5doq4LKjblPxehNSnoVaacfXOxW6eBrOO1BoPYQw8WUcMwSZwbn727kgD69+YlhmKd1ovt5zH5zmBCdJHhJ1+EEAPE7ZF8H61bEXK9s4aa3dhXomulKm23XztqU1u2APZ7GqpUV961lnGUNVjcvvShm2fL70fI8aSH/xNOGcbjxecvv0fkh/tJU2bJeY5CKLpMDv/nc76kt+5g6NcvC+bx3Lof9x5b1SPolk1UtXwaByAhSKG8oPKtRjNGN8QGBsyLJjDGBW5/fDLKf3iD5vU6GY/1URT29T6m1UsY8dPrD01m32a5VCkBId0OPWH8w489zHxNhxwIvpdCFzgwFr/+/Ds6t7GJHIizo+diKbBVlMdMqiyOaz4FA5AFJCPbBZsRmQPz/ntsb+YYOSRSiZHs4Lo2frGE6GZwlxbqmDc6JdVzHWFgjNEMMgCL7aKqfbQ3ETTd6Nmiad2cRrDi00+oNIUajFN/S5j2uD29vLZdZuuLV0GJ5Ra1OVaMNjOYaspPvdCaV5cG0oiAJYRkwujvd+910I1hw52sEaqG7BS62WSGcFryu6p7G80pY86Aj59FA5ADC18h8NDrV/ftdIxPgI44eV8vl3wf6p4cUlvXcpjDJse1ZQjQx31gycORk+0xvtiZr/hkXzT05fGOgLhdmn9WvTwULvYc+C5Vukn+zZ8QlxoQZiCj7rUcS7EzeM0nyzsIud3Ct6f1mwYgceo9wkrAl3ZuB2/DgZByRBKVgOgACSsj7NIaH8/eHhbXFUYrmLEwvlRsKFUn6HrA1o0/8DzNuyShjYvDQVLnwBCrlWYDVruyxX31w2d0BOACSMx6pz9W0+UjB2Lt73aVrqsduvcmk2z619Y1fDWtradxT31B/qPt8R7BtSoOkIjM3x5XFe65EhTtK28r2FH176nTvCLa7f+U9l9bmxkFCQlRF1CaZ6lk0bqugu8OHcMa5sD9x55fQTpqFJIF3vPKXMOvOAgAw+lvGiWIp2u7TD84A6ByRe4IJQfHthvkM2HDDgCOHpUdDTGMbGPglHYXYOgVMGDLSkpwZ8uDSgxjYOObqpa26cOwomIs3iLavav0hOsDm4y7N33KlbPlOYhyQWPDeHAfrcQuLL4ji/tXPHvFY/8Z+W6nJqn59dtWnbwlfsOv3Zv4x/vbNi2qH7L7Jrf/azqiRv3PPKNsoeuKV1+cdFCzGanDKII1Dkt7J0lzX+zY1dyqYN5Y7reEY/8x55HUghbGrzkJtDUd/esjutnW6hNBxPT0Ki6VfnHVeh92LDZKTUbTJsJvM4QNga+p+EPZqcJzUjUgjMXFF2fo0Odt9VvPr9wnhX8TGww7LGGfRR1oQOLGBsQILlWyWOVOJK/XqxaIIHrCiEwwCZ6syQOxbTEWsignElxOCjhCu/29d0PHx1qSdp+s509EKC05/CnS36R6t1QmjlCuZeXLhF7D6SEwY7mCVNQBLVXXNfe6tx9qbTQFvawrbSnOaDHghMMwZsLbusoYUVlaqK+jAHo4JDt6Kq6Ye9ahxh0Y/AVns9liR5Qjy4+SPTGzISNgGakPD1YLhhCz86J3Sf9thCWIjsTpXEkYfD4W1NxgIUcRpAYS2pfjauxM26Vpr/SXjhTSDH82ynC7QVBPdxe/1JEiY6jZZlmJOBsuPr06Ly6LZgIxcx7XroobcyX4bnIa4y1EgEU1giafii10WN3HdrmKgD7miMYpMnFVkpzsnpPagaL/bXtIeyvjY0AKN+UJeB5twpsnBsbX+jHplHwJnBQsDYtBZrTEoa39ZzHzwaFryR7ebqRaISo5tQ9mbIfqpNgWNcW390W7xlLyGu0Ag1mfau6TBLC2D94ZBafD+I4C7YyTaPIgQPD/ZcVL8aJUKhxZQoAoJCrGTz2tbIHnVTEgZPGxQBrq20z/Qa/WfzPn6w79JCTmWh/joMhfW78yTwjajMcwrJOZFPMp6Y6KyFMK95Ys0ZV4yM4iOTAyagL5X8oXmRJefIE30eKZj95/K+JPjAZ65qI1Fh55O2ZWDQLG5reTHLWmzyn+inqqGIgehF0WqzvqRPCRwtvd43Pxk33Qmg3GaCI5AA9IeVeIS15F6sHqdHC6SygsfbJqv6ntlLixeEEoAJQxnlIfouYu7R+a78cU1gwL9W2jpUAGjV7PBJtuaFiNUGu057Ok13AfW3niiFdVsjHa4i237rvCXB8UG5M7nhhdJQkjKOB9TlD4qwhz08PPN2lRlghRpKbgb8cVOP51ZscpH6Gfy8KYCCLowLwf3bnXcfkdjL8tRGHrZwlAVidCJzcvf1HPhqe707zO1NLdWzX/PP9T7/RUfarpneuFJfawGERchyIt0iPn8Z5YSYd3SUcBZfNez8m3L4PnFXtw3LzYV8cSFDaW39VyXLU/EkEcBR4wY/DfsG874tFdxX01WhsnJOqJMY6ZYQABrOK0GL0738GjL80D10ADkhWYe55fOCjhbdli3OxtRyYmCFs4p9asGb4QkAV2AXYJTTkv3XvExh7NkvBRq52e7Z5x/niXCzUTioWArlkQVvZ6wjNfqDx9QFqwqaYfUlTa+G0CMAK1ozqwSPnifnpcQBqS79DQgPZRsNhssRchxSgiWN+dyrcY2Yvi4hKGyOgYvDTRcv+0r1XYV8O23yOEC0YNGLXo+Cl6H+STQU2mGsH5ygI3lz12x65jw35SIS+U8PE01PCMiOroj9ydPsl4bkEAQoQNibFDlJHWpzfgqcPi87wVXb0kjgLWpDp1v2M66ICNyy2dYfyfne8QFPjJnIPR2SpiXhfoo+Orv+5a69NCFrg+OPo5wA1wMBRw2ieSfAm2Ight/bZ4/F2lc36MeHsbN8mpnd0l9I3v24Tut1SwF7gT7d0bbIv1nY+0fuKuubg45v2PhrRhpKPPHk/Kmvw0xPvzd230Q4+OTooefg+IW9WmKami0GrgJMcPlV219FYm8yMnjTT3WdJAPgUWY3/rOZpcPyckgc8rKnf5VEvs8KHyh1oVFLOd6sePTjQhod+2J7pFDem/mtwbW0tnhWeDzoWRSgQAKwmEKGUZAWPzyX4rim7b1f/QTbEMpG7mxQCwEc1DnbcWr0hS/K40q4dnIrdT/SyyhaC2VJ+RW+9ik3xksQ0IiRohhuygPyN8lXwBcn8D7hDAYwK80HihlyQY1/b9TDfU6sq1P5RZ5Gz9ECYZ907WjNwMIURVWO31jz5Ef5c5wCWQXSwKTz87LVH31PMIvjhQoMlw9kIvXBPDYj7bHKyLNhWGk0GRwibdF8ozfnvqt92KxGFnk2TajBwne4+njUH6KyfFnyB49GOQN2zU77FKQmAI3hC3pnhvPxDL8TUIZW6wmlJ428p6qOzQIIHpL+Ui93pMcGCqXYsFhJyzwvP+fWRt0/EO1lnTwahG5vZmSECJK9bqx+zCgE3SNgCzgk2QzhoCyNMGpyvGVLKgRoZ3WuJgkg06wgMLQueX9jBgIPPmSFy82pf7hs2lpzS38xyVBMhWvglOF/Ognywc8BZmSEGLFKevQDnPFwjLftj206qXCU1PT6gZcYI0BbvXnpo2/lSvh3j9T7HDp8zFLRjvsmXHfKNpZlxpi4WpraLhHLAC4ttLeHc86U5uTXP9SsDwzAZcILjlL43pzUTOrE51nlj1Vrw3rN5NkTMYxFzLytc9OP9T+4fOh7HTuasqfM4qn9oZW6Snm70qwO/ObL940WLsMGXRNFKIegs8FPfrMlztWw4mdNHI/KCMyggSjZoYPXhN1rifSYm5dTF+kNSjkKmLJSsGasats8Mz6WchB9L5MTgtypW/rl9Jwh9GhmGL2Eqd5xQ78wNcNDiCmX9D/e33LT3sfML8+x8Dlbps5j+JIogNgwyG9MJnBsnEnu+Wf7r99srqbOaGkvqVJGYZqKbIzwU+c+dFTP5/OwPckDxfqZoGShbvmu/rMgq685mJknGMqIn9coYARTsPI7VhKCOWuJdm04UXB1eSiVUXFZ4Uj01K7WymCF6XKL/Qn5ecP/G+miLplCrZDbbaHjAGXeSZqhgj6ny/oavlT9gEUBdz8upeaawd1+P0gdHPkr4Lpy9gekBwq8bac84S16ZHOhM7KtoCVRVi9zL7d94Vcmd7h1eCkUkCgqJIRjAwhxpiqlUNueUOmNi9pHNV6O/4qhTVpVozuR0JA+IEMxCCRvr0yh4Lyqc//29a4txrBFukmIwO2XkyZRsWLyuqK3KwOLqP/xP1dN/7CjplHsZlosUA+vsTSWfzNbUWQWHkq7hP2xlcJ7waYuKHYxebbCod3+g9tmLwwvYnmIkQPBaJDBOvFaewxJObAhlUgLTXiEf5XjR5nNStsvJRqyxubP4pwA5oijorZjyDVDWl14CP3GMnP9fKh76Q3tJS7xHTjYzR7hXPP5ozqtKjzpYO9AWUeOJ1tYTDqSfKALAYVHIqqAsk96t9DzV9Ndbq397RemdMzE77wHn3gXGieixIbyJo6mmCKm0SX5ymlg+HSFmCPPDYbe46Wjh8NQ9gU12JIPHGeLQxueDHy1cfEvleqG3WsEcImvRMhIWZ9hKDNxDpUoj6xkc1YzJTdgGsTVRBFBYPsLMvKPLo+hqRIkU9Rx4pjV0S9UTHyu607Yjzy3kYSyaAJrADXZqDGLBCiy8rJg5Cbj4oAssWoy5BqzklDppmCC7gB5uIXB12bL7j7z2fkdlpzxAIBfWJyohF0ddMuuqTe04mKQ6BQY5fTlAN8xBsgbNJzSoWJsdRyr779P6t7fvztn/7PlFiyxinpWOMxjd5yGeO9cqgAWSay30IDJeyMHEmZhjgYv/uZ3/uSP0/7IKub8ryrsyfPf8mi3FA4dULYbzdOlT0ECUo0Zcpv7PqaWIaoJ/E4hU9Wxmcp71mjAdYLZn0thMYFJ9J7+qWftDCk4d0AeF7prftYTurH/lf2qe+s6+R765Z+W/lN3/hdK7rt25/KrSpdeULvvczmVf2n3PN/b88vuVj+bWPH3Xwa2bW6TyyKEhPWpW17FgGOG5kd2YkciiNKl1gCmsmFurm/dvdnafaC0wcTrglDOUOFD6sL/ow58g62qX0n8s1lU31Fw9cHRPpGl3X0N5pLGy/2jN4Imjse5ueUA5zfk06aklpAX7w0lDZwwawHzaKYNGTr/5CV4TSIC/rbGsvxFgitffCDDF628EmOL1NwJM8fr/Qhln69jkwFYAAAAASUVORK5CYII=
// @grant        none
// @run-at       document-end
// @license      MIT
// @downloadURL https://update.greasyfork.org/scripts/445178/wxmp-history-url.user.js
// @updateURL https://update.greasyfork.org/scripts/445178/wxmp-history-url.meta.js
// ==/UserScript==

(function() {
    'use strict';
    appendStyle();
    appendCustomer();
})();

function appendStyle() {
    var styles = document.createElement('style');
    styles.type = 'text/css';
    styles.innerHTML = ".mppu-tool{ position:fixed;bottom:20%;right:20px; padding:10px;border-radius:8px;background: #51a8dd; cursor:pointer;} .mppu-tool .btn-copy{ display: flex;justify-content: center;align-items: center;color: #fff;} .mppu-url{ position:fixed;bottom:30%;right:20px; padding:10px;border-radius:8px;background: #51a8dd; cursor:pointer;}";
    document.getElementsByTagName('head')[0].appendChild(styles);
}

function appendCustomer() {
    let div = document.createElement("div");
    div.id = "mppu-tool";
    div.className = "mppu-tool";
    div.innerHTML = "<span id='mppu-btn-copy' class='btn-copy'>显示历史消息URL</span>";
    div.onclick = function (event) {
        const copyBtn = document.getElementById("mppu-btn-copy");
        if (copyBtn.innerText == "显示历史消息URL") {
            copyBtn.innerText = "关闭"
            const url = extraUrl();
            showUrl(url)
        } else {
            copyBtn.innerText = "显示历史消息URL"
            let tool = document.getElementById("mppu-url");
            tool.style.display = 'none';
        }
    };
    document.body.append(div)
}

function extraUrl() {
    let body = document.body.innerHTML;
    const results = body.matchAll(/var biz = "(?<biz>.*)" \|\| ""/mg)
    // console.log(results);
    const [result] = results;
    if (!result || result == undefined) return "";
    const biz = result.groups.biz;
    return biz ? 'https://mp.weixin.qq.com/mp/profile_ext?action=home&__biz=' + biz + '#wechat_redirect': '';
    // const profileUrl = 'https://mp.weixin.qq.com/mp/profile_ext?action=home&__biz=' + biz + '#wechat_redirect';
    // console.log(profileUrl);
    // return profileUrl;
}

function showUrl(url) {
    let tool = document.getElementById("mppu-url");
    if (tool) {
        document.body.removeChild(tool);
    }
    let span = document.createElement("span");
    span.id="mppu-url";
    span.className = "mppu-url";
    span.append(url? url: "无法获取");
    document.body.append(span);
}