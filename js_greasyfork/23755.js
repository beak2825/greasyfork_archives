// ==UserScript==
// @name        WaniKani Kanji Support
// @namespace   Aru
// @description Adds useful links to the Kanji and Lesson pages
// @include     http*.wanikani.com/kanji/*
// @include     http*.wanikani.com/level/*/kanji/*
// @include     https://www.wanikani.com/review/session*
// @include     http://www.wanikani.com/review/session*
// @include     https://www.wanikani.com/lesson/session*
// @include     http://www.wanikani.com/lesson/session*
// @version     0.1.0.3
// @grant       none
// @downloadURL https://update.greasyfork.org/scripts/23755/WaniKani%20Kanji%20Support.user.js
// @updateURL https://update.greasyfork.org/scripts/23755/WaniKani%20Kanji%20Support.meta.js
// ==/UserScript==

// Based on Looki's original info page alc link script

$(document).ready(initVars);

var objCurItem;
var strCurrentVCR;
var strCurrentVCRType;
var strCurrentArena;
var strInfoPageLinkListElement;
var strLinkString;
var strLinkContent;
var strJishoURL = "http://classic.jisho.org";
var WKJishoArray = {卵:'21365',浜:'27996',七:'19971',謎:'35598',二:'20108',雇:'38599',加:'21152',潔:'28500',三:'19977',鳩:'40169',山:'23665',衆:'34886',値:'20516',岐:'23696',大:'22823',女:'22899',芽:'33469',販:'36009',巨:'24040',排:'25490',湧:'28263',才:'25165',替:'26367',煙:'29017',仙:'20185',員:'21729',奪:'22890',階:'38542',度:'24230',卓:'21331',右:'21491',聡:'32865',意:'24847',拒:'25298',甘:'29976',白:'30333',牛:'29275',磨:'30952',花:'33457',牙:'29273',公:'20844',鋼:'37628',玉:'29577',応:'24540',立:'31435',笛:'31515',微:'24494',位:'20301',切:'20999',陥:'38501',札:'26413',太:'22826',量:'37327',竹:'31481',寺:'23546',戸:'25144',代:'20195',貸:'36024',婦:'23142',神:'31070',少:'23569',舞:'33310',各:'21508',誘:'35480',欄:'27396',他:'20182',氷:'27703',有:'26377',肉:'32905',頂:'38914',矢:'30690',母:'27597',章:'31456',皮:'30382',埼:'22524',史:'21490',飯:'39151',皿:'30399',四:'22235',農:'36786',休:'20241',群:'32676',小:'23567',洋:'27915',手:'25163',資:'36039',短:'30701',惰:'24816',充:'20805',易:'26131',町:'30010',耳:'32819',未:'26410',退:'36864',糸:'31992',例:'20363',虫:'34411',剰:'21104',不:'19981',学:'23398',交:'20132',成:'25104',練:'32244',凍:'20941',仕:'20181',万:'19975',漸:'28472',行:'34892',同:'21516',希:'24076',駅:'39365',鳴:'40180',西:'35199',協:'21332',体:'20307',児:'20816',貫:'36011',声:'22768',湿:'28287',目:'30446',走:'36208',亡:'20129',収:'21454',金:'37329',空:'31354',雨:'38632',谷:'35895',青:'38738',林:'26519',第:'31532',化:'21270',安:'23433',入:'20837',畔:'30036',判:'21028',括:'25324',季:'23395',固:'22266',車:'36554',親:'35242',両:'20001',乗:'20055',涙:'28057',集:'38598',九:'20061',血:'34880',父:'29238',勧:'21223',繊:'32330',違:'36949',回:'22238',知:'30693',明:'26126',歩:'27497',店:'24215',枯:'26543',周:'21608',権:'27177',科:'31185',犠:'29344',味:'21619',南:'21335',沸:'27832',茶:'33590',椅:'26885',活:'27963',海:'28023',百:'30334',願:'39000',赤:'36196',惨:'24808',孔:'23380',由:'30001',恋:'24651',怠:'24608',失:'22833',全:'20840',必:'24517',久:'20037',翔:'32724',末:'26411',校:'26657',般:'33324',裂:'35010',家:'23478',遭:'36973',紙:'32025',帥:'24101',対:'23550',理:'29702',魚:'39770',逸:'36920',燥:'29157',鳥:'40165',船:'33337',雪:'38634',黄:'40644',週:'36913',胡:'32993',用:'29992',君:'21531',暗:'26263',布:'24067',接:'25509',幻:'24187',投:'25237',杯:'26479',役:'24441',作:'20316',紋:'32011',買:'36023',研:'30740',馬:'39340',飛:'39131',負:'36000',瓶:'29942',島:'23798',絵:'32117',監:'30435',楽:'27005',雲:'38642',話:'35441',数:'25968',詩:'35433',践:'36341',肥:'32933',所:'25152',停:'20572',酒:'37202',県:'30476',待:'24453',又:'21448',重:'37325',盗:'30423',深:'28145',倍:'20493',累:'32047',温:'28201',迫:'36843',求:'27714',項:'38917',死:'27515',村:'26449',銀:'37504',速:'36895',羊:'32650',名:'21517',鹿:'40575',人:'20154',夕:'22805',茎:'33550',広:'24195',八:'20843',住:'20303',主:'20027',分:'20998',低:'20302',途:'36884',電:'38651',通:'36890',見:'35211',友:'21451',帝:'24093',日:'26085',薄:'34180',朴:'26420',嵐:'23888',高:'39640',補:'35036',露:'38706',方:'26041',池:'27744',月:'26376',雅:'38597',好:'22909',里:'37324',貞:'35998',前:'21069',技:'25216',長:'38263',之:'20043',格:'26684',尻:'23611',読:'35501',気:'27671',反:'21453',能:'33021',冒:'20882',物:'29289',育:'32946',悦:'24742',星:'26143',新:'26032',私:'31169',使:'20351',寂:'23490',勝:'21213',奇:'22855',予:'20104',答:'31572',轄:'36676',便:'20415',光:'20809',骨:'39592',訓:'35347',泳:'27891',遊:'36938',遠:'36960',具:'20855',持:'25345',即:'21363',送:'36865',粘:'31896',設:'35373',械:'26800',虚:'34394',準:'28310',麗:'40599',報:'22577',館:'39208',卒:'21330',業:'26989',次:'27425',談:'35527',放:'25918',服:'26381',囲:'22258',社:'31038',美:'32654',底:'24213',表:'34920',模:'27169',評:'35413',荒:'33618',靖:'38742',院:'38498',飲:'39154',唄:'21764',顔:'38996',聞:'32862',習:'32722',蝶:'34678',錬:'37676',音:'38899',写:'20889',最:'26368',転:'36578',士:'22763',醸:'37304',芯:'33455',償:'20767',列:'21015',了:'20102',路:'36335',運:'36939',致:'33268',保:'20445',望:'26395',注:'27880',拾:'25342',仲:'20210',御:'24481',特:'29305',酎:'37198',努:'21162',吉:'21513',超:'36229',師:'24107',弓:'24339',共:'20849',約:'32004',基:'22522',波:'27874',会:'20250',移:'31227',欠:'27424',出:'20986',執:'22519',鉄:'37444',腸:'33144',鼻:'40763',隻:'38587',羅:'32645',番:'30058',任:'20219',北:'21271',庭:'24237',術:'34899',売:'22770',決:'27770',一:'19968',課:'35506',然:'28982',風:'39080',東:'26481',動:'21205',参:'21442',息:'24687',根:'26681',喝:'21917',商:'21830',堅:'22533',童:'31461',悲:'24754',供:'20379',笑:'31505',俺:'20474',植:'26893',賞:'36062',棟:'26847',尼:'23612',期:'26399',齢:'40802',喪:'21930',鏡:'37857',秋:'31179',塊:'22602',膜:'33180',映:'26144',席:'24109',問:'21839',岩:'23721',六:'20845',帰:'24112',返:'36820',貝:'35997',塩:'22633',昼:'26172',刀:'20992',様:'27096',慨:'24936',区:'21306',綱:'32177',計:'35336',陪:'38506',想:'24819',寄:'23492',無:'28961',結:'32080',葉:'33865',果:'26524',億:'20740',橋:'27211',歯:'27503',僚:'20698',天:'22825',痛:'30171',王:'29579',石:'30707',犬:'29356',釈:'37320',譜:'35676',建:'24314',礼:'31036',界:'30028',申:'30003',診:'35386',肪:'32938',振:'25391',禍:'31117',飼:'39164',雄:'38596',麦:'40614',廉:'24265',経:'32076',勉:'21193',角:'35282',崇:'23815',医:'21307',発:'30330',戻:'25147',労:'21172',熱:'29105',客:'23458',漢:'28450',批:'25209',坂:'22338',秒:'31186',阪:'38442',詳:'35443',抗:'25239',泣:'27875',梅:'26757',真:'30495',疾:'30142',急:'24613',箱:'31665',猫:'29483',懐:'25040',軍:'36557',典:'20856',府:'24220',市:'24066',連:'36899',検:'26908',侮:'20398',英:'33521',川:'24029',築:'31689',聴:'32884',喜:'21916',力:'21147',辞:'36766',信:'20449',変:'22793',仏:'20175',取:'21462',非:'38750',初:'21021',渉:'28169',弁:'24321',式:'24335',寡:'23521',是:'26159',証:'35388',識:'35672',寒:'23506',面:'38754',的:'30340',係:'20418',門:'38272',汽:'27773',官:'23448',辱:'36785',震:'38663',誕:'35477',養:'39178',緑:'32209',湾:'28286',残:'27531',雰:'38640',凶:'20982',妥:'22949',国:'22269',法:'27861',弔:'24340',束:'26463',折:'25240',材:'26448',憾:'25022',毒:'27602',革:'38761',去:'21435',昨:'26152',黒:'40658',浴:'28020',晩:'26217',険:'38522',遍:'36941',比:'27604',因:'22240',字:'23383',喫:'21931',夏:'22799',色:'33394',順:'38918',茜:'33564',節:'31680',若:'33509',財:'36001',渓:'28179',進:'36914',句:'21477',験:'39443',僧:'20711',稿:'31295',閥:'38309',狩:'29417',像:'20687',舌:'33292',際:'38555',敵:'25973',胸:'33016',洗:'27927',宙:'23449',敷:'25975',殺:'27578',混:'28151',暴:'26292',団:'22243',履:'23653',忙:'24537',渦:'28198',達:'36948',脳:'33075',類:'39006',種:'31278',可:'21487',豪:'35946',弟:'24351',忘:'24536',号:'21495',企:'20225',探:'25506',得:'24471',提:'25552',徒:'24466',坊:'22346',頑:'38929',困:'22256',善:'21892',災:'28797',自:'33258',級:'32026',責:'36012',増:'22679',欧:'27431',居:'23621',在:'22312',律:'24459',産:'29987',慮:'24942',嫌:'23244',落:'33853',枚:'26522',妙:'22937',妻:'22971',圧:'22311',間:'38291',外:'22806',挙:'25369',獣:'29539',倒:'20498',制:'21046',裕:'35029',冊:'20874',務:'21209',件:'20214',逆:'36870',総:'32207',岡:'23713',議:'35696',穴:'31348',守:'23432',被:'34987',銃:'37507',遣:'36963',質:'36074',害:'23475',半:'21322',疑:'30097',冗:'20887',引:'24341',警:'35686',静:'38745',覚:'35226',闇:'38343',続:'32154',旅:'26053',臨:'33256',稚:'31258',借:'20511',禅:'31109',喚:'21914',焼:'28988',論:'35542',罪:'32618',難:'38627',機:'27231',箸:'31672',塁:'22593',含:'21547',撃:'25731',認:'35469',曲:'26354',株:'26666',置:'32622',博:'21338',等:'31561',製:'35069',謝:'35613',録:'37682',局:'23616',修:'20462',案:'26696',隼:'38588',清:'28165',円:'20870',央:'22830',荷:'33655',券:'21048',勢:'21218',装:'35013',届:'23626',統:'32113',営:'21942',陣:'38499',腰:'33136',亮:'20142',肩:'32937',庁:'24193',型:'22411',旬:'26092',載:'36617',廃:'24259',京:'20140',益:'30410',濃:'28611',管:'31649',視:'35222',差:'24046',上:'19978',部:'37096',精:'31934',境:'22659',程:'31243',象:'35937',武:'27494',民:'27665',競:'31478',述:'36848',環:'29872',憲:'25010',裁:'35009',浦:'28006',粉:'31881',態:'24907',傘:'20632',展:'23637',況:'27841',鐘:'37912',影:'24433',鬼:'39740',施:'26045',兆:'20806',身:'36523',割:'21106',口:'21475',崎:'23822',限:'38480',護:'35703',規:'35215',胃:'32963',沿:'27839',側:'20596',姉:'22985',捕:'25429',景:'26223',秀:'31168',宅:'23429',呼:'21628',追:'36861',幹:'24185',抜:'25244',張:'24373',現:'29694',沢:'27810',掛:'25499',針:'37341',逮:'36910',肌:'32908',訟:'35359',横:'27178',乾:'20094',徴:'24500',足:'36275',城:'22478',伺:'20282',看:'30475',鮮:'39854',契:'22865',乳:'20083',怪:'24618',拝:'25309',属:'23646',慣:'24931',絞:'32094',品:'21697',捜:'25436',触:'35302',選:'36984',古:'21476',個:'20491',突:'31361',今:'20170',複:'35079',図:'22259',台:'21488',心:'24515',頻:'38971',生:'29983',事:'20107',五:'20116',午:'21320',語:'35486',登:'30331',常:'24120',解:'35299',義:'32681',元:'20803',合:'21512',審:'23529',済:'28168',過:'36942',澄:'28548',援:'25588',委:'22996',厚:'21402',異:'30064',策:'31574',吸:'21560',藤:'34276',菌:'33740',縁:'32257',岸:'23736',観:'35251',領:'38936',秘:'31192',千:'21315',韓:'38867',座:'24231',優:'20778',則:'21063',輸:'36664',隠:'38560',豊:'35914',祝:'31069',奥:'22885',眠:'30496',迷:'36855',萌:'33804',極:'26997',症:'30151',閣:'38307',仮:'20206',給:'32102',刑:'21009',端:'31471',盾:'30462',再:'20877',悪:'24746',就:'23601',奏:'22863',都:'37117',織:'32340',障:'38556',汁:'27713',煩:'29033',男:'30007',筆:'31558',較:'36611',河:'27827',菓:'33747',刺:'21050',励:'21169',締:'32224',怖:'24598',系:'31995',烈:'28872',猛:'29467',版:'29256',適:'36969',貧:'36007',翌:'32716',債:'20661',延:'24310',略:'30053',流:'27969',越:'36234',世:'19990',符:'31526',娘:'23064',献:'29486',宗:'23447',占:'21344',婚:'23130',江:'27743',促:'20419',催:'20652',宴:'23476',督:'30563',詰:'35440',臣:'33251',旗:'26071',押:'25276',渇:'28167',魅:'39749',快:'24555',照:'29031',覧:'35239',昇:'26119',飾:'39166',激:'28608',枕:'26517',撮:'25774',繁:'32321',壌:'22732',貯:'36015',往:'24448',創:'21109',印:'21360',造:'36896',故:'25925',屈:'23624',惑:'24785',悩:'24745',睡:'30561',復:'24489',独:'29420',受:'21463',消:'28040',専:'23554',令:'20196',付:'20184',暑:'26257',陽:'38525',蓄:'33988',単:'21336',段:'27573',街:'34903',板:'26495',添:'28155',米:'31859',索:'32034',請:'35531',緊:'32202',幼:'24188',簿:'31807',酢:'37218',香:'39321',浮:'28014',嫁:'23233',融:'34701',既:'26082',健:'20581',編:'32232',粋:'31883',棒:'26834',与:'19982',華:'33775',普:'26222',鑑:'37969',除:'38500',幾:'24190',来:'26469',聖:'32854',倉:'20489',孫:'23403',径:'24452',舎:'33294',隊:'38538',嘆:'22022',尋:'23563',討:'35342',迎:'36814',志:'24535',壊:'22730',磁:'30913',驚:'39514',帯:'24111',散:'25955',貨:'36008',筋:'31563',脈:'33032',近:'36817',銅:'37509',酔:'37204',陸:'38520',射:'23556',訳:'35379',破:'30772',滞:'28382',弱:'24369',亀:'20096',彼:'24444',炎:'28814',綺:'32186',介:'20171',靴:'38772',徳:'24499',祈:'31048',眼:'30524',偵:'20597',辺:'36794',序:'24207',賛:'36059',乏:'20047',密:'23494',食:'39135',蛇:'34503',圏:'22287',績:'32318',銭:'37549',漣:'28451',込:'36796',危:'21361',背:'32972',皇:'30343',妹:'22969',墳:'22707',党:'20826',暖:'26262',歓:'27475',雑:'38609',興:'33288',欲:'27442',染:'26579',左:'24038',朝:'26397',机:'26426',厄:'21380',劇:'21127',豆:'35910',窓:'31379',巧:'24039',湖:'28246',簡:'31777',誌:'35468',否:'21542',紹:'32057',講:'35611',政:'25919',地:'22320',互:'20114',垂:'22402',宝:'23453',灰:'28784',伴:'20276',拡:'25313',干:'24178',汗:'27735',宣:'23459',忠:'24544',納:'32013',宮:'23470',頭:'38957',園:'22290',剣:'21091',杉:'26441',料:'26009',枝:'26525',爪:'29226',盛:'30427',砂:'30722',肺:'32954',著:'33879',蔵:'34101',諸:'35576',攻:'25915',却:'21364',恩:'24681',蒸:'33976',署:'32626',賃:'36035',掃:'25475',巣:'24035',液:'28082',捨:'25448',細:'32048',操:'25805',敬:'25964',離:'38626',糖:'31958',球:'29699',似:'20284',鍋:'37707',払:'25173',崩:'23849',称:'31216',賄:'36036',敗:'25943',免:'20813',患:'24739',抵:'25269',埋:'22475',醤:'37284',爆:'29190',並:'20006',恐:'24656',毎:'27598',弾:'24382',器:'22120',貴:'36020',燃:'29123',念:'24565',授:'25480',愛:'24859',油:'27833',奴:'22900',隷:'38583',紅:'32005',純:'32020',幕:'24149',芋:'33419',推:'25512',承:'25215',揮:'25582',損:'25613',刻:'21051',恥:'24677',松:'26494',択:'25246',描:'25551',豚:'35930',郵:'37109',誤:'35492',彫:'24427',丼:'20028',顧:'39015',塀:'22592',年:'24180',緒:'32210',算:'31639',指:'25351',毛:'27611',醜:'37276',緩:'32233',場:'22580',曜:'26332',柱:'26609',寝:'23517',功:'21151',者:'32773',兄:'20804',実:'23455',水:'27700',歌:'27468',組:'32068',平:'24179',夜:'22812',恵:'24693',賂:'36034',記:'35352',更:'26356',氏:'27663',州:'24030',着:'30528',下:'19979',土:'22303',避:'36991',担:'25285',文:'25991',働:'20685',道:'36947',租:'31199',栄:'26628',田:'30000',配:'37197',贈:'36104',康:'24247',療:'30274',満:'28288',起:'36215',後:'24460',宇:'23431',効:'21177',降:'38477',候:'20505',航:'33322',購:'36092',構:'27083',粗:'31895',存:'23384',薦:'34214',強:'24375',別:'21029',確:'30906',刊:'21002',富:'23500',輩:'36649',内:'20869',寿:'23551',打:'25171',繰:'32368',需:'38656',貿:'36031',遺:'36986',及:'21450',津:'27941',維:'32173',縄:'32260',姓:'22995',滑:'28369',伎:'20238',伸:'20280',奈:'22856',幅:'24133',頼:'38972',樹:'27193',跳:'36339',沖:'27798',摘:'25688',核:'26680',踏:'36367',懸:'25080',房:'25151',壮:'22766',絶:'32118',併:'20341',盤:'30436',託:'35351',昭:'26157',妊:'22922',娠:'23072',旧:'26087',盟:'30431',漁:'28417',扱:'25201',閉:'38281',跡:'36321',漠:'28448',削:'21066',調:'35519',掲:'25522',逃:'36867',騒:'39442',傾:'20670',還:'36996',絡:'32097',従:'24467',額:'38989',均:'22343',祉:'31049',謙:'35609',縮:'32302',当:'24403',丸:'20024',十:'21313',開:'38283',歴:'27508',族:'26063',薬:'34220',泥:'27877',邦:'37030',暮:'26286',暇:'26247',点:'28857',線:'32218',救:'25937',渋:'28171',壁:'22721',斐:'26000',棋:'26827',片:'29255',塚:'22618',菜:'33756',唱:'21809',躍:'36493',吹:'21561',抑:'25233',駆:'39366',稲:'31282',褒:'35090',欺:'27450',兼:'20860',舗:'33303',巡:'24033',堀:'22528',戒:'25106',携:'25658',敏:'25935',獲:'29554',乱:'20081',透:'36879',預:'38928',誉:'35465',鈴:'37428',永:'27704',書:'26360',湯:'28271',導:'23566',蜜:'34588',徹:'24505',揚:'25562',瀬:'28716',包:'21253',措:'25514',我:'25105',桃:'26691',撤:'25764',防:'38450',蛍:'34509',唆:'21766',至:'33267',墟:'22687',蜂:'34562',虎:'34382',測:'28204',垣:'22435',硬:'30828',郷:'37111',闘:'38360',完:'23436',価:'20385',艦:'33382',桜:'26716',犯:'29359',炭:'28845',仁:'20161',拳:'25331',潜:'28508',鉱:'37489',輪:'36650',将:'23558',陰:'38512',衣:'34915',枠:'26528',偽:'20605',侵:'20405',棄:'26820',処:'20966',泉:'27849',髪:'39658',梨:'26792',晴:'26228',隆:'38534',拠:'25312',職:'32887',情:'24773',冠:'20896',遜:'36956',汚:'27738',狭:'29421',早:'26089',素:'32032',芳:'33459',噌:'22092',漂:'28418',福:'31119',相:'30456',利:'21033',賀:'36032',時:'26178',墓:'22675',俳:'20467',到:'21040',克:'20811',稼:'31292',床:'24202',思:'24605',哲:'21746',妨:'22952',僕:'20693',溝:'28317',演:'28436',奮:'22894',握:'25569',掘:'25496',弧:'24359',滝:'28381',墨:'22696',丘:'19992',募:'21215',暫:'26283',仰:'20208',珍:'29645',泊:'27850',枢:'26530',析:'26512',籍:'31821',雷:'38647',匹:'21305',司:'21496',斗:'26007',網:'32178',糾:'31998',範:'31684',焦:'28966',潟:'28511',升:'21319',貢:'36002',狂:'29378',賭:'36077',盲:'30450',誰:'35504',竜:'31452',威:'23041',沈:'27784',摩:'25705',余:'20313',娯:'23087',缶:'32566',笠:'31520',寸:'23544',寮:'23534',裸:'35064',鈍:'37389',臭:'33261',姫:'23019',良:'33391',殉:'27529',軽:'36605',多:'22810',木:'26408',塾:'22654',眺:'30522',呪:'21610',叫:'21483',刃:'20995',翼:'32764',塔:'22612',整:'25972',侍:'20365',忍:'24525',容:'23481',痢:'30178',棚:'26842',兵:'20853',命:'21629',粒:'31890',釣:'37347',曇:'26311',井:'20117',舟:'33311',矛:'30683',副:'21103',柔:'26580',刷:'21047',趣:'36259',距:'36317',旨:'26088',腕:'33109',岳:'23731',撲:'25778',懲:'25074',恒:'24658',堂:'22530',疲:'30130',暦:'26278',也:'20063',脚:'33050',炉:'28809',滅:'28357',穏:'31311',魂:'39746',泰:'27888',衛:'34907',採:'25505',詞:'35422',袋:'34955',柄:'26564',肝:'32925',尾:'23614',芝:'33437',紛:'32027',軸:'36600',挑:'25361',頃:'38915',琴:'29748',双:'21452',沼:'27836',斉:'25993',慰:'24944',筒:'31570',潮:'28526',叱:'21489',砲:'30770',霊:'38666',泡:'27873',碁:'30849',吾:'21566',屋:'23627',陛:'38491',形:'24418',悔:'24724',幽:'24189',零:'38646',寧:'23527',斬:'26028',控:'25511',憶:'25014',猿:'29503',考:'32771',察:'23519',衝:'34909',溶:'28342',銘:'37528',鍵:'37749',断:'26029',耐:'32784',勇:'21191',瞳:'30643',依:'20381',輝:'36637',俗:'20439',須:'38920',癖:'30294',巾:'24062',瞬:'30636',直:'30452',渡:'28193',積:'31309',踊:'36362',黙:'40665',鍛:'37723',換:'25563',巻:'24059',庫:'24235',賢:'36066',駒:'39378',綿:'32191',菊:'33738',阻:'38459',爽:'29245',佐:'20304',阜:'38428',俵:'20469',庄:'24196',誇:'35463',継:'32153',殿:'27583',瞭:'30637',哀:'21696',怒:'24594',詐:'35408',尺:'23610',伊:'20234',訴:'35380',霧:'38695',炊:'28810',婆:'23110',如:'22914',墜:'22684',謡:'35617',憎:'24974',帽:'24125',感:'24863',扉:'25161',扇:'25159',憩:'25001',崖:'23830',恨:'24680',火:'28779',搬:'25644',掌:'25484',挿:'25407',戯:'25135',桑:'26705',揺:'25594',咲:'21682',悟:'24735',抽:'25277',窒:'31378',滴:'28404',葬:'33900',拓:'25299',傷:'20663',誓:'35475',紫:'32043',胴:'33012',襲:'35186',剤:'21092',脇:'33031',把:'25226',淀:'28096',伯:'20271',架:'26550',駐:'39376',衡:'34913',遂:'36930',盆:'30406',虹:'34425',唇:'21767',粧:'31911',殖:'27542',剛:'21083',率:'29575',鶴:'40372',礎:'30990',堤:'22564',訂:'35330',茂:'33538',鉛:'37467',壇:'22727',斎:'25998',贅:'36101',甲:'30002',歳:'27507',以:'20197',諾:'35582',尊:'23562',珠:'29664',概:'27010',辛:'36763',儀:'20736',懇:'25031',誠:'35488',訪:'35370',廷:'24311',征:'24449',劣:'21155',堰:'22576',彰:'24432',邪:'37034',淡:'28129',畑:'30033',招:'25307',煮:'29038',支:'25903',為:'28858',子:'23376',羽:'32701',殊:'27530',標:'27161',草:'33609',穂:'31298',争:'20105',皆:'30342',票:'31080',画:'30011',勘:'21208',奨:'22888',衰:'34928',鰐:'39952',域:'22495',砕:'30741',潤:'28516',峰:'23792',向:'21521',要:'35201',涼:'28092',腹:'33145',丈:'19976',改:'25913',紀:'32000',留:'30041',魔:'39764',昔:'26132',唐:'21776',臓:'33235',亭:'20141',伝:'20253',髄:'39620',先:'20808',苦:'33510',究:'31350',朱:'26417',祭:'31085',疫:'30123',晶:'26230',幸:'24184',中:'20013',洞:'27934',滋:'28363',穫:'31339',病:'30149',和:'21644',税:'31246',浅:'27973',省:'30465',殴:'27572',塗:'22615',班:'29677',培:'22521',涯:'28079',彩:'24425',后:'21518',騎:'39438',麻:'40635',脅:'33029',尽:'23613',冬:'20908',隙:'38553',牧:'29287',畜:'30044',飢:'39138',霜:'38684',貼:'36028',鉢:'37474',妃:'22915',言:'35328',帳:'24115',謀:'35584',浸:'28024',唯:'21807',刈:'21000',翻:'32763',駄:'39364',諮:'35566',擦:'25830',芸:'33464',偶:'20598',軌:'36556',漫:'28459',蟹:'34809',鬱:'39729',告:'21578',陶:'38518',拘:'25304',斜:'26012',迅:'36805',蚊:'34442',灯:'28783',性:'24615',首:'39318',工:'24037',条:'26465',姿:'23039',罰:'32624',禁:'31105',熟:'29087',関:'38306',抱:'25265',縦:'32294',腐:'33104',港:'28207',源:'28304',慎:'24910',終:'32066',何:'20309',室:'23460',吐:'21520',勤:'21220',野:'37326',費:'36027',原:'21407',遅:'36933',裏:'35023',備:'20633',宿:'23487',状:'29366',示:'31034',戦:'25126',試:'35430',森:'26862',昆:'26118',派:'27966',許:'35377',熊:'29066',己:'24049',丁:'19969',獄:'29508',本:'26412',層:'23652',春:'26149',冷:'20919',厳:'21427',響:'38911',餓:'39187',柳:'26611',隔:'38548',封:'23553',覆:'35206',夫:'22827',劾:'21182',老:'32769',覇:'35207',且:'19988',止:'27490',漏:'28431',愚:'24858',孝:'23389',朗:'26391',赴:'36212',呂:'21570',騰:'39472',叔:'21460',郎:'37070',題:'38988',茨:'33576',鎌:'37772',廊:'24266',教:'25945',始:'22987',治:'27835',桟:'26719',慢:'24930',祥:'31077',助:'21161',正:'27491',乃:'20035',栞:'26654',夢:'22818',査:'26619',説:'35500',擁:'25793',婿:'23167',宜:'23452',賠:'36064',慕:'24917',阿:'38463',孤:'23396',拙:'25305',狙:'29401',綾:'32190',緯:'32239',曙:'26329',鎖:'37782',噴:'22132',艇:'33351',祖:'31062',搭:'25645',偏:'20559',畳:'30067',定:'23450',脱:'33073',鋭:'37613',減:'28187',酸:'37240',俊:'20426',罷:'32631',牲:'29298',秩:'31209',譲:'35698',矯:'30703',披:'25259',嬢:'23330',幣:'24163',某:'26576',囚:'22234',倫:'20523',錦:'37670',瑞:'29790',膨:'33192',偉:'20553',召:'21484',瓜:'29916',挟:'25375',耕:'32789',准:'20934',泌:'27852',藍:'34253',濯:'28655',那:'37027',鯨:'39912',堕:'22549',吟:'21535',軟:'36575',脂:'33026',肯:'32943',寛:'23515',膚:'33178',郊:'37066',胞:'32990',庶:'24246',甚:'29978',軒:'36562',鼓:'40723',糧:'31975',遇:'36935',烏:'28879',藻:'34299',妄:'22916',鎮:'37806',諭:'35565',没:'27809',奉:'22857',傍:'20621',蛮:'34542',凸:'20984',虐:'34384',徐:'24464',諒:'35538',猟:'29471',狐:'29392',据:'25454',倹:'20537',啓:'21843',莉:'33673',颯:'39087',勲:'21234',緋:'32203',葵:'33909',蒙:'33945',佳:'20339',荘:'33624',輔:'36628',酬:'37228',卸:'21368',栽:'26685',悠:'24736',尚:'23578',顕:'38997',呈:'21576',粛:'31899',該:'35442',酷:'37239',叙:'21465',痴:'30196',呆:'21574',疎:'30094',郭:'37101',愉:'24841',哺:'21754',虜:'34396',杏:'26447',傲:'20658',旦:'26086',龍:'40845',剖:'21078',酌:'37196',篤:'31716',憂:'24962',凹:'20985',紡:'32033',栃:'26627',惜:'24796',悼:'24764',癒:'30290',尿:'23615',賓:'36051',脊:'33034',循:'24490',凝:'20957',弥:'24357',昌:'26124',抹:'25273',弊:'24330',遼:'36988',瑛:'29787',拍:'25293',窮:'31406',栓:'26643',猶:'29494',宰:'23472',呉:'21577',舶:'33334',庸:'24248',搾:'25662',菅:'33733',楓:'26963',縫:'32299',恭:'24685',凡:'20961',錯:'37679',穀:'31296',陵:'38517',縛:'32283',弦:'24358',遥:'36965',乙:'20057',伐:'20240',胎:'32974',扶:'25206',峡:'23777',憤:'24996',洪:'27946',飽:'39165',摂:'25666',柴:'26612',嘉:'22025',紳:'32051',碑:'30865',尉:'23561',凛:'20955',匠:'21280',賊:'36042',旋:'26059',智:'26234',槽:'27133',漬:'28460',坪:'22378',紺:'32058',俸:'20472',閲:'38322',款:'27454',敢:'25954',酵:'37237',哉:'21705',蒼:'33980',瑠:'29792',硫:'30827',赦:'36198',窃:'31363',忌:'24524',肖:'32918',奔:'22868',朽:'26429',藩:'34281',椎:'26894',濁:'28609',殻:'27579',享:'20139',媒:'23186',鶏:'40335',嘱:'22065',迭:'36845',絹:'32121',淑:'28113',帆:'24070',暁:'26241',卑:'21329',傑:'20625',錠:'37664',凌:'20940',璃:'29827',峠:'23776',雌:'38604',堪:'22570',姻:'23035',浪:'28010',遷:'36983',梓:'26771',漆:'28422',岬:'23724',曹:'26361',酪:'37226',沙:'27801',亜:'20124',礁:'30977',屯:'23663',擬:'25836',睦:'30566',閑:'38289',詠:'35424',胆:'32966',蔑:'34065',憧:'24999',慶:'24950',汰:'27760',逝:'36893',匿:'21311',鋳:'37619',浄:'27972',邸:'37048',郡:'37089',坑:'22353',拐:'25296',隅:'38533',拷:'25335',鯉:'39881',随:'38543',媛:'23195',駿:'39423',隣:'38563',玄:'29572',戴:'25140',苗:'33495',陳:'38515',慈:'24904',丹:'20025',伏:'20239',襟:'35167',謹:'35641',遮:'36974',蓮:'34030'};

function initVars()
{
	if ( ! $.jStorage.get("pAlcLinkType") ) {
		$.jStorage.set("pAlcLinkType", "1");
	}
	
	if ( ! $.jStorage.get("pAutoloadSO") ) {
		$.jStorage.set("pAutoloadSO", "0");
	}
}

// INITIAL LOCATION CHECKS

if ($(location).attr('href').indexOf("review") != -1 || $(location).attr('href').indexOf("lesson") != -1) {
	
	$.jStorage.listenKeyChange("currentItem", function(key, action){
		strCurrentArena = "rev";
		addLink(key, "#item-info");
	});


	$.jStorage.listenKeyChange("l/currentLesson", function(key, action){
		strCurrentArena = "les";
		addLink(key, "#supplement-info");	
	});


	$.jStorage.listenKeyChange("l/currentQuizItem", function(key, action){
		strCurrentArena = "quz";
		addLink(key, "#item-info");	
	});	
	
} else {
	addInfoPageLinks();	
}

// LINK ADDING FUNCTIONS

// Reveiw, Lesson, Quiz
function addLink(strKey, strLinkElement) {
	strLinkContent = "";
	
	
	var gooURL;
	var weblioURL;
	var strStrokeORderButtonText;
	var strOptionsLinkContent;
    
    objCurItem = $.jStorage.get(strKey);
    
    
    if (objCurItem === null) {
		return 0;
	}
    
    if ("kan" in objCurItem)
	{
		strCurrentVCRType = "kan";
		// Kanji
		strLinkContent = objCurItem.kan;
		
		strLinkString = "";		
		
		
		
		
		// goo link
		gooURL = 'http://classic.jisho.org/words?jap=*' + encodeURIComponent(strLinkContent) + '*&eng=&dict=edict&common=on';
		strLinkString += " | <a class='hvAdResLink' target='_gooLink' href='"+gooURL+"'>Jisho</a>";
		// weblio link
		weblioURL = 'http://classic.jisho.org/kanji/details/' + encodeURIComponent(strLinkContent);
		strLinkString += " | <a class='hvAdResLink' target='_weblioLink' href='"+weblioURL+"'>Details</a>";
		
		// Stroke order button
		strStrokeORderButtonText = "画(手)";
		if ($.jStorage.get('pAutoloadSO') == "1") {strStrokeORderButtonText = "画(自)";}
		strLinkString += " | <a class='hvAdResLink' id='strokeOrderToggle' href=''>"+strStrokeORderButtonText+"</a>";
		
		strOptionsLinkContent = "<a class='hvAdResLink' id='additionaInfoOptionsLink' title='Additional Resource Preferences' href=''>択</a> | ";
		// Setting the click function for the options link doesn't work on lesson quiz right now. Remove link.
		if (strCurrentArena == "quz") {strOptionsLinkContent = "";}
		
		if ($(strLinkElement + " #hvAlcLinkDisplaySection").length) {
			$(strLinkElement + " #hvAlcLinkDisplaySection").html("");
			$(strLinkElement + " #hvAlcLinkDisplaySection").html(strOptionsLinkContent + strLinkContent + " on: " +strLinkString);
			clearStrokeORderDiagram();
		} else {
			$(strLinkElement).prepend( "<p><span id='hvAlcLinkDisplaySection'>"+ strOptionsLinkContent +strLinkContent + " on: " +strLinkString+" </span><div id='strokeOrderDiagram'></div></p><p></p>");
		}
		$('a.hvAdResLink').css("text-decoration", "none");
		$('a.hvAdResLink').css("color", "#ffffff");
		$('span#hvAlcLinkDisplaySection').css("padding", "4px");		
		$('span#hvAlcLinkDisplaySection').css("color", "#ffffff");
		$('span#hvAlcLinkDisplaySection').css("background-color", "#ff00aa");
		
		
		
		$('#strokeOrderToggle').click(function() {
			insertStrokeOrder(strLinkContent, "div#strokeOrderDiagram");
			return false;
		});
		
		if ($.jStorage.get('pAutoloadSO') == "1" && ! bSOVisible()) {
			insertStrokeOrder(strLinkContent, "div#strokeOrderDiagram");			
		} else {
			clearStrokeORderDiagram();
		}
		setOptionLinkProperties(strLinkElement);
		
	}
	else if ("voc" in objCurItem)
	{
		strCurrentVCRType = "voc";
		clearStrokeORderDiagram();
		// Vocabulary
		strLinkContent = objCurItem.voc;	
		// strip 〜 from vocab item
		strLinkContent =  strLinkContent.replace('〜', "");
		
		strLinkString = "";		

		// goo link
		gooURL = 'http://dictionary.goo.ne.jp/srch/all/' + encodeURIComponent(strLinkContent) + '/m0u/';
		strLinkString += " | <a class='hvAdResLink' target='_gooLink' href='"+gooURL+"'>goo</a>";
		// weblio link
		weblioURL = 'http://ejje.weblio.jp/content/' + encodeURIComponent(strLinkContent);
		strLinkString += " | <a class='hvAdResLink' target='_weblioLink' href='"+weblioURL+"'>weblio</a>";
		
		// Forvo link
		forvoURL = "http://forvo.com/search/"+ encodeURIComponent(strLinkContent) +"/";
		strLinkString += " | <a class='hvAdResLink' target='_forvoLink' href='"+forvoURL+"'>forvo</a>";
		
		strOptionsLinkContent = "<a class='hvAdResLink' id='additionaInfoOptionsLink' title='Additional Resource Preferences' href='https://www.wanikani.com'>択</a> | ";
		// Setting the click function for the options link doesn't work on lesson quiz right now. Remove link.
		if (strCurrentArena == "quz") {strOptionsLinkContent = "";}
		
		if ($(strLinkElement + " #hvAlcLinkDisplaySection").length) {
			$(strLinkElement + " #hvAlcLinkDisplaySection").html("");
			$(strLinkElement + " #hvAlcLinkDisplaySection").html(strOptionsLinkContent + strLinkContent + " on: " +strLinkString);
		} else {
			$(strLinkElement).prepend( "<p><span id='hvAlcLinkDisplaySection'>"+ strOptionsLinkContent + strLinkContent + " on: " +strLinkString+" </span><div id='strokeOrderDiagram'></div></p>" );
		}
		$('a.hvAdResLink').css("text-decoration", "none");
		$('a.hvAdResLink').css("color", "#ffffff");
		$('span#hvAlcLinkDisplaySection').css("padding", "4px");		
		$('span#hvAlcLinkDisplaySection').css("color", "#ffffff");
		$('span#hvAlcLinkDisplaySection').css("background-color", "#9f00ef");
		setOptionLinkProperties(strLinkElement);
		
	}
	else if ("rad" in objCurItem)
	{
		strCurrentVCRType = "rad";
		clearStrokeORderDiagram();
		// Clear the link element if the item is a Radical
		if ($(strLinkElement + " #hvAlcLinkDisplaySection").length) {
			$(strLinkElement + " #hvAlcLinkDisplaySection").html("");
			$('span#hvAlcLinkDisplaySection').css("padding", "0");
		}
		
		
	}
	strCurrentVCR = strLinkContent;
}

// Info page
function addInfoPageLinks()
{
	if (! $("#strokeOrderDiagram").length) {
		$("#information").before("<div id='strokeOrderDiagram'></div>");
	}
	if ($(location).attr('href').indexOf("vocabulary") != -1) {
		strInfoPageLinkListElement = "vocabulary-icon";
	} else {
		strInfoPageLinkListElement = "kanji-icon";	
	}
	
	var strItem = document.getElementsByClassName(strInfoPageLinkListElement)[0].firstChild.innerHTML;
	strCurrentVCR = strItem;
	// strip 〜 from vocab item
	strLinkContent =  strItem.replace('〜', "");
		
	// alc link	
	var strAlcLinkString;
	switch ($.jStorage.get('pAlcLinkType'))
	{
		case "1": // no login
			alcURL = 'http://eow.alc.co.jp/search?q=' + encodeURIComponent(strLinkContent);
			strAlcLinkString = "<a id='pAlcLink' target='_alcLink' href='"+alcURL+"'>alc</a>";
			break;		
		case "2":
			alcURL = 'http://eowpf.alc.co.jp/search?q=' + encodeURIComponent(strLinkContent);
			strAlcLinkString = "<a id='pAlcLink' target='_alcLink' href='"+alcURL+"'>alc*</a>";
			break;
	}
	// goo link
	var gooURL = 'http://dictionary.goo.ne.jp/srch/all/' + encodeURIComponent(strLinkContent) + '/m0u/';
	var strGooLinkString = "<a target='_gooLink' href='"+gooURL+"'>goo</a>";
	// weblio link
	var weblioURL = 'http://ejje.weblio.jp/content/' + encodeURIComponent(strLinkContent);
	var strWeblioLinkString = "<a target='_weblioLink' href='"+weblioURL+"'>weblio</a>";
	
	var forvoURL;
	var strForvoLinkString;
	var bPageIsVocab = $(location).attr('href').indexOf("vocabulary") != -1;
	if (bPageIsVocab) {
		forvoURL = "http://forvo.com/search/"+ encodeURIComponent(strLinkContent) +"/";
		strForvoLinkString = "<a target='_forvoLink' href='"+forvoURL+"'>forvo</a>";
	}
	
	
	var info = document.getElementsByClassName('page-list')[0].getElementsByTagName('ul')[0];
	
	
	var alcLi = document.createElement('li');
	var gooLi = document.createElement('li');
	var weblioLi = document.createElement('li');
	var optionsLi = document.createElement('li');
	var forvoLi;
	if (bPageIsVocab) forvoLi = document.createElement('li');
	alcLi.innerHTML = strAlcLinkString;
	gooLi.innerHTML = strGooLinkString;
	weblioLi.innerHTML = strWeblioLinkString;	
	if (bPageIsVocab) forvoLi.innerHTML = strForvoLinkString;
	optionsLi.innerHTML = "<a id='additionaInfoOptionsLink' title='Additional Resource Preferences' href=''>択</a>";	
	
	
	info.appendChild(optionsLi);
	info.appendChild(alcLi);
	info.appendChild(gooLi);
	info.appendChild(weblioLi);
	if (bPageIsVocab) info.appendChild(forvoLi);
	
	
	if ($(location).attr('href').indexOf("kanji") != -1) {
		// Stroke order button
		var SOLI = document.createElement('li');
		var strStrokeORderButtonText = "画(手)";
		if ($.jStorage.get('pAutoloadSO') == "1") {strStrokeORderButtonText = "画(自)";}
		SOLI.innerHTML = "<a  id='strokeOrderToggle' title='Show/Hide Stroke Order Diagram' href=''>"+strStrokeORderButtonText+"</a>";
		info.appendChild(SOLI);
		$('#strokeOrderToggle').click(function() {
			insertStrokeOrder(strLinkContent, "div#strokeOrderDiagram");
			return false;
		});
		
		if ($.jStorage.get('pAutoloadSO') == "1" && ! bSOVisible()) {
			insertStrokeOrder(strLinkContent, "div#strokeOrderDiagram");			
		} else {
			clearStrokeORderDiagram();
		}
	} else {
		clearStrokeORderDiagram();
	}
	
	setOptionLinkProperties("InfoPage");
}

// UI property setting functions

function setOptionLinkProperties(strLinkElement)
{
	$('#additionaInfoOptionsLink').click(function(event) {
		event.preventDefault();
		if ($("#AdditionalInfoMainOptions").length) {
		    $("#AdditionalInfoMainOptions").remove(); 
		    return false;
		    
		}
		
		if ($(location).attr('href').indexOf("review") != -1 || $(location).attr('href').indexOf("lesson") != -1) {
			// reviews and lessons
			$("#hvAlcLinkDisplaySection").after(getOptionsLinkString());
		} else {
			// info
			$("#information").before(getOptionsLinkString());
		}
		setCloseOtionsProperties();
		setOptionElementsClickResponders();
		return false;
	});
}


function setOptionElementsClickResponders()
{
	$('#pAutoloadStroke').click(function() {
		// do autoload set
		// set jstor prop
		if ($('#pAutoloadStroke').prop('checked')) {
			$.jStorage.set('pAutoloadSO', '1');
			$("#strokeOrderToggle").text("画(自)");
			if ($(location).attr('href').indexOf("kanji") != -1 || strCurrentVCRType == "kan") {
				insertStrokeOrder(strCurrentVCR, "div#strokeOrderDiagram");
			}
		} else {
			$.jStorage.set('pAutoloadSO', '0');	
			clearStrokeORderDiagram();
			$("#strokeOrderToggle").text("画(手)");
		}
	});
	
	$('#pAlcLinkType').click(function() {
		// do alc link set
		// set jstor prop
		if ($('#pAlcLinkType').prop('checked')) {
			$.jStorage.set('pAlcLinkType', '2');
		} else {
			$.jStorage.set('pAlcLinkType', '1');	
		}
		// redraw links
		var strItem = "";
		
		
		updateAlcLink();
	});
}

function setCloseOtionsProperties()
{
	$('#closeOptions').click(function() {
		$("#AdditionalInfoMainOptions").remove();
		return false;
	});
}

// Processing functions

function updateAlcLink()
{
	 var alcURL;
	 switch ($.jStorage.get('pAlcLinkType'))
	{
		case "1": // no login
			alcURL = 'http://eow.alc.co.jp/search?q=' + encodeURIComponent(strCurrentVCR);
			
			$("#pAlcLink").attr("href", alcURL);
			$("#pAlcLink").text("alc");
			break;		
		case "2":
			alcURL = 'http://eowpf.alc.co.jp/search?q=' + encodeURIComponent(strCurrentVCR);
			
			$("#pAlcLink").attr("href", alcURL);
			$("#pAlcLink").text("alc*");
			break;
	}
	 
}

function getOptionsLinkString()
{
	var strAlcProLiteChecked = '';
	if ($.jStorage.get('pAlcLinkType') == "2") {strAlcProLiteChecked = 'checked="checked"';}
	var strAutoloadSOChecked = "";
	if ($.jStorage.get('pAutoloadSO') == "1") {strAutoloadSOChecked = 'checked="checked"';}
	
	var strOptionsLink = '<div id="AdditionalInfoMainOptions" style="width:350px; text-align:center; font-family:sans-serif; font-size:14px; padding: 4px; margin-top:4px; background-color:#D8CAA7; border:1px solid #4D4D4D;"><input '+strAutoloadSOChecked+' type="checkbox" name="pAutoloadStroke" id="pAutoloadStroke" value="pAutoloadStroke"> Autoload Stroke Order | <input '+strAlcProLiteChecked+'  type="checkbox" name="pAlcLinkType" id="pAlcLinkType" value="pAlcLinkType"> ALC Pro lite | <a title="Close Preferences" style="color:#810200; text-decoration:none; font-weight:bold;" href="" id="closeOptions">x</a></div>';
	return strOptionsLink;
}



function clearStrokeORderDiagram()
{
	$("#strokeOrderDiagram").html("");
}

function insertStrokeOrder(strKanjiCharacter, strElement)
{
	if ( $("div#strokeOrderDiagram").html() === "") {
		var strStokeOrderContent = '<img src="' + strJishoURL + "/static/images/stroke_diagrams/"+ WKJishoArray[strKanjiCharacter]+"_frames.png" + '" alt="Stroke order" title="Stroke order for '+strKanjiCharacter+'" />';
		$("div#strokeOrderDiagram").html(strStokeOrderContent);
	} else {
		$("div#strokeOrderDiagram").html("");
	}
}

function bSOVisible()
{
	return $("div#strokeOrderDiagram").html() !== "";
}


