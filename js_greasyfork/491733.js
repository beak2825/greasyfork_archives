// ==UserScript==
// @name         Margonem Anti-Captcha
// @namespace    Margonem-AntiCaptcha
// @version      1.0
// @description  Skrypt rozwiązujący captcha w grze Margonem
// @author       https://discord.gg/EBzMkXvxzQ
// @match        https://*.margonem.pl/
// @exclude      https://www.margonem.pl/
// @exclude      https://addons2.margonem.pl/*
// @exclude      https://forum.margonem.pl/*
// @exclude      https://support.garmory.pl/*
// @exclude      https://pomoc.margonem.pl/*
// @grant        GM_info
// @grant        GM_setValue
// @grant        GM_getValue
// @grant        GM_listValues
// @grant        GM_xmlhttpRequest
// @grant        GM_registerMenuCommand
// @grant        unsafeWindow
// @connect      margonem-anticaptcha.pl
// @run-at 		 document-start
// @downloadURL https://update.greasyfork.org/scripts/491733/Margonem%20Anti-Captcha.user.js
// @updateURL https://update.greasyfork.org/scripts/491733/Margonem%20Anti-Captcha.meta.js
// ==/UserScript==

/**
 * Obiekt z ustawieniami wpływającymi na działanie skryptu
 * Ustawienia zapisane przy użyciu gui są nadrzędne względem poniższej konfiguracji
 */
const config = {
	/**
	 * Token używany do komunikacji z API
	 * @type {string}
	 * @example "726a5171-403f-445c-9d47-37322b608785"
	*/
	token: "4b96222f-8910-439d-a733-0b1e042fa9a9",
	/**
	 * Opcjonalny webhook Discord na który wysyłane są informacje o otrzymanych captcha
	 * Webhook zawiera:
	 * - Pytanie
	 * - Rozwiązanie
	 * - Obrazek captcha
	 * - Świat i nazwa postaci (jeśli gra jest załadowana)
	 * @type {string}
	 * @default undefined
	 */
	webhook: "",
	/**
	 * Opcje wpływające na działanie skryptu
	 */
	settings: {
		/**
		 * Minimalny czas rozwiązywania captcha w milisekundach (1s = 1000ms)
		 * Wartość używana w celu obliczenia czasu do odczekania przed wysłaniem rozwiązania jeśli API zwróci rozwiązanie szybciej
		 * @type {number}
		 */
		min: 6000,
		/**
		 * Maksymalny czas rozwiązywania captcha w milisekundach (1s = 1000ms)
		 * Wartość używana w celu obliczenia czasu do odczekania przed wysłaniem rozwiązania jeśli API zwróci rozwiązanie szybciej
		 * @type {number}
		 */
		max: 15000,
		/**
		 * Generowanie rozwiązania w przypadku nie otrzymania odpowiedzi z API
		 * Opcja nie może być używana z opcją followRedirects
		 * @type {boolean}
		 * @default false
		 */
		generateResponse: false,
		/**
		 * Pokazywanie komunikatów otrzymanych z API
		 * Komunikaty są logowane w konsoli przeglądarki i gui
		 * @type {boolean}
		 * @default true
		 */
		showMessages: true,
		/**
		 * Używanie przekierowań otrzymanych z API np. nieznane pytania
		 * Jeśli opcja jest włączona skrypt opuści grę w celu uniknięcia blokady
		 * Opcja nie może być używana z opcją generateResponse
		 * @type {boolean}
		 * @default true
		 */
		followRedirects: true,
		/**
		 * Opuszczanie gry w przypadku blokady captcha
		 * Jeśli opcja jest włączona skrypt opuści grę i wróci kiedy blokada minie
		 * @type {boolean}
		 * @default true
		 */
		temporaryLogout: true,
		/**
		 * Otwieranie captcha
		 * Jeśli opcja jest włączona skrypt rozpocznie captche w ciągu 5s-15s od jej otrzymania
		 * @type {boolean}
		 * @default true
		*/
		startCaptcha: true,
	},
};

(()=>{function A(){}function Et(t){return!!t&&(typeof t=="object"||typeof t=="function")&&typeof t.then=="function"}function zt(t){return t()}function bt(){return Object.create(null)}function oe(t){t.forEach(zt)}function Je(t){return typeof t=="function"}function ye(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function jt(t){return Object.keys(t).length===0}const St=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function a(t,e){t.appendChild(e)}function xe(t,e,n){const o=Ot(t);if(!o.getElementById(e)){const s=m("style");s.id=e,s.textContent=n,Pt(o,s)}}function Ot(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function Pt(t,e){return a(t.head||t,e),e.sheet}function M(t,e,n){t.insertBefore(e,n||null)}function z(t){t.parentNode&&t.parentNode.removeChild(t)}function At(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function m(t){return document.createElement(t)}function G(t){return document.createTextNode(t)}function y(){return G(" ")}function Mt(){return G("")}function x(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function Ae(t){return function(e){return e.preventDefault(),t.call(this,e)}}function Y(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function u(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Dt(t){return Array.from(t.childNodes)}function we(t,e,n){t.classList.toggle(e,!!n)}let Re;function te(t){Re=t}function Rt(){if(!Re)throw new Error("Function called outside component initialization");return Re}function Lt(t){Rt().$$.on_mount.push(t)}function V(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach(o=>o.call(this,e))}const _e=[],Ne=[];let ke=[];const vt=[],Wt=Promise.resolve();let qe=!1;function Tt(){qe||(qe=!0,Wt.then(He))}function Ge(t){ke.push(t)}const We=new Set;let be=0;function He(){if(be!==0)return;const t=Re;do{try{for(;be<_e.length;){const e=_e[be];be++,te(e),Nt(e.$$)}}catch(e){throw _e.length=0,be=0,e}for(te(null),_e.length=0,be=0;Ne.length;)Ne.pop()();for(let e=0;e<ke.length;e+=1){const n=ke[e];We.has(n)||(We.add(n),n())}ke.length=0}while(_e.length);for(;vt.length;)vt.pop()();qe=!1,We.clear(),te(t)}function Nt(t){if(t.fragment!==null){t.update(),oe(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Ge)}}function qt(t){const e=[],n=[];ke.forEach(o=>t.indexOf(o)===-1?e.push(o):n.push(o)),n.forEach(o=>o()),ke=e}const Pe=new Set;let ue;function Fe(){ue={r:0,c:[],p:ue}}function Be(){ue.r||oe(ue.c),ue=ue.p}function I(t,e){t&&t.i&&(Pe.delete(t),t.i(e))}function E(t,e,n,o){if(t&&t.o){if(Pe.has(t))return;Pe.add(t),ue.c.push(()=>{Pe.delete(t),o&&(n&&t.d(1),o())}),t.o(e)}else o&&o()}function Gt(t,e){const n=e.token={};function o(s,i,r,l){if(e.token!==n)return;e.resolved=l;let d=e.ctx;r!==void 0&&(d=d.slice(),d[r]=l);const g=s&&(e.current=s)(d);let $=!1;e.block&&(e.blocks?e.blocks.forEach((v,_)=>{_!==i&&v&&(Fe(),E(v,1,1,()=>{e.blocks[_]===v&&(e.blocks[_]=null)}),Be())}):e.block.d(1),g.c(),I(g,1),g.m(e.mount(),e.anchor),$=!0),e.block=g,e.blocks&&(e.blocks[i]=g),$&&He()}if(Et(t)){const s=Rt();if(t.then(i=>{te(s),o(e.then,1,e.value,i),te(null)},i=>{if(te(s),o(e.catch,2,e.error,i),te(null),!e.hasCatch)throw i}),e.current!==e.pending)return o(e.pending,0),!0}else{if(e.current!==e.then)return o(e.then,1,e.value,t),!0;e.resolved=t}}function Ft(t,e,n){const o=e.slice(),{resolved:s}=t;t.current===t.then&&(o[t.value]=s),t.current===t.catch&&(o[t.error]=s),t.block.p(o,n)}function _t(t){return t?.length!==void 0?t:Array.from(t)}function L(t){t&&t.c()}function O(t,e,n){const{fragment:o,after_update:s}=t.$$;o&&o.m(e,n),Ge(()=>{const i=t.$$.on_mount.map(zt).filter(Je);t.$$.on_destroy?t.$$.on_destroy.push(...i):oe(i),t.$$.on_mount=[]}),s.forEach(Ge)}function P(t,e){const n=t.$$;n.fragment!==null&&(qt(n.after_update),oe(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Bt(t,e){t.$$.dirty[0]===-1&&(_e.push(t),Tt(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function $e(t,e,n,o,s,i,r,l=[-1]){const d=Re;te(t);const g=t.$$={fragment:null,ctx:[],props:i,update:A,not_equal:s,bound:bt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(d?d.$$.context:[])),callbacks:bt(),dirty:l,skip_bound:!1,root:e.target||d.$$.root};r&&r(g.root);let $=!1;if(g.ctx=n?n(t,e.props||{},(v,_,...R)=>{const k=R.length?R[0]:_;return g.ctx&&s(g.ctx[v],g.ctx[v]=k)&&(!g.skip_bound&&g.bound[v]&&g.bound[v](k),$&&Bt(t,v)),_}):[],g.update(),$=!0,oe(g.before_update),g.fragment=o?o(g.ctx):!1,e.target){if(e.hydrate){const v=Dt(e.target);g.fragment&&g.fragment.l(v),v.forEach(z)}else g.fragment&&g.fragment.c();e.intro&&I(t.$$.fragment),O(t,e.target,e.anchor),He()}te(d)}class Ce{$$=void 0;$$set=void 0;$destroy(){P(this,1),this.$destroy=A}$on(e,n){if(!Je(n))return A;const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(n),()=>{const s=o.indexOf(n);s!==-1&&o.splice(s,1)}}$set(e){this.$$set&&!jt(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Ut="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Ut);function Jt(t){xe(t,"svelte-310buw",".tooltip.svelte-310buw{position:absolute;bottom:100%;left:50%;z-index:10000000;width:fit-content;min-width:100%;padding:5px;background-color:rgba(51, 51, 51, 0.85);border-radius:8px;pointer-events:none;transform:translateX(-50%) scale(0);transition:transform 0.3s}.tooltip__title.svelte-310buw{color:#fff;text-align:center;text-wrap:balance;white-space:nowrap;font-weight:bold;font-size:16px}.tooltip__description.svelte-310buw{color:#ddd;text-align:center;text-wrap:balance;white-space:nowrap;font-weight:300;font-size:15px}[show-tooltip]>.tooltip.svelte-310buw{transform:translateX(-50%) scale(1)}")}function Ht(t){let e,n,o,s;return{c(){e=m("span"),n=m("p"),n.textContent=`${t[0]}`,o=y(),s=m("p"),s.textContent=`${t[1]}`,u(n,"class","tooltip__title svelte-310buw"),u(s,"class","tooltip__description svelte-310buw"),u(e,"class","tooltip svelte-310buw")},m(i,r){M(i,e,r),a(e,n),a(e,o),a(e,s)},p:A,i:A,o:A,d(i){i&&z(e)}}}function Xt(t,e,n){let{tooltip:o}=e;const{title:s,description:i}=o;return t.$$set=r=>{"tooltip"in r&&n(2,o=r.tooltip)},[s,i,o]}class K extends Ce{constructor(e){super(),$e(this,e,Xt,Ht,ye,{tooltip:2},Jt)}}function Q(t){t.target.setAttribute("show-tooltip","")}function Z(t){t.target.removeAttribute("show-tooltip")}function Yt(t){xe(t,"svelte-oji68g",".header-item.svelte-oji68g{position:relative;width:100%;max-width:33.3333333333%;padding:3px;background-color:transparent;border:none;border-right:1px solid rgba(255, 255, 255, 0.1);box-shadow:inset -2px -2px 5px rgba(0, 0, 0, 0.45), inset 2px 2px 5px rgba(255, 255, 255, 0.3);font-size:15px;color:#fff;cursor:pointer;transition:background-color 0.3s, box-shadow 0.3s}.header-item.svelte-oji68g:last-child{border:none}.header-item--active.svelte-oji68g{background-color:rgba(51, 51, 51, 0.85);box-shadow:inset -2px -2px 5px rgba(0, 0, 0, 0.35), inset 2px 2px 5px rgba(0, 0, 0, 0.35);cursor:initial}")}function Vt(t){let e,n,o,s,i,r,l;return s=new K({props:{tooltip:t[3]}}),{c(){e=m("button"),n=G(t[1]),o=y(),L(s.$$.fragment),u(e,"class","header-item svelte-oji68g"),we(e,"header-item--active",t[0])},m(d,g){M(d,e,g),a(e,n),a(e,o),O(s,e,null),i=!0,r||(l=[x(e,"click",Y(Ae(t[2]))),x(e,"mouseover",Q),x(e,"mouseleave",Z)],r=!0)},p(d,[g]){(!i||g&1)&&we(e,"header-item--active",d[0])},i(d){i||(I(s.$$.fragment,d),i=!0)},o(d){E(s.$$.fragment,d),i=!1},d(d){d&&z(e),P(s),r=!1,oe(l)}}}function Kt(t,e,n){let{isActive:o}=e,{headerIcon:s}=e;const{text:i,onClick:r,tooltip:l}=s;return t.$$set=d=>{"isActive"in d&&n(0,o=d.isActive),"headerIcon"in d&&n(4,s=d.headerIcon)},[o,i,r,l,s]}class Qt extends Ce{constructor(e){super(),$e(this,e,Kt,Vt,ye,{isActive:0,headerIcon:4},Yt)}}function wt(){const t=[],e=Math.floor(Math.random()*6)+1,n=[0,1,2,3,4,5];for(let o=0;o<e;o++){const s=Math.floor(Math.random()*n.length);t.push(n.splice(s,1)[0])}return t.sort()}function Zt(){return new Promise(t=>{const e=()=>{unsafeWindow.Engine?.communication?.parseJSON?t():setTimeout(e,10)};e()})}function en(){return new Promise(t=>{const e=()=>{unsafeWindow.parseInput?t():setTimeout(e,10)};e()})}function tn(){return new Promise(t=>{const e=()=>{document?.body?t():setTimeout(e,10)};e()})}function kt(t){return new Promise(e=>setTimeout(e,t))}class nn{getAll(e=[]){const n=GM_listValues();let o;return e.length?o=n.filter(s=>e.includes(s)).map(s=>[s,this.get(s)]):o=n.map(s=>[s,this.get(s)]),Object.fromEntries(o)}get(e,n=null){return GM_getValue(e,n)}set(e,n){GM_setValue(e,n)}}const ne=new nn,yt="https://margonem-anticaptcha.pl/client-error?error=0";function Ue({url:t,method:e,body:n}){return new Promise((o,s)=>{const{origin:i}=new URL(window.location.href);GM_xmlhttpRequest({url:t,method:e,headers:{"Content-type":"application/json",Origin:i},responseType:"json",data:JSON.stringify(n),onload(r){return!r.response&&r.status!==204?(console.log("xhr",!!r.response,r.status),s({redirect:yt})):o(r.response)},onerror(r){return console.error("Unknown error during request",r),s({redirect:yt})}})})}const on=["token","webhook","settings","ui"],sn=["token",{settings:["min","max"]}];function rn(t){const e=ne.getAll(on),n={...t,...e},o=It(t,sn);if(o.length!==0){const s=`W twoim configu brakuje następujących opcji: ${o.join(", ")}`;throw new Error(s)}if(JSON.stringify(e)==="{}"&&(Object.assign(n,{webhook:n.webhook??void 0,settings:{min:n.settings.min,max:n.settings.max,state:n.settings.state??!0,generateResponse:n.settings.generateResponse??!1,showMessages:n.settings.showMessages??!0,followRedirects:n.settings.followRedirects??!0,temporaryLogout:n.settings.temporaryLogout??!0,startCaptcha:n.settings.startCaptcha??!0},ui:{x:n.ui?.x??0,y:n.ui?.y??0,page:n.ui?.page??0,visible:n.ui?.visible??!1}}),ne.set("settings",n.settings),ne.set("ui",n.ui)),n.settings.min<0||n.settings.max<0){const s="Twój config jest niepoprawny: minimalny lub maksymalny czas rozwiązywania nie może być mniejszy od 0";throw new Error(s)}return n.settings.followRedirects&&n.settings.generateResponse&&console.error("Twój config jest niepoprawny: nie można używać followRedirects i generateResponse jednocześnie"),n}function It(t,e){const n=[];for(const o of e)if(typeof o=="string"){if(!(o in t)){n.push(o);continue}}else for(const s in o){if(!(s in t)){n.push(s);continue}n.push(...It(t[s],o[s]).map(i=>`${s}.${i}`))}return n}function an(t){const e=atob(t.split(",")[1]),n=t.split(",")[0].split(":")[1].split(";")[0],o=new ArrayBuffer(e.length),s=new Uint8Array(o);for(let i=0;i<e.length;i++)s[i]=e.charCodeAt(i);return new Blob([o],{type:n})}async function ln(){const t=document.cookie.match(/hs3=(\w+)/)?.[1],e=document.cookie.match(/mchar_id=(\w+)/)?.[1],n=await window.fetch(`https://public-api.margonem.pl/account/charlist?hs3=${t}`,{credentials:"include"});return n.status!==200?void 0:(await n.json()).find(({id:s})=>s==e)}function cn(t,e){return Math.random()*(e-t)+t}function un(t){xe(t,"svelte-5q6on5",".text.svelte-5q6on5{margin-block:5px;color:#ddd;font-size:16px;letter-spacing:0.5px}.text.svelte-5q6on5 b{color:#fff}.link.svelte-5q6on5{padding:2px;color:#ddd;font-size:16px;letter-spacing:0.5px;text-decoration:none;font-weight:500;transition:color 0.3s}.link.svelte-5q6on5:hover{color:#fff}")}function fn(t){let e;return{c(){e=m("p"),e.innerHTML="<b>Wystąpił błąd podczas pobierania danych</b>",u(e,"class","text svelte-5q6on5")},m(n,o){M(n,e,o)},p:A,d(n){n&&z(e)}}}function dn(t){let e,n,o,s=t[5].version+"",i,r,l,d,g,$=new Date(t[5].ts).toLocaleString(void 0,t[1])+"",v,_,R,k,h,w,c,f,p,j,S=t[5].token_data&&pn(t),N=t[5].ts&&t[5].id&&bn(t),W=t[5].message&&t[0].settings.showMessages&&xt(t);return{c(){e=m("p"),n=m("b"),n.textContent="Wersja skryptu:",o=y(),i=G(s),r=y(),l=m("p"),d=m("b"),d.textContent="Ostatnia aktualizacja:",g=y(),v=G($),_=y(),S&&S.c(),R=y(),N&&N.c(),k=y(),W&&W.c(),h=y(),w=m("p"),c=G("Dołącz do naszego "),f=m("a"),p=G("Discorda"),j=G("."),u(e,"class","text svelte-5q6on5"),u(l,"class","text svelte-5q6on5"),u(f,"href",wn),u(f,"target","_blank"),u(f,"class","link svelte-5q6on5"),u(w,"class","text svelte-5q6on5")},m(C,D){M(C,e,D),a(e,n),a(e,o),a(e,i),M(C,r,D),M(C,l,D),a(l,d),a(l,g),a(l,v),M(C,_,D),S&&S.m(C,D),M(C,R,D),N&&N.m(C,D),M(C,k,D),W&&W.m(C,D),M(C,h,D),M(C,w,D),a(w,c),a(w,f),a(f,p),a(w,j)},p(C,D){C[5].token_data&&S.p(C,D),C[5].ts&&C[5].id&&N.p(C,D),C[5].message&&C[0].settings.showMessages?W?W.p(C,D):(W=xt(C),W.c(),W.m(h.parentNode,h)):W&&(W.d(1),W=null)},d(C){C&&(z(e),z(r),z(l),z(_),z(R),z(k),z(h),z(w)),S&&S.d(C),N&&N.d(C),W&&W.d(C)}}}function pn(t){let e;function n(i,r){return i[5].token_data.unlimited_access?mn:i[5].token_data.active_token_timestamp?hn:gn}let s=n(t)(t);return{c(){s.c(),e=Mt()},m(i,r){s.m(i,r),M(i,e,r)},p(i,r){s.p(i,r)},d(i){i&&z(e),s.d(i)}}}function gn(t){let e,n,o,s=t[5].token_data.uses+"",i;return{c(){e=m("p"),n=m("b"),n.textContent="Pozostało użyć:",o=y(),i=G(s),u(e,"class","text svelte-5q6on5")},m(r,l){M(r,e,l),a(e,n),a(e,o),a(e,i)},p:A,d(r){r&&z(e)}}}function hn(t){let e,n,o,s=new Date(t[5].token_data.active_token_timestamp).toLocaleString("pl-PL",t[1])+"",i,r;return{c(){e=m("p"),n=m("b"),n.textContent="Pakiet miesięczny aktywny do:",o=y(),i=G(s),r=G(" czasu polskiego"),u(e,"class","text svelte-5q6on5")},m(l,d){M(l,e,d),a(e,n),a(e,o),a(e,i),a(e,r)},p:A,d(l){l&&z(e)}}}function mn(t){let e;return{c(){e=m("p"),e.innerHTML="<b>Pakiet nieograniczony:</b> aktywny",u(e,"class","text svelte-5q6on5")},m(n,o){M(n,e,o)},p:A,d(n){n&&z(e)}}}function bn(t){let e,n,o,s=new Date(t[5].ts).toLocaleString(void 0,t[1])+"",i;return{c(){e=m("p"),n=m("b"),n.textContent="Ostatnia captcha:",o=y(),i=G(s),u(e,"class","text svelte-5q6on5")},m(r,l){M(r,e,l),a(e,n),a(e,o),a(e,i)},p:A,d(r){r&&z(e)}}}function xt(t){let e,n,o,s=t[5].message+"",i;return{c(){e=m("p"),n=m("b"),n.textContent="Ostatnia wiadomość API:",o=y(),i=G(s),u(e,"class","text svelte-5q6on5")},m(r,l){M(r,e,l),a(e,n),a(e,o),a(e,i)},p:A,d(r){r&&z(e)}}}function vn(t){let e;return{c(){e=m("p"),e.textContent="Pobieranie danych...",u(e,"class","text svelte-5q6on5")},m(n,o){M(n,e,o)},p:A,d(n){n&&z(e)}}}function _n(t){let e,n={ctx:t,current:null,token:null,hasCatch:!0,pending:vn,then:dn,catch:fn,value:5};return Gt(t[2](),n),{c(){e=Mt(),n.block.c()},m(o,s){M(o,e,s),n.block.m(o,n.anchor=s),n.mount=()=>e.parentNode,n.anchor=e},p(o,[s]){t=o,Ft(n,t,s)},i:A,o:A,d(o){o&&z(e),n.block.d(o),n.token=null,n=null}}}const wn="https://discord.gg/EBzMkXvxzQ";function kn(t,e,n){let{config:o}=e,{solutionData:s}=e;const i=ne.get("info-cache"),r={day:"2-digit",month:"2-digit",year:"numeric",second:"2-digit",minute:"2-digit",hour:"2-digit"};async function l(){if(s)return{...s,version:GM_info.script.version};if(i&&Date.now()-i.ts<3e5)return{...i,version:GM_info.script.version};const g={token_data:await Ue({url:`https://margonem-anticaptcha.pl/api/v1/token/${o.token}`,method:"GET"}),ts:Date.now()};return ne.set("info-cache",g),{...g,version:GM_info.script.version}}return t.$$set=d=>{"config"in d&&n(0,o=d.config),"solutionData"in d&&n(3,s=d.solutionData)},[o,r,l,s]}class yn extends Ce{constructor(e){super(),$e(this,e,kn,_n,ye,{config:0,solutionData:3},un)}}function xn(t){xe(t,"svelte-hysb0y",'@charset "UTF-8";.label.svelte-hysb0y.svelte-hysb0y{position:relative;cursor:pointer}.checkbox.svelte-hysb0y.svelte-hysb0y{position:absolute;top:-101vh;left:-101vw}.checkbox.svelte-hysb0y+.label.svelte-hysb0y::before{content:"";position:absolute;top:50%;transform:translateY(-50%);display:block;width:30px;height:4px;border:1px solid rgba(255, 255, 255, 0.1);border-radius:8px;background-color:#333;transition:background-color 0.3s}.checkbox.svelte-hysb0y:checked+.label.svelte-hysb0y::before{background-color:#444}.checkbox.svelte-hysb0y+.label.svelte-hysb0y::after{content:"✕";display:block;position:absolute;top:50%;transform:translateY(-50%);width:14px;height:14px;border:1px solid rgba(255, 255, 255, 0.1);border-radius:50%;background-color:#444;color:#fff;font-size:10px;text-align:center;transition:background-color 0.3s, transform 0.3s}.checkbox.svelte-hysb0y:checked+.label.svelte-hysb0y::after{content:"✓";background-color:#666;transform:translate(16px, -50%)}')}function $n(t){let e,n,o,s,i;return{c(){e=m("input"),n=y(),o=m("label"),u(e,"id",t[2]),u(e,"class","checkbox svelte-hysb0y"),u(e,"type","checkbox"),e.checked=t[0],u(o,"class","label svelte-hysb0y"),u(o,"for",t[2])},m(r,l){M(r,e,l),M(r,n,l),M(r,o,l),s||(i=x(e,"change",Ae(function(){Je(t[1])&&t[1].apply(this,arguments)})),s=!0)},p(r,[l]){t=r,l&4&&u(e,"id",t[2]),l&1&&(e.checked=t[0]),l&4&&u(o,"for",t[2])},i:A,o:A,d(r){r&&(z(e),z(n),z(o)),s=!1,i()}}}function Cn(t,e,n){let{isChecked:o}=e,{onChange:s}=e,{id:i}=e;return t.$$set=r=>{"isChecked"in r&&n(0,o=r.isChecked),"onChange"in r&&n(1,s=r.onChange),"id"in r&&n(2,i=r.id)},[o,s,i]}class ve extends Ce{constructor(e){super(),$e(this,e,Cn,$n,ye,{isChecked:0,onChange:1,id:2},xn)}}function zn(t){xe(t,"svelte-1eg7vb4",".box.svelte-1eg7vb4.svelte-1eg7vb4{position:relative;display:flex;align-items:center;gap:8px}.box--center.svelte-1eg7vb4.svelte-1eg7vb4{justify-content:center}.box--wrap.svelte-1eg7vb4.svelte-1eg7vb4{flex-wrap:wrap}.box--fit-content.svelte-1eg7vb4.svelte-1eg7vb4{width:fit-content}.box--one-third.svelte-1eg7vb4.svelte-1eg7vb4{width:100%;max-width:30%}.box.svelte-1eg7vb4>.box.svelte-1eg7vb4,.box--no-interaction.svelte-1eg7vb4.svelte-1eg7vb4{cursor:initial}.box.svelte-1eg7vb4.svelte-1eg7vb4:has(> .box){margin-bottom:10px}.input.svelte-1eg7vb4.svelte-1eg7vb4{padding:2px;background:none;border:1px solid rgba(255, 255, 255, 0.1);border-radius:8px;color:#ddd;font-size:15px}.input.svelte-1eg7vb4.svelte-1eg7vb4:active,.input.svelte-1eg7vb4.svelte-1eg7vb4:focus{outline:none;border:1px solid rgba(255, 255, 255, 0.4)}.input--one-two.svelte-1eg7vb4.svelte-1eg7vb4{width:100%;max-width:50%}.input--three-four.svelte-1eg7vb4.svelte-1eg7vb4{width:100%;max-width:75%}.text.svelte-1eg7vb4.svelte-1eg7vb4{margin-block:5px;color:#ddd;font-size:16px;letter-spacing:0.5px}.text.svelte-1eg7vb4 b{color:#fff}")}function Mn(t){let e,n,o,s,i,r,l,d,g,$,v,_,R,k,h,w,c,f,p,j,S,N,W,C,D,q,B,Ie,Xe,se,Ye,fe,Ve,U,Ee,Ke,ie,Qe,de,Ze,J,je,et,re,tt,pe,nt,H,Se,ot,ae,st,ge,it,X,Oe,rt,le,at,he,De,F,ze,lt,ee,Me,ct,me,ce,Le,ut;return i=new ve({props:{isChecked:t[0].settings.state,onChange:t[1],id:"state"}}),l=new K({props:{tooltip:{title:"Stan skryptu",description:"Stan działania skryptu"}}}),w=new K({props:{tooltip:{title:"Minimalny czas",description:"Minimalny czas rozwiązywania"}}}),C=new K({props:{tooltip:{title:"Maksymalny czas",description:"Maksymalny czas rozwiązywania"}}}),se=new ve({props:{isChecked:t[0].settings.generateResponse,onChange:t[1],id:"generateResponse"}}),fe=new K({props:{tooltip:{title:"Generowanie",description:"Generowanie rozwiązań captcha"}}}),ie=new ve({props:{isChecked:t[0].settings.showMessages,onChange:t[1],id:"showMessages"}}),de=new K({props:{tooltip:{title:"Wiadomości",description:"Pokazywanie wiadomości API"}}}),re=new ve({props:{isChecked:t[0].settings.followRedirects,onChange:t[1],id:"followRedirects"}}),pe=new K({props:{tooltip:{title:"Przekierowania",description:"Podążanie za przekierowaniami API"}}}),ae=new ve({props:{isChecked:t[0].settings.temporaryLogout,onChange:t[1],id:"temporaryLogout"}}),ge=new K({props:{tooltip:{title:"Wylogowania",description:"Opuszczanie gry na blokadzie"}}}),le=new ve({props:{isChecked:t[0].settings.startCaptcha,onChange:t[1],id:"startCaptcha"}}),he=new K({props:{tooltip:{title:"Otwieranie",description:"Otwieranie captcha przed czasem"}}}),me=new K({props:{tooltip:{title:"Webhook",description:"Webhook Discord"}}}),{c(){e=m("div"),n=m("div"),o=m("p"),o.textContent="Stan skryptu:",s=y(),L(i.$$.fragment),r=y(),L(l.$$.fragment),d=y(),g=m("div"),$=m("div"),v=m("label"),v.textContent="Min. czas:",_=y(),R=m("input"),h=y(),L(w.$$.fragment),c=y(),f=m("div"),p=m("label"),p.textContent="Max. czas:",j=y(),S=m("input"),W=y(),L(C.$$.fragment),D=y(),q=m("div"),B=m("div"),Ie=m("p"),Ie.textContent="Generowanie:",Xe=y(),L(se.$$.fragment),Ye=y(),L(fe.$$.fragment),Ve=y(),U=m("div"),Ee=m("p"),Ee.textContent="Wiadomości:",Ke=y(),L(ie.$$.fragment),Qe=y(),L(de.$$.fragment),Ze=y(),J=m("div"),je=m("p"),je.textContent="Przekierowania:",et=y(),L(re.$$.fragment),tt=y(),L(pe.$$.fragment),nt=y(),H=m("div"),Se=m("p"),Se.textContent="Wylogowania:",ot=y(),L(ae.$$.fragment),st=y(),L(ge.$$.fragment),it=y(),X=m("div"),Oe=m("p"),Oe.textContent="Otwieranie:",rt=y(),L(le.$$.fragment),at=y(),L(he.$$.fragment),De=y(),F=m("div"),ze=m("label"),ze.textContent="Webhook:",lt=y(),ee=m("input"),ct=y(),L(me.$$.fragment),u(o,"class","text svelte-1eg7vb4"),u(n,"class","box box--fit-content svelte-1eg7vb4"),u(e,"class","box box--center svelte-1eg7vb4"),u(v,"class","text svelte-1eg7vb4"),u(v,"for","min"),u(R,"class","input input--one-two svelte-1eg7vb4"),u(R,"id","min"),u(R,"type","number"),u(R,"min","0"),R.value=k=t[0].settings.min,u($,"class","box box--fit-content box--center svelte-1eg7vb4"),u(p,"class","text svelte-1eg7vb4"),u(p,"for","max"),u(S,"class","input input--one-two svelte-1eg7vb4"),u(S,"id","max"),u(S,"type","number"),u(S,"min","0"),S.value=N=t[0].settings.max,u(f,"class","box box--center svelte-1eg7vb4"),u(g,"class","box box--center svelte-1eg7vb4"),u(Ie,"class","text svelte-1eg7vb4"),u(B,"class","box box--one-third svelte-1eg7vb4"),u(Ee,"class","text svelte-1eg7vb4"),u(U,"class","box box--one-third svelte-1eg7vb4"),u(je,"class","text svelte-1eg7vb4"),u(J,"class","box box--one-third svelte-1eg7vb4"),u(Se,"class","text svelte-1eg7vb4"),u(H,"class","box box--one-third svelte-1eg7vb4"),u(Oe,"class","text svelte-1eg7vb4"),u(X,"class","box box--one-third svelte-1eg7vb4"),u(q,"class","box box--wrap box--center svelte-1eg7vb4"),u(ze,"class","text svelte-1eg7vb4"),u(ze,"for","webhook"),u(ee,"class","input input--three-four svelte-1eg7vb4"),u(ee,"id","webhook"),u(ee,"type","text"),ee.value=Me=t[0].webhook,u(F,"class","box box--center box--no-interaction svelte-1eg7vb4")},m(b,T){M(b,e,T),a(e,n),a(n,o),a(n,s),O(i,n,null),a(n,r),O(l,n,null),M(b,d,T),M(b,g,T),a(g,$),a($,v),a($,_),a($,R),a($,h),O(w,$,null),a(g,c),a(g,f),a(f,p),a(f,j),a(f,S),a(f,W),O(C,f,null),M(b,D,T),M(b,q,T),a(q,B),a(B,Ie),a(B,Xe),O(se,B,null),a(B,Ye),O(fe,B,null),a(q,Ve),a(q,U),a(U,Ee),a(U,Ke),O(ie,U,null),a(U,Qe),O(de,U,null),a(q,Ze),a(q,J),a(J,je),a(J,et),O(re,J,null),a(J,tt),O(pe,J,null),a(q,nt),a(q,H),a(H,Se),a(H,ot),O(ae,H,null),a(H,st),O(ge,H,null),a(q,it),a(q,X),a(X,Oe),a(X,rt),O(le,X,null),a(X,at),O(he,X,null),M(b,De,T),M(b,F,T),a(F,ze),a(F,lt),a(F,ee),a(F,ct),O(me,F,null),ce=!0,Le||(ut=[x(n,"mousedown",Y(t[10])),x(n,"mouseover",Q),x(n,"mouseleave",Z),x(R,"change",t[1]),x($,"mousedown",Y(t[9])),x($,"mouseover",Q),x($,"mouseleave",Z),x(S,"change",t[1]),x(f,"mousedown",Y(t[8])),x(f,"mouseover",Q),x(f,"mouseleave",Z),x(B,"mousedown",Y(t[7])),x(B,"mouseover",Q),x(B,"mouseleave",Z),x(U,"mousedown",Y(t[6])),x(U,"mouseover",Q),x(U,"mouseleave",Z),x(J,"mousedown",Y(t[5])),x(J,"mouseover",Q),x(J,"mouseleave",Z),x(H,"mousedown",Y(t[4])),x(H,"mouseover",Q),x(H,"mouseleave",Z),x(X,"mousedown",Y(t[3])),x(X,"mouseover",Q),x(X,"mouseleave",Z),x(ee,"change",t[1]),x(F,"mousedown",Y(t[2])),x(F,"mouseover",Q),x(F,"mouseleave",Z)],Le=!0)},p(b,[T]){const ft={};T&1&&(ft.isChecked=b[0].settings.state),i.$set(ft),(!ce||T&1&&k!==(k=b[0].settings.min)&&R.value!==k)&&(R.value=k),(!ce||T&1&&N!==(N=b[0].settings.max)&&S.value!==N)&&(S.value=N);const dt={};T&1&&(dt.isChecked=b[0].settings.generateResponse),se.$set(dt);const pt={};T&1&&(pt.isChecked=b[0].settings.showMessages),ie.$set(pt);const gt={};T&1&&(gt.isChecked=b[0].settings.followRedirects),re.$set(gt);const ht={};T&1&&(ht.isChecked=b[0].settings.temporaryLogout),ae.$set(ht);const mt={};T&1&&(mt.isChecked=b[0].settings.startCaptcha),le.$set(mt),(!ce||T&1&&Me!==(Me=b[0].webhook)&&ee.value!==Me)&&(ee.value=Me)},i(b){ce||(I(i.$$.fragment,b),I(l.$$.fragment,b),I(w.$$.fragment,b),I(C.$$.fragment,b),I(se.$$.fragment,b),I(fe.$$.fragment,b),I(ie.$$.fragment,b),I(de.$$.fragment,b),I(re.$$.fragment,b),I(pe.$$.fragment,b),I(ae.$$.fragment,b),I(ge.$$.fragment,b),I(le.$$.fragment,b),I(he.$$.fragment,b),I(me.$$.fragment,b),ce=!0)},o(b){E(i.$$.fragment,b),E(l.$$.fragment,b),E(w.$$.fragment,b),E(C.$$.fragment,b),E(se.$$.fragment,b),E(fe.$$.fragment,b),E(ie.$$.fragment,b),E(de.$$.fragment,b),E(re.$$.fragment,b),E(pe.$$.fragment,b),E(ae.$$.fragment,b),E(ge.$$.fragment,b),E(le.$$.fragment,b),E(he.$$.fragment,b),E(me.$$.fragment,b),ce=!1},d(b){b&&(z(e),z(d),z(g),z(D),z(q),z(De),z(F)),P(i),P(l),P(w),P(C),P(se),P(fe),P(ie),P(de),P(re),P(pe),P(ae),P(ge),P(le),P(he),P(me),Le=!1,oe(ut)}}}function Rn(t,e,n){let{config:o}=e;function s(k){const h=k.target,w=h.type,c=h.getAttribute("id"),f=w==="checkbox"?h.checked:w==="number"?+h.value:h.value;c&&(c in o?(n(0,o[c]=f,o),ne.set(c,f)):(n(0,o.settings[c]=f,o),ne.set("settings",o.settings)))}function i(k){V.call(this,t,k)}function r(k){V.call(this,t,k)}function l(k){V.call(this,t,k)}function d(k){V.call(this,t,k)}function g(k){V.call(this,t,k)}function $(k){V.call(this,t,k)}function v(k){V.call(this,t,k)}function _(k){V.call(this,t,k)}function R(k){V.call(this,t,k)}return t.$$set=k=>{"config"in k&&n(0,o=k.config)},[o,s,i,r,l,d,g,$,v,_,R]}class In extends Ce{constructor(e){super(),$e(this,e,Rn,Mn,ye,{config:0},zn)}}const{document:Te}=St;function En(t){xe(t,"svelte-1re8zkd","*{margin:0;padding:0;box-sizing:border-box}.container.svelte-1re8zkd{position:absolute;display:none;top:var(--top);left:var(--left);z-index:1000000;width:550px;border-radius:8px;background-color:rgba(34, 34, 34, 0.85);font-family:Arial, sans-serif;cursor:grab}.container--drag.svelte-1re8zkd{cursor:grabbing}.container--show.svelte-1re8zkd{display:block}.container__header.svelte-1re8zkd{display:flex;border-bottom:1px solid rgba(255, 255, 255, 0.1)}.container__content.svelte-1re8zkd{padding:10px 20px 20px}.text.svelte-1re8zkd{margin-block:5px;color:#ddd;font-size:16px;letter-spacing:0.5px}.text.svelte-1re8zkd b{color:#fff}")}function $t(t,e,n){const o=t.slice();return o[16]=e[n],o}function Ct(t){let e,n;return e=new Qt({props:{headerIcon:t[16],isActive:t[16].page===t[0].ui.page}}),{c(){L(e.$$.fragment)},m(o,s){O(e,o,s),n=!0},p(o,s){const i={};s&1&&(i.isActive=o[16].page===o[0].ui.page),e.$set(i)},i(o){n||(I(e.$$.fragment,o),n=!0)},o(o){E(e.$$.fragment,o),n=!1},d(o){P(e,o)}}}function jn(t){let e;return{c(){e=m("p"),e.innerHTML="<b>Nieznana zakładka</b>",u(e,"class","text svelte-1re8zkd")},m(n,o){M(n,e,o)},p:A,i:A,o:A,d(n){n&&z(e)}}}function Sn(t){let e,n;return e=new yn({props:{solutionData:t[1],config:t[0]}}),{c(){L(e.$$.fragment)},m(o,s){O(e,o,s),n=!0},p(o,s){const i={};s&2&&(i.solutionData=o[1]),s&1&&(i.config=o[0]),e.$set(i)},i(o){n||(I(e.$$.fragment,o),n=!0)},o(o){E(e.$$.fragment,o),n=!1},d(o){P(e,o)}}}function On(t){let e,n;return e=new In({props:{config:t[0]}}),{c(){L(e.$$.fragment)},m(o,s){O(e,o,s),n=!0},p(o,s){const i={};s&1&&(i.config=o[0]),e.$set(i)},i(o){n||(I(e.$$.fragment,o),n=!0)},o(o){E(e.$$.fragment,o),n=!1},d(o){P(e,o)}}}function Pn(t){let e,n,o,s,i,r,l,d,g,$,v=_t(t[5]),_=[];for(let c=0;c<v.length;c+=1)_[c]=Ct($t(t,v,c));const R=c=>E(_[c],1,1,()=>{_[c]=null}),k=[On,Sn,jn],h=[];function w(c,f){return c[0].ui.page===c[4].CONFIG?0:c[0].ui.page===c[4].INFO?1:2}return r=w(t),l=h[r]=k[r](t),{c(){e=y(),n=m("div"),o=m("header");for(let c=0;c<_.length;c+=1)_[c].c();s=y(),i=m("div"),l.c(),u(o,"class","container__header svelte-1re8zkd"),u(i,"class","container__content svelte-1re8zkd"),u(n,"class","container svelte-1re8zkd"),u(n,"draggable",!0),we(n,"container--drag",t[3]),we(n,"container--show",t[0].ui.visible)},m(c,f){M(c,e,f),M(c,n,f),a(n,o);for(let p=0;p<_.length;p+=1)_[p]&&_[p].m(o,null);a(n,s),a(n,i),h[r].m(i,null),t[11](n),d=!0,g||($=[x(Te,"mousemove",Ae(t[7])),x(Te,"mouseup",t[8]),x(Te,"keydown",t[9],!0),x(o,"mousedown",Y(t[10])),x(n,"mousedown",Ae(t[6]))],g=!0)},p(c,[f]){if(f&33){v=_t(c[5]);let j;for(j=0;j<v.length;j+=1){const S=$t(c,v,j);_[j]?(_[j].p(S,f),I(_[j],1)):(_[j]=Ct(S),_[j].c(),I(_[j],1),_[j].m(o,null))}for(Fe(),j=v.length;j<_.length;j+=1)R(j);Be()}let p=r;r=w(c),r===p?h[r].p(c,f):(Fe(),E(h[p],1,1,()=>{h[p]=null}),Be(),l=h[r],l?l.p(c,f):(l=h[r]=k[r](c),l.c()),I(l,1),l.m(i,null)),(!d||f&8)&&we(n,"container--drag",c[3]),(!d||f&1)&&we(n,"container--show",c[0].ui.visible)},i(c){if(!d){for(let f=0;f<v.length;f+=1)I(_[f]);I(l),d=!0}},o(c){_=_.filter(Boolean);for(let f=0;f<_.length;f+=1)E(_[f]);E(l),d=!1},d(c){c&&(z(e),z(n)),At(_,c),h[r].d(),t[11](null),g=!1,oe($)}}}function An(t,e,n){let{config:o}=e,{solutionData:s}=e;var i=(p=>(p[p.CONFIG=0]="CONFIG",p[p.INFO=1]="INFO",p))(i||{});const r=[{page:0,text:"⚙️",onClick(){v(0)},tooltip:{title:"Konfiguracja",description:"Konfiguracja skryptu"}},{page:1,text:"ℹ️",onClick(){v(1)},tooltip:{title:"Informacja",description:"Informacje o skrypcie"}},{text:"❌",onClick(){_({visible:!1})},tooltip:{title:"Zamknij",description:"Zamknięcie interfejsu"}}];let l,d=o.ui.x,g=o.ui.y,$=!1;function v(p){o.ui.page!==p&&_({page:p})}function _(p){for(const[j,S]of Object.entries(p))n(0,o.ui[j]=S,o);ne.set("ui",o.ui)}function R(p){d=Math.abs(l.offsetLeft-p.clientX),g=Math.abs(l.offsetTop-p.clientY),n(3,$=!0)}function k(p){$&&(l.style.setProperty("--left",`${p.clientX-d}px`),l.style.setProperty("--top",`${p.clientY-g}px`))}function h(p){$&&(n(3,$=!1),_({x:p.clientX-d,y:p.clientY-g}))}function w(p){document.activeElement===l.getRootNode().host&&p.stopPropagation()}Lt(()=>{l.style.setProperty("--left",`${d}px`),l.style.setProperty("--top",`${g}px`),GM_registerMenuCommand("Pokaż/schowaj gui",()=>{_({visible:!o.ui.visible})})});function c(p){V.call(this,t,p)}function f(p){Ne[p?"unshift":"push"](()=>{l=p,n(2,l)})}return t.$$set=p=>{"config"in p&&n(0,o=p.config),"solutionData"in p&&n(1,s=p.solutionData)},[o,s,l,$,i,r,R,k,h,w,c,f]}class Dn extends Ce{constructor(e){super(),$e(this,e,An,Pn,ye,{config:0,solutionData:1},En)}}(async()=>{const t=()=>{const h=$?unsafeWindow.parseInput:unsafeWindow.Engine.communication.parseJSON,w=function(c){return c.captcha&&v.settings.state&&(c.captcha.autostart_time_left&&v.settings.startCaptcha&&n(c.captcha.autostart_time_left),(c.captcha.blocked||c.captcha.blockade_time_left)&&v.settings.temporaryLogout&&s(c.captcha.blockade_time_left??60),c.captcha.content&&g(c.captcha),c.captcha.done&&R&&l()),h.apply(this,arguments)};$?unsafeWindow.parseInput=w:unsafeWindow.Engine.communication.parseJSON=w},e=()=>{const h=document.createElement("div"),w=h.attachShadow({mode:"closed"}),c=new Dn({target:w,props:{config:v,solutionData:R}}),f=[...document.querySelectorAll("body > *")];if(f.length!==0){const p=f[Math.floor(Math.random()*f.length)];Math.random()>.5?p.before(h):p.after(h)}else document.body.append(h);return c},n=async h=>{if(h<=5)return;const w=cn(5e3,h>15?15e3:(h-1)*1e3);await kt(w),unsafeWindow._g("captcha&start=1"),o()},o=()=>{const h=$?"#pre-captcha":".pre-captcha",w=document.querySelector(h);w!==null&&(w.innerHTML="",w.classList.remove("show"))},s=h=>{const w=`https://margonem-anticaptcha.pl/client-error?error=5&blockade_time=${h*1e3}`;d(w)},i=h=>{const w=`captcha&answerId=${h.join(",")}`;if($){if(unsafeWindow.g.init===5)return unsafeWindow._g(w);unsafeWindow.startEngine(),unsafeWindow.sendFirstInit(`&${w}`)}else{if(unsafeWindow.Engine.interface.alreadyInitialised)return unsafeWindow._g(w);unsafeWindow.Engine.start(),unsafeWindow.Engine.setFirstLoadInit1(!0),unsafeWindow.Engine.setFirstLoadInit2(!0),unsafeWindow.Engine.reCallInitQueue(`&${w}`)}},r=async h=>{_||(_=await ln());const w=an(h.content.image.data),c={content:"Rozwiązano captcha",username:"Margonem Anti-Captcha",embeds:[{title:`Pytanie: ${h.content.question.text}`,description:`Rozwiązanie: ${h.solution.length!==0?h.solution.map(p=>String.fromCharCode(p+65)).join(", "):"Brak rozwiązania"}`,image:{url:"attachment://captcha.jpg"},footer:{text:`${_?`Świat: ${_.world} • Postać: ${_.nick}`:"nie udało się pobrać danych postaci"}`}}]},f=new FormData;f.append("files[0]",w,"captcha.jpg"),f.append("payload_json",JSON.stringify(c)),fetch(v.webhook,{method:"POST",body:f})},l=()=>Ue({url:`https://margonem-anticaptcha.pl/api/v1/captcha/${R.id}`,method:"POST"}),d=h=>{unsafeWindow.location.href=h+`&source=${encodeURIComponent(unsafeWindow.location.href)}`},g=async h=>{try{const w=performance.now();let c;const f=await Ue({url:"https://margonem-anticaptcha.pl/api/v1/captcha",method:"POST",body:{token:v.token,client_version:GM_info.script.version,captcha:{question:h.content.question.text,src:h.content.image.data}}});if(R={...R,...f,ts:Date.now()},k.$set({solutionData:R}),f.message&&v.settings.showMessages&&console.warn(f.message),f.redirect&&v.settings.followRedirects)return d(f.redirect);if(f.solution?.length?c=f.solution:v.settings.generateResponse&&(c=wt()),c?.length!==0){if(v.settings.min!==0&&v.settings.max!==0){const p=Math.random()*(config.settings.max-config.settings.min)+config.settings.min-(performance.now()-w);p>0&&await kt(p)}return v.webhook&&r({...f,...h}),i(c)}else console.error("The solution is either undefined or its length is 0",f)}catch(w){if(w.redirect&&v.settings.followRedirects)return d(w.redirect);if(v.settings.generateResponse){const c=wt();return i(c)}}},$=document.cookie.match(/interface=(\w+)/)?.[1]==="si",v=rn(config);let _,R;await tn(),await($?en():Zt());const k=e();t()})();})()