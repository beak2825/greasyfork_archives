// ==UserScript==
// @name         YouTube PiP
// @namespace    https://github.com/dmitroderkach/youtube-pip
// @version      1.3.2
// @description  Smart Picture-in-Picture mode with all YouTube controls and functions
// @author       Dmytro Derkach
// @match        https://www.youtube.com/*
// @grant        none
// @homepageURL  https://github.com/dmitroderkach/youtube-pip
// @supportURL   https://github.com/dmitroderkach/youtube-pip/issues
// @license      MIT
// @downloadURL https://update.greasyfork.org/scripts/564173/YouTube%20PiP.user.js
// @updateURL https://update.greasyfork.org/scripts/564173/YouTube%20PiP.meta.js
// ==/UserScript==


!function(){"use strict";const e=5e3,t=480,n=270,i=600,r=-1,o=1,a="LIKE",s="DISLIKE",l="INDIFFERENT",c="WEB_PAGE_TYPE_WATCH",d=new Intl.DateTimeFormat("en-CA",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1});const u=class e{constructor(e){this.scope=e}static getInstance(t){e.storageListenerAdded||(e.enabled=e.checkDebugFlag(),window.addEventListener("storage",()=>{e.enabled=e.checkDebugFlag()}),e.storageListenerAdded=!0);let n=e.instances.get(t);return n||(n=new e(t),e.instances.set(t,n)),n}static checkDebugFlag(){try{return"true"===localStorage.getItem("YOUTUBE_PIP_DEBUG")}catch{return!1}}static setGlobalMetadata(t){e.globalMetadata={...t}}styled(t,n,i,r){const o=function(e){const t=String(e.getMilliseconds()).padStart(3,"0");return d.format(e).replace(", ",":")+"."+t}(new Date),a=i.replace(/%/g,"%%");var s;const l=[`%c${o}%c [YouTube PiP]%c${s=this.scope,`[${s}]`}%c ${a}`,"color: #3b82f6; font-weight: 500;","color: #6366f1; font-weight: 600;","color: #f59e0b; font-weight: 500;",n];void 0!==r&&l.push(r),Object.keys(e.globalMetadata).length>0&&l.push(e.globalMetadata),t(...l)}log(t,n){e.enabled&&this.styled(console.log.bind(console),"color: #86efac;",t,n)}warn(t,n){e.enabled&&this.styled(console.warn.bind(console),"color: #fde047;",t,n)}error(e,t){this.styled(console.error.bind(console),"color: #f87171;",e,t)}debug(t,n){e.enabled&&this.styled(console.debug.bind(console),"color: #a1a1aa;",t,n)}};u.instances=new Map,u.enabled=!1,u.storageListenerAdded=!1,u.globalMetadata={};let p=u;const h="ytd-miniplayer",y="ytd-miniplayer-player-container",g=".ytdMiniplayerComponentHost.ytdMiniplayerComponentVisible",m="#movie_player",w="ytd-app",b="yt-draggable",v=".html5-video-player",f=".ytp-popup.ytp-contextmenu",P=".ytp-contextmenu",M=".yt-spec-button-shape-next[aria-expanded]",E=".ytdMiniplayerComponentPlaylistPanel",S=".ytp-progress-bar",x="ytd-slim-metadata-toggle-button-renderer",C=".yt-spec-button-shape-next",W=".yt-simple-endpoint",I="button",k='style, link[rel="stylesheet"]',T=p.getInstance("MiniPlayerController");class A{constructor(e){this.playerManager=e}isVisible(){const e=!!document.querySelector(g);return T.debug(`Mini player visible: ${e}`),e}activateMiniPlayer(){T.debug("Activating mini player via YouTube API");const e=document.querySelector(w);if(e)try{e.fire("yt-action",{actionName:"yt-activate-miniplayer",args:[!1],returnValue:[void 0]}),T.debug("Mini player activation event dispatched")}catch(t){T.error("Error activating mini player:",t)}else T.error("ytd-app not found")}toggleMiniPlayer(e=!1){const t=this.isVisible(),n=document.querySelector(w);if(n)try{if(t||e){T.debug("Returning to full player via YouTube API");const e=this.playerManager.getVideoId(document);if(!e)return;n.fire("yt-navigate",{endpoint:{watchEndpoint:{videoId:e}}}),T.debug(`Navigation to full player dispatched for video ${e}`)}else T.debug("Activating miniplayer via YouTube API"),n.fire("yt-action",{actionName:"yt-activate-miniplayer-from-watch-action",returnValue:[]}),T.debug("Miniplayer activation event dispatched")}catch(i){T.error("Error toggling mini player:",i)}else T.error("ytd-app not found")}}const O=p.getInstance("DOMUtils");class z{static createPlaceholder(e){return document.createComment(e)}static insertPlaceholderBefore(e,t){const n=e.parentNode;return n?(n.insertBefore(t,e),O.debug("Placeholder inserted"),!0):(O.warn("insertPlaceholderBefore: element has no parent"),!1)}static restoreElementFromPlaceholder(e,t){const n=t.parentNode;n?(n.insertBefore(e,t),t.remove(),O.debug("Element restored from placeholder")):O.warn("restoreElementFromPlaceholder: placeholder has no parent")}static copyAttributes(e,t){if(e&&t)try{Array.from(e.attributes).forEach(e=>{try{t.setAttribute(e.nodeName,e.nodeValue||"")}catch(n){O.warn(`Failed to copy attribute ${e.nodeName}:`,n)}}),O.debug("Attributes copied successfully")}catch(n){O.error("Error copying attributes:",n)}else O.warn("copyAttributes: source or target is null")}static unwrap(e){if(!e)return void O.warn("unwrap: wrapper is null");const t=e.parentNode;if(t)try{for(;e.firstChild;)t.insertBefore(e.firstChild,e);t.removeChild(e),O.debug("Element unwrapped successfully")}catch(n){O.error("Error unwrapping element:",n)}else O.warn("unwrap: Element has no parent node")}static waitForElementSelector(t,n=document,i=e,r){return new Promise((e,o)=>{const a=n.querySelector(t);if(a)return O.debug(`Element found immediately: ${t}`),e(a);O.debug(`Waiting for element: ${t}`);const s=new MutationObserver((i,r)=>{const o=n.querySelector(t);o&&(O.debug(`Element appeared: ${t}`),r.disconnect(),e(o))}),l=n===document?document.body:n;l?(s.observe(l,{childList:!0,subtree:!0}),i>0&&setTimeout(()=>{s.disconnect(),o(new Error(`Timeout: ${t} not found`))},i),0===i&&r&&!r.closed&&r.addEventListener("pagehide",()=>{s.disconnect(),o(new Error("Wait aborted: target window closed"))},{once:!0})):o(new Error(`Target element not found for selector: ${t}`))})}}const F=p.getInstance("PlayerManager");class H{constructor(){this.wasPlaying=!1}getPlayerState(e){return e?e.getPlayerState():r}isPlaying(e){return this.getPlayerState(e)===o}savePlayingState(e){this.wasPlaying=this.isPlaying(e),F.debug(`Player state saved: wasPlaying = ${this.wasPlaying}`)}restorePlayingState(e){if(this.wasPlaying&&e)try{"function"==typeof e.playVideo&&(e.playVideo(),F.log("Playback restored after return to main window"))}catch(t){F.error("Error restoring playback:",t)}else F.debug("No need to restore playing state")}getVideoData(e){return e&&"function"==typeof e.getVideoData&&e.getVideoData()||null}getVideoId(e){const t=e.querySelector(m),n=this.getVideoData(t),i=null==n?void 0:n.video_id;return i||(F.error("Video ID not found, cannot navigate",{player:t}),null)}async waitForMainPlayer(){try{const t=await z.waitForElementSelector(m,document,e);return F.debug("Main player is ready"),t}catch(t){return F.error("Error waiting for main player:",t),null}}async waitForMiniPlayer(){try{const t=await z.waitForElementSelector(g,document,e);return F.debug("Miniplayer is ready"),t}catch(t){return F.error("Error waiting for miniplayer:",t),null}}resetState(){this.wasPlaying=!1,F.debug("Player state reset")}}const N=p.getInstance("NavigationHandler");class B{constructor(){this.pipWindow=null}initialize(e){this.pipWindow=e,this.setupClickHandler(),N.debug("Navigation handler initialized")}setupClickHandler(){this.pipWindow?this.pipWindow.document.addEventListener("click",e=>{var t,n;const i=this.pipWindow.document.querySelector(v);i&&"focus"in i&&"function"==typeof i.focus&&i.focus();const r=null==(t=e.target)?void 0:t.closest(W);if((null==(n=e.target)?void 0:n.closest(I))||!r)return;const o=r.href;if(o){N.log("Navigation click detected");try{const t=new URL(o),n=Object.fromEntries(t.searchParams);e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation();const i={endpoint:{commandMetadata:{webCommandMetadata:{url:o,webPageType:c,rootVe:3832}},watchEndpoint:{videoId:n.v,playlistId:n.list||null,index:n.index?parseInt(n.index)-1:0,params:"OAE%3D",playerParams:n.pp}},entryTime:performance.now()};N.log(`SPA navigation via yt-navigate: ${o}`),window.dispatchEvent(new PopStateEvent("popstate",{state:i}))}catch(a){N.error("Error handling navigation:",a)}}},!0):N.error("PiP window not available for navigation handler")}cleanup(){this.pipWindow=null,N.debug("Navigation handler cleaned up")}}const $=p.getInstance("StyleUtils");class L{static copyStyles(e,t){try{const n=e.querySelectorAll(k);$.debug(`Copying ${n.length} style elements`),n.forEach(e=>{try{t.head.appendChild(e.cloneNode(!0))}catch(n){$.warn("Failed to copy style node:",n)}}),$.debug("Styles copied successfully")}catch(n){$.error("Error copying styles:",n)}}static injectCSSFixes(e){try{const t=e.createElement("style");t.textContent="/**\n * CSS styles for PiP window fixes and customizations\n */\n\nbody {\n  overflow: auto !important;\n}\n\nytd-miniplayer {\n  left: 0 !important;\n  right: 0 !important;\n  top: 0 !important;\n  bottom: 0 !important;\n  width: 100% !important;\n  height: 100% !important;\n  max-height: 100% !important;\n  display: flex !important;\n}\n\nytd-miniplayer-player-container {\n  width: 100% !important;\n  height: 100% !important;\n}\n\n.html5-video-container {\n  position: absolute;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n}\n\n.html5-video-container .html5-main-video {\n  width: 100% !important;\n  height: 100% !important;\n  object-fit: contain;\n}\n\nvideo {\n  left: 0 !important;\n  top: 0 !important;\n  right: 0 !important;\n  bottom: 0 !important;\n}\n\n.ytDraggableComponentHost.ytdMiniplayerComponentDraggable {\n  pointer-events: auto !important;\n}\n\n.ytp-miniplayer-expand-watch-page-button,\n.ytp-miniplayer-close-button,\n#header-contents,\n.ytdMiniplayerComponentResizers {\n  display: none !important;\n}\n\n/* Stretch progress bar to full width */\n.ytp-progress-bar-container,\n.ytp-progress-bar {\n  width: 100% !important;\n}\n\n.ytp-prev-button,\n.ytp-next-button {\n  display: inline-flex !important;\n}\n",e.head.appendChild(t),$.debug("CSS fixes injected successfully")}catch(t){$.error("Error injecting CSS fixes:",t)}}}class R extends Error{constructor(e,t){super(e),this.cause=t,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}class D extends R{constructor(e,t){super(e,t),this.name="PiPError"}}const q=p.getInstance("PiPManager");class V{constructor(e,t,n,i){this.pipWindow=null,this.miniplayer=null,this.miniPlayerContainer=null,this.placeholder=null,this.wasMiniPlayerActiveBeforePiP=!1,this.onBeforeReturn=null,this.miniPlayerController=e,this.playerManager=t,this.navigationHandler=n,this.onWindowReady=i}isOpen(){return null!==this.pipWindow&&!this.pipWindow.closed}getWindow(){return this.pipWindow}async open(){if(this.isOpen())q.warn("PiP window already open");else{q.log("Opening PiP window");try{if(await this.movePlayerToPIP(),this.pipWindow&&this.miniplayer){this.pipWindow.addEventListener("pagehide",()=>this.returnPlayerToMain()),this.navigationHandler.initialize(this.pipWindow);const e=await this.onWindowReady(this.pipWindow,this.miniplayer);"function"==typeof e&&(this.onBeforeReturn=e)}}catch(e){throw q.error("Error opening PiP:",e),e}}}async movePlayerToPIP(){var e,i;if(this.miniplayer=document.querySelector(h),!this.miniplayer)throw new D("Mini player element not found");this.wasMiniPlayerActiveBeforePiP=this.miniPlayerController.isVisible(),this.wasMiniPlayerActiveBeforePiP||(this.miniPlayerController.toggleMiniPlayer(),await z.waitForElementSelector(y),q.debug("Mini player container ready"));const r=this.miniplayer.offsetWidth||t,o=this.miniplayer.offsetHeight||n;q.debug(`Requesting PiP window: ${r}x${o}`);const a=window.documentPictureInPicture;if(!a)throw new D("Document Picture-in-Picture API not available");this.pipWindow=await a.requestWindow({width:r,height:o}),q.log("PiP window opened");const s=this.pipWindow.document;if(z.copyAttributes(document.documentElement,s.documentElement),z.copyAttributes(document.body,s.body),L.copyStyles(document,s),L.injectCSSFixes(s),!this.wasMiniPlayerActiveBeforePiP){const t=(null==(i=null==(e=window.navigator.mediaSession)?void 0:e.metadata)?void 0:i.title)||"";this.setWindowsTitle(t)}const l=document.querySelector(w);if(l&&this.pipWindow){const e=s.createElement("ytd-app");z.copyAttributes(l,e),s.body.appendChild(e)}this.miniPlayerContainer=document.querySelector(y),this.placeholder=z.createPlaceholder("mini_player_placeholder"),z.insertPlaceholderBefore(this.miniplayer,this.placeholder);const c=this.pipWindow.document.querySelector(w);c&&this.miniplayer&&c.appendChild(this.miniplayer);const d=s.querySelector(b);d&&this.miniPlayerContainer&&d.prepend(this.miniPlayerContainer),z.unwrap(d);const u=s.querySelector(v);u&&"focus"in u&&"function"==typeof u.focus&&u.focus()}async returnPlayerToMain(){if(q.log("Returning player to main window"),this.placeholder&&this.miniplayer){if(this.onBeforeReturn){try{await this.onBeforeReturn()}catch(e){q.error("Error in onBeforeReturn:",e)}this.onBeforeReturn=null}await this.movePlayerToMain(),this.pipWindow=null}else q.warn("Placeholder or miniplayer not found")}async movePlayerToMain(){if(!this.placeholder||!this.miniplayer)return;const e=this.miniplayer.querySelector(m);this.playerManager.savePlayingState(e),z.restoreElementFromPlaceholder(this.miniplayer,this.placeholder),this.placeholder=null;const t=document.querySelector(b);t&&this.miniPlayerContainer&&t.prepend(this.miniPlayerContainer),this.wasMiniPlayerActiveBeforePiP||(this.miniPlayerController.toggleMiniPlayer(!0),await this.playerManager.waitForMainPlayer());const n=document.querySelector(y);n&&n.remove(),setTimeout(()=>{this.playerManager.restorePlayingState(e),this.wasMiniPlayerActiveBeforePiP&&(this.miniPlayerController.activateMiniPlayer(),this.playerManager.waitForMiniPlayer())})}setWindowsTitle(e){const t=`${e} - YouTube`;this.pipWindow&&(document.title=t,this.pipWindow.document.title=t,q.debug(`Title synced from MediaSession: ${e}`))}updateTitle(e){this.wasMiniPlayerActiveBeforePiP||this.setWindowsTitle(e)}}const _=p.getInstance("ResizeTracker");class Y{constructor(){this.observer=null}start(e,t){if("undefined"==typeof ResizeObserver)return void _.error("ResizeObserver not available");_.debug("Starting resize tracking");const n=t.document;this.observer=new ResizeObserver(e=>{var t;for(const i of e){const e=i.contentRect.width;_.debug(`New size: ${e}px`);const r=n.querySelector(m);r&&("function"==typeof r.setInternalSize&&(r.setInternalSize(),null==(t=r.setSize)||t.call(r)),r.dispatchEvent(new Event("resize",{bubbles:!0})),_.debug("Player size updated"))}}),this.observer.observe(e)}stop(){this.observer&&(this.observer.disconnect(),this.observer=null,_.debug("Resize tracking stopped"))}}const j=p.getInstance("MenuObserver");class U{constructor(){this.observer=null,this.removalObserver=null}async start(e){await this.runObservation(e)}async runObservation(e){if(e.closed)return void j.debug("PiP window already closed, skipping menu observation");let t;try{t=await z.waitForElementSelector(M,e.document,0,e)}catch(n){return void j.warn("Wait for menu button aborted",n)}j.debug("Starting menu observation"),this.observer=new MutationObserver(n=>{for(const r of n)if("aria-expanded"===r.attributeName){const n="true"===t.getAttribute("aria-expanded"),r=e.document.querySelector(E),o=e.outerHeight;j.debug(`Menu state changed: expanded = ${n}`),n?(o<i&&(e.resizeTo(e.outerWidth,i),j.debug("PiP window expanded")),r&&(r.style.display="block")):r&&(r.style.display="none")}}),this.observer.observe(t,{attributes:!0,attributeFilter:["aria-expanded"]}),this.removalObserver=new MutationObserver(()=>{var n,i;t.isConnected||(null==(n=this.observer)||n.disconnect(),null==(i=this.removalObserver)||i.disconnect(),this.observer=null,this.removalObserver=null,j.debug("Menu button removed from DOM, re-waiting"),this.runObservation(e))}),this.removalObserver.observe(e.document.body,{childList:!0,subtree:!0})}stop(){this.observer&&(this.observer.disconnect(),this.observer=null),this.removalObserver&&(this.removalObserver.disconnect(),this.removalObserver=null),j.debug("Menu observation stopped")}}const G=p.getInstance("ContextMenuHandler");class X{constructor(){this.visibilityObserver=null,this.pipWindow=null,this.contextMenu=null,this.contextMenuPlaceholder=null}async initialize(e){this.pipWindow=e,this.contextMenuPlaceholder=z.createPlaceholder("context_menu_placeholder");try{this.contextMenu=await z.waitForElementSelector(f,document,0,e),G.log("Context menu element found, starting visibility monitoring"),this.startMonitoring(),this.setupDismissalHandler()}catch(t){G.warn("Error initializing context menu handler:",t)}}startMonitoring(){this.contextMenu&&this.pipWindow&&(this.visibilityObserver=new MutationObserver(()=>{var e;if(!this.contextMenu||!this.pipWindow)return;const t="none"!==this.contextMenu.style.display,n=this.contextMenu.parentNode!==this.pipWindow.document.body;t&&n?(G.log("Context menu opened in main window. Intercepting..."),this.contextMenuPlaceholder&&z.insertPlaceholderBefore(this.contextMenu,this.contextMenuPlaceholder),this.pipWindow.document.body.appendChild(this.contextMenu)):t||this.contextMenu.parentNode!==this.pipWindow.document.body||(null==(e=this.contextMenuPlaceholder)?void 0:e.parentNode)&&(G.log("Context menu closed in PiP window. Returning to main..."),z.restoreElementFromPlaceholder(this.contextMenu,this.contextMenuPlaceholder),this.simulateMainContextMenu())}),this.visibilityObserver.observe(this.contextMenu,{attributes:!0,attributeFilter:["style"]}),"none"!==this.contextMenu.style.display&&(this.contextMenuPlaceholder&&z.insertPlaceholderBefore(this.contextMenu,this.contextMenuPlaceholder),this.pipWindow.document.body.appendChild(this.contextMenu)))}setupDismissalHandler(){if(!this.pipWindow)return;const e=e=>{var t;const n=this.pipWindow.document.querySelector(f);n&&"none"!==n.style.display&&!(null==(t=e.target)?void 0:t.closest(P))&&(e.stopPropagation(),n.style.display="none",G.debug("Context menu dismissed"))};this.pipWindow.document.addEventListener("click",e,!0),this.pipWindow.document.addEventListener("contextmenu",e,!0)}simulateMainContextMenu(){const e=document.querySelector(w);if(!e)return;const t=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!0,view:window,clientX:0,clientY:0,button:2});e.dispatchEvent(t),G.debug("Synthetic contextmenu event sent to main window")}stop(){var e;this.visibilityObserver&&(this.visibilityObserver.disconnect(),this.visibilityObserver=null),this.contextMenu&&this.pipWindow&&this.contextMenu.parentNode===this.pipWindow.document.body&&(null==(e=this.contextMenuPlaceholder)?void 0:e.parentNode)&&(G.log("Returning context menu to main window"),z.restoreElementFromPlaceholder(this.contextMenu,this.contextMenuPlaceholder),this.simulateMainContextMenu()),this.pipWindow=null,G.debug("Context menu handler stopped")}}const K=p.getInstance("SeekHandler");class J{constructor(){this.pipWindow=null}initialize(e){this.pipWindow=e,this.setupSeekHandler(),K.debug("Seek handler initialized")}setupSeekHandler(){if(!this.pipWindow)return;const e=this.pipWindow.document;e.addEventListener("mousedown",t=>{var n;const i=null==(n=t.target)?void 0:n.closest(S);if(!i)return;const r=e.querySelector(m);if(!r)return;K.debug("Progress bar clicked, initiating seek"),t.preventDefault(),t.stopPropagation();const o=e=>{const t=i.getBoundingClientRect(),n=e.clientX-t.left,o=Math.max(0,Math.min(1,n/t.width)),a=r.getDuration();if(a){const e=o*a;r.seekTo(e,!0),K.debug(`Seeking to ${e.toFixed(2)}s (${(100*o).toFixed(1)}%)`)}};o(t);const a=e=>o(e),s=()=>{e.removeEventListener("mousemove",a),e.removeEventListener("mouseup",s),K.debug("Seek drag ended")};e.addEventListener("mousemove",a),e.addEventListener("mouseup",s)},!0)}cleanup(){this.pipWindow=null,K.debug("Seek handler cleaned up")}}const Q=p.getInstance("YtActionSender");class Z{constructor(e,t){this.pipWindow=e,this.playerManager=t}send(e){if(!this.pipWindow)return;const t=this.playerManager.getVideoId(this.pipWindow.document);if(!t)return;const n=document.querySelector(w);if(!n||"function"!=typeof n.resolveCommand)return void Q.error("Failed to find resolveCommand in main window");const i={likeEndpoint:{status:{[a]:"LIKE",[s]:"DISLIKE",[l]:"INDIFFERENT"}[e],target:{videoId:t}}};try{n.resolveCommand(i),Q.log(`Sent ${e} for video ${t}`)}catch(r){Q.error("Error sending YouTube action:",r)}}}const ee=p.getInstance("LikeButtonHandler");class te{constructor(e){this.pipWindow=null,this.ytActionSender=null,this.playerManager=e}initialize(e){this.pipWindow=e,this.ytActionSender=new Z(e,this.playerManager),this.setupClickHandler(),ee.debug("Like button handler initialized")}setupClickHandler(){this.pipWindow&&this.pipWindow.document.addEventListener("click",e=>{var t,n,i;const r=null==(t=e.target)?void 0:t.closest(x);if(!r)return;const o=r.parentElement;if(!o)return;const c=o.childNodes[0]===r,d=o.childNodes[1]===r;if(!c&&!d)return;const u=null==(n=e.target)?void 0:n.closest(C);if(!u)return;const p="true"===u.getAttribute("aria-pressed"),h=p?l:c?a:s;ee.log(`${h} button clicked (currently pressed: ${p})`),null==(i=this.ytActionSender)||i.send(h)},!0)}cleanup(){this.pipWindow=null,this.ytActionSender=null,ee.debug("Like button handler cleaned up")}}class ne extends R{constructor(e,t){super(e,t),this.name="AppInitializationError"}}const ie=p.getInstance("MediaSessionHandler");class re{constructor(e){this.pipManager=e}initialize(){"mediaSession"in navigator?(this.registerActionHandler(),this.setupTitleSync(),ie.debug("Media session handler initialized")):ie.warn("Media Session API not available")}registerActionHandler(){if("mediaSession"in navigator)try{navigator.mediaSession.setActionHandler("enterpictureinpicture",()=>{ie.log("Media session enterpictureinpicture action triggered"),this.pipManager.open().catch(e=>{ie.error("Error opening PiP from media session:",e)})}),ie.debug("Media session action handler registered")}catch(e){throw new ne("Error registering media session action handler",e)}}setupTitleSync(){if("mediaSession"in navigator)try{const e=Object.getPrototypeOf(navigator.mediaSession),t=Object.getOwnPropertyDescriptor(e,"metadata");if(!t||!t.get||!t.set)return void ie.warn("Could not get original metadata descriptor");Object.defineProperty(navigator.mediaSession,"metadata",{get:()=>t.get.call(navigator.mediaSession),set:e=>{t.set.call(navigator.mediaSession,e),e&&e.title&&this.pipManager.updateTitle(e.title)},configurable:!0,enumerable:!0}),ie.debug("Media session title sync configured")}catch(e){throw new ne("Error setting up title sync",e)}}}function oe(){var e,t,n;try{const i=window.ytcfg;if(null==(n=null==(t=null==(e=null==i?void 0:i.data_)?void 0:e.INNERTUBE_CONTEXT)?void 0:t.client)?void 0:n.clientVersion)return i.data_.INNERTUBE_CONTEXT.client.clientVersion}catch{}return"unknown"}function ae(){try{const e=navigator.userAgent;if(!e)return"unknown";const t=e.match(/Chrome\/([\d.]+)/);if(t&&!e.includes("Edg/"))return`Chrome/${t[1]}`;const n=e.match(/Edg\/([\d.]+)/);if(n)return`Edge/${n[1]}`;const i=e.match(/Firefox\/([\d.]+)/);if(i)return`Firefox/${i[1]}`;const r=e.match(/Version\/([\d.]+).*Safari/);return r&&!e.includes("Chrome")?`Safari/${r[1]}`:e}catch{}return"unknown"}function se(){const e={youtubeVersion:oe(),scriptVersion:"1.3.2",browserVersion:ae()},t=function(){try{const e=window.ytcfg;if(!(null==e?void 0:e.data_))return{};const t=e.data_;return"EXPERIMENT_FLAGS"in t&&t.EXPERIMENT_FLAGS?t.EXPERIMENT_FLAGS:{}}catch{}return{}}();return Object.keys(t).length>0&&(e.youtubeFeatureFlags=t),e}const le=p.getInstance("Main");function ce(){p.setGlobalMetadata(se());(new de).initialize().catch(e=>{le.error("Error initializing application:",e)})}class de{constructor(){this.playerManager=new H,this.miniPlayerController=new A(this.playerManager),this.navigationHandler=new B,this.resizeTracker=new Y,this.menuObserver=new U,this.contextMenuHandler=new X,this.seekHandler=new J,this.likeButtonHandler=new te(this.playerManager),this.pipManager=new V(this.miniPlayerController,this.playerManager,this.navigationHandler,(e,t)=>this.createPiPWindowCallback(e,t)),this.mediaSessionHandler=new re(this.pipManager)}async createPiPWindowCallback(e,t){return await this.initializePiPWindowHandlers(e,t),()=>{this.seekHandler.cleanup(),this.likeButtonHandler.cleanup(),this.contextMenuHandler.stop(),this.menuObserver.stop(),this.resizeTracker.stop(),this.navigationHandler.cleanup()}}async initialize(){le.log("Initializing YouTube PiP application"),this.mediaSessionHandler.initialize(),le.log("YouTube PiP application initialized")}async initializePiPWindowHandlers(e,t){le.debug("Initializing PiP window handlers"),this.resizeTracker.start(t,e),this.menuObserver.start(e),this.contextMenuHandler.initialize(e),this.seekHandler.initialize(e),this.likeButtonHandler.initialize(e),le.debug("All PiP window handlers initialized")}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",ce):ce()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXNlcnNjcmlwdC5qcyIsInNvdXJjZXMiOlsiLi4vc3JjL2NvbnN0YW50cy50cyIsIi4uL3NyYy9sb2dnZXIudHMiLCIuLi9zcmMvc2VsZWN0b3JzLnRzIiwiLi4vc3JjL3VpL01pbmlQbGF5ZXJDb250cm9sbGVyLnRzIiwiLi4vc3JjL3V0aWxzL0RPTVV0aWxzLnRzIiwiLi4vc3JjL2NvcmUvUGxheWVyTWFuYWdlci50cyIsIi4uL3NyYy9jb3JlL05hdmlnYXRpb25IYW5kbGVyLnRzIiwiLi4vc3JjL3N0eWxlcy5jc3M/cmF3IiwiLi4vc3JjL3V0aWxzL1N0eWxlVXRpbHMudHMiLCIuLi9zcmMvZXJyb3JzL0FwcEVycm9yLnRzIiwiLi4vc3JjL2Vycm9ycy9QaVBFcnJvci50cyIsIi4uL3NyYy9jb3JlL1BpUE1hbmFnZXIudHMiLCIuLi9zcmMvdWkvUmVzaXplVHJhY2tlci50cyIsIi4uL3NyYy91aS9NZW51T2JzZXJ2ZXIudHMiLCIuLi9zcmMvdWkvQ29udGV4dE1lbnVIYW5kbGVyLnRzIiwiLi4vc3JjL2hhbmRsZXJzL1NlZWtIYW5kbGVyLnRzIiwiLi4vc3JjL2NvcmUvWXRBY3Rpb25TZW5kZXIudHMiLCIuLi9zcmMvaGFuZGxlcnMvTGlrZUJ1dHRvbkhhbmRsZXIudHMiLCIuLi9zcmMvZXJyb3JzL0FwcEluaXRpYWxpemF0aW9uRXJyb3IudHMiLCIuLi9zcmMvaGFuZGxlcnMvTWVkaWFTZXNzaW9uSGFuZGxlci50cyIsIi4uL3NyYy91dGlscy9WZXJzaW9uRGV0ZWN0b3IudHMiLCIuLi9zcmMvbWFpbi50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEFwcGxpY2F0aW9uIGNvbnN0YW50c1xuICovXG5cbi8vIExvY2FsU3RvcmFnZSBmbGFnIGZvciBlbmFibGluZyBkZWJ1ZyBsb2dzXG5leHBvcnQgY29uc3QgREVCVUdfRkxBRyA9ICdZT1VUVUJFX1BJUF9ERUJVRyc7XG5cbi8vIFRpbWVvdXQgdmFsdWVzIChpbiBtaWxsaXNlY29uZHMpXG5leHBvcnQgY29uc3QgVElNRU9VVFMgPSB7XG4gIEVMRU1FTlRfV0FJVDogNTAwMCxcbiAgRUxFTUVOVF9XQUlUX0lORklOSVRFOiAwLFxuICBNRU5VX1JFVFJZX0RFTEFZOiAxMDAsXG59IGFzIGNvbnN0O1xuXG4vLyBSZXRyeSBjb3VudHNcbmV4cG9ydCBjb25zdCBSRVRSWV9MSU1JVFMgPSB7XG4gIE1JTklQTEFZRVJfU1dJVENIOiA1LFxufSBhcyBjb25zdDtcblxuLy8gRGVmYXVsdCBkaW1lbnNpb25zXG5leHBvcnQgY29uc3QgREVGQVVMVF9ESU1FTlNJT05TID0ge1xuICBQSVBfV0lEVEg6IDQ4MCxcbiAgUElQX0hFSUdIVDogMjcwLFxuICBQSVBfRVhQQU5ERURfSEVJR0hUOiA2MDAsXG59IGFzIGNvbnN0O1xuXG4vLyBZb3VUdWJlIHBsYXllciBzdGF0ZXNcbmV4cG9ydCBjb25zdCBQTEFZRVJfU1RBVEVTID0ge1xuICBVTlNUQVJURUQ6IC0xLFxuICBFTkRFRDogMCxcbiAgUExBWUlORzogMSxcbiAgUEFVU0VEOiAyLFxuICBCVUZGRVJJTkc6IDMsXG4gIENVRUQ6IDUsXG59IGFzIGNvbnN0O1xuXG4vLyBZb3VUdWJlIGFjdGlvbiB0eXBlc1xuZXhwb3J0IGNvbnN0IFlUX0FDVElPTlMgPSB7XG4gIExJS0U6ICdMSUtFJyxcbiAgRElTTElLRTogJ0RJU0xJS0UnLFxuICBSRU1PVkU6ICdJTkRJRkZFUkVOVCcsXG59IGFzIGNvbnN0O1xuXG4vLyBZb3VUdWJlIHdlYiBwYWdlIHR5cGVzXG5leHBvcnQgY29uc3QgV0VCX1BBR0VfVFlQRVMgPSB7XG4gIFdBVENIOiAnV0VCX1BBR0VfVFlQRV9XQVRDSCcsXG59IGFzIGNvbnN0O1xuXG4vLyBZb3VUdWJlIHJvb3QgVkVcbmV4cG9ydCBjb25zdCBST09UX1ZFID0gMzgzMjtcbiIsImltcG9ydCB7IERFQlVHX0ZMQUcgfSBmcm9tICcuL2NvbnN0YW50cyc7XG5cbi8qKlxuICogRm9ybWF0IGRhdGUgYXMgWVlZWS1NTS1ERDpISDptbTpzcy5TU1MgdXNpbmcgSW50bC5EYXRlVGltZUZvcm1hdFxuICovXG5jb25zdCB0aW1lc3RhbXBGb3JtYXR0ZXIgPSBuZXcgSW50bC5EYXRlVGltZUZvcm1hdCgnZW4tQ0EnLCB7XG4gIHllYXI6ICdudW1lcmljJyxcbiAgbW9udGg6ICcyLWRpZ2l0JyxcbiAgZGF5OiAnMi1kaWdpdCcsXG4gIGhvdXI6ICcyLWRpZ2l0JyxcbiAgbWludXRlOiAnMi1kaWdpdCcsXG4gIHNlY29uZDogJzItZGlnaXQnLFxuICBob3VyMTI6IGZhbHNlLFxufSk7XG5cbmZ1bmN0aW9uIGZvcm1hdFRpbWVzdGFtcChkYXRlOiBEYXRlKTogc3RyaW5nIHtcbiAgLy8gSW50bC5EYXRlVGltZUZvcm1hdCBvdXRwdXRzOiBcIjIwMjYtMDEtMjcsIDEyOjM0OjU2XCJcbiAgLy8gQWRkIG1pbGxpc2Vjb25kcyBtYW51YWxseTogXCIyMDI2LTAxLTI3OjEyOjM0OjU2Ljc4OVwiXG4gIGNvbnN0IG1zID0gU3RyaW5nKGRhdGUuZ2V0TWlsbGlzZWNvbmRzKCkpLnBhZFN0YXJ0KDMsICcwJyk7XG4gIHJldHVybiB0aW1lc3RhbXBGb3JtYXR0ZXIuZm9ybWF0KGRhdGUpLnJlcGxhY2UoJywgJywgJzonKSArICcuJyArIG1zO1xufVxuXG5jb25zdCBQUkVGSVhfQlJBTkQgPSAnW1lvdVR1YmUgUGlQXSc7XG5jb25zdCBQUkVGSVhfU0NPUEUgPSAoc2NvcGU6IHN0cmluZykgPT4gYFske3Njb3BlfV1gIGFzIGNvbnN0O1xuXG4vKiogVGltZXN0YW1wIFlZWVktTU0tREQ6SEg6bW06c3MuU1NTIOKAkyBibHVlICovXG5jb25zdCBTVFlMRV9USU1FU1RBTVAgPSAnY29sb3I6ICMzYjgyZjY7IGZvbnQtd2VpZ2h0OiA1MDA7Jztcbi8qKiBbWW91VHViZSBQaVBdIOKAkyBpbmRpZ28sIGJvbGQgKi9cbmNvbnN0IFNUWUxFX0JSQU5EID0gJ2NvbG9yOiAjNjM2NmYxOyBmb250LXdlaWdodDogNjAwOyc7XG4vKiogW3Njb3BlXSDigJMgYW1iZXIgKi9cbmNvbnN0IFNUWUxFX1NDT1BFID0gJ2NvbG9yOiAjZjU5ZTBiOyBmb250LXdlaWdodDogNTAwOyc7XG4vKiogSW5mbyAobG9nKSBtZXNzYWdlIOKAkyBsaWdodCBncmVlbiAqL1xuY29uc3QgU1RZTEVfTVNHX0lORk8gPSAnY29sb3I6ICM4NmVmYWM7Jztcbi8qKiBXYXJuIG1lc3NhZ2Ug4oCTIGxpZ2h0IHllbGxvdyAqL1xuY29uc3QgU1RZTEVfTVNHX1dBUk4gPSAnY29sb3I6ICNmZGUwNDc7Jztcbi8qKiBFcnJvciBtZXNzYWdlIOKAkyBsaWdodCByZWQgKi9cbmNvbnN0IFNUWUxFX01TR19FUlJPUiA9ICdjb2xvcjogI2Y4NzE3MTsnO1xuLyoqIERlYnVnIG1lc3NhZ2Ug4oCTIG11dGVkIGdyYXkgKi9cbmNvbnN0IFNUWUxFX01TR19ERUJVRyA9ICdjb2xvcjogI2ExYTFhYTsnO1xuXG4vKipcbiAqIExvZ2dlciBjbGFzcyBmb3IgY29uZGl0aW9uYWwgY29uc29sZSBsb2dnaW5nIHdpdGggbW9kdWxlIHNjb3BlLlxuICogT25seSBsb2dzIHdoZW4gREVCVUdfRkxBRyBpcyBzZXQgaW4gbG9jYWxTdG9yYWdlIChleGNlcHQgZXJyb3IsIGFsd2F5cyBsb2dnZWQpLlxuICogVXNlcyAlYyBzdHlsaW5nOiBbWW91VHViZSBQaVBdIC8gW3Njb3BlXSAvIG1lc3NhZ2UgaW4gc2VwYXJhdGUgY29sb3JzLlxuICogTWVzc2FnZSBhbmQgb3B0aW9uYWwgbWV0YWRhdGEgYXJlIHBhc3NlZCB0byBjb25zb2xlIGFzLWlzIChvYmplY3RzIHN0YXkgZXhwYW5kYWJsZSkuXG4gKi9cbmV4cG9ydCBjbGFzcyBMb2dnZXIge1xuICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZXMgPSBuZXcgTWFwPHN0cmluZywgTG9nZ2VyPigpO1xuICBwcml2YXRlIHN0YXRpYyBlbmFibGVkID0gZmFsc2U7XG4gIHByaXZhdGUgc3RhdGljIHN0b3JhZ2VMaXN0ZW5lckFkZGVkID0gZmFsc2U7XG4gIHByaXZhdGUgc3RhdGljIGdsb2JhbE1ldGFkYXRhOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiA9IHt9O1xuXG4gIHByaXZhdGUgcmVhZG9ubHkgc2NvcGU6IHN0cmluZztcblxuICBwcml2YXRlIGNvbnN0cnVjdG9yKHNjb3BlOiBzdHJpbmcpIHtcbiAgICB0aGlzLnNjb3BlID0gc2NvcGU7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGxvZ2dlciBpbnN0YW5jZSBmb3IgdGhlIGdpdmVuIG1vZHVsZSBzY29wZS5cbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgZ2V0SW5zdGFuY2Uoc2NvcGU6IHN0cmluZyk6IExvZ2dlciB7XG4gICAgaWYgKCFMb2dnZXIuc3RvcmFnZUxpc3RlbmVyQWRkZWQpIHtcbiAgICAgIExvZ2dlci5lbmFibGVkID0gTG9nZ2VyLmNoZWNrRGVidWdGbGFnKCk7XG4gICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignc3RvcmFnZScsICgpID0+IHtcbiAgICAgICAgTG9nZ2VyLmVuYWJsZWQgPSBMb2dnZXIuY2hlY2tEZWJ1Z0ZsYWcoKTtcbiAgICAgIH0pO1xuICAgICAgTG9nZ2VyLnN0b3JhZ2VMaXN0ZW5lckFkZGVkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBsZXQgaW5zdGFuY2UgPSBMb2dnZXIuaW5zdGFuY2VzLmdldChzY29wZSk7XG4gICAgaWYgKCFpbnN0YW5jZSkge1xuICAgICAgaW5zdGFuY2UgPSBuZXcgTG9nZ2VyKHNjb3BlKTtcbiAgICAgIExvZ2dlci5pbnN0YW5jZXMuc2V0KHNjb3BlLCBpbnN0YW5jZSk7XG4gICAgfVxuICAgIHJldHVybiBpbnN0YW5jZTtcbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIGNoZWNrRGVidWdGbGFnKCk6IGJvb2xlYW4ge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gbG9jYWxTdG9yYWdlLmdldEl0ZW0oREVCVUdfRkxBRykgPT09ICd0cnVlJztcbiAgICB9IGNhdGNoIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU2V0IGdsb2JhbCBtZXRhZGF0YSB0aGF0IHdpbGwgYmUgaW5jbHVkZWQgaW4gYWxsIGxvZyBtZXNzYWdlcy5cbiAgICogU2hvdWxkIGJlIGNhbGxlZCBiZWZvcmUgaW5pdGlhbGl6aW5nIHRoZSBhcHBsaWNhdGlvbi5cbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgc2V0R2xvYmFsTWV0YWRhdGEobWV0YWRhdGE6IFJlY29yZDxzdHJpbmcsIHVua25vd24+KTogdm9pZCB7XG4gICAgTG9nZ2VyLmdsb2JhbE1ldGFkYXRhID0geyAuLi5tZXRhZGF0YSB9O1xuICB9XG5cbiAgcHJpdmF0ZSBzdHlsZWQoXG4gICAgZm46ICh0ZW1wbGF0ZTogc3RyaW5nLCAuLi5yZXN0OiB1bmtub3duW10pID0+IHZvaWQsXG4gICAgbXNnU3R5bGU6IHN0cmluZyxcbiAgICBtZXNzYWdlOiBzdHJpbmcsXG4gICAgbWV0YT86IHVua25vd25cbiAgKTogdm9pZCB7XG4gICAgY29uc3QgdHMgPSBmb3JtYXRUaW1lc3RhbXAobmV3IERhdGUoKSk7XG4gICAgY29uc3QgZXNjYXBlZCA9IG1lc3NhZ2UucmVwbGFjZSgvJS9nLCAnJSUnKTtcbiAgICBjb25zdCB0ZW1wbGF0ZSA9IGAlYyR7dHN9JWMgJHtQUkVGSVhfQlJBTkR9JWMke1BSRUZJWF9TQ09QRSh0aGlzLnNjb3BlKX0lYyAke2VzY2FwZWR9YDtcblxuICAgIC8vIEJ1aWxkIGFyZ3VtZW50czogdGVtcGxhdGUsIHN0eWxlcywgbWV0YSAoaWYgcHJvdmlkZWQpLCBnbG9iYWwgbWV0YWRhdGEgKGlmIGV4aXN0cylcbiAgICBjb25zdCBhcmdzOiBbc3RyaW5nLCAuLi51bmtub3duW11dID0gW1xuICAgICAgdGVtcGxhdGUsXG4gICAgICBTVFlMRV9USU1FU1RBTVAsXG4gICAgICBTVFlMRV9CUkFORCxcbiAgICAgIFNUWUxFX1NDT1BFLFxuICAgICAgbXNnU3R5bGUsXG4gICAgXTtcblxuICAgIC8vIEFkZCB1c2VyLXByb3ZpZGVkIG1ldGFkYXRhIGZpcnN0XG4gICAgaWYgKG1ldGEgIT09IHVuZGVmaW5lZCkge1xuICAgICAgYXJncy5wdXNoKG1ldGEpO1xuICAgIH1cblxuICAgIC8vIEFkZCBnbG9iYWwgbWV0YWRhdGEgYWZ0ZXIgdXNlciBtZXRhZGF0YSAoaWYgZXhpc3RzKVxuICAgIGlmIChPYmplY3Qua2V5cyhMb2dnZXIuZ2xvYmFsTWV0YWRhdGEpLmxlbmd0aCA+IDApIHtcbiAgICAgIGFyZ3MucHVzaChMb2dnZXIuZ2xvYmFsTWV0YWRhdGEpO1xuICAgIH1cblxuICAgIGZuKC4uLmFyZ3MpO1xuICB9XG5cbiAgLyoqXG4gICAqIExvZyBtZXNzYWdlIGlmIGRlYnVnIGlzIGVuYWJsZWQuIEluZm8gbGV2ZWwg4oCTIGxpZ2h0IGdyZWVuLiBPcHRpb25hbCBtZXRhZGF0YSBhcyBzZWNvbmQgYXJnLlxuICAgKi9cbiAgcHVibGljIGxvZyhtZXNzYWdlOiBzdHJpbmcsIG1ldGE/OiB1bmtub3duKTogdm9pZCB7XG4gICAgaWYgKExvZ2dlci5lbmFibGVkKSB7XG4gICAgICB0aGlzLnN0eWxlZChjb25zb2xlLmxvZy5iaW5kKGNvbnNvbGUpLCBTVFlMRV9NU0dfSU5GTywgbWVzc2FnZSwgbWV0YSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIExvZyB3YXJuaW5nIGlmIGRlYnVnIGlzIGVuYWJsZWQuIE9wdGlvbmFsIG1ldGFkYXRhIGFzIHNlY29uZCBhcmcuXG4gICAqL1xuICBwdWJsaWMgd2FybihtZXNzYWdlOiBzdHJpbmcsIG1ldGE/OiB1bmtub3duKTogdm9pZCB7XG4gICAgaWYgKExvZ2dlci5lbmFibGVkKSB7XG4gICAgICB0aGlzLnN0eWxlZChjb25zb2xlLndhcm4uYmluZChjb25zb2xlKSwgU1RZTEVfTVNHX1dBUk4sIG1lc3NhZ2UsIG1ldGEpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBMb2cgZXJyb3IgKGFsd2F5cyBsb2dnZWQsIHJlZ2FyZGxlc3Mgb2YgZGVidWcgZmxhZykuIE9wdGlvbmFsIG1ldGFkYXRhIGFzIHNlY29uZCBhcmcuXG4gICAqL1xuICBwdWJsaWMgZXJyb3IobWVzc2FnZTogc3RyaW5nLCBtZXRhPzogdW5rbm93bik6IHZvaWQge1xuICAgIHRoaXMuc3R5bGVkKGNvbnNvbGUuZXJyb3IuYmluZChjb25zb2xlKSwgU1RZTEVfTVNHX0VSUk9SLCBtZXNzYWdlLCBtZXRhKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBMb2cgZGVidWcgbWVzc2FnZSBpZiBkZWJ1ZyBpcyBlbmFibGVkLiBPcHRpb25hbCBtZXRhZGF0YSBhcyBzZWNvbmQgYXJnLlxuICAgKi9cbiAgcHVibGljIGRlYnVnKG1lc3NhZ2U6IHN0cmluZywgbWV0YT86IHVua25vd24pOiB2b2lkIHtcbiAgICBpZiAoTG9nZ2VyLmVuYWJsZWQpIHtcbiAgICAgIHRoaXMuc3R5bGVkKGNvbnNvbGUuZGVidWcuYmluZChjb25zb2xlKSwgU1RZTEVfTVNHX0RFQlVHLCBtZXNzYWdlLCBtZXRhKTtcbiAgICB9XG4gIH1cbn1cbiIsIi8qKlxuICogRE9NIHNlbGVjdG9ycyDigJMgc2luZ2xlIHNvdXJjZSBvZiB0cnV0aFxuICovXG5cbmV4cG9ydCBjb25zdCBTRUxFQ1RPUlMgPSB7XG4gIE1JTklQTEFZRVI6ICd5dGQtbWluaXBsYXllcicsXG4gIE1JTklQTEFZRVJfQ09OVEFJTkVSOiAneXRkLW1pbmlwbGF5ZXItcGxheWVyLWNvbnRhaW5lcicsXG4gIE1JTklQTEFZRVJfSE9TVDogJy55dGRNaW5pcGxheWVyQ29tcG9uZW50SG9zdC55dGRNaW5pcGxheWVyQ29tcG9uZW50VmlzaWJsZScsXG4gIE1PVklFX1BMQVlFUjogJyNtb3ZpZV9wbGF5ZXInLFxuICBZVERfQVBQOiAneXRkLWFwcCcsXG4gIFlUX0RSQUdHQUJMRTogJ3l0LWRyYWdnYWJsZScsXG4gIEhUTUw1X1ZJREVPX1BMQVlFUjogJy5odG1sNS12aWRlby1wbGF5ZXInLFxuICBDT05URVhUX01FTlU6ICcueXRwLXBvcHVwLnl0cC1jb250ZXh0bWVudScsXG4gIENPTlRFWFRfTUVOVV9DT05UQUlORVI6ICcueXRwLWNvbnRleHRtZW51JyxcbiAgTUVOVV9CVVRUT046ICcueXQtc3BlYy1idXR0b24tc2hhcGUtbmV4dFthcmlhLWV4cGFuZGVkXScsXG4gIFBMQVlMSVNUX1BBTkVMOiAnLnl0ZE1pbmlwbGF5ZXJDb21wb25lbnRQbGF5bGlzdFBhbmVsJyxcbiAgUFJPR1JFU1NfQkFSOiAnLnl0cC1wcm9ncmVzcy1iYXInLFxuICBMSUtFX0JVVFRPTjogJ3l0ZC1zbGltLW1ldGFkYXRhLXRvZ2dsZS1idXR0b24tcmVuZGVyZXInLFxuICBCVVRUT05fU0hBUEU6ICcueXQtc3BlYy1idXR0b24tc2hhcGUtbmV4dCcsXG4gIFNJTVBMRV9FTkRQT0lOVDogJy55dC1zaW1wbGUtZW5kcG9pbnQnLFxuICBCVVRUT046ICdidXR0b24nLFxuICBTVFlMRVNIRUVUUzogJ3N0eWxlLCBsaW5rW3JlbD1cInN0eWxlc2hlZXRcIl0nLFxufSBhcyBjb25zdDtcblxuZXhwb3J0IHR5cGUgU2VsZWN0b3IgPSAodHlwZW9mIFNFTEVDVE9SUylba2V5b2YgdHlwZW9mIFNFTEVDVE9SU107XG4iLCJpbXBvcnQgeyBMb2dnZXIgfSBmcm9tICcuLi9sb2dnZXInO1xuaW1wb3J0IHsgU0VMRUNUT1JTIH0gZnJvbSAnLi4vc2VsZWN0b3JzJztcbmltcG9ydCB7IFBsYXllck1hbmFnZXIgfSBmcm9tICcuLi9jb3JlL1BsYXllck1hbmFnZXInO1xuaW1wb3J0IHR5cGUgeyBZb3VUdWJlQXBwRWxlbWVudCB9IGZyb20gJy4uL3R5cGVzL3lvdXR1YmUnO1xuaW1wb3J0IHR5cGUgeyBOdWxsYWJsZSB9IGZyb20gJy4uL3R5cGVzL2FwcCc7XG5cbmNvbnN0IGxvZ2dlciA9IExvZ2dlci5nZXRJbnN0YW5jZSgnTWluaVBsYXllckNvbnRyb2xsZXInKTtcblxuLyoqXG4gKiBDb250cm9scyBtaW5pIHBsYXllciB2aXNpYmlsaXR5IGFuZCBzdGF0ZSB1c2luZyBZb3VUdWJlIG5hdGl2ZSBhY3Rpb25zXG4gKi9cbmV4cG9ydCBjbGFzcyBNaW5pUGxheWVyQ29udHJvbGxlciB7XG4gIHByaXZhdGUgcGxheWVyTWFuYWdlcjogUGxheWVyTWFuYWdlcjtcblxuICBjb25zdHJ1Y3RvcihwbGF5ZXJNYW5hZ2VyOiBQbGF5ZXJNYW5hZ2VyKSB7XG4gICAgdGhpcy5wbGF5ZXJNYW5hZ2VyID0gcGxheWVyTWFuYWdlcjtcbiAgfVxuICAvKipcbiAgICogQ2hlY2sgaWYgbWluaSBwbGF5ZXIgaXMgY3VycmVudGx5IHZpc2libGVcbiAgICovXG4gIHB1YmxpYyBpc1Zpc2libGUoKTogYm9vbGVhbiB7XG4gICAgY29uc3QgaXNWaXNpYmxlID0gISFkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFNFTEVDVE9SUy5NSU5JUExBWUVSX0hPU1QpO1xuICAgIGxvZ2dlci5kZWJ1ZyhgTWluaSBwbGF5ZXIgdmlzaWJsZTogJHtpc1Zpc2libGV9YCk7XG4gICAgcmV0dXJuIGlzVmlzaWJsZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBY3RpdmF0ZSBtaW5pIHBsYXllciB1c2luZyBZb3VUdWJlIG5hdGl2ZSBhY3Rpb25cbiAgICogVXNlcyB5dC1hY3Rpb24gd2l0aCB5dC1hY3RpdmF0ZS1taW5pcGxheWVyLWZyb20td2F0Y2gtYWN0aW9uXG4gICAqL1xuICBwdWJsaWMgYWN0aXZhdGVNaW5pUGxheWVyKCk6IHZvaWQge1xuICAgIGxvZ2dlci5kZWJ1ZygnQWN0aXZhdGluZyBtaW5pIHBsYXllciB2aWEgWW91VHViZSBBUEknKTtcblxuICAgIGNvbnN0IHl0ZEFwcCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoU0VMRUNUT1JTLllURF9BUFApIGFzIE51bGxhYmxlPFlvdVR1YmVBcHBFbGVtZW50PjtcbiAgICBpZiAoIXl0ZEFwcCkge1xuICAgICAgbG9nZ2VyLmVycm9yKCd5dGQtYXBwIG5vdCBmb3VuZCcpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICB5dGRBcHAuZmlyZSgneXQtYWN0aW9uJywge1xuICAgICAgICBhY3Rpb25OYW1lOiAneXQtYWN0aXZhdGUtbWluaXBsYXllcicsXG4gICAgICAgIGFyZ3M6IFtmYWxzZV0sXG4gICAgICAgIHJldHVyblZhbHVlOiBbdW5kZWZpbmVkXSxcbiAgICAgIH0pO1xuICAgICAgbG9nZ2VyLmRlYnVnKCdNaW5pIHBsYXllciBhY3RpdmF0aW9uIGV2ZW50IGRpc3BhdGNoZWQnKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGFjdGl2YXRpbmcgbWluaSBwbGF5ZXI6JywgZSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFRvZ2dsZSBtaW5pIHBsYXllciBtb2RlIHVzaW5nIFlvdVR1YmUgbmF0aXZlIEFQSVxuICAgKlxuICAgKiBJZiBtaW5pIHBsYXllciBpcyB2aXNpYmxlIG9yIGZvcmNlSGlkZSBpcyB0cnVlLCBuYXZpZ2F0ZXMgYmFjayB0byBmdWxsIHBsYXllciB1c2luZyB5dC1uYXZpZ2F0ZS5cbiAgICogT3RoZXJ3aXNlLCBhY3RpdmF0ZXMgbWluaSBwbGF5ZXIgdXNpbmcgeXQtYWN0aW9uIHdpdGggeXQtYWN0aXZhdGUtbWluaXBsYXllci1mcm9tLXdhdGNoLWFjdGlvbi5cbiAgICpcbiAgICogQHBhcmFtIGZvcmNlSGlkZSAtIElmIHRydWUsIGZvcmNlcyByZXR1cm4gdG8gZnVsbCBwbGF5ZXIgZXZlbiBpZiBtaW5pIHBsYXllciBpcyBub3QgdmlzaWJsZVxuICAgKiBAcmV0dXJucyB2b2lkXG4gICAqL1xuICBwdWJsaWMgdG9nZ2xlTWluaVBsYXllcihmb3JjZUhpZGU6IGJvb2xlYW4gPSBmYWxzZSk6IHZvaWQge1xuICAgIGNvbnN0IGlzVmlzaWJsZSA9IHRoaXMuaXNWaXNpYmxlKCk7XG5cbiAgICBjb25zdCB5dGRBcHAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFNFTEVDVE9SUy5ZVERfQVBQKSBhcyBOdWxsYWJsZTxZb3VUdWJlQXBwRWxlbWVudD47XG4gICAgaWYgKCF5dGRBcHApIHtcbiAgICAgIGxvZ2dlci5lcnJvcigneXRkLWFwcCBub3QgZm91bmQnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgaWYgKGlzVmlzaWJsZSB8fCBmb3JjZUhpZGUpIHtcbiAgICAgICAgLy8gUmV0dXJuIHRvIGZ1bGwgcGxheWVyOiB1c2UgeXQtbmF2aWdhdGUgd2l0aCB3YXRjaEVuZHBvaW50XG4gICAgICAgIGxvZ2dlci5kZWJ1ZygnUmV0dXJuaW5nIHRvIGZ1bGwgcGxheWVyIHZpYSBZb3VUdWJlIEFQSScpO1xuXG4gICAgICAgIC8vIEdldCB2aWRlbyBJRCBmcm9tIHBsYXllciB1c2luZyBQbGF5ZXJNYW5hZ2VyXG4gICAgICAgIGNvbnN0IHZpZGVvSWQgPSB0aGlzLnBsYXllck1hbmFnZXIuZ2V0VmlkZW9JZChkb2N1bWVudCk7XG4gICAgICAgIGlmICghdmlkZW9JZCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHl0ZEFwcC5maXJlKCd5dC1uYXZpZ2F0ZScsIHtcbiAgICAgICAgICBlbmRwb2ludDoge1xuICAgICAgICAgICAgd2F0Y2hFbmRwb2ludDogeyB2aWRlb0lkIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIGxvZ2dlci5kZWJ1ZyhgTmF2aWdhdGlvbiB0byBmdWxsIHBsYXllciBkaXNwYXRjaGVkIGZvciB2aWRlbyAke3ZpZGVvSWR9YCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBBY3RpdmF0ZSBtaW5pcGxheWVyOiB1c2UgeXQtYWN0aW9uIHdpdGggeXQtYWN0aXZhdGUtbWluaXBsYXllci1mcm9tLXdhdGNoLWFjdGlvblxuICAgICAgICBsb2dnZXIuZGVidWcoJ0FjdGl2YXRpbmcgbWluaXBsYXllciB2aWEgWW91VHViZSBBUEknKTtcbiAgICAgICAgeXRkQXBwLmZpcmUoJ3l0LWFjdGlvbicsIHtcbiAgICAgICAgICBhY3Rpb25OYW1lOiAneXQtYWN0aXZhdGUtbWluaXBsYXllci1mcm9tLXdhdGNoLWFjdGlvbicsXG4gICAgICAgICAgcmV0dXJuVmFsdWU6IFtdLFxuICAgICAgICB9KTtcbiAgICAgICAgbG9nZ2VyLmRlYnVnKCdNaW5pcGxheWVyIGFjdGl2YXRpb24gZXZlbnQgZGlzcGF0Y2hlZCcpO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgdG9nZ2xpbmcgbWluaSBwbGF5ZXI6JywgZSk7XG4gICAgfVxuICB9XG59XG4iLCJpbXBvcnQgeyBMb2dnZXIgfSBmcm9tICcuLi9sb2dnZXInO1xuaW1wb3J0IHsgVElNRU9VVFMgfSBmcm9tICcuLi9jb25zdGFudHMnO1xuaW1wb3J0IHR5cGUgeyBEb2N1bWVudE9yRWxlbWVudCwgTnVsbGFibGUgfSBmcm9tICcuLi90eXBlcy9hcHAnO1xuXG5jb25zdCBsb2dnZXIgPSBMb2dnZXIuZ2V0SW5zdGFuY2UoJ0RPTVV0aWxzJyk7XG5cbi8qKlxuICogVXRpbGl0eSBjbGFzcyBmb3IgRE9NIG9wZXJhdGlvbnNcbiAqL1xuZXhwb3J0IGNsYXNzIERPTVV0aWxzIHtcbiAgLyoqXG4gICAqIENyZWF0ZSBhIGNvbW1lbnQgbm9kZSB0byB1c2UgYXMgYSBwbGFjZWhvbGRlciAoZS5nLiBiZWZvcmUgbW92aW5nIGFuIGVsZW1lbnQgZWxzZXdoZXJlKS5cbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgY3JlYXRlUGxhY2Vob2xkZXIoY29tbWVudFRleHQ6IHN0cmluZyk6IENvbW1lbnQge1xuICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVDb21tZW50KGNvbW1lbnRUZXh0KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBJbnNlcnQgcGxhY2Vob2xkZXIgYmVmb3JlIGVsZW1lbnQuIEVsZW1lbnQgc3RheXMgaW4gRE9NOyBjYWxsZXIgdHlwaWNhbGx5IG1vdmVzIGl0LlxuICAgKiBAcmV0dXJucyB0cnVlIGlmIGluc2VydGVkLCBmYWxzZSBpZiBlbGVtZW50IGhhcyBubyBwYXJlbnRcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgaW5zZXJ0UGxhY2Vob2xkZXJCZWZvcmUoZWxlbWVudDogTm9kZSwgcGxhY2Vob2xkZXI6IENvbW1lbnQpOiBib29sZWFuIHtcbiAgICBjb25zdCBwYXJlbnQgPSBlbGVtZW50LnBhcmVudE5vZGU7XG4gICAgaWYgKCFwYXJlbnQpIHtcbiAgICAgIGxvZ2dlci53YXJuKCdpbnNlcnRQbGFjZWhvbGRlckJlZm9yZTogZWxlbWVudCBoYXMgbm8gcGFyZW50Jyk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHBhcmVudC5pbnNlcnRCZWZvcmUocGxhY2Vob2xkZXIsIGVsZW1lbnQpO1xuICAgIGxvZ2dlci5kZWJ1ZygnUGxhY2Vob2xkZXIgaW5zZXJ0ZWQnKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXN0b3JlIGVsZW1lbnQgaW4gcGxhY2Ugb2YgcGxhY2Vob2xkZXIsIHRoZW4gcmVtb3ZlIHBsYWNlaG9sZGVyLlxuICAgKiBVc2UgYWZ0ZXIgbW92aW5nIGVsZW1lbnQgYmFjayBmcm9tIGFub3RoZXIgY29udGFpbmVyLlxuICAgKi9cbiAgcHVibGljIHN0YXRpYyByZXN0b3JlRWxlbWVudEZyb21QbGFjZWhvbGRlcihlbGVtZW50OiBOb2RlLCBwbGFjZWhvbGRlcjogQ29tbWVudCk6IHZvaWQge1xuICAgIGNvbnN0IHBhcmVudCA9IHBsYWNlaG9sZGVyLnBhcmVudE5vZGU7XG4gICAgaWYgKCFwYXJlbnQpIHtcbiAgICAgIGxvZ2dlci53YXJuKCdyZXN0b3JlRWxlbWVudEZyb21QbGFjZWhvbGRlcjogcGxhY2Vob2xkZXIgaGFzIG5vIHBhcmVudCcpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBwYXJlbnQuaW5zZXJ0QmVmb3JlKGVsZW1lbnQsIHBsYWNlaG9sZGVyKTtcbiAgICBwbGFjZWhvbGRlci5yZW1vdmUoKTtcbiAgICBsb2dnZXIuZGVidWcoJ0VsZW1lbnQgcmVzdG9yZWQgZnJvbSBwbGFjZWhvbGRlcicpO1xuICB9XG5cbiAgLyoqXG4gICAqIENvcHkgYWxsIGF0dHJpYnV0ZXMgZnJvbSBzb3VyY2UgZWxlbWVudCB0byB0YXJnZXQgZWxlbWVudFxuICAgKi9cbiAgcHVibGljIHN0YXRpYyBjb3B5QXR0cmlidXRlcyhzb3VyY2U6IE51bGxhYmxlPEVsZW1lbnQ+LCB0YXJnZXQ6IE51bGxhYmxlPEVsZW1lbnQ+KTogdm9pZCB7XG4gICAgaWYgKCFzb3VyY2UgfHwgIXRhcmdldCkge1xuICAgICAgbG9nZ2VyLndhcm4oJ2NvcHlBdHRyaWJ1dGVzOiBzb3VyY2Ugb3IgdGFyZ2V0IGlzIG51bGwnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgQXJyYXkuZnJvbShzb3VyY2UuYXR0cmlidXRlcykuZm9yRWFjaCgoYXR0cikgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIHRhcmdldC5zZXRBdHRyaWJ1dGUoYXR0ci5ub2RlTmFtZSwgYXR0ci5ub2RlVmFsdWUgfHwgJycpO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgbG9nZ2VyLndhcm4oYEZhaWxlZCB0byBjb3B5IGF0dHJpYnV0ZSAke2F0dHIubm9kZU5hbWV9OmAsIGUpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGxvZ2dlci5kZWJ1ZygnQXR0cmlidXRlcyBjb3BpZWQgc3VjY2Vzc2Z1bGx5Jyk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBjb3B5aW5nIGF0dHJpYnV0ZXM6JywgZSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFVud3JhcCBlbGVtZW50IGJ5IG1vdmluZyBhbGwgY2hpbGRyZW4gdG8gcGFyZW50IGFuZCByZW1vdmluZyB3cmFwcGVyXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIHVud3JhcCh3cmFwcGVyOiBOdWxsYWJsZTxFbGVtZW50Pik6IHZvaWQge1xuICAgIGlmICghd3JhcHBlcikge1xuICAgICAgbG9nZ2VyLndhcm4oJ3Vud3JhcDogd3JhcHBlciBpcyBudWxsJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgcGFyZW50ID0gd3JhcHBlci5wYXJlbnROb2RlO1xuICAgIGlmICghcGFyZW50KSB7XG4gICAgICBsb2dnZXIud2FybigndW53cmFwOiBFbGVtZW50IGhhcyBubyBwYXJlbnQgbm9kZScpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICAvLyBNb3ZlIGFsbCBjaGlsZCBub2RlcyBiZWZvcmUgdGhlIHdyYXBwZXJcbiAgICAgIHdoaWxlICh3cmFwcGVyLmZpcnN0Q2hpbGQpIHtcbiAgICAgICAgcGFyZW50Lmluc2VydEJlZm9yZSh3cmFwcGVyLmZpcnN0Q2hpbGQsIHdyYXBwZXIpO1xuICAgICAgfVxuXG4gICAgICAvLyBSZW1vdmUgdGhlIG5vdy1lbXB0eSB3cmFwcGVyXG4gICAgICBwYXJlbnQucmVtb3ZlQ2hpbGQod3JhcHBlcik7XG4gICAgICBsb2dnZXIuZGVidWcoJ0VsZW1lbnQgdW53cmFwcGVkIHN1Y2Nlc3NmdWxseScpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgdW53cmFwcGluZyBlbGVtZW50OicsIGUpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBXYWl0IGZvciBlbGVtZW50IHRvIGFwcGVhciBpbiBET00gdXNpbmcgc2VsZWN0b3JcbiAgICogQHBhcmFtIHNlbGVjdG9yIENTUyBzZWxlY3RvclxuICAgKiBAcGFyYW0gcGFyZW50IFBhcmVudCBlbGVtZW50IHRvIHNlYXJjaCBpbiAoZGVmYXVsdDogZG9jdW1lbnQpXG4gICAqIEBwYXJhbSB0aW1lb3V0IFRpbWVvdXQgaW4gbWlsbGlzZWNvbmRzICgwID0gaW5maW5pdGUpXG4gICAqIEBwYXJhbSB0YXJnZXRXaW5kb3cgV2hlbiB0aW1lb3V0IGlzIDAsIGRpc2Nvbm5lY3Qgb2JzZXJ2ZXIgb24gdGhpcyB3aW5kb3cncyBwYWdlaGlkZSAoZS5nLiBQaVAgd2luZG93KVxuICAgKiBAcmV0dXJucyBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgd2l0aCB0aGUgZm91bmQgZWxlbWVudFxuICAgKi9cbiAgcHVibGljIHN0YXRpYyB3YWl0Rm9yRWxlbWVudFNlbGVjdG9yKFxuICAgIHNlbGVjdG9yOiBzdHJpbmcsXG4gICAgcGFyZW50OiBEb2N1bWVudE9yRWxlbWVudCA9IGRvY3VtZW50LFxuICAgIHRpbWVvdXQ6IG51bWJlciA9IFRJTUVPVVRTLkVMRU1FTlRfV0FJVCxcbiAgICB0YXJnZXRXaW5kb3c/OiBXaW5kb3cgfCBudWxsXG4gICk6IFByb21pc2U8RWxlbWVudD4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAvLyBDaGVjayBpZiBlbGVtZW50IGFscmVhZHkgZXhpc3RzXG4gICAgICBjb25zdCBleGlzdGluZyA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcbiAgICAgIGlmIChleGlzdGluZykge1xuICAgICAgICBsb2dnZXIuZGVidWcoYEVsZW1lbnQgZm91bmQgaW1tZWRpYXRlbHk6ICR7c2VsZWN0b3J9YCk7XG4gICAgICAgIHJldHVybiByZXNvbHZlKGV4aXN0aW5nKTtcbiAgICAgIH1cblxuICAgICAgbG9nZ2VyLmRlYnVnKGBXYWl0aW5nIGZvciBlbGVtZW50OiAke3NlbGVjdG9yfWApO1xuXG4gICAgICAvLyBDcmVhdGUgb2JzZXJ2ZXIgdG8gd2F0Y2ggZm9yIGVsZW1lbnRcbiAgICAgIGNvbnN0IG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoKF8sIG9icykgPT4ge1xuICAgICAgICBjb25zdCBlbGVtZW50ID0gcGFyZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpO1xuICAgICAgICBpZiAoZWxlbWVudCkge1xuICAgICAgICAgIGxvZ2dlci5kZWJ1ZyhgRWxlbWVudCBhcHBlYXJlZDogJHtzZWxlY3Rvcn1gKTtcbiAgICAgICAgICBvYnMuZGlzY29ubmVjdCgpO1xuICAgICAgICAgIHJlc29sdmUoZWxlbWVudCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyBPYnNlcnZlIHRoZSBwYXJlbnQgZm9yIGNoYW5nZXNcbiAgICAgIGNvbnN0IHRhcmdldCA9IHBhcmVudCA9PT0gZG9jdW1lbnQgPyBkb2N1bWVudC5ib2R5IDogcGFyZW50O1xuICAgICAgaWYgKCF0YXJnZXQpIHtcbiAgICAgICAgcmVqZWN0KG5ldyBFcnJvcihgVGFyZ2V0IGVsZW1lbnQgbm90IGZvdW5kIGZvciBzZWxlY3RvcjogJHtzZWxlY3Rvcn1gKSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgb2JzZXJ2ZXIub2JzZXJ2ZSh0YXJnZXQsIHtcbiAgICAgICAgY2hpbGRMaXN0OiB0cnVlLFxuICAgICAgICBzdWJ0cmVlOiB0cnVlLFxuICAgICAgfSk7XG5cbiAgICAgIC8vIFNldCB0aW1lb3V0IGlmIHNwZWNpZmllZFxuICAgICAgaWYgKHRpbWVvdXQgPiAwKSB7XG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIG9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgICByZWplY3QobmV3IEVycm9yKGBUaW1lb3V0OiAke3NlbGVjdG9yfSBub3QgZm91bmRgKSk7XG4gICAgICAgIH0sIHRpbWVvdXQpO1xuICAgICAgfVxuXG4gICAgICAvLyBGb3IgaW5maW5pdGUgdGltZW91dDogZGlzY29ubmVjdCBhbmQgcmVqZWN0IHdoZW4gdGFyZ2V0V2luZG93IGZpcmVzIHBhZ2VoaWRlIChlLmcuIFBpUCBjbG9zZWQpXG4gICAgICBpZiAodGltZW91dCA9PT0gMCAmJiB0YXJnZXRXaW5kb3cgJiYgIXRhcmdldFdpbmRvdy5jbG9zZWQpIHtcbiAgICAgICAgdGFyZ2V0V2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICAgICAgJ3BhZ2VoaWRlJyxcbiAgICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgICBvYnNlcnZlci5kaXNjb25uZWN0KCk7XG4gICAgICAgICAgICByZWplY3QobmV3IEVycm9yKCdXYWl0IGFib3J0ZWQ6IHRhcmdldCB3aW5kb3cgY2xvc2VkJykpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgeyBvbmNlOiB0cnVlIH1cbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgTG9nZ2VyIH0gZnJvbSAnLi4vbG9nZ2VyJztcbmltcG9ydCB7IFlvdVR1YmVQbGF5ZXIsIFZpZGVvRGF0YSB9IGZyb20gJy4uL3R5cGVzL3lvdXR1YmUnO1xuaW1wb3J0IHsgUExBWUVSX1NUQVRFUyB9IGZyb20gJy4uL2NvbnN0YW50cyc7XG5pbXBvcnQgeyBET01VdGlscyB9IGZyb20gJy4uL3V0aWxzL0RPTVV0aWxzJztcbmltcG9ydCB7IFRJTUVPVVRTIH0gZnJvbSAnLi4vY29uc3RhbnRzJztcbmltcG9ydCB7IFNFTEVDVE9SUyB9IGZyb20gJy4uL3NlbGVjdG9ycyc7XG5pbXBvcnQgdHlwZSB7IE51bGxhYmxlIH0gZnJvbSAnLi4vdHlwZXMvYXBwJztcblxuY29uc3QgbG9nZ2VyID0gTG9nZ2VyLmdldEluc3RhbmNlKCdQbGF5ZXJNYW5hZ2VyJyk7XG5cbi8qKlxuICogTWFuYWdlcyBwbGF5ZXIgc3RhdGUgYW5kIG9wZXJhdGlvbnNcbiAqL1xuZXhwb3J0IGNsYXNzIFBsYXllck1hbmFnZXIge1xuICBwcml2YXRlIHdhc1BsYXlpbmc6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAvKipcbiAgICogR2V0IHBsYXllciBzdGF0ZSAocGxheWluZy9wYXVzZWQpXG4gICAqL1xuICBwdWJsaWMgZ2V0UGxheWVyU3RhdGUocGxheWVyOiBOdWxsYWJsZTxZb3VUdWJlUGxheWVyPik6IG51bWJlciB7XG4gICAgaWYgKCFwbGF5ZXIpIHtcbiAgICAgIHJldHVybiBQTEFZRVJfU1RBVEVTLlVOU1RBUlRFRDtcbiAgICB9XG4gICAgcmV0dXJuIHBsYXllci5nZXRQbGF5ZXJTdGF0ZSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIHBsYXllciBpcyBjdXJyZW50bHkgcGxheWluZ1xuICAgKi9cbiAgcHVibGljIGlzUGxheWluZyhwbGF5ZXI6IE51bGxhYmxlPFlvdVR1YmVQbGF5ZXI+KTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0UGxheWVyU3RhdGUocGxheWVyKSA9PT0gUExBWUVSX1NUQVRFUy5QTEFZSU5HO1xuICB9XG5cbiAgLyoqXG4gICAqIFNhdmUgY3VycmVudCBwbGF5aW5nIHN0YXRlXG4gICAqL1xuICBwdWJsaWMgc2F2ZVBsYXlpbmdTdGF0ZShwbGF5ZXI6IE51bGxhYmxlPFlvdVR1YmVQbGF5ZXI+KTogdm9pZCB7XG4gICAgdGhpcy53YXNQbGF5aW5nID0gdGhpcy5pc1BsYXlpbmcocGxheWVyKTtcbiAgICBsb2dnZXIuZGVidWcoYFBsYXllciBzdGF0ZSBzYXZlZDogd2FzUGxheWluZyA9ICR7dGhpcy53YXNQbGF5aW5nfWApO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlc3RvcmUgcGxheWluZyBzdGF0ZSBpZiBpdCB3YXMgcGxheWluZyBiZWZvcmVcbiAgICovXG4gIHB1YmxpYyByZXN0b3JlUGxheWluZ1N0YXRlKHBsYXllcjogTnVsbGFibGU8WW91VHViZVBsYXllcj4pOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMud2FzUGxheWluZyB8fCAhcGxheWVyKSB7XG4gICAgICBsb2dnZXIuZGVidWcoJ05vIG5lZWQgdG8gcmVzdG9yZSBwbGF5aW5nIHN0YXRlJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGlmICh0eXBlb2YgcGxheWVyLnBsYXlWaWRlbyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBwbGF5ZXIucGxheVZpZGVvKCk7XG4gICAgICAgIGxvZ2dlci5sb2coJ1BsYXliYWNrIHJlc3RvcmVkIGFmdGVyIHJldHVybiB0byBtYWluIHdpbmRvdycpO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgcmVzdG9yaW5nIHBsYXliYWNrOicsIGUpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdmlkZW8gZGF0YSBmcm9tIHBsYXllclxuICAgKi9cbiAgcHJpdmF0ZSBnZXRWaWRlb0RhdGEocGxheWVyOiBOdWxsYWJsZTxZb3VUdWJlUGxheWVyPik6IE51bGxhYmxlPFZpZGVvRGF0YT4ge1xuICAgIGlmICghcGxheWVyIHx8IHR5cGVvZiBwbGF5ZXIuZ2V0VmlkZW9EYXRhICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgcmV0dXJuIHBsYXllci5nZXRWaWRlb0RhdGEoKSB8fCBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCB2aWRlbyBJRCBmcm9tIHBsYXllciBlbGVtZW50IGluIERPTVxuICAgKiBMb2dzIHdhcm5pbmcgaWYgdmlkZW8gSUQgaXMgbm90IGZvdW5kXG4gICAqIEByZXR1cm5zIFZpZGVvIElEIG9yIG51bGwgaWYgbm90IGZvdW5kXG4gICAqL1xuICBwdWJsaWMgZ2V0VmlkZW9JZChkb2N1bWVudDogRG9jdW1lbnQpOiBOdWxsYWJsZTxzdHJpbmc+IHtcbiAgICBjb25zdCBwbGF5ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFNFTEVDVE9SUy5NT1ZJRV9QTEFZRVIpIGFzIE51bGxhYmxlPFlvdVR1YmVQbGF5ZXI+O1xuICAgIGNvbnN0IHZpZGVvRGF0YSA9IHRoaXMuZ2V0VmlkZW9EYXRhKHBsYXllcik7XG4gICAgY29uc3QgdmlkZW9JZCA9IHZpZGVvRGF0YT8udmlkZW9faWQ7XG5cbiAgICBpZiAoIXZpZGVvSWQpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignVmlkZW8gSUQgbm90IGZvdW5kLCBjYW5ub3QgbmF2aWdhdGUnLCB7XG4gICAgICAgIHBsYXllcixcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgcmV0dXJuIHZpZGVvSWQ7XG4gIH1cblxuICAvKipcbiAgICogV2FpdCBmb3IgbWFpbiBwbGF5ZXIgdG8gYmUgcmVhZHlcbiAgICovXG4gIHB1YmxpYyBhc3luYyB3YWl0Rm9yTWFpblBsYXllcigpOiBQcm9taXNlPE51bGxhYmxlPEVsZW1lbnQ+PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHBsYXllciA9IGF3YWl0IERPTVV0aWxzLndhaXRGb3JFbGVtZW50U2VsZWN0b3IoXG4gICAgICAgIFNFTEVDVE9SUy5NT1ZJRV9QTEFZRVIsXG4gICAgICAgIGRvY3VtZW50LFxuICAgICAgICBUSU1FT1VUUy5FTEVNRU5UX1dBSVRcbiAgICAgICk7XG4gICAgICBsb2dnZXIuZGVidWcoJ01haW4gcGxheWVyIGlzIHJlYWR5Jyk7XG4gICAgICByZXR1cm4gcGxheWVyO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3Igd2FpdGluZyBmb3IgbWFpbiBwbGF5ZXI6JywgZSk7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogV2FpdCBmb3IgbWluaXBsYXllciB0byBiZSByZWFkeVxuICAgKi9cbiAgcHVibGljIGFzeW5jIHdhaXRGb3JNaW5pUGxheWVyKCk6IFByb21pc2U8TnVsbGFibGU8RWxlbWVudD4+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgbWluaXBsYXllciA9IGF3YWl0IERPTVV0aWxzLndhaXRGb3JFbGVtZW50U2VsZWN0b3IoXG4gICAgICAgIFNFTEVDVE9SUy5NSU5JUExBWUVSX0hPU1QsXG4gICAgICAgIGRvY3VtZW50LFxuICAgICAgICBUSU1FT1VUUy5FTEVNRU5UX1dBSVRcbiAgICAgICk7XG4gICAgICBsb2dnZXIuZGVidWcoJ01pbmlwbGF5ZXIgaXMgcmVhZHknKTtcbiAgICAgIHJldHVybiBtaW5pcGxheWVyO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3Igd2FpdGluZyBmb3IgbWluaXBsYXllcjonLCBlKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZXNldCBzYXZlZCBzdGF0ZVxuICAgKi9cbiAgcHVibGljIHJlc2V0U3RhdGUoKTogdm9pZCB7XG4gICAgdGhpcy53YXNQbGF5aW5nID0gZmFsc2U7XG4gICAgbG9nZ2VyLmRlYnVnKCdQbGF5ZXIgc3RhdGUgcmVzZXQnKTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgTG9nZ2VyIH0gZnJvbSAnLi4vbG9nZ2VyJztcbmltcG9ydCB7IE5hdmlnYXRpb25TdGF0ZSB9IGZyb20gJy4uL3R5cGVzL3lvdXR1YmUnO1xuaW1wb3J0IHsgV0VCX1BBR0VfVFlQRVMsIFJPT1RfVkUgfSBmcm9tICcuLi9jb25zdGFudHMnO1xuaW1wb3J0IHsgU0VMRUNUT1JTIH0gZnJvbSAnLi4vc2VsZWN0b3JzJztcbmltcG9ydCB0eXBlIHsgTnVsbGFibGUgfSBmcm9tICcuLi90eXBlcy9hcHAnO1xuXG5jb25zdCBsb2dnZXIgPSBMb2dnZXIuZ2V0SW5zdGFuY2UoJ05hdmlnYXRpb25IYW5kbGVyJyk7XG5cbi8qKlxuICogSGFuZGxlcyBTUEEgbmF2aWdhdGlvbiBpbiBQaVAgd2luZG93XG4gKi9cbmV4cG9ydCBjbGFzcyBOYXZpZ2F0aW9uSGFuZGxlciB7XG4gIHByaXZhdGUgcGlwV2luZG93OiBOdWxsYWJsZTxXaW5kb3c+ID0gbnVsbDtcblxuICAvKipcbiAgICogSW5pdGlhbGl6ZSBuYXZpZ2F0aW9uIGhhbmRsZXIgZm9yIFBpUCB3aW5kb3dcbiAgICovXG4gIHB1YmxpYyBpbml0aWFsaXplKHBpcFdpbmRvdzogV2luZG93KTogdm9pZCB7XG4gICAgdGhpcy5waXBXaW5kb3cgPSBwaXBXaW5kb3c7XG4gICAgdGhpcy5zZXR1cENsaWNrSGFuZGxlcigpO1xuICAgIGxvZ2dlci5kZWJ1ZygnTmF2aWdhdGlvbiBoYW5kbGVyIGluaXRpYWxpemVkJyk7XG4gIH1cblxuICAvKipcbiAgICogU2V0dXAgY2xpY2sgaGFuZGxlciBmb3IgbmF2aWdhdGlvbiBpbiBQaVAgd2luZG93XG4gICAqL1xuICBwcml2YXRlIHNldHVwQ2xpY2tIYW5kbGVyKCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5waXBXaW5kb3cpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignUGlQIHdpbmRvdyBub3QgYXZhaWxhYmxlIGZvciBuYXZpZ2F0aW9uIGhhbmRsZXInKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLnBpcFdpbmRvdy5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgJ2NsaWNrJyxcbiAgICAgIChldmVudDogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICAvLyBGb2N1cyB2aWRlbyBwbGF5ZXJcbiAgICAgICAgY29uc3QgcGxheWVyID0gdGhpcy5waXBXaW5kb3chLmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoU0VMRUNUT1JTLkhUTUw1X1ZJREVPX1BMQVlFUik7XG4gICAgICAgIGlmIChwbGF5ZXIgJiYgJ2ZvY3VzJyBpbiBwbGF5ZXIgJiYgdHlwZW9mIChwbGF5ZXIgYXMgSFRNTEVsZW1lbnQpLmZvY3VzID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgKHBsYXllciBhcyBIVE1MRWxlbWVudCkuZm9jdXMoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGVuZHBvaW50ID0gKGV2ZW50LnRhcmdldCBhcyBFbGVtZW50KT8uY2xvc2VzdChTRUxFQ1RPUlMuU0lNUExFX0VORFBPSU5UKTtcbiAgICAgICAgY29uc3QgYnV0dG9uID0gKGV2ZW50LnRhcmdldCBhcyBFbGVtZW50KT8uY2xvc2VzdChTRUxFQ1RPUlMuQlVUVE9OKTtcblxuICAgICAgICAvLyBTa2lwIGJ1dHRvbiBjbGlja3MgKGhhbmRsZWQgYnkgTGlrZUJ1dHRvbkhhbmRsZXIpXG4gICAgICAgIGlmIChidXR0b24gfHwgIWVuZHBvaW50KSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgaHJlZiA9IChlbmRwb2ludCBhcyBIVE1MQW5jaG9yRWxlbWVudCkuaHJlZjtcbiAgICAgICAgaWYgKCFocmVmKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgbG9nZ2VyLmxvZygnTmF2aWdhdGlvbiBjbGljayBkZXRlY3RlZCcpO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgdXJsID0gbmV3IFVSTChocmVmKTtcbiAgICAgICAgICBjb25zdCBwYXJhbXMgPSBPYmplY3QuZnJvbUVudHJpZXModXJsLnNlYXJjaFBhcmFtcyk7XG5cbiAgICAgICAgICAvLyBQcmV2ZW50IGRlZmF1bHQgbmF2aWdhdGlvblxuICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgZXZlbnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG5cbiAgICAgICAgICAvLyBCdWlsZCBuYXZpZ2F0aW9uIHN0YXRlXG4gICAgICAgICAgY29uc3Qgc3RhdGU6IE5hdmlnYXRpb25TdGF0ZSA9IHtcbiAgICAgICAgICAgIGVuZHBvaW50OiB7XG4gICAgICAgICAgICAgIGNvbW1hbmRNZXRhZGF0YToge1xuICAgICAgICAgICAgICAgIHdlYkNvbW1hbmRNZXRhZGF0YToge1xuICAgICAgICAgICAgICAgICAgdXJsOiBocmVmLFxuICAgICAgICAgICAgICAgICAgd2ViUGFnZVR5cGU6IFdFQl9QQUdFX1RZUEVTLldBVENILFxuICAgICAgICAgICAgICAgICAgcm9vdFZlOiBST09UX1ZFLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHdhdGNoRW5kcG9pbnQ6IHtcbiAgICAgICAgICAgICAgICB2aWRlb0lkOiBwYXJhbXMudixcbiAgICAgICAgICAgICAgICBwbGF5bGlzdElkOiBwYXJhbXMubGlzdCB8fCBudWxsLFxuICAgICAgICAgICAgICAgIGluZGV4OiBwYXJhbXMuaW5kZXggPyBwYXJzZUludChwYXJhbXMuaW5kZXgpIC0gMSA6IDAsXG4gICAgICAgICAgICAgICAgcGFyYW1zOiAnT0FFJTNEJyxcbiAgICAgICAgICAgICAgICBwbGF5ZXJQYXJhbXM6IHBhcmFtcy5wcCxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlbnRyeVRpbWU6IHBlcmZvcm1hbmNlLm5vdygpLFxuICAgICAgICAgIH07XG5cbiAgICAgICAgICBsb2dnZXIubG9nKGBTUEEgbmF2aWdhdGlvbiB2aWEgeXQtbmF2aWdhdGU6ICR7aHJlZn1gKTtcblxuICAgICAgICAgIC8vIFRyaWdnZXIgbmF2aWdhdGlvbiAobm8gcHVzaFN0YXRlIOKAlCBZb3VUdWJlIGRvZXMgbm90IHVwZGF0ZSBVUkwgaW4gbWluaSBwbGF5ZXIpXG4gICAgICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IFBvcFN0YXRlRXZlbnQoJ3BvcHN0YXRlJywgeyBzdGF0ZSB9KSk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGhhbmRsaW5nIG5hdmlnYXRpb246JywgZSk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICB0cnVlXG4gICAgKTsgLy8gVXNlIGNhcHR1cmUgcGhhc2VcbiAgfVxuXG4gIC8qKlxuICAgKiBDbGVhbnVwIG5hdmlnYXRpb24gaGFuZGxlclxuICAgKi9cbiAgcHVibGljIGNsZWFudXAoKTogdm9pZCB7XG4gICAgdGhpcy5waXBXaW5kb3cgPSBudWxsO1xuICAgIGxvZ2dlci5kZWJ1ZygnTmF2aWdhdGlvbiBoYW5kbGVyIGNsZWFuZWQgdXAnKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgXCIvKipcXG4gKiBDU1Mgc3R5bGVzIGZvciBQaVAgd2luZG93IGZpeGVzIGFuZCBjdXN0b21pemF0aW9uc1xcbiAqL1xcblxcbmJvZHkge1xcbiAgb3ZlcmZsb3c6IGF1dG8gIWltcG9ydGFudDtcXG59XFxuXFxueXRkLW1pbmlwbGF5ZXIge1xcbiAgbGVmdDogMCAhaW1wb3J0YW50O1xcbiAgcmlnaHQ6IDAgIWltcG9ydGFudDtcXG4gIHRvcDogMCAhaW1wb3J0YW50O1xcbiAgYm90dG9tOiAwICFpbXBvcnRhbnQ7XFxuICB3aWR0aDogMTAwJSAhaW1wb3J0YW50O1xcbiAgaGVpZ2h0OiAxMDAlICFpbXBvcnRhbnQ7XFxuICBtYXgtaGVpZ2h0OiAxMDAlICFpbXBvcnRhbnQ7XFxuICBkaXNwbGF5OiBmbGV4ICFpbXBvcnRhbnQ7XFxufVxcblxcbnl0ZC1taW5pcGxheWVyLXBsYXllci1jb250YWluZXIge1xcbiAgd2lkdGg6IDEwMCUgIWltcG9ydGFudDtcXG4gIGhlaWdodDogMTAwJSAhaW1wb3J0YW50O1xcbn1cXG5cXG4uaHRtbDUtdmlkZW8tY29udGFpbmVyIHtcXG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG4gIHRvcDogMDtcXG4gIGxlZnQ6IDA7XFxuICBib3R0b206IDA7XFxuICByaWdodDogMDtcXG59XFxuXFxuLmh0bWw1LXZpZGVvLWNvbnRhaW5lciAuaHRtbDUtbWFpbi12aWRlbyB7XFxuICB3aWR0aDogMTAwJSAhaW1wb3J0YW50O1xcbiAgaGVpZ2h0OiAxMDAlICFpbXBvcnRhbnQ7XFxuICBvYmplY3QtZml0OiBjb250YWluO1xcbn1cXG5cXG52aWRlbyB7XFxuICBsZWZ0OiAwICFpbXBvcnRhbnQ7XFxuICB0b3A6IDAgIWltcG9ydGFudDtcXG4gIHJpZ2h0OiAwICFpbXBvcnRhbnQ7XFxuICBib3R0b206IDAgIWltcG9ydGFudDtcXG59XFxuXFxuLnl0RHJhZ2dhYmxlQ29tcG9uZW50SG9zdC55dGRNaW5pcGxheWVyQ29tcG9uZW50RHJhZ2dhYmxlIHtcXG4gIHBvaW50ZXItZXZlbnRzOiBhdXRvICFpbXBvcnRhbnQ7XFxufVxcblxcbi55dHAtbWluaXBsYXllci1leHBhbmQtd2F0Y2gtcGFnZS1idXR0b24sXFxuLnl0cC1taW5pcGxheWVyLWNsb3NlLWJ1dHRvbixcXG4jaGVhZGVyLWNvbnRlbnRzLFxcbi55dGRNaW5pcGxheWVyQ29tcG9uZW50UmVzaXplcnMge1xcbiAgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50O1xcbn1cXG5cXG4vKiBTdHJldGNoIHByb2dyZXNzIGJhciB0byBmdWxsIHdpZHRoICovXFxuLnl0cC1wcm9ncmVzcy1iYXItY29udGFpbmVyLFxcbi55dHAtcHJvZ3Jlc3MtYmFyIHtcXG4gIHdpZHRoOiAxMDAlICFpbXBvcnRhbnQ7XFxufVxcblxcbi55dHAtcHJldi1idXR0b24sXFxuLnl0cC1uZXh0LWJ1dHRvbiB7XFxuICBkaXNwbGF5OiBpbmxpbmUtZmxleCAhaW1wb3J0YW50O1xcbn1cXG5cIiIsImltcG9ydCB7IENTU19GSVhFUyB9IGZyb20gJy4uL3N0eWxlcyc7XG5pbXBvcnQgeyBMb2dnZXIgfSBmcm9tICcuLi9sb2dnZXInO1xuaW1wb3J0IHsgU0VMRUNUT1JTIH0gZnJvbSAnLi4vc2VsZWN0b3JzJztcblxuY29uc3QgbG9nZ2VyID0gTG9nZ2VyLmdldEluc3RhbmNlKCdTdHlsZVV0aWxzJyk7XG5cbi8qKlxuICogVXRpbGl0eSBjbGFzcyBmb3Igc3R5bGUgYW5kIENTUyBvcGVyYXRpb25zXG4gKi9cbmV4cG9ydCBjbGFzcyBTdHlsZVV0aWxzIHtcbiAgLyoqXG4gICAqIENvcHkgYWxsIHN0eWxlc2hlZXRzIGZyb20gc291cmNlIGRvY3VtZW50IHRvIHRhcmdldCBkb2N1bWVudFxuICAgKi9cbiAgcHVibGljIHN0YXRpYyBjb3B5U3R5bGVzKHNvdXJjZURvYzogRG9jdW1lbnQsIHRhcmdldERvYzogRG9jdW1lbnQpOiB2b2lkIHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc3R5bGVzID0gc291cmNlRG9jLnF1ZXJ5U2VsZWN0b3JBbGwoU0VMRUNUT1JTLlNUWUxFU0hFRVRTKTtcbiAgICAgIGxvZ2dlci5kZWJ1ZyhgQ29weWluZyAke3N0eWxlcy5sZW5ndGh9IHN0eWxlIGVsZW1lbnRzYCk7XG5cbiAgICAgIHN0eWxlcy5mb3JFYWNoKChub2RlKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgdGFyZ2V0RG9jLmhlYWQuYXBwZW5kQ2hpbGQobm9kZS5jbG9uZU5vZGUodHJ1ZSkpO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgbG9nZ2VyLndhcm4oJ0ZhaWxlZCB0byBjb3B5IHN0eWxlIG5vZGU6JywgZSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBsb2dnZXIuZGVidWcoJ1N0eWxlcyBjb3BpZWQgc3VjY2Vzc2Z1bGx5Jyk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBjb3B5aW5nIHN0eWxlczonLCBlKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogSW5qZWN0IENTUyBmaXhlcyBpbnRvIHRhcmdldCBkb2N1bWVudFxuICAgKi9cbiAgcHVibGljIHN0YXRpYyBpbmplY3RDU1NGaXhlcyh0YXJnZXREb2M6IERvY3VtZW50KTogdm9pZCB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHN0eWxlRml4ID0gdGFyZ2V0RG9jLmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7XG4gICAgICBzdHlsZUZpeC50ZXh0Q29udGVudCA9IENTU19GSVhFUztcbiAgICAgIHRhcmdldERvYy5oZWFkLmFwcGVuZENoaWxkKHN0eWxlRml4KTtcbiAgICAgIGxvZ2dlci5kZWJ1ZygnQ1NTIGZpeGVzIGluamVjdGVkIHN1Y2Nlc3NmdWxseScpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgaW5qZWN0aW5nIENTUyBmaXhlczonLCBlKTtcbiAgICB9XG4gIH1cbn1cbiIsIi8qKlxuICogQWJzdHJhY3QgYmFzZSBjbGFzcyBmb3IgYWxsIGFwcGxpY2F0aW9uIGVycm9ycy5cbiAqIFByb3ZpZGVzIGNvbW1vbiBmdW5jdGlvbmFsaXR5IGxpa2Ugc3RhY2sgdHJhY2UgY2FwdHVyZS5cbiAqL1xuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEFwcEVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICBwdWJsaWMgcmVhZG9ubHkgY2F1c2U6IHVua25vd247XG5cbiAgY29uc3RydWN0b3IobWVzc2FnZTogc3RyaW5nLCBjYXVzZT86IHVua25vd24pIHtcbiAgICBzdXBlcihtZXNzYWdlKTtcbiAgICB0aGlzLmNhdXNlID0gY2F1c2U7XG5cbiAgICAvLyBNYWludGFpbnMgcHJvcGVyIHN0YWNrIHRyYWNlIGZvciB3aGVyZSBvdXIgZXJyb3Igd2FzIHRocm93biAob25seSBhdmFpbGFibGUgb24gVjgpXG4gICAgaWYgKEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKSB7XG4gICAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLCB0aGlzLmNvbnN0cnVjdG9yKTtcbiAgICB9XG4gIH1cbn1cbiIsImltcG9ydCB7IEFwcEVycm9yIH0gZnJvbSAnLi9BcHBFcnJvcic7XG5cbi8qKlxuICogRXJyb3IgdGhyb3duIGR1cmluZyBQaVAgb3BlcmF0aW9ucy5cbiAqL1xuZXhwb3J0IGNsYXNzIFBpUEVycm9yIGV4dGVuZHMgQXBwRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihtZXNzYWdlOiBzdHJpbmcsIGNhdXNlPzogdW5rbm93bikge1xuICAgIHN1cGVyKG1lc3NhZ2UsIGNhdXNlKTtcbiAgICB0aGlzLm5hbWUgPSAnUGlQRXJyb3InO1xuICB9XG59XG4iLCJpbXBvcnQgeyBMb2dnZXIgfSBmcm9tICcuLi9sb2dnZXInO1xuaW1wb3J0IHsgRE9NVXRpbHMgfSBmcm9tICcuLi91dGlscy9ET01VdGlscyc7XG5pbXBvcnQgeyBTdHlsZVV0aWxzIH0gZnJvbSAnLi4vdXRpbHMvU3R5bGVVdGlscyc7XG5pbXBvcnQgeyBNaW5pUGxheWVyQ29udHJvbGxlciB9IGZyb20gJy4uL3VpL01pbmlQbGF5ZXJDb250cm9sbGVyJztcbmltcG9ydCB7IFBsYXllck1hbmFnZXIgfSBmcm9tICcuL1BsYXllck1hbmFnZXInO1xuaW1wb3J0IHsgTmF2aWdhdGlvbkhhbmRsZXIgfSBmcm9tICcuL05hdmlnYXRpb25IYW5kbGVyJztcbmltcG9ydCB7IERFRkFVTFRfRElNRU5TSU9OUyB9IGZyb20gJy4uL2NvbnN0YW50cyc7XG5pbXBvcnQgeyBTRUxFQ1RPUlMgfSBmcm9tICcuLi9zZWxlY3RvcnMnO1xuaW1wb3J0IHsgTWluaVBsYXllckVsZW1lbnQsIFlvdVR1YmVQbGF5ZXIgfSBmcm9tICcuLi90eXBlcy95b3V0dWJlJztcbmltcG9ydCB0eXBlIHsgTnVsbGFibGUsIFBpUENsZWFudXBDYWxsYmFjaywgUGlQV2luZG93UmVhZHlDYWxsYmFjayB9IGZyb20gJy4uL3R5cGVzL2FwcCc7XG5pbXBvcnQgeyBQaVBFcnJvciB9IGZyb20gJy4uL2Vycm9ycy9QaVBFcnJvcic7XG5cbmNvbnN0IGxvZ2dlciA9IExvZ2dlci5nZXRJbnN0YW5jZSgnUGlQTWFuYWdlcicpO1xuXG4vKipcbiAqIE1hbmFnZXMgUGljdHVyZS1pbi1QaWN0dXJlIHdpbmRvdyBsaWZlY3ljbGVcbiAqL1xuZXhwb3J0IGNsYXNzIFBpUE1hbmFnZXIge1xuICBwcml2YXRlIHBpcFdpbmRvdzogTnVsbGFibGU8V2luZG93PiA9IG51bGw7XG4gIHByaXZhdGUgbWluaXBsYXllcjogTnVsbGFibGU8TWluaVBsYXllckVsZW1lbnQ+ID0gbnVsbDtcbiAgcHJpdmF0ZSBtaW5pUGxheWVyQ29udGFpbmVyOiBOdWxsYWJsZTxFbGVtZW50PiA9IG51bGw7XG4gIHByaXZhdGUgcGxhY2Vob2xkZXI6IE51bGxhYmxlPENvbW1lbnQ+ID0gbnVsbDtcbiAgcHJpdmF0ZSB3YXNNaW5pUGxheWVyQWN0aXZlQmVmb3JlUGlQOiBib29sZWFuID0gZmFsc2U7XG5cbiAgcHJpdmF0ZSBtaW5pUGxheWVyQ29udHJvbGxlcjogTWluaVBsYXllckNvbnRyb2xsZXI7XG4gIHByaXZhdGUgcGxheWVyTWFuYWdlcjogUGxheWVyTWFuYWdlcjtcbiAgcHJpdmF0ZSBuYXZpZ2F0aW9uSGFuZGxlcjogTmF2aWdhdGlvbkhhbmRsZXI7XG5cbiAgcHJpdmF0ZSBvbldpbmRvd1JlYWR5OiBQaVBXaW5kb3dSZWFkeUNhbGxiYWNrO1xuICBwcml2YXRlIG9uQmVmb3JlUmV0dXJuOiBOdWxsYWJsZTxQaVBDbGVhbnVwQ2FsbGJhY2s+ID0gbnVsbDtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBtaW5pUGxheWVyQ29udHJvbGxlcjogTWluaVBsYXllckNvbnRyb2xsZXIsXG4gICAgcGxheWVyTWFuYWdlcjogUGxheWVyTWFuYWdlcixcbiAgICBuYXZpZ2F0aW9uSGFuZGxlcjogTmF2aWdhdGlvbkhhbmRsZXIsXG4gICAgb25XaW5kb3dSZWFkeTogUGlQV2luZG93UmVhZHlDYWxsYmFja1xuICApIHtcbiAgICB0aGlzLm1pbmlQbGF5ZXJDb250cm9sbGVyID0gbWluaVBsYXllckNvbnRyb2xsZXI7XG4gICAgdGhpcy5wbGF5ZXJNYW5hZ2VyID0gcGxheWVyTWFuYWdlcjtcbiAgICB0aGlzLm5hdmlnYXRpb25IYW5kbGVyID0gbmF2aWdhdGlvbkhhbmRsZXI7XG4gICAgdGhpcy5vbldpbmRvd1JlYWR5ID0gb25XaW5kb3dSZWFkeTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBpZiBQaVAgd2luZG93IGlzIG9wZW5cbiAgICovXG4gIHB1YmxpYyBpc09wZW4oKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMucGlwV2luZG93ICE9PSBudWxsICYmICF0aGlzLnBpcFdpbmRvdy5jbG9zZWQ7XG4gIH1cblxuICAvKipcbiAgICogR2V0IFBpUCB3aW5kb3cgaW5zdGFuY2VcbiAgICovXG4gIHB1YmxpYyBnZXRXaW5kb3coKTogTnVsbGFibGU8V2luZG93PiB7XG4gICAgcmV0dXJuIHRoaXMucGlwV2luZG93O1xuICB9XG5cbiAgLyoqXG4gICAqIE9wZW4gUGljdHVyZS1pbi1QaWN0dXJlIHdpbmRvd1xuICAgKi9cbiAgcHVibGljIGFzeW5jIG9wZW4oKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgaWYgKHRoaXMuaXNPcGVuKCkpIHtcbiAgICAgIGxvZ2dlci53YXJuKCdQaVAgd2luZG93IGFscmVhZHkgb3BlbicpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGxvZ2dlci5sb2coJ09wZW5pbmcgUGlQIHdpbmRvdycpO1xuXG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHRoaXMubW92ZVBsYXllclRvUElQKCk7XG5cbiAgICAgIGlmICh0aGlzLnBpcFdpbmRvdyAmJiB0aGlzLm1pbmlwbGF5ZXIpIHtcbiAgICAgICAgdGhpcy5waXBXaW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncGFnZWhpZGUnLCAoKSA9PiB0aGlzLnJldHVyblBsYXllclRvTWFpbigpKTtcbiAgICAgICAgdGhpcy5uYXZpZ2F0aW9uSGFuZGxlci5pbml0aWFsaXplKHRoaXMucGlwV2luZG93KTtcblxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLm9uV2luZG93UmVhZHkodGhpcy5waXBXaW5kb3csIHRoaXMubWluaXBsYXllcik7XG4gICAgICAgIGlmICh0eXBlb2YgcmVzdWx0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgdGhpcy5vbkJlZm9yZVJldHVybiA9IHJlc3VsdDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIG9wZW5pbmcgUGlQOicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBNb3ZlIHBsYXllciB0byBQaVAgd2luZG93XG4gICAqL1xuICBwcml2YXRlIGFzeW5jIG1vdmVQbGF5ZXJUb1BJUCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAvLyBGaW5kIG1pbmkgcGxheWVyIGVsZW1lbnRcbiAgICB0aGlzLm1pbmlwbGF5ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFNFTEVDVE9SUy5NSU5JUExBWUVSKSBhcyBNaW5pUGxheWVyRWxlbWVudDtcbiAgICBpZiAoIXRoaXMubWluaXBsYXllcikge1xuICAgICAgdGhyb3cgbmV3IFBpUEVycm9yKCdNaW5pIHBsYXllciBlbGVtZW50IG5vdCBmb3VuZCcpO1xuICAgIH1cblxuICAgIC8vIFNhdmUgbWluaSBwbGF5ZXIgc3RhdGVcbiAgICB0aGlzLndhc01pbmlQbGF5ZXJBY3RpdmVCZWZvcmVQaVAgPSB0aGlzLm1pbmlQbGF5ZXJDb250cm9sbGVyLmlzVmlzaWJsZSgpO1xuXG4gICAgaWYgKCF0aGlzLndhc01pbmlQbGF5ZXJBY3RpdmVCZWZvcmVQaVApIHtcbiAgICAgIHRoaXMubWluaVBsYXllckNvbnRyb2xsZXIudG9nZ2xlTWluaVBsYXllcigpO1xuXG4gICAgICAvLyBXYWl0IGZvciBtaW5pIHBsYXllciBjb250YWluZXJcbiAgICAgIGF3YWl0IERPTVV0aWxzLndhaXRGb3JFbGVtZW50U2VsZWN0b3IoU0VMRUNUT1JTLk1JTklQTEFZRVJfQ09OVEFJTkVSKTtcbiAgICAgIGxvZ2dlci5kZWJ1ZygnTWluaSBwbGF5ZXIgY29udGFpbmVyIHJlYWR5Jyk7XG4gICAgfVxuXG4gICAgLy8gR2V0IGRpbWVuc2lvbnNcbiAgICBjb25zdCB3aWR0aCA9IHRoaXMubWluaXBsYXllci5vZmZzZXRXaWR0aCB8fCBERUZBVUxUX0RJTUVOU0lPTlMuUElQX1dJRFRIO1xuICAgIGNvbnN0IGhlaWdodCA9IHRoaXMubWluaXBsYXllci5vZmZzZXRIZWlnaHQgfHwgREVGQVVMVF9ESU1FTlNJT05TLlBJUF9IRUlHSFQ7XG5cbiAgICBsb2dnZXIuZGVidWcoYFJlcXVlc3RpbmcgUGlQIHdpbmRvdzogJHt3aWR0aH14JHtoZWlnaHR9YCk7XG5cbiAgICAvLyBSZXF1ZXN0IFBpUCB3aW5kb3dcbiAgICBjb25zdCBkcHAgPSB3aW5kb3cuZG9jdW1lbnRQaWN0dXJlSW5QaWN0dXJlO1xuICAgIGlmICghZHBwKSB7XG4gICAgICB0aHJvdyBuZXcgUGlQRXJyb3IoJ0RvY3VtZW50IFBpY3R1cmUtaW4tUGljdHVyZSBBUEkgbm90IGF2YWlsYWJsZScpO1xuICAgIH1cblxuICAgIHRoaXMucGlwV2luZG93ID0gYXdhaXQgZHBwLnJlcXVlc3RXaW5kb3coeyB3aWR0aCwgaGVpZ2h0IH0pO1xuICAgIGxvZ2dlci5sb2coJ1BpUCB3aW5kb3cgb3BlbmVkJyk7XG5cbiAgICBjb25zdCBwaXBEb2MgPSB0aGlzLnBpcFdpbmRvdy5kb2N1bWVudDtcblxuICAgIC8vIENvcHkgYXR0cmlidXRlcyBhbmQgc3R5bGVzXG4gICAgRE9NVXRpbHMuY29weUF0dHJpYnV0ZXMoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LCBwaXBEb2MuZG9jdW1lbnRFbGVtZW50KTtcbiAgICBET01VdGlscy5jb3B5QXR0cmlidXRlcyhkb2N1bWVudC5ib2R5LCBwaXBEb2MuYm9keSk7XG4gICAgU3R5bGVVdGlscy5jb3B5U3R5bGVzKGRvY3VtZW50LCBwaXBEb2MpO1xuICAgIFN0eWxlVXRpbHMuaW5qZWN0Q1NTRml4ZXMocGlwRG9jKTtcblxuICAgIC8vIFNldCB3aW5kb3cgdGl0bGUgb25seSBpZiBQaVAgd2FzIG5vdCBvcGVuZWQgZnJvbSBtaW5pIHBsYXllciBtb2RlXG4gICAgLy8gV2hlbiBvcGVuZWQgZnJvbSBtaW5pIHBsYXllciwgdGl0bGUgaXMgYWxyZWFkeSBzZXQgYW5kIHNob3VsZCBub3QgYmUgb3ZlcndyaXR0ZW5cbiAgICBpZiAoIXRoaXMud2FzTWluaVBsYXllckFjdGl2ZUJlZm9yZVBpUCkge1xuICAgICAgY29uc3QgdGl0bGUgPSB3aW5kb3cubmF2aWdhdG9yLm1lZGlhU2Vzc2lvbj8ubWV0YWRhdGE/LnRpdGxlIHx8ICcnO1xuICAgICAgdGhpcy5zZXRXaW5kb3dzVGl0bGUodGl0bGUpO1xuICAgIH1cblxuICAgIC8vIENyZWF0ZSB5dGQtYXBwIGluIFBpUCB3aW5kb3dcbiAgICBjb25zdCB5dGRBcHAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFNFTEVDVE9SUy5ZVERfQVBQKTtcbiAgICBpZiAoeXRkQXBwICYmIHRoaXMucGlwV2luZG93KSB7XG4gICAgICBjb25zdCBuZXdBcHAgPSBwaXBEb2MuY3JlYXRlRWxlbWVudCgneXRkLWFwcCcpO1xuICAgICAgRE9NVXRpbHMuY29weUF0dHJpYnV0ZXMoeXRkQXBwLCBuZXdBcHApO1xuICAgICAgcGlwRG9jLmJvZHkuYXBwZW5kQ2hpbGQobmV3QXBwKTtcbiAgICB9XG5cbiAgICAvLyBNb3ZlIG1pbmkgcGxheWVyIHRvIFBpUFxuICAgIHRoaXMubWluaVBsYXllckNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoU0VMRUNUT1JTLk1JTklQTEFZRVJfQ09OVEFJTkVSKTtcbiAgICB0aGlzLnBsYWNlaG9sZGVyID0gRE9NVXRpbHMuY3JlYXRlUGxhY2Vob2xkZXIoJ21pbmlfcGxheWVyX3BsYWNlaG9sZGVyJyk7XG4gICAgRE9NVXRpbHMuaW5zZXJ0UGxhY2Vob2xkZXJCZWZvcmUodGhpcy5taW5pcGxheWVyLCB0aGlzLnBsYWNlaG9sZGVyKTtcblxuICAgIGNvbnN0IHBpcEFwcCA9IHRoaXMucGlwV2luZG93LmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoU0VMRUNUT1JTLllURF9BUFApO1xuICAgIGlmIChwaXBBcHAgJiYgdGhpcy5taW5pcGxheWVyKSB7XG4gICAgICBwaXBBcHAuYXBwZW5kQ2hpbGQodGhpcy5taW5pcGxheWVyKTtcbiAgICB9XG5cbiAgICAvLyBNb3ZlIGNvbnRhaW5lciB0byBkcmFnZ2FibGVcbiAgICBjb25zdCB5dERyYWdnYWJsZSA9IHBpcERvYy5xdWVyeVNlbGVjdG9yKFNFTEVDVE9SUy5ZVF9EUkFHR0FCTEUpO1xuICAgIGlmICh5dERyYWdnYWJsZSAmJiB0aGlzLm1pbmlQbGF5ZXJDb250YWluZXIpIHtcbiAgICAgIHl0RHJhZ2dhYmxlLnByZXBlbmQodGhpcy5taW5pUGxheWVyQ29udGFpbmVyKTtcbiAgICB9XG5cbiAgICBET01VdGlscy51bndyYXAoeXREcmFnZ2FibGUpO1xuXG4gICAgLy8gRm9jdXMgdmlkZW8gcGxheWVyXG4gICAgY29uc3QgdmlkZW9QbGF5ZXIgPSBwaXBEb2MucXVlcnlTZWxlY3RvcihTRUxFQ1RPUlMuSFRNTDVfVklERU9fUExBWUVSKTtcbiAgICBpZiAoXG4gICAgICB2aWRlb1BsYXllciAmJlxuICAgICAgJ2ZvY3VzJyBpbiB2aWRlb1BsYXllciAmJlxuICAgICAgdHlwZW9mICh2aWRlb1BsYXllciBhcyBIVE1MRWxlbWVudCkuZm9jdXMgPT09ICdmdW5jdGlvbidcbiAgICApIHtcbiAgICAgICh2aWRlb1BsYXllciBhcyBIVE1MRWxlbWVudCkuZm9jdXMoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJuIHBsYXllciB0byBtYWluIHdpbmRvd1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyByZXR1cm5QbGF5ZXJUb01haW4oKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgbG9nZ2VyLmxvZygnUmV0dXJuaW5nIHBsYXllciB0byBtYWluIHdpbmRvdycpO1xuXG4gICAgaWYgKCF0aGlzLnBsYWNlaG9sZGVyIHx8ICF0aGlzLm1pbmlwbGF5ZXIpIHtcbiAgICAgIGxvZ2dlci53YXJuKCdQbGFjZWhvbGRlciBvciBtaW5pcGxheWVyIG5vdCBmb3VuZCcpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIFJ1biBiZWZvcmUtcmV0dXJuIGNsZWFudXAgKGUuZy4gbW92ZSBjb250ZXh0IG1lbnUgYmFjaylcbiAgICBpZiAodGhpcy5vbkJlZm9yZVJldHVybikge1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgdGhpcy5vbkJlZm9yZVJldHVybigpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGluIG9uQmVmb3JlUmV0dXJuOicsIGUpO1xuICAgICAgfVxuICAgICAgdGhpcy5vbkJlZm9yZVJldHVybiA9IG51bGw7XG4gICAgfVxuXG4gICAgYXdhaXQgdGhpcy5tb3ZlUGxheWVyVG9NYWluKCk7XG5cbiAgICB0aGlzLnBpcFdpbmRvdyA9IG51bGw7XG4gIH1cblxuICAvKipcbiAgICogTW92ZSBwbGF5ZXIgYmFjayB0byBtYWluIHdpbmRvd1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBtb3ZlUGxheWVyVG9NYWluKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICghdGhpcy5wbGFjZWhvbGRlciB8fCAhdGhpcy5taW5pcGxheWVyKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gR2V0IHBsYXllciBhbmQgc2F2ZSBzdGF0ZVxuICAgIGNvbnN0IHBsYXllciA9IHRoaXMubWluaXBsYXllci5xdWVyeVNlbGVjdG9yKFNFTEVDVE9SUy5NT1ZJRV9QTEFZRVIpIGFzIE51bGxhYmxlPFlvdVR1YmVQbGF5ZXI+O1xuICAgIHRoaXMucGxheWVyTWFuYWdlci5zYXZlUGxheWluZ1N0YXRlKHBsYXllcik7XG5cbiAgICAvLyBNb3ZlIG1pbmkgcGxheWVyIGJhY2tcbiAgICBET01VdGlscy5yZXN0b3JlRWxlbWVudEZyb21QbGFjZWhvbGRlcih0aGlzLm1pbmlwbGF5ZXIsIHRoaXMucGxhY2Vob2xkZXIpO1xuICAgIHRoaXMucGxhY2Vob2xkZXIgPSBudWxsO1xuXG4gICAgLy8gTW92ZSBjb250YWluZXIgYmFja1xuICAgIGNvbnN0IHl0RHJhZ2dhYmxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihTRUxFQ1RPUlMuWVRfRFJBR0dBQkxFKTtcbiAgICBpZiAoeXREcmFnZ2FibGUgJiYgdGhpcy5taW5pUGxheWVyQ29udGFpbmVyKSB7XG4gICAgICB5dERyYWdnYWJsZS5wcmVwZW5kKHRoaXMubWluaVBsYXllckNvbnRhaW5lcik7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLndhc01pbmlQbGF5ZXJBY3RpdmVCZWZvcmVQaVApIHtcbiAgICAgIHRoaXMubWluaVBsYXllckNvbnRyb2xsZXIudG9nZ2xlTWluaVBsYXllcih0cnVlKTtcblxuICAgICAgLy8gV2FpdCBmb3IgbWFpbiBwbGF5ZXJcbiAgICAgIGF3YWl0IHRoaXMucGxheWVyTWFuYWdlci53YWl0Rm9yTWFpblBsYXllcigpO1xuICAgIH1cblxuICAgIC8vIFJlbW92ZSBtaW5pIHBsYXllciBjb250YWluZXJcbiAgICBjb25zdCBtaW5pcGxheWVyQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihTRUxFQ1RPUlMuTUlOSVBMQVlFUl9DT05UQUlORVIpO1xuICAgIGlmIChtaW5pcGxheWVyQ29udGFpbmVyKSB7XG4gICAgICBtaW5pcGxheWVyQ29udGFpbmVyLnJlbW92ZSgpO1xuICAgIH1cblxuICAgIC8vIFJlc3RvcmUgcGxheWJhY2sgc3RhdGVcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHRoaXMucGxheWVyTWFuYWdlci5yZXN0b3JlUGxheWluZ1N0YXRlKHBsYXllcik7XG4gICAgICBpZiAodGhpcy53YXNNaW5pUGxheWVyQWN0aXZlQmVmb3JlUGlQKSB7XG4gICAgICAgIHRoaXMubWluaVBsYXllckNvbnRyb2xsZXIuYWN0aXZhdGVNaW5pUGxheWVyKCk7XG4gICAgICAgIHZvaWQgdGhpcy5wbGF5ZXJNYW5hZ2VyLndhaXRGb3JNaW5pUGxheWVyKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogU2V0IHdpbmRvdyB0aXRsZXNcbiAgICovXG4gIHByaXZhdGUgc2V0V2luZG93c1RpdGxlKHRpdGxlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICBjb25zdCBuZXdUaXRsZSA9IGAke3RpdGxlfSAtIFlvdVR1YmVgO1xuICAgIGlmICh0aGlzLnBpcFdpbmRvdykge1xuICAgICAgZG9jdW1lbnQudGl0bGUgPSBuZXdUaXRsZTtcbiAgICAgIHRoaXMucGlwV2luZG93LmRvY3VtZW50LnRpdGxlID0gbmV3VGl0bGU7XG4gICAgICBsb2dnZXIuZGVidWcoYFRpdGxlIHN5bmNlZCBmcm9tIE1lZGlhU2Vzc2lvbjogJHt0aXRsZX1gKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlIHdpbmRvdyB0aXRsZSBmcm9tIG1lZGlhIHNlc3Npb25cbiAgICogU2tpcHMgdXBkYXRlIGlmIFBpUCB3YXMgb3BlbmVkIGZyb20gbWluaSBwbGF5ZXIgbW9kZVxuICAgKi9cbiAgcHVibGljIHVwZGF0ZVRpdGxlKHRpdGxlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAvLyBEb24ndCBzeW5jIHRpdGxlIGlmIFBpUCB3YXMgb3BlbmVkIGZyb20gbWluaSBwbGF5ZXIgbW9kZVxuICAgIGlmICghdGhpcy53YXNNaW5pUGxheWVyQWN0aXZlQmVmb3JlUGlQKSB7XG4gICAgICB0aGlzLnNldFdpbmRvd3NUaXRsZSh0aXRsZSk7XG4gICAgfVxuICB9XG59XG4iLCJpbXBvcnQgeyBMb2dnZXIgfSBmcm9tICcuLi9sb2dnZXInO1xuaW1wb3J0IHsgU0VMRUNUT1JTIH0gZnJvbSAnLi4vc2VsZWN0b3JzJztcbmltcG9ydCB7IFlvdVR1YmVQbGF5ZXIgfSBmcm9tICcuLi90eXBlcy95b3V0dWJlJztcbmltcG9ydCB0eXBlIHsgTnVsbGFibGUgfSBmcm9tICcuLi90eXBlcy9hcHAnO1xuXG5jb25zdCBsb2dnZXIgPSBMb2dnZXIuZ2V0SW5zdGFuY2UoJ1Jlc2l6ZVRyYWNrZXInKTtcblxuLyoqXG4gKiBUcmFja3MgZWxlbWVudCByZXNpemUgZXZlbnRzIGFuZCB1cGRhdGVzIHBsYXllclxuICovXG5leHBvcnQgY2xhc3MgUmVzaXplVHJhY2tlciB7XG4gIHByaXZhdGUgb2JzZXJ2ZXI6IE51bGxhYmxlPFJlc2l6ZU9ic2VydmVyPiA9IG51bGw7XG5cbiAgLyoqXG4gICAqIFN0YXJ0IHRyYWNraW5nIHJlc2l6ZSBldmVudHMgZm9yIGVsZW1lbnQgaW4gUGlQIHdpbmRvd1xuICAgKi9cbiAgcHVibGljIHN0YXJ0KHRhcmdldEVsZW1lbnQ6IEVsZW1lbnQsIHBpcFdpbmRvdzogV2luZG93KTogdm9pZCB7XG4gICAgaWYgKHR5cGVvZiBSZXNpemVPYnNlcnZlciA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignUmVzaXplT2JzZXJ2ZXIgbm90IGF2YWlsYWJsZScpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGxvZ2dlci5kZWJ1ZygnU3RhcnRpbmcgcmVzaXplIHRyYWNraW5nJyk7XG5cbiAgICBjb25zdCBwaXBEb2MgPSBwaXBXaW5kb3cuZG9jdW1lbnQ7XG4gICAgdGhpcy5vYnNlcnZlciA9IG5ldyBSZXNpemVPYnNlcnZlcigoZW50cmllczogUmVzaXplT2JzZXJ2ZXJFbnRyeVtdKSA9PiB7XG4gICAgICBmb3IgKGNvbnN0IGVudHJ5IG9mIGVudHJpZXMpIHtcbiAgICAgICAgY29uc3Qgd2lkdGggPSBlbnRyeS5jb250ZW50UmVjdC53aWR0aDtcbiAgICAgICAgbG9nZ2VyLmRlYnVnKGBOZXcgc2l6ZTogJHt3aWR0aH1weGApO1xuXG4gICAgICAgIGNvbnN0IHBsYXllciA9IHBpcERvYy5xdWVyeVNlbGVjdG9yKFNFTEVDVE9SUy5NT1ZJRV9QTEFZRVIpIGFzIE51bGxhYmxlPFlvdVR1YmVQbGF5ZXI+O1xuICAgICAgICBpZiAocGxheWVyKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBwbGF5ZXIuc2V0SW50ZXJuYWxTaXplID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBwbGF5ZXIuc2V0SW50ZXJuYWxTaXplKCk7XG4gICAgICAgICAgICBwbGF5ZXIuc2V0U2l6ZT8uKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHBsYXllci5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgncmVzaXplJywgeyBidWJibGVzOiB0cnVlIH0pKTtcbiAgICAgICAgICBsb2dnZXIuZGVidWcoJ1BsYXllciBzaXplIHVwZGF0ZWQnKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgdGhpcy5vYnNlcnZlci5vYnNlcnZlKHRhcmdldEVsZW1lbnQpO1xuICB9XG5cbiAgLyoqXG4gICAqIFN0b3AgdHJhY2tpbmcgcmVzaXplIGV2ZW50c1xuICAgKi9cbiAgcHVibGljIHN0b3AoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMub2JzZXJ2ZXIpIHtcbiAgICAgIHRoaXMub2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xuICAgICAgdGhpcy5vYnNlcnZlciA9IG51bGw7XG4gICAgICBsb2dnZXIuZGVidWcoJ1Jlc2l6ZSB0cmFja2luZyBzdG9wcGVkJyk7XG4gICAgfVxuICB9XG59XG4iLCJpbXBvcnQgeyBMb2dnZXIgfSBmcm9tICcuLi9sb2dnZXInO1xuaW1wb3J0IHsgREVGQVVMVF9ESU1FTlNJT05TIH0gZnJvbSAnLi4vY29uc3RhbnRzJztcbmltcG9ydCB7IFNFTEVDVE9SUyB9IGZyb20gJy4uL3NlbGVjdG9ycyc7XG5pbXBvcnQgeyBET01VdGlscyB9IGZyb20gJy4uL3V0aWxzL0RPTVV0aWxzJztcbmltcG9ydCB0eXBlIHsgTnVsbGFibGUgfSBmcm9tICcuLi90eXBlcy9hcHAnO1xuXG5jb25zdCBsb2dnZXIgPSBMb2dnZXIuZ2V0SW5zdGFuY2UoJ01lbnVPYnNlcnZlcicpO1xuXG4vKipcbiAqIE9ic2VydmVzIG1lbnUgYnV0dG9uIHN0YXRlIGFuZCBhZGp1c3RzIFBpUCB3aW5kb3cuXG4gKiBSZS13YWl0cyBmb3IgdGhlIGJ1dHRvbiB3aGVuIGl0IGlzIHJlbW92ZWQgZnJvbSBET00gKGUuZy4gbmF2aWdhdGUgdG8gdmlkZW8gd2l0aG91dCBwbGF5bGlzdCkuXG4gKi9cbmV4cG9ydCBjbGFzcyBNZW51T2JzZXJ2ZXIge1xuICBwcml2YXRlIG9ic2VydmVyOiBOdWxsYWJsZTxNdXRhdGlvbk9ic2VydmVyPiA9IG51bGw7XG4gIHByaXZhdGUgcmVtb3ZhbE9ic2VydmVyOiBOdWxsYWJsZTxNdXRhdGlvbk9ic2VydmVyPiA9IG51bGw7XG5cbiAgLyoqXG4gICAqIFN0YXJ0IG9ic2VydmluZyBtZW51IGJ1dHRvbiBpbiBQaVAgd2luZG93XG4gICAqL1xuICBwdWJsaWMgYXN5bmMgc3RhcnQocGlwV2luZG93OiBXaW5kb3cpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBhd2FpdCB0aGlzLnJ1bk9ic2VydmF0aW9uKHBpcFdpbmRvdyk7XG4gIH1cblxuICAvKipcbiAgICogV2FpdCBmb3IgYnV0dG9uLCBvYnNlcnZlIGl0OyB3aGVuIHJlbW92ZWQgZnJvbSBET00sIHJlLXdhaXQgYW5kIHJlLW9ic2VydmUuXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHJ1bk9ic2VydmF0aW9uKHBpcFdpbmRvdzogV2luZG93KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgaWYgKHBpcFdpbmRvdy5jbG9zZWQpIHtcbiAgICAgIGxvZ2dlci5kZWJ1ZygnUGlQIHdpbmRvdyBhbHJlYWR5IGNsb3NlZCwgc2tpcHBpbmcgbWVudSBvYnNlcnZhdGlvbicpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGxldCBidXR0b246IEVsZW1lbnQ7XG4gICAgdHJ5IHtcbiAgICAgIGJ1dHRvbiA9IGF3YWl0IERPTVV0aWxzLndhaXRGb3JFbGVtZW50U2VsZWN0b3IoXG4gICAgICAgIFNFTEVDVE9SUy5NRU5VX0JVVFRPTixcbiAgICAgICAgcGlwV2luZG93LmRvY3VtZW50LFxuICAgICAgICAwLFxuICAgICAgICBwaXBXaW5kb3dcbiAgICAgICk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgbG9nZ2VyLndhcm4oJ1dhaXQgZm9yIG1lbnUgYnV0dG9uIGFib3J0ZWQnLCBlKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBsb2dnZXIuZGVidWcoJ1N0YXJ0aW5nIG1lbnUgb2JzZXJ2YXRpb24nKTtcblxuICAgIHRoaXMub2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigobXV0YXRpb25zKSA9PiB7XG4gICAgICBmb3IgKGNvbnN0IG11dGF0aW9uIG9mIG11dGF0aW9ucykge1xuICAgICAgICBpZiAobXV0YXRpb24uYXR0cmlidXRlTmFtZSA9PT0gJ2FyaWEtZXhwYW5kZWQnKSB7XG4gICAgICAgICAgY29uc3QgaXNFeHBhbmRlZCA9IGJ1dHRvbi5nZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnKSA9PT0gJ3RydWUnO1xuICAgICAgICAgIGNvbnN0IHBsYXlMaXN0Q29udGFpbmVyID0gcGlwV2luZG93LmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoU0VMRUNUT1JTLlBMQVlMSVNUX1BBTkVMKTtcbiAgICAgICAgICBjb25zdCBjdXJyZW50SGVpZ2h0ID0gcGlwV2luZG93Lm91dGVySGVpZ2h0O1xuXG4gICAgICAgICAgbG9nZ2VyLmRlYnVnKGBNZW51IHN0YXRlIGNoYW5nZWQ6IGV4cGFuZGVkID0gJHtpc0V4cGFuZGVkfWApO1xuXG4gICAgICAgICAgaWYgKGlzRXhwYW5kZWQpIHtcbiAgICAgICAgICAgIC8vIEV4cGFuZCB3aW5kb3cgaWYgbmVlZGVkXG4gICAgICAgICAgICBpZiAoY3VycmVudEhlaWdodCA8IERFRkFVTFRfRElNRU5TSU9OUy5QSVBfRVhQQU5ERURfSEVJR0hUKSB7XG4gICAgICAgICAgICAgIHBpcFdpbmRvdy5yZXNpemVUbyhwaXBXaW5kb3cub3V0ZXJXaWR0aCwgREVGQVVMVF9ESU1FTlNJT05TLlBJUF9FWFBBTkRFRF9IRUlHSFQpO1xuICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ1BpUCB3aW5kb3cgZXhwYW5kZWQnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gU2hvdyBwbGF5bGlzdCBwYW5lbFxuICAgICAgICAgICAgaWYgKHBsYXlMaXN0Q29udGFpbmVyKSB7XG4gICAgICAgICAgICAgIChwbGF5TGlzdENvbnRhaW5lciBhcyBIVE1MRWxlbWVudCkuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIEhpZGUgcGxheWxpc3QgcGFuZWxcbiAgICAgICAgICAgIGlmIChwbGF5TGlzdENvbnRhaW5lcikge1xuICAgICAgICAgICAgICAocGxheUxpc3RDb250YWluZXIgYXMgSFRNTEVsZW1lbnQpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBPYnNlcnZlIG9ubHkgYXJpYS1leHBhbmRlZCBhdHRyaWJ1dGVcbiAgICB0aGlzLm9ic2VydmVyLm9ic2VydmUoYnV0dG9uLCB7XG4gICAgICBhdHRyaWJ1dGVzOiB0cnVlLFxuICAgICAgYXR0cmlidXRlRmlsdGVyOiBbJ2FyaWEtZXhwYW5kZWQnXSxcbiAgICB9KTtcblxuICAgIHRoaXMucmVtb3ZhbE9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoKCkgPT4ge1xuICAgICAgaWYgKCFidXR0b24uaXNDb25uZWN0ZWQpIHtcbiAgICAgICAgdGhpcy5vYnNlcnZlcj8uZGlzY29ubmVjdCgpO1xuICAgICAgICB0aGlzLnJlbW92YWxPYnNlcnZlcj8uZGlzY29ubmVjdCgpO1xuICAgICAgICB0aGlzLm9ic2VydmVyID0gbnVsbDtcbiAgICAgICAgdGhpcy5yZW1vdmFsT2JzZXJ2ZXIgPSBudWxsO1xuICAgICAgICBsb2dnZXIuZGVidWcoJ01lbnUgYnV0dG9uIHJlbW92ZWQgZnJvbSBET00sIHJlLXdhaXRpbmcnKTtcbiAgICAgICAgdm9pZCB0aGlzLnJ1bk9ic2VydmF0aW9uKHBpcFdpbmRvdyk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICB0aGlzLnJlbW92YWxPYnNlcnZlci5vYnNlcnZlKHBpcFdpbmRvdy5kb2N1bWVudC5ib2R5LCB7XG4gICAgICBjaGlsZExpc3Q6IHRydWUsXG4gICAgICBzdWJ0cmVlOiB0cnVlLFxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFN0b3Agb2JzZXJ2aW5nIG1lbnUgYnV0dG9uXG4gICAqL1xuICBwdWJsaWMgc3RvcCgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5vYnNlcnZlcikge1xuICAgICAgdGhpcy5vYnNlcnZlci5kaXNjb25uZWN0KCk7XG4gICAgICB0aGlzLm9ic2VydmVyID0gbnVsbDtcbiAgICB9XG4gICAgaWYgKHRoaXMucmVtb3ZhbE9ic2VydmVyKSB7XG4gICAgICB0aGlzLnJlbW92YWxPYnNlcnZlci5kaXNjb25uZWN0KCk7XG4gICAgICB0aGlzLnJlbW92YWxPYnNlcnZlciA9IG51bGw7XG4gICAgfVxuICAgIGxvZ2dlci5kZWJ1ZygnTWVudSBvYnNlcnZhdGlvbiBzdG9wcGVkJyk7XG4gIH1cbn1cbiIsImltcG9ydCB7IExvZ2dlciB9IGZyb20gJy4uL2xvZ2dlcic7XG5pbXBvcnQgeyBET01VdGlscyB9IGZyb20gJy4uL3V0aWxzL0RPTVV0aWxzJztcbmltcG9ydCB7IFNFTEVDVE9SUyB9IGZyb20gJy4uL3NlbGVjdG9ycyc7XG5pbXBvcnQgdHlwZSB7IE51bGxhYmxlIH0gZnJvbSAnLi4vdHlwZXMvYXBwJztcblxuY29uc3QgbG9nZ2VyID0gTG9nZ2VyLmdldEluc3RhbmNlKCdDb250ZXh0TWVudUhhbmRsZXInKTtcblxuLyoqXG4gKiBIYW5kbGVzIGNvbnRleHQgbWVudSBtb3ZlbWVudCBiZXR3ZWVuIHdpbmRvd3NcbiAqL1xuZXhwb3J0IGNsYXNzIENvbnRleHRNZW51SGFuZGxlciB7XG4gIHByaXZhdGUgdmlzaWJpbGl0eU9ic2VydmVyOiBOdWxsYWJsZTxNdXRhdGlvbk9ic2VydmVyPiA9IG51bGw7XG4gIHByaXZhdGUgcGlwV2luZG93OiBOdWxsYWJsZTxXaW5kb3c+ID0gbnVsbDtcbiAgcHJpdmF0ZSBjb250ZXh0TWVudTogTnVsbGFibGU8RWxlbWVudD4gPSBudWxsO1xuICBwcml2YXRlIGNvbnRleHRNZW51UGxhY2Vob2xkZXI6IE51bGxhYmxlPENvbW1lbnQ+ID0gbnVsbDtcblxuICAvKipcbiAgICogSW5pdGlhbGl6ZSBjb250ZXh0IG1lbnUgaGFuZGxlclxuICAgKi9cbiAgcHVibGljIGFzeW5jIGluaXRpYWxpemUocGlwV2luZG93OiBXaW5kb3cpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0aGlzLnBpcFdpbmRvdyA9IHBpcFdpbmRvdztcbiAgICB0aGlzLmNvbnRleHRNZW51UGxhY2Vob2xkZXIgPSBET01VdGlscy5jcmVhdGVQbGFjZWhvbGRlcignY29udGV4dF9tZW51X3BsYWNlaG9sZGVyJyk7XG5cbiAgICAvLyBXYWl0IGZvciBjb250ZXh0IG1lbnUgdG8gYXBwZWFyXG4gICAgdHJ5IHtcbiAgICAgIHRoaXMuY29udGV4dE1lbnUgPSBhd2FpdCBET01VdGlscy53YWl0Rm9yRWxlbWVudFNlbGVjdG9yKFxuICAgICAgICBTRUxFQ1RPUlMuQ09OVEVYVF9NRU5VLFxuICAgICAgICBkb2N1bWVudCxcbiAgICAgICAgMCxcbiAgICAgICAgcGlwV2luZG93XG4gICAgICApO1xuXG4gICAgICBsb2dnZXIubG9nKCdDb250ZXh0IG1lbnUgZWxlbWVudCBmb3VuZCwgc3RhcnRpbmcgdmlzaWJpbGl0eSBtb25pdG9yaW5nJyk7XG5cbiAgICAgIHRoaXMuc3RhcnRNb25pdG9yaW5nKCk7XG4gICAgICB0aGlzLnNldHVwRGlzbWlzc2FsSGFuZGxlcigpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGxvZ2dlci53YXJuKCdFcnJvciBpbml0aWFsaXppbmcgY29udGV4dCBtZW51IGhhbmRsZXI6JywgZSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFN0YXJ0IG1vbml0b3JpbmcgY29udGV4dCBtZW51IHZpc2liaWxpdHlcbiAgICovXG4gIHByaXZhdGUgc3RhcnRNb25pdG9yaW5nKCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5jb250ZXh0TWVudSB8fCAhdGhpcy5waXBXaW5kb3cpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLnZpc2liaWxpdHlPYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKCgpID0+IHtcbiAgICAgIGlmICghdGhpcy5jb250ZXh0TWVudSB8fCAhdGhpcy5waXBXaW5kb3cpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBpc1Zpc2libGUgPSAodGhpcy5jb250ZXh0TWVudSBhcyBIVE1MRWxlbWVudCkuc3R5bGUuZGlzcGxheSAhPT0gJ25vbmUnO1xuICAgICAgY29uc3QgaXNJbk1haW5XaW5kb3cgPSB0aGlzLmNvbnRleHRNZW51LnBhcmVudE5vZGUgIT09IHRoaXMucGlwV2luZG93LmRvY3VtZW50LmJvZHk7XG5cbiAgICAgIGlmIChpc1Zpc2libGUgJiYgaXNJbk1haW5XaW5kb3cpIHtcbiAgICAgICAgbG9nZ2VyLmxvZygnQ29udGV4dCBtZW51IG9wZW5lZCBpbiBtYWluIHdpbmRvdy4gSW50ZXJjZXB0aW5nLi4uJyk7XG5cbiAgICAgICAgaWYgKHRoaXMuY29udGV4dE1lbnVQbGFjZWhvbGRlcikge1xuICAgICAgICAgIERPTVV0aWxzLmluc2VydFBsYWNlaG9sZGVyQmVmb3JlKHRoaXMuY29udGV4dE1lbnUsIHRoaXMuY29udGV4dE1lbnVQbGFjZWhvbGRlcik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5waXBXaW5kb3cuZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0aGlzLmNvbnRleHRNZW51KTtcbiAgICAgIH0gZWxzZSBpZiAoIWlzVmlzaWJsZSAmJiB0aGlzLmNvbnRleHRNZW51LnBhcmVudE5vZGUgPT09IHRoaXMucGlwV2luZG93LmRvY3VtZW50LmJvZHkpIHtcbiAgICAgICAgaWYgKHRoaXMuY29udGV4dE1lbnVQbGFjZWhvbGRlcj8ucGFyZW50Tm9kZSkge1xuICAgICAgICAgIGxvZ2dlci5sb2coJ0NvbnRleHQgbWVudSBjbG9zZWQgaW4gUGlQIHdpbmRvdy4gUmV0dXJuaW5nIHRvIG1haW4uLi4nKTtcbiAgICAgICAgICBET01VdGlscy5yZXN0b3JlRWxlbWVudEZyb21QbGFjZWhvbGRlcih0aGlzLmNvbnRleHRNZW51LCB0aGlzLmNvbnRleHRNZW51UGxhY2Vob2xkZXIpO1xuICAgICAgICAgIHRoaXMuc2ltdWxhdGVNYWluQ29udGV4dE1lbnUoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gT2JzZXJ2ZSBzdHlsZSBhdHRyaWJ1dGUgY2hhbmdlc1xuICAgIHRoaXMudmlzaWJpbGl0eU9ic2VydmVyLm9ic2VydmUodGhpcy5jb250ZXh0TWVudSwge1xuICAgICAgYXR0cmlidXRlczogdHJ1ZSxcbiAgICAgIGF0dHJpYnV0ZUZpbHRlcjogWydzdHlsZSddLFxuICAgIH0pO1xuXG4gICAgLy8gTW92ZSBtZW51IGltbWVkaWF0ZWx5IGlmIGFscmVhZHkgdmlzaWJsZVxuICAgIGlmICgodGhpcy5jb250ZXh0TWVudSBhcyBIVE1MRWxlbWVudCkuc3R5bGUuZGlzcGxheSAhPT0gJ25vbmUnKSB7XG4gICAgICBpZiAodGhpcy5jb250ZXh0TWVudVBsYWNlaG9sZGVyKSB7XG4gICAgICAgIERPTVV0aWxzLmluc2VydFBsYWNlaG9sZGVyQmVmb3JlKHRoaXMuY29udGV4dE1lbnUsIHRoaXMuY29udGV4dE1lbnVQbGFjZWhvbGRlcik7XG4gICAgICB9XG4gICAgICB0aGlzLnBpcFdpbmRvdy5kb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuY29udGV4dE1lbnUpO1xuICAgIH1cblxuICAgIC8vIENsZWFudXAgaXMgZG9uZSB2aWEgUGlQTWFuYWdlci5vbkJlZm9yZVJldHVyblxuICB9XG5cbiAgLyoqXG4gICAqIFNldHVwIGhhbmRsZXIgdG8gZGlzbWlzcyBjb250ZXh0IG1lbnUgb24gY2xpY2sgb3V0c2lkZVxuICAgKi9cbiAgcHJpdmF0ZSBzZXR1cERpc21pc3NhbEhhbmRsZXIoKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLnBpcFdpbmRvdykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGhhbmRsZUV2ZW50ID0gKGU6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgIGNvbnN0IG1lbnVJblBpcCA9IHRoaXMucGlwV2luZG93IS5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFNFTEVDVE9SUy5DT05URVhUX01FTlUpO1xuXG4gICAgICBpZiAoXG4gICAgICAgIG1lbnVJblBpcCAmJlxuICAgICAgICAobWVudUluUGlwIGFzIEhUTUxFbGVtZW50KS5zdHlsZS5kaXNwbGF5ICE9PSAnbm9uZScgJiZcbiAgICAgICAgIShlLnRhcmdldCBhcyBFbGVtZW50KT8uY2xvc2VzdChTRUxFQ1RPUlMuQ09OVEVYVF9NRU5VX0NPTlRBSU5FUilcbiAgICAgICkge1xuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAobWVudUluUGlwIGFzIEhUTUxFbGVtZW50KS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICBsb2dnZXIuZGVidWcoJ0NvbnRleHQgbWVudSBkaXNtaXNzZWQnKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5waXBXaW5kb3cuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVFdmVudCwgdHJ1ZSk7XG4gICAgdGhpcy5waXBXaW5kb3cuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY29udGV4dG1lbnUnLCBoYW5kbGVFdmVudCwgdHJ1ZSk7XG4gIH1cblxuICAvKipcbiAgICogU2ltdWxhdGUgY29udGV4dCBtZW51IGV2ZW50IGluIG1haW4gd2luZG93XG4gICAqL1xuICBwcml2YXRlIHNpbXVsYXRlTWFpbkNvbnRleHRNZW51KCk6IHZvaWQge1xuICAgIGNvbnN0IG1haW5BcHAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFNFTEVDVE9SUy5ZVERfQVBQKTtcbiAgICBpZiAoIW1haW5BcHApIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBldmVudCA9IG5ldyBNb3VzZUV2ZW50KCdjb250ZXh0bWVudScsIHtcbiAgICAgIGJ1YmJsZXM6IHRydWUsXG4gICAgICBjYW5jZWxhYmxlOiB0cnVlLFxuICAgICAgdmlldzogd2luZG93LFxuICAgICAgY2xpZW50WDogMCxcbiAgICAgIGNsaWVudFk6IDAsXG4gICAgICBidXR0b246IDIsIC8vIFJpZ2h0IG1vdXNlIGJ1dHRvblxuICAgIH0pO1xuXG4gICAgbWFpbkFwcC5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbiAgICBsb2dnZXIuZGVidWcoJ1N5bnRoZXRpYyBjb250ZXh0bWVudSBldmVudCBzZW50IHRvIG1haW4gd2luZG93Jyk7XG4gIH1cblxuICAvKipcbiAgICogU3RvcCBtb25pdG9yaW5nIGFuZCBjbGVhbnVwXG4gICAqL1xuICBwdWJsaWMgc3RvcCgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy52aXNpYmlsaXR5T2JzZXJ2ZXIpIHtcbiAgICAgIHRoaXMudmlzaWJpbGl0eU9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcbiAgICAgIHRoaXMudmlzaWJpbGl0eU9ic2VydmVyID0gbnVsbDtcbiAgICB9XG5cbiAgICAvLyBSZXR1cm4gbWVudSB0byBtYWluIHdpbmRvdyBpZiBzdGlsbCBpbiBQaVBcbiAgICBpZiAoXG4gICAgICB0aGlzLmNvbnRleHRNZW51ICYmXG4gICAgICB0aGlzLnBpcFdpbmRvdyAmJlxuICAgICAgdGhpcy5jb250ZXh0TWVudS5wYXJlbnROb2RlID09PSB0aGlzLnBpcFdpbmRvdy5kb2N1bWVudC5ib2R5ICYmXG4gICAgICB0aGlzLmNvbnRleHRNZW51UGxhY2Vob2xkZXI/LnBhcmVudE5vZGVcbiAgICApIHtcbiAgICAgIGxvZ2dlci5sb2coJ1JldHVybmluZyBjb250ZXh0IG1lbnUgdG8gbWFpbiB3aW5kb3cnKTtcbiAgICAgIERPTVV0aWxzLnJlc3RvcmVFbGVtZW50RnJvbVBsYWNlaG9sZGVyKHRoaXMuY29udGV4dE1lbnUsIHRoaXMuY29udGV4dE1lbnVQbGFjZWhvbGRlcik7XG4gICAgICB0aGlzLnNpbXVsYXRlTWFpbkNvbnRleHRNZW51KCk7XG4gICAgfVxuXG4gICAgdGhpcy5waXBXaW5kb3cgPSBudWxsO1xuICAgIGxvZ2dlci5kZWJ1ZygnQ29udGV4dCBtZW51IGhhbmRsZXIgc3RvcHBlZCcpO1xuICB9XG59XG4iLCJpbXBvcnQgeyBMb2dnZXIgfSBmcm9tICcuLi9sb2dnZXInO1xuaW1wb3J0IHsgU0VMRUNUT1JTIH0gZnJvbSAnLi4vc2VsZWN0b3JzJztcbmltcG9ydCB7IFlvdVR1YmVQbGF5ZXIgfSBmcm9tICcuLi90eXBlcy95b3V0dWJlJztcbmltcG9ydCB0eXBlIHsgTnVsbGFibGUgfSBmcm9tICcuLi90eXBlcy9hcHAnO1xuXG5jb25zdCBsb2dnZXIgPSBMb2dnZXIuZ2V0SW5zdGFuY2UoJ1NlZWtIYW5kbGVyJyk7XG5cbi8qKlxuICogSGFuZGxlcyBtYW51YWwgc2Vla2luZyBvbiBwcm9ncmVzcyBiYXJcbiAqL1xuZXhwb3J0IGNsYXNzIFNlZWtIYW5kbGVyIHtcbiAgcHJpdmF0ZSBwaXBXaW5kb3c6IE51bGxhYmxlPFdpbmRvdz4gPSBudWxsO1xuXG4gIC8qKlxuICAgKiBJbml0aWFsaXplIHNlZWsgaGFuZGxlciBmb3IgUGlQIHdpbmRvd1xuICAgKi9cbiAgcHVibGljIGluaXRpYWxpemUocGlwV2luZG93OiBXaW5kb3cpOiB2b2lkIHtcbiAgICB0aGlzLnBpcFdpbmRvdyA9IHBpcFdpbmRvdztcbiAgICB0aGlzLnNldHVwU2Vla0hhbmRsZXIoKTtcbiAgICBsb2dnZXIuZGVidWcoJ1NlZWsgaGFuZGxlciBpbml0aWFsaXplZCcpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldHVwIG1vdXNlIGhhbmRsZXJzIGZvciBwcm9ncmVzcyBiYXIgc2Vla2luZ1xuICAgKi9cbiAgcHJpdmF0ZSBzZXR1cFNlZWtIYW5kbGVyKCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5waXBXaW5kb3cpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBwaXBEb2MgPSB0aGlzLnBpcFdpbmRvdy5kb2N1bWVudDtcbiAgICBwaXBEb2MuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICdtb3VzZWRvd24nLFxuICAgICAgKGU6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgY29uc3QgcHJvZ3Jlc3NCYXIgPSAoZS50YXJnZXQgYXMgRWxlbWVudCk/LmNsb3Nlc3QoU0VMRUNUT1JTLlBST0dSRVNTX0JBUik7XG4gICAgICAgIGlmICghcHJvZ3Jlc3NCYXIpIHJldHVybjtcblxuICAgICAgICBjb25zdCBwbGF5ZXIgPSBwaXBEb2MucXVlcnlTZWxlY3RvcihTRUxFQ1RPUlMuTU9WSUVfUExBWUVSKSBhcyBOdWxsYWJsZTxZb3VUdWJlUGxheWVyPjtcbiAgICAgICAgaWYgKCFwbGF5ZXIpIHJldHVybjtcblxuICAgICAgICBsb2dnZXIuZGVidWcoJ1Byb2dyZXNzIGJhciBjbGlja2VkLCBpbml0aWF0aW5nIHNlZWsnKTtcblxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICAgICAgY29uc3QgcGVyZm9ybVNlZWsgPSAoZXZlbnQ6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgICBjb25zdCByZWN0ID0gcHJvZ3Jlc3NCYXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgICAgY29uc3QgeCA9IGV2ZW50LmNsaWVudFggLSByZWN0LmxlZnQ7XG4gICAgICAgICAgY29uc3QgcGVyY2VudCA9IE1hdGgubWF4KDAsIE1hdGgubWluKDEsIHggLyByZWN0LndpZHRoKSk7XG4gICAgICAgICAgY29uc3QgZHVyYXRpb24gPSBwbGF5ZXIuZ2V0RHVyYXRpb24oKTtcbiAgICAgICAgICBpZiAoZHVyYXRpb24pIHtcbiAgICAgICAgICAgIGNvbnN0IHNlZWtUaW1lID0gcGVyY2VudCAqIGR1cmF0aW9uO1xuICAgICAgICAgICAgcGxheWVyLnNlZWtUbyhzZWVrVGltZSwgdHJ1ZSk7XG4gICAgICAgICAgICBsb2dnZXIuZGVidWcoYFNlZWtpbmcgdG8gJHtzZWVrVGltZS50b0ZpeGVkKDIpfXMgKCR7KHBlcmNlbnQgKiAxMDApLnRvRml4ZWQoMSl9JSlgKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgcGVyZm9ybVNlZWsoZSk7XG5cbiAgICAgICAgY29uc3Qgb25Nb3VzZU1vdmUgPSAobW92ZUV2ZW50OiBNb3VzZUV2ZW50KSA9PiBwZXJmb3JtU2Vlayhtb3ZlRXZlbnQpO1xuICAgICAgICBjb25zdCBvbk1vdXNlVXAgPSAoKSA9PiB7XG4gICAgICAgICAgcGlwRG9jLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIG9uTW91c2VNb3ZlKTtcbiAgICAgICAgICBwaXBEb2MucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIG9uTW91c2VVcCk7XG4gICAgICAgICAgbG9nZ2VyLmRlYnVnKCdTZWVrIGRyYWcgZW5kZWQnKTtcbiAgICAgICAgfTtcblxuICAgICAgICBwaXBEb2MuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgb25Nb3VzZU1vdmUpO1xuICAgICAgICBwaXBEb2MuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIG9uTW91c2VVcCk7XG4gICAgICB9LFxuICAgICAgdHJ1ZVxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogQ2xlYW51cCBzZWVrIGhhbmRsZXJcbiAgICovXG4gIHB1YmxpYyBjbGVhbnVwKCk6IHZvaWQge1xuICAgIHRoaXMucGlwV2luZG93ID0gbnVsbDtcbiAgICBsb2dnZXIuZGVidWcoJ1NlZWsgaGFuZGxlciBjbGVhbmVkIHVwJyk7XG4gIH1cbn1cbiIsImltcG9ydCB7IExvZ2dlciB9IGZyb20gJy4uL2xvZ2dlcic7XG5pbXBvcnQgeyBZVF9BQ1RJT05TIH0gZnJvbSAnLi4vY29uc3RhbnRzJztcbmltcG9ydCB7IFNFTEVDVE9SUyB9IGZyb20gJy4uL3NlbGVjdG9ycyc7XG5pbXBvcnQgeyBQbGF5ZXJNYW5hZ2VyIH0gZnJvbSAnLi9QbGF5ZXJNYW5hZ2VyJztcbmltcG9ydCB7IFlvdVR1YmVDb21tYW5kLCBZb3VUdWJlQXBwRWxlbWVudCwgTGlrZUFjdGlvblN0YXR1c01hcCB9IGZyb20gJy4uL3R5cGVzL3lvdXR1YmUnO1xuaW1wb3J0IHR5cGUgeyBOdWxsYWJsZSB9IGZyb20gJy4uL3R5cGVzL2FwcCc7XG5cbmNvbnN0IGxvZ2dlciA9IExvZ2dlci5nZXRJbnN0YW5jZSgnWXRBY3Rpb25TZW5kZXInKTtcblxuLyoqXG4gKiBTZW5kcyBZb3VUdWJlIGxpa2UvZGlzbGlrZS9yZW1vdmUgY29tbWFuZHMgdG8gbWFpbiB3aW5kb3cgeXRkLWFwcC5cbiAqIFVzZWQgYnkgTGlrZUJ1dHRvbkhhbmRsZXIgd2hlbiB1c2VyIGNsaWNrcyBsaWtlL2Rpc2xpa2UgaW4gUGlQLlxuICovXG5leHBvcnQgY2xhc3MgWXRBY3Rpb25TZW5kZXIge1xuICBwcml2YXRlIHJlYWRvbmx5IHBpcFdpbmRvdzogTnVsbGFibGU8V2luZG93PjtcbiAgcHJpdmF0ZSByZWFkb25seSBwbGF5ZXJNYW5hZ2VyOiBQbGF5ZXJNYW5hZ2VyO1xuXG4gIGNvbnN0cnVjdG9yKHBpcFdpbmRvdzogTnVsbGFibGU8V2luZG93PiwgcGxheWVyTWFuYWdlcjogUGxheWVyTWFuYWdlcikge1xuICAgIHRoaXMucGlwV2luZG93ID0gcGlwV2luZG93O1xuICAgIHRoaXMucGxheWVyTWFuYWdlciA9IHBsYXllck1hbmFnZXI7XG4gIH1cblxuICAvKipcbiAgICogU2VuZCBZb3VUdWJlIGFjdGlvbiAoTElLRSAvIERJU0xJS0UgLyBSRU1PVkUpIGZvciB0aGUgY3VycmVudCBQaVAgdmlkZW8uXG4gICAqIFJlc29sdmVzIHZpZGVvIElEIGZyb20gUGlQIHBsYXllciBhbmQgaW52b2tlcyBtYWluIHdpbmRvdyByZXNvbHZlQ29tbWFuZC5cbiAgICovXG4gIHB1YmxpYyBzZW5kKGFjdGlvblR5cGU6IHN0cmluZyk6IHZvaWQge1xuICAgIGlmICghdGhpcy5waXBXaW5kb3cpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCB2aWRlb0lkID0gdGhpcy5wbGF5ZXJNYW5hZ2VyLmdldFZpZGVvSWQodGhpcy5waXBXaW5kb3cuZG9jdW1lbnQpO1xuXG4gICAgaWYgKCF2aWRlb0lkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgbWFpbkFwcCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoU0VMRUNUT1JTLllURF9BUFApIGFzIE51bGxhYmxlPFlvdVR1YmVBcHBFbGVtZW50PjtcbiAgICBpZiAoIW1haW5BcHAgfHwgdHlwZW9mIG1haW5BcHAucmVzb2x2ZUNvbW1hbmQgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRmFpbGVkIHRvIGZpbmQgcmVzb2x2ZUNvbW1hbmQgaW4gbWFpbiB3aW5kb3cnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBhY3Rpb25NYXA6IExpa2VBY3Rpb25TdGF0dXNNYXAgPSB7XG4gICAgICBbWVRfQUNUSU9OUy5MSUtFXTogJ0xJS0UnLFxuICAgICAgW1lUX0FDVElPTlMuRElTTElLRV06ICdESVNMSUtFJyxcbiAgICAgIFtZVF9BQ1RJT05TLlJFTU9WRV06ICdJTkRJRkZFUkVOVCcsXG4gICAgfTtcblxuICAgIGNvbnN0IGNvbW1hbmQ6IFlvdVR1YmVDb21tYW5kID0ge1xuICAgICAgbGlrZUVuZHBvaW50OiB7XG4gICAgICAgIHN0YXR1czogYWN0aW9uTWFwW2FjdGlvblR5cGVdLFxuICAgICAgICB0YXJnZXQ6IHsgdmlkZW9JZCB9LFxuICAgICAgfSxcbiAgICB9O1xuXG4gICAgdHJ5IHtcbiAgICAgIG1haW5BcHAucmVzb2x2ZUNvbW1hbmQoY29tbWFuZCk7XG4gICAgICBsb2dnZXIubG9nKGBTZW50ICR7YWN0aW9uVHlwZX0gZm9yIHZpZGVvICR7dmlkZW9JZH1gKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIHNlbmRpbmcgWW91VHViZSBhY3Rpb246JywgZSk7XG4gICAgfVxuICB9XG59XG4iLCJpbXBvcnQgeyBMb2dnZXIgfSBmcm9tICcuLi9sb2dnZXInO1xuaW1wb3J0IHsgWVRfQUNUSU9OUyB9IGZyb20gJy4uL2NvbnN0YW50cyc7XG5pbXBvcnQgeyBTRUxFQ1RPUlMgfSBmcm9tICcuLi9zZWxlY3RvcnMnO1xuaW1wb3J0IHsgWXRBY3Rpb25TZW5kZXIgfSBmcm9tICcuLi9jb3JlL1l0QWN0aW9uU2VuZGVyJztcbmltcG9ydCB7IFBsYXllck1hbmFnZXIgfSBmcm9tICcuLi9jb3JlL1BsYXllck1hbmFnZXInO1xuaW1wb3J0IHR5cGUgeyBOdWxsYWJsZSB9IGZyb20gJy4uL3R5cGVzL2FwcCc7XG5cbmNvbnN0IGxvZ2dlciA9IExvZ2dlci5nZXRJbnN0YW5jZSgnTGlrZUJ1dHRvbkhhbmRsZXInKTtcblxuLyoqXG4gKiBIYW5kbGVzIGxpa2UvZGlzbGlrZSBidXR0b24gY2xpY2tzIGluIFBpUCB3aW5kb3dcbiAqL1xuZXhwb3J0IGNsYXNzIExpa2VCdXR0b25IYW5kbGVyIHtcbiAgcHJpdmF0ZSBwaXBXaW5kb3c6IE51bGxhYmxlPFdpbmRvdz4gPSBudWxsO1xuICBwcml2YXRlIHl0QWN0aW9uU2VuZGVyOiBOdWxsYWJsZTxZdEFjdGlvblNlbmRlcj4gPSBudWxsO1xuICBwcml2YXRlIHBsYXllck1hbmFnZXI6IFBsYXllck1hbmFnZXI7XG5cbiAgY29uc3RydWN0b3IocGxheWVyTWFuYWdlcjogUGxheWVyTWFuYWdlcikge1xuICAgIHRoaXMucGxheWVyTWFuYWdlciA9IHBsYXllck1hbmFnZXI7XG4gIH1cblxuICAvKipcbiAgICogSW5pdGlhbGl6ZSBsaWtlIGJ1dHRvbiBoYW5kbGVyIGZvciBQaVAgd2luZG93XG4gICAqL1xuICBwdWJsaWMgaW5pdGlhbGl6ZShwaXBXaW5kb3c6IFdpbmRvdyk6IHZvaWQge1xuICAgIHRoaXMucGlwV2luZG93ID0gcGlwV2luZG93O1xuICAgIHRoaXMueXRBY3Rpb25TZW5kZXIgPSBuZXcgWXRBY3Rpb25TZW5kZXIocGlwV2luZG93LCB0aGlzLnBsYXllck1hbmFnZXIpO1xuICAgIHRoaXMuc2V0dXBDbGlja0hhbmRsZXIoKTtcbiAgICBsb2dnZXIuZGVidWcoJ0xpa2UgYnV0dG9uIGhhbmRsZXIgaW5pdGlhbGl6ZWQnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXR1cCBjbGljayBoYW5kbGVyIGZvciBsaWtlL2Rpc2xpa2UgYnV0dG9uc1xuICAgKi9cbiAgcHJpdmF0ZSBzZXR1cENsaWNrSGFuZGxlcigpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMucGlwV2luZG93KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5waXBXaW5kb3cuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICdjbGljaycsXG4gICAgICAoZXZlbnQ6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgY29uc3QgdG9nZ2xlQnV0dG9uID0gKGV2ZW50LnRhcmdldCBhcyBFbGVtZW50KT8uY2xvc2VzdChTRUxFQ1RPUlMuTElLRV9CVVRUT04pO1xuICAgICAgICBpZiAoIXRvZ2dsZUJ1dHRvbikge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGJ1dHRvbkNvbnRhaW5lciA9IHRvZ2dsZUJ1dHRvbi5wYXJlbnRFbGVtZW50O1xuICAgICAgICBpZiAoIWJ1dHRvbkNvbnRhaW5lcikge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGlzTGlrZUJ1dHRvbiA9IGJ1dHRvbkNvbnRhaW5lci5jaGlsZE5vZGVzWzBdID09PSB0b2dnbGVCdXR0b247XG4gICAgICAgIGNvbnN0IGlzRGlzbGlrZUJ1dHRvbiA9IGJ1dHRvbkNvbnRhaW5lci5jaGlsZE5vZGVzWzFdID09PSB0b2dnbGVCdXR0b247XG5cbiAgICAgICAgaWYgKCFpc0xpa2VCdXR0b24gJiYgIWlzRGlzbGlrZUJ1dHRvbikge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGJ1dHRvbiA9IChldmVudC50YXJnZXQgYXMgRWxlbWVudCk/LmNsb3Nlc3QoU0VMRUNUT1JTLkJVVFRPTl9TSEFQRSk7XG4gICAgICAgIGlmICghYnV0dG9uKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgaXNQcmVzc2VkID0gYnV0dG9uLmdldEF0dHJpYnV0ZSgnYXJpYS1wcmVzc2VkJykgPT09ICd0cnVlJztcbiAgICAgICAgY29uc3QgYWN0aW9uVHlwZSA9IGlzUHJlc3NlZFxuICAgICAgICAgID8gWVRfQUNUSU9OUy5SRU1PVkVcbiAgICAgICAgICA6IGlzTGlrZUJ1dHRvblxuICAgICAgICAgICAgPyBZVF9BQ1RJT05TLkxJS0VcbiAgICAgICAgICAgIDogWVRfQUNUSU9OUy5ESVNMSUtFO1xuXG4gICAgICAgIGxvZ2dlci5sb2coYCR7YWN0aW9uVHlwZX0gYnV0dG9uIGNsaWNrZWQgKGN1cnJlbnRseSBwcmVzc2VkOiAke2lzUHJlc3NlZH0pYCk7XG5cbiAgICAgICAgdGhpcy55dEFjdGlvblNlbmRlcj8uc2VuZChhY3Rpb25UeXBlKTtcbiAgICAgIH0sXG4gICAgICB0cnVlXG4gICAgKTsgLy8gQ2FwdHVyZSBwaGFzZVxuICB9XG5cbiAgLyoqXG4gICAqIENsZWFudXAgbGlrZSBidXR0b24gaGFuZGxlclxuICAgKi9cbiAgcHVibGljIGNsZWFudXAoKTogdm9pZCB7XG4gICAgdGhpcy5waXBXaW5kb3cgPSBudWxsO1xuICAgIHRoaXMueXRBY3Rpb25TZW5kZXIgPSBudWxsO1xuICAgIGxvZ2dlci5kZWJ1ZygnTGlrZSBidXR0b24gaGFuZGxlciBjbGVhbmVkIHVwJyk7XG4gIH1cbn1cbiIsImltcG9ydCB7IEFwcEVycm9yIH0gZnJvbSAnLi9BcHBFcnJvcic7XG5cbi8qKlxuICogRXJyb3IgdGhyb3duIGR1cmluZyBhcHBsaWNhdGlvbiBpbml0aWFsaXphdGlvbi5cbiAqL1xuZXhwb3J0IGNsYXNzIEFwcEluaXRpYWxpemF0aW9uRXJyb3IgZXh0ZW5kcyBBcHBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2U6IHN0cmluZywgY2F1c2U/OiB1bmtub3duKSB7XG4gICAgc3VwZXIobWVzc2FnZSwgY2F1c2UpO1xuICAgIHRoaXMubmFtZSA9ICdBcHBJbml0aWFsaXphdGlvbkVycm9yJztcbiAgfVxufVxuIiwiaW1wb3J0IHsgTG9nZ2VyIH0gZnJvbSAnLi4vbG9nZ2VyJztcbmltcG9ydCB7IE1lZGlhU2Vzc2lvbk1ldGFkYXRhIH0gZnJvbSAnLi4vdHlwZXMveW91dHViZSc7XG5pbXBvcnQgeyBQaVBNYW5hZ2VyIH0gZnJvbSAnLi4vY29yZS9QaVBNYW5hZ2VyJztcbmltcG9ydCB7IEFwcEluaXRpYWxpemF0aW9uRXJyb3IgfSBmcm9tICcuLi9lcnJvcnMvQXBwSW5pdGlhbGl6YXRpb25FcnJvcic7XG5pbXBvcnQgdHlwZSB7IE51bGxhYmxlIH0gZnJvbSAnLi4vdHlwZXMvYXBwJztcblxuY29uc3QgbG9nZ2VyID0gTG9nZ2VyLmdldEluc3RhbmNlKCdNZWRpYVNlc3Npb25IYW5kbGVyJyk7XG5cbi8qKlxuICogSGFuZGxlcyBNZWRpYSBTZXNzaW9uIEFQSSBpbnRlZ3JhdGlvblxuICovXG5leHBvcnQgY2xhc3MgTWVkaWFTZXNzaW9uSGFuZGxlciB7XG4gIHByaXZhdGUgcGlwTWFuYWdlcjogUGlQTWFuYWdlcjtcblxuICBjb25zdHJ1Y3RvcihwaXBNYW5hZ2VyOiBQaVBNYW5hZ2VyKSB7XG4gICAgdGhpcy5waXBNYW5hZ2VyID0gcGlwTWFuYWdlcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBJbml0aWFsaXplIG1lZGlhIHNlc3Npb24gaGFuZGxlclxuICAgKi9cbiAgcHVibGljIGluaXRpYWxpemUoKTogdm9pZCB7XG4gICAgaWYgKCEoJ21lZGlhU2Vzc2lvbicgaW4gbmF2aWdhdG9yKSkge1xuICAgICAgbG9nZ2VyLndhcm4oJ01lZGlhIFNlc3Npb24gQVBJIG5vdCBhdmFpbGFibGUnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLnJlZ2lzdGVyQWN0aW9uSGFuZGxlcigpO1xuICAgIHRoaXMuc2V0dXBUaXRsZVN5bmMoKTtcbiAgICBsb2dnZXIuZGVidWcoJ01lZGlhIHNlc3Npb24gaGFuZGxlciBpbml0aWFsaXplZCcpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlZ2lzdGVyIGVudGVycGljdHVyZWlucGljdHVyZSBhY3Rpb24gaGFuZGxlclxuICAgKi9cbiAgcHJpdmF0ZSByZWdpc3RlckFjdGlvbkhhbmRsZXIoKTogdm9pZCB7XG4gICAgaWYgKCEoJ21lZGlhU2Vzc2lvbicgaW4gbmF2aWdhdG9yKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICAvLyAnZW50ZXJwaWN0dXJlaW5waWN0dXJlJyBpcyBhIENocm9tZS1zcGVjaWZpYyBNZWRpYSBTZXNzaW9uIGFjdGlvblxuICAgICAgbmF2aWdhdG9yLm1lZGlhU2Vzc2lvbi5zZXRBY3Rpb25IYW5kbGVyKCdlbnRlcnBpY3R1cmVpbnBpY3R1cmUnIGFzIE1lZGlhU2Vzc2lvbkFjdGlvbiwgKCkgPT4ge1xuICAgICAgICBsb2dnZXIubG9nKCdNZWRpYSBzZXNzaW9uIGVudGVycGljdHVyZWlucGljdHVyZSBhY3Rpb24gdHJpZ2dlcmVkJyk7XG4gICAgICAgIHRoaXMucGlwTWFuYWdlci5vcGVuKCkuY2F0Y2goKGUpID0+IHtcbiAgICAgICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIG9wZW5pbmcgUGlQIGZyb20gbWVkaWEgc2Vzc2lvbjonLCBlKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICAgIGxvZ2dlci5kZWJ1ZygnTWVkaWEgc2Vzc2lvbiBhY3Rpb24gaGFuZGxlciByZWdpc3RlcmVkJyk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgdGhyb3cgbmV3IEFwcEluaXRpYWxpemF0aW9uRXJyb3IoJ0Vycm9yIHJlZ2lzdGVyaW5nIG1lZGlhIHNlc3Npb24gYWN0aW9uIGhhbmRsZXInLCBlKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU2V0dXAgdGl0bGUgc3luY2hyb25pemF0aW9uIGZyb20gTWVkaWFTZXNzaW9uIG1ldGFkYXRhXG4gICAqL1xuICBwcml2YXRlIHNldHVwVGl0bGVTeW5jKCk6IHZvaWQge1xuICAgIGlmICghKCdtZWRpYVNlc3Npb24nIGluIG5hdmlnYXRvcikpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgcHJvdG90eXBlID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG5hdmlnYXRvci5tZWRpYVNlc3Npb24pO1xuICAgICAgY29uc3QgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IocHJvdG90eXBlLCAnbWV0YWRhdGEnKTtcbiAgICAgIGlmICghZGVzYyB8fCAhZGVzYy5nZXQgfHwgIWRlc2Muc2V0KSB7XG4gICAgICAgIGxvZ2dlci53YXJuKCdDb3VsZCBub3QgZ2V0IG9yaWdpbmFsIG1ldGFkYXRhIGRlc2NyaXB0b3InKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobmF2aWdhdG9yLm1lZGlhU2Vzc2lvbiwgJ21ldGFkYXRhJywge1xuICAgICAgICBnZXQ6ICgpID0+IGRlc2MuZ2V0IS5jYWxsKG5hdmlnYXRvci5tZWRpYVNlc3Npb24pLFxuICAgICAgICBzZXQ6ICh2YWx1ZTogTnVsbGFibGU8TWVkaWFTZXNzaW9uTWV0YWRhdGE+KSA9PiB7XG4gICAgICAgICAgZGVzYy5zZXQhLmNhbGwobmF2aWdhdG9yLm1lZGlhU2Vzc2lvbiwgdmFsdWUpO1xuXG4gICAgICAgICAgLy8gU3luYyB0aXRsZSBpZiBhdmFpbGFibGVcbiAgICAgICAgICBpZiAodmFsdWUgJiYgdmFsdWUudGl0bGUpIHtcbiAgICAgICAgICAgIHRoaXMucGlwTWFuYWdlci51cGRhdGVUaXRsZSh2YWx1ZS50aXRsZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICB9KTtcblxuICAgICAgbG9nZ2VyLmRlYnVnKCdNZWRpYSBzZXNzaW9uIHRpdGxlIHN5bmMgY29uZmlndXJlZCcpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHRocm93IG5ldyBBcHBJbml0aWFsaXphdGlvbkVycm9yKCdFcnJvciBzZXR0aW5nIHVwIHRpdGxlIHN5bmMnLCBlKTtcbiAgICB9XG4gIH1cbn1cbiIsIi8qKlxuICogVXRpbGl0eSBmb3IgZGV0ZWN0aW5nIFlvdVR1YmUgY2xpZW50IHZlcnNpb24gYW5kIHNjcmlwdCB2ZXJzaW9uXG4gKi9cblxuLyoqXG4gKiBHZXQgc2NyaXB0IHZlcnNpb24gZnJvbSBWaXRlIGRlZmluZSAoaW5qZWN0ZWQgYXQgYnVpbGQgdGltZSlcbiAqL1xuZnVuY3Rpb24gZ2V0U2NyaXB0VmVyc2lvbigpOiBzdHJpbmcge1xuICByZXR1cm4gdHlwZW9mIFNDUklQVF9WRVJTSU9OICE9PSAndW5kZWZpbmVkJyA/IFNDUklQVF9WRVJTSU9OIDogJ3Vua25vd24nO1xufVxuXG4vKipcbiAqIEdldCBZb3VUdWJlIGNsaWVudCB2ZXJzaW9uIGZyb20gd2luZG93Lnl0Y2ZnXG4gKi9cbmZ1bmN0aW9uIGdldFlvdVR1YmVWZXJzaW9uKCk6IHN0cmluZyB7XG4gIHRyeSB7XG4gICAgY29uc3QgeXRjZmcgPSB3aW5kb3cueXRjZmc7XG4gICAgaWYgKHl0Y2ZnPy5kYXRhXz8uSU5ORVJUVUJFX0NPTlRFWFQ/LmNsaWVudD8uY2xpZW50VmVyc2lvbikge1xuICAgICAgcmV0dXJuIHl0Y2ZnLmRhdGFfLklOTkVSVFVCRV9DT05URVhULmNsaWVudC5jbGllbnRWZXJzaW9uO1xuICAgIH1cbiAgfSBjYXRjaCB7XG4gICAgLy8gU2lsZW50bHkgZmFpbCBpZiB2ZXJzaW9uIGRldGVjdGlvbiBmYWlsc1xuICB9XG5cbiAgcmV0dXJuICd1bmtub3duJztcbn1cblxuLyoqXG4gKiBHZXQgWW91VHViZSBmZWF0dXJlIGZsYWdzL2V4cGVyaW1lbnRzIGNvbmZpZ3VyYXRpb24gZnJvbSB3aW5kb3cueXRjZmdcbiAqL1xuZnVuY3Rpb24gZ2V0WW91VHViZUZlYXR1cmVGbGFncygpOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiB7XG4gIHRyeSB7XG4gICAgY29uc3QgeXRjZmcgPSB3aW5kb3cueXRjZmc7XG4gICAgaWYgKCF5dGNmZz8uZGF0YV8pIHtcbiAgICAgIHJldHVybiB7fTtcbiAgICB9XG5cbiAgICBjb25zdCBkYXRhID0geXRjZmcuZGF0YV8gYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG5cbiAgICAvLyBFWFBFUklNRU5UX0ZMQUdTIC0gZmVhdHVyZSBmbGFncyBsb2NhdGlvblxuICAgIGlmICgnRVhQRVJJTUVOVF9GTEFHUycgaW4gZGF0YSAmJiBkYXRhLkVYUEVSSU1FTlRfRkxBR1MpIHtcbiAgICAgIHJldHVybiBkYXRhLkVYUEVSSU1FTlRfRkxBR1MgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG4gICAgfVxuXG4gICAgcmV0dXJuIHt9O1xuICB9IGNhdGNoIHtcbiAgICAvLyBTaWxlbnRseSBmYWlsIGlmIGZlYXR1cmUgZmxhZ3MgZGV0ZWN0aW9uIGZhaWxzXG4gIH1cblxuICByZXR1cm4ge307XG59XG5cbi8qKlxuICogRXh0cmFjdCBicm93c2VyIG5hbWUgYW5kIHZlcnNpb24gZnJvbSBuYXZpZ2F0b3IgdXNlckFnZW50XG4gKi9cbmZ1bmN0aW9uIGdldEJyb3dzZXJWZXJzaW9uKCk6IHN0cmluZyB7XG4gIHRyeSB7XG4gICAgY29uc3QgdXNlckFnZW50ID0gbmF2aWdhdG9yLnVzZXJBZ2VudDtcbiAgICBpZiAoIXVzZXJBZ2VudCkge1xuICAgICAgcmV0dXJuICd1bmtub3duJztcbiAgICB9XG5cbiAgICAvLyBDaHJvbWUgKGNoZWNrIGJlZm9yZSBFZGdlIGFzIEVkZ2UgVUEgY29udGFpbnMgXCJDaHJvbWVcIilcbiAgICBjb25zdCBjaHJvbWVNYXRjaCA9IHVzZXJBZ2VudC5tYXRjaCgvQ2hyb21lXFwvKFtcXGQuXSspLyk7XG4gICAgaWYgKGNocm9tZU1hdGNoICYmICF1c2VyQWdlbnQuaW5jbHVkZXMoJ0VkZy8nKSkge1xuICAgICAgcmV0dXJuIGBDaHJvbWUvJHtjaHJvbWVNYXRjaFsxXX1gO1xuICAgIH1cblxuICAgIC8vIEVkZ2VcbiAgICBjb25zdCBlZGdlTWF0Y2ggPSB1c2VyQWdlbnQubWF0Y2goL0VkZ1xcLyhbXFxkLl0rKS8pO1xuICAgIGlmIChlZGdlTWF0Y2gpIHtcbiAgICAgIHJldHVybiBgRWRnZS8ke2VkZ2VNYXRjaFsxXX1gO1xuICAgIH1cblxuICAgIC8vIEZpcmVmb3hcbiAgICBjb25zdCBmaXJlZm94TWF0Y2ggPSB1c2VyQWdlbnQubWF0Y2goL0ZpcmVmb3hcXC8oW1xcZC5dKykvKTtcbiAgICBpZiAoZmlyZWZveE1hdGNoKSB7XG4gICAgICByZXR1cm4gYEZpcmVmb3gvJHtmaXJlZm94TWF0Y2hbMV19YDtcbiAgICB9XG5cbiAgICAvLyBTYWZhcmkgKGNoZWNrIFZlcnNpb24gZmlyc3QsIHRoZW4gU2FmYXJpKVxuICAgIGNvbnN0IHNhZmFyaVZlcnNpb25NYXRjaCA9IHVzZXJBZ2VudC5tYXRjaCgvVmVyc2lvblxcLyhbXFxkLl0rKS4qU2FmYXJpLyk7XG4gICAgaWYgKHNhZmFyaVZlcnNpb25NYXRjaCAmJiAhdXNlckFnZW50LmluY2x1ZGVzKCdDaHJvbWUnKSkge1xuICAgICAgcmV0dXJuIGBTYWZhcmkvJHtzYWZhcmlWZXJzaW9uTWF0Y2hbMV19YDtcbiAgICB9XG5cbiAgICAvLyBGYWxsYmFjazogcmV0dXJuIGZ1bGwgdXNlciBhZ2VudCBpZiBubyBtYXRjaFxuICAgIHJldHVybiB1c2VyQWdlbnQ7XG4gIH0gY2F0Y2gge1xuICAgIC8vIFNpbGVudGx5IGZhaWwgaWYgYnJvd3NlciB2ZXJzaW9uIGRldGVjdGlvbiBmYWlsc1xuICB9XG5cbiAgcmV0dXJuICd1bmtub3duJztcbn1cblxuLyoqXG4gKiBHZXQgZ2xvYmFsIG1ldGFkYXRhIG9iamVjdCB3aXRoIFlvdVR1YmUsIHNjcmlwdCwgYnJvd3NlciB2ZXJzaW9ucywgYW5kIGZlYXR1cmUgZmxhZ3NcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEdsb2JhbE1ldGFkYXRhKCk6IFJlY29yZDxzdHJpbmcsIHVua25vd24+IHtcbiAgY29uc3QgbWV0YWRhdGE6IFJlY29yZDxzdHJpbmcsIHVua25vd24+ID0ge1xuICAgIHlvdXR1YmVWZXJzaW9uOiBnZXRZb3VUdWJlVmVyc2lvbigpLFxuICAgIHNjcmlwdFZlcnNpb246IGdldFNjcmlwdFZlcnNpb24oKSxcbiAgICBicm93c2VyVmVyc2lvbjogZ2V0QnJvd3NlclZlcnNpb24oKSxcbiAgfTtcblxuICBjb25zdCBmZWF0dXJlRmxhZ3MgPSBnZXRZb3VUdWJlRmVhdHVyZUZsYWdzKCk7XG4gIGlmIChPYmplY3Qua2V5cyhmZWF0dXJlRmxhZ3MpLmxlbmd0aCA+IDApIHtcbiAgICBtZXRhZGF0YS55b3V0dWJlRmVhdHVyZUZsYWdzID0gZmVhdHVyZUZsYWdzO1xuICB9XG5cbiAgcmV0dXJuIG1ldGFkYXRhO1xufVxuIiwiaW1wb3J0IHsgTG9nZ2VyIH0gZnJvbSAnLi9sb2dnZXInO1xuaW1wb3J0IHsgTWluaVBsYXllckNvbnRyb2xsZXIgfSBmcm9tICcuL3VpL01pbmlQbGF5ZXJDb250cm9sbGVyJztcbmltcG9ydCB7IFBsYXllck1hbmFnZXIgfSBmcm9tICcuL2NvcmUvUGxheWVyTWFuYWdlcic7XG5pbXBvcnQgeyBOYXZpZ2F0aW9uSGFuZGxlciB9IGZyb20gJy4vY29yZS9OYXZpZ2F0aW9uSGFuZGxlcic7XG5pbXBvcnQgeyBQaVBNYW5hZ2VyIH0gZnJvbSAnLi9jb3JlL1BpUE1hbmFnZXInO1xuaW1wb3J0IHsgUmVzaXplVHJhY2tlciB9IGZyb20gJy4vdWkvUmVzaXplVHJhY2tlcic7XG5pbXBvcnQgeyBNZW51T2JzZXJ2ZXIgfSBmcm9tICcuL3VpL01lbnVPYnNlcnZlcic7XG5pbXBvcnQgeyBDb250ZXh0TWVudUhhbmRsZXIgfSBmcm9tICcuL3VpL0NvbnRleHRNZW51SGFuZGxlcic7XG5pbXBvcnQgeyBTZWVrSGFuZGxlciB9IGZyb20gJy4vaGFuZGxlcnMvU2Vla0hhbmRsZXInO1xuaW1wb3J0IHsgTGlrZUJ1dHRvbkhhbmRsZXIgfSBmcm9tICcuL2hhbmRsZXJzL0xpa2VCdXR0b25IYW5kbGVyJztcbmltcG9ydCB7IE1lZGlhU2Vzc2lvbkhhbmRsZXIgfSBmcm9tICcuL2hhbmRsZXJzL01lZGlhU2Vzc2lvbkhhbmRsZXInO1xuaW1wb3J0IHsgZ2V0R2xvYmFsTWV0YWRhdGEgfSBmcm9tICcuL3V0aWxzL1ZlcnNpb25EZXRlY3Rvcic7XG5pbXBvcnQgdHlwZSB7IFBpUENsZWFudXBDYWxsYmFjayB9IGZyb20gJy4vdHlwZXMvYXBwJztcblxuY29uc3QgbG9nZ2VyID0gTG9nZ2VyLmdldEluc3RhbmNlKCdNYWluJyk7XG5cbi8qKlxuICogSW5pdGlhbGl6ZSB0aGUgYXBwbGljYXRpb25cbiAqL1xuZnVuY3Rpb24gaW5pdGlhbGl6ZUFwcCgpOiB2b2lkIHtcbiAgTG9nZ2VyLnNldEdsb2JhbE1ldGFkYXRhKGdldEdsb2JhbE1ldGFkYXRhKCkpO1xuXG4gIGNvbnN0IGFwcCA9IG5ldyBZb3VUdWJlUGlQQXBwKCk7XG4gIGFwcC5pbml0aWFsaXplKCkuY2F0Y2goKGUpID0+IHtcbiAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGluaXRpYWxpemluZyBhcHBsaWNhdGlvbjonLCBlKTtcbiAgfSk7XG59XG5cbi8qKlxuICogTWFpbiBhcHBsaWNhdGlvbiBjbGFzc1xuICovXG5jbGFzcyBZb3VUdWJlUGlQQXBwIHtcbiAgcHJpdmF0ZSBtaW5pUGxheWVyQ29udHJvbGxlcjogTWluaVBsYXllckNvbnRyb2xsZXI7XG4gIHByaXZhdGUgcGxheWVyTWFuYWdlcjogUGxheWVyTWFuYWdlcjtcbiAgcHJpdmF0ZSBuYXZpZ2F0aW9uSGFuZGxlcjogTmF2aWdhdGlvbkhhbmRsZXI7XG4gIHByaXZhdGUgcGlwTWFuYWdlcjogUGlQTWFuYWdlcjtcbiAgcHJpdmF0ZSByZXNpemVUcmFja2VyOiBSZXNpemVUcmFja2VyO1xuICBwcml2YXRlIG1lbnVPYnNlcnZlcjogTWVudU9ic2VydmVyO1xuICBwcml2YXRlIGNvbnRleHRNZW51SGFuZGxlcjogQ29udGV4dE1lbnVIYW5kbGVyO1xuICBwcml2YXRlIHNlZWtIYW5kbGVyOiBTZWVrSGFuZGxlcjtcbiAgcHJpdmF0ZSBsaWtlQnV0dG9uSGFuZGxlcjogTGlrZUJ1dHRvbkhhbmRsZXI7XG4gIHByaXZhdGUgbWVkaWFTZXNzaW9uSGFuZGxlcjogTWVkaWFTZXNzaW9uSGFuZGxlcjtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLnBsYXllck1hbmFnZXIgPSBuZXcgUGxheWVyTWFuYWdlcigpO1xuICAgIHRoaXMubWluaVBsYXllckNvbnRyb2xsZXIgPSBuZXcgTWluaVBsYXllckNvbnRyb2xsZXIodGhpcy5wbGF5ZXJNYW5hZ2VyKTtcbiAgICB0aGlzLm5hdmlnYXRpb25IYW5kbGVyID0gbmV3IE5hdmlnYXRpb25IYW5kbGVyKCk7XG4gICAgdGhpcy5yZXNpemVUcmFja2VyID0gbmV3IFJlc2l6ZVRyYWNrZXIoKTtcbiAgICB0aGlzLm1lbnVPYnNlcnZlciA9IG5ldyBNZW51T2JzZXJ2ZXIoKTtcbiAgICB0aGlzLmNvbnRleHRNZW51SGFuZGxlciA9IG5ldyBDb250ZXh0TWVudUhhbmRsZXIoKTtcbiAgICB0aGlzLnNlZWtIYW5kbGVyID0gbmV3IFNlZWtIYW5kbGVyKCk7XG4gICAgdGhpcy5saWtlQnV0dG9uSGFuZGxlciA9IG5ldyBMaWtlQnV0dG9uSGFuZGxlcih0aGlzLnBsYXllck1hbmFnZXIpO1xuXG4gICAgdGhpcy5waXBNYW5hZ2VyID0gbmV3IFBpUE1hbmFnZXIoXG4gICAgICB0aGlzLm1pbmlQbGF5ZXJDb250cm9sbGVyLFxuICAgICAgdGhpcy5wbGF5ZXJNYW5hZ2VyLFxuICAgICAgdGhpcy5uYXZpZ2F0aW9uSGFuZGxlcixcbiAgICAgIChwaXBXaW5kb3csIG1pbmlwbGF5ZXIpID0+IHRoaXMuY3JlYXRlUGlQV2luZG93Q2FsbGJhY2socGlwV2luZG93LCBtaW5pcGxheWVyKVxuICAgICk7XG5cbiAgICB0aGlzLm1lZGlhU2Vzc2lvbkhhbmRsZXIgPSBuZXcgTWVkaWFTZXNzaW9uSGFuZGxlcih0aGlzLnBpcE1hbmFnZXIpO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGxiYWNrIGZvciBQaVBNYW5hZ2VyOiBpbml0IGhhbmRsZXJzIHdoZW4gUGlQIG9wZW5zLCByZXR1cm4gY2xlYW51cCBvbiBjbG9zZVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBjcmVhdGVQaVBXaW5kb3dDYWxsYmFjayhcbiAgICBwaXBXaW5kb3c6IFdpbmRvdyxcbiAgICBtaW5pcGxheWVyOiBFbGVtZW50XG4gICk6IFByb21pc2U8UGlQQ2xlYW51cENhbGxiYWNrPiB7XG4gICAgYXdhaXQgdGhpcy5pbml0aWFsaXplUGlQV2luZG93SGFuZGxlcnMocGlwV2luZG93LCBtaW5pcGxheWVyKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgdGhpcy5zZWVrSGFuZGxlci5jbGVhbnVwKCk7XG4gICAgICB0aGlzLmxpa2VCdXR0b25IYW5kbGVyLmNsZWFudXAoKTtcbiAgICAgIHRoaXMuY29udGV4dE1lbnVIYW5kbGVyLnN0b3AoKTtcbiAgICAgIHRoaXMubWVudU9ic2VydmVyLnN0b3AoKTtcbiAgICAgIHRoaXMucmVzaXplVHJhY2tlci5zdG9wKCk7XG4gICAgICB0aGlzLm5hdmlnYXRpb25IYW5kbGVyLmNsZWFudXAoKTtcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEluaXRpYWxpemUgdGhlIGFwcGxpY2F0aW9uXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgaW5pdGlhbGl6ZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBsb2dnZXIubG9nKCdJbml0aWFsaXppbmcgWW91VHViZSBQaVAgYXBwbGljYXRpb24nKTtcblxuICAgIC8vIEluaXRpYWxpemUgbWVkaWEgc2Vzc2lvbiBoYW5kbGVyXG4gICAgdGhpcy5tZWRpYVNlc3Npb25IYW5kbGVyLmluaXRpYWxpemUoKTtcblxuICAgIGxvZ2dlci5sb2coJ1lvdVR1YmUgUGlQIGFwcGxpY2F0aW9uIGluaXRpYWxpemVkJyk7XG4gIH1cblxuICAvKipcbiAgICogSW5pdGlhbGl6ZSBhbGwgaGFuZGxlcnMgZm9yIFBpUCB3aW5kb3dcbiAgICogQ2FsbGVkIHdoZW4gUGlQIHdpbmRvdyBpcyBvcGVuZWRcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgaW5pdGlhbGl6ZVBpUFdpbmRvd0hhbmRsZXJzKHBpcFdpbmRvdzogV2luZG93LCBtaW5pcGxheWVyOiBFbGVtZW50KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgbG9nZ2VyLmRlYnVnKCdJbml0aWFsaXppbmcgUGlQIHdpbmRvdyBoYW5kbGVycycpO1xuXG4gICAgLy8gSW5pdGlhbGl6ZSBoYW5kbGVyc1xuICAgIHRoaXMucmVzaXplVHJhY2tlci5zdGFydChtaW5pcGxheWVyLCBwaXBXaW5kb3cpO1xuICAgIC8vIFJ1biBpbiBiYWNrZ3JvdW5kIC0gbWF5IHdhaXQgaW5kZWZpbml0ZWx5IGZvciBtZW51IHRvIGFwcGVhclxuICAgIHZvaWQgdGhpcy5tZW51T2JzZXJ2ZXIuc3RhcnQocGlwV2luZG93KTtcbiAgICAvLyBSdW4gaW4gYmFja2dyb3VuZCAtIG1heSB3YWl0IGluZGVmaW5pdGVseSBmb3IgbWVudSB0byBhcHBlYXJcbiAgICB2b2lkIHRoaXMuY29udGV4dE1lbnVIYW5kbGVyLmluaXRpYWxpemUocGlwV2luZG93KTtcbiAgICB0aGlzLnNlZWtIYW5kbGVyLmluaXRpYWxpemUocGlwV2luZG93KTtcbiAgICB0aGlzLmxpa2VCdXR0b25IYW5kbGVyLmluaXRpYWxpemUocGlwV2luZG93KTtcblxuICAgIGxvZ2dlci5kZWJ1ZygnQWxsIFBpUCB3aW5kb3cgaGFuZGxlcnMgaW5pdGlhbGl6ZWQnKTtcbiAgfVxufVxuXG4vLyBJbml0aWFsaXplIGFwcGxpY2F0aW9uIHdoZW4gRE9NIGlzIHJlYWR5XG5pZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gJ2xvYWRpbmcnKSB7XG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBpbml0aWFsaXplQXBwKTtcbn0gZWxzZSB7XG4gIGluaXRpYWxpemVBcHAoKTtcbn1cbiJdLCJuYW1lcyI6WyJUSU1FT1VUUyIsIkRFRkFVTFRfRElNRU5TSU9OUyIsIlBMQVlFUl9TVEFURVMiLCJZVF9BQ1RJT05TIiwiV0VCX1BBR0VfVFlQRVMiLCJ0aW1lc3RhbXBGb3JtYXR0ZXIiLCJJbnRsIiwiRGF0ZVRpbWVGb3JtYXQiLCJ5ZWFyIiwibW9udGgiLCJkYXkiLCJob3VyIiwibWludXRlIiwic2Vjb25kIiwiaG91cjEyIiwiX0xvZ2dlciIsImNvbnN0cnVjdG9yIiwic2NvcGUiLCJ0aGlzIiwiZ2V0SW5zdGFuY2UiLCJzdG9yYWdlTGlzdGVuZXJBZGRlZCIsImVuYWJsZWQiLCJjaGVja0RlYnVnRmxhZyIsIndpbmRvdyIsImFkZEV2ZW50TGlzdGVuZXIiLCJpbnN0YW5jZSIsImluc3RhbmNlcyIsImdldCIsInNldCIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJzZXRHbG9iYWxNZXRhZGF0YSIsIm1ldGFkYXRhIiwiZ2xvYmFsTWV0YWRhdGEiLCJzdHlsZWQiLCJmbiIsIm1zZ1N0eWxlIiwibWVzc2FnZSIsIm1ldGEiLCJ0cyIsImRhdGUiLCJtcyIsIlN0cmluZyIsImdldE1pbGxpc2Vjb25kcyIsInBhZFN0YXJ0IiwiZm9ybWF0IiwicmVwbGFjZSIsImZvcm1hdFRpbWVzdGFtcCIsIkRhdGUiLCJlc2NhcGVkIiwiYXJncyIsInB1c2giLCJPYmplY3QiLCJrZXlzIiwibGVuZ3RoIiwibG9nIiwiY29uc29sZSIsImJpbmQiLCJ3YXJuIiwiZXJyb3IiLCJkZWJ1ZyIsIk1hcCIsIkxvZ2dlciIsIlNFTEVDVE9SUyIsImxvZ2dlciIsIk1pbmlQbGF5ZXJDb250cm9sbGVyIiwicGxheWVyTWFuYWdlciIsImlzVmlzaWJsZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImFjdGl2YXRlTWluaVBsYXllciIsInl0ZEFwcCIsImZpcmUiLCJhY3Rpb25OYW1lIiwicmV0dXJuVmFsdWUiLCJlIiwidG9nZ2xlTWluaVBsYXllciIsImZvcmNlSGlkZSIsInZpZGVvSWQiLCJnZXRWaWRlb0lkIiwiZW5kcG9pbnQiLCJ3YXRjaEVuZHBvaW50IiwiRE9NVXRpbHMiLCJjcmVhdGVQbGFjZWhvbGRlciIsImNvbW1lbnRUZXh0IiwiY3JlYXRlQ29tbWVudCIsImluc2VydFBsYWNlaG9sZGVyQmVmb3JlIiwiZWxlbWVudCIsInBsYWNlaG9sZGVyIiwicGFyZW50IiwicGFyZW50Tm9kZSIsImluc2VydEJlZm9yZSIsInJlc3RvcmVFbGVtZW50RnJvbVBsYWNlaG9sZGVyIiwicmVtb3ZlIiwiY29weUF0dHJpYnV0ZXMiLCJzb3VyY2UiLCJ0YXJnZXQiLCJBcnJheSIsImZyb20iLCJhdHRyaWJ1dGVzIiwiZm9yRWFjaCIsImF0dHIiLCJzZXRBdHRyaWJ1dGUiLCJub2RlTmFtZSIsIm5vZGVWYWx1ZSIsInVud3JhcCIsIndyYXBwZXIiLCJmaXJzdENoaWxkIiwicmVtb3ZlQ2hpbGQiLCJ3YWl0Rm9yRWxlbWVudFNlbGVjdG9yIiwic2VsZWN0b3IiLCJ0aW1lb3V0IiwidGFyZ2V0V2luZG93IiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJleGlzdGluZyIsIm9ic2VydmVyIiwiTXV0YXRpb25PYnNlcnZlciIsIl8iLCJvYnMiLCJkaXNjb25uZWN0IiwiYm9keSIsIm9ic2VydmUiLCJjaGlsZExpc3QiLCJzdWJ0cmVlIiwic2V0VGltZW91dCIsIkVycm9yIiwiY2xvc2VkIiwib25jZSIsIlBsYXllck1hbmFnZXIiLCJ3YXNQbGF5aW5nIiwiZ2V0UGxheWVyU3RhdGUiLCJwbGF5ZXIiLCJpc1BsYXlpbmciLCJzYXZlUGxheWluZ1N0YXRlIiwicmVzdG9yZVBsYXlpbmdTdGF0ZSIsInBsYXlWaWRlbyIsImdldFZpZGVvRGF0YSIsInZpZGVvRGF0YSIsInZpZGVvX2lkIiwid2FpdEZvck1haW5QbGF5ZXIiLCJ3YWl0Rm9yTWluaVBsYXllciIsIm1pbmlwbGF5ZXIiLCJyZXNldFN0YXRlIiwiTmF2aWdhdGlvbkhhbmRsZXIiLCJwaXBXaW5kb3ciLCJpbml0aWFsaXplIiwic2V0dXBDbGlja0hhbmRsZXIiLCJldmVudCIsImZvY3VzIiwiX2EiLCJjbG9zZXN0IiwiX2IiLCJocmVmIiwidXJsIiwiVVJMIiwicGFyYW1zIiwiZnJvbUVudHJpZXMiLCJzZWFyY2hQYXJhbXMiLCJwcmV2ZW50RGVmYXVsdCIsInN0b3BQcm9wYWdhdGlvbiIsInN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbiIsInN0YXRlIiwiY29tbWFuZE1ldGFkYXRhIiwid2ViQ29tbWFuZE1ldGFkYXRhIiwid2ViUGFnZVR5cGUiLCJyb290VmUiLCJ2IiwicGxheWxpc3RJZCIsImxpc3QiLCJpbmRleCIsInBhcnNlSW50IiwicGxheWVyUGFyYW1zIiwicHAiLCJlbnRyeVRpbWUiLCJwZXJmb3JtYW5jZSIsIm5vdyIsImRpc3BhdGNoRXZlbnQiLCJQb3BTdGF0ZUV2ZW50IiwiY2xlYW51cCIsIlN0eWxlVXRpbHMiLCJjb3B5U3R5bGVzIiwic291cmNlRG9jIiwidGFyZ2V0RG9jIiwic3R5bGVzIiwicXVlcnlTZWxlY3RvckFsbCIsIm5vZGUiLCJoZWFkIiwiYXBwZW5kQ2hpbGQiLCJjbG9uZU5vZGUiLCJpbmplY3RDU1NGaXhlcyIsInN0eWxlRml4IiwiY3JlYXRlRWxlbWVudCIsInRleHRDb250ZW50IiwiQXBwRXJyb3IiLCJjYXVzZSIsInN1cGVyIiwiY2FwdHVyZVN0YWNrVHJhY2UiLCJQaVBFcnJvciIsIm5hbWUiLCJQaVBNYW5hZ2VyIiwibWluaVBsYXllckNvbnRyb2xsZXIiLCJuYXZpZ2F0aW9uSGFuZGxlciIsIm9uV2luZG93UmVhZHkiLCJtaW5pUGxheWVyQ29udGFpbmVyIiwid2FzTWluaVBsYXllckFjdGl2ZUJlZm9yZVBpUCIsIm9uQmVmb3JlUmV0dXJuIiwiaXNPcGVuIiwiZ2V0V2luZG93Iiwib3BlbiIsIm1vdmVQbGF5ZXJUb1BJUCIsInJldHVyblBsYXllclRvTWFpbiIsInJlc3VsdCIsIndpZHRoIiwib2Zmc2V0V2lkdGgiLCJoZWlnaHQiLCJvZmZzZXRIZWlnaHQiLCJkcHAiLCJkb2N1bWVudFBpY3R1cmVJblBpY3R1cmUiLCJyZXF1ZXN0V2luZG93IiwicGlwRG9jIiwiZG9jdW1lbnRFbGVtZW50IiwidGl0bGUiLCJuYXZpZ2F0b3IiLCJtZWRpYVNlc3Npb24iLCJzZXRXaW5kb3dzVGl0bGUiLCJuZXdBcHAiLCJwaXBBcHAiLCJ5dERyYWdnYWJsZSIsInByZXBlbmQiLCJ2aWRlb1BsYXllciIsIm1vdmVQbGF5ZXJUb01haW4iLCJtaW5pcGxheWVyQ29udGFpbmVyIiwibmV3VGl0bGUiLCJ1cGRhdGVUaXRsZSIsIlJlc2l6ZVRyYWNrZXIiLCJzdGFydCIsInRhcmdldEVsZW1lbnQiLCJSZXNpemVPYnNlcnZlciIsImVudHJpZXMiLCJlbnRyeSIsImNvbnRlbnRSZWN0Iiwic2V0SW50ZXJuYWxTaXplIiwic2V0U2l6ZSIsImNhbGwiLCJFdmVudCIsImJ1YmJsZXMiLCJzdG9wIiwiTWVudU9ic2VydmVyIiwicmVtb3ZhbE9ic2VydmVyIiwicnVuT2JzZXJ2YXRpb24iLCJidXR0b24iLCJtdXRhdGlvbnMiLCJtdXRhdGlvbiIsImF0dHJpYnV0ZU5hbWUiLCJpc0V4cGFuZGVkIiwiZ2V0QXR0cmlidXRlIiwicGxheUxpc3RDb250YWluZXIiLCJjdXJyZW50SGVpZ2h0Iiwib3V0ZXJIZWlnaHQiLCJyZXNpemVUbyIsIm91dGVyV2lkdGgiLCJzdHlsZSIsImRpc3BsYXkiLCJhdHRyaWJ1dGVGaWx0ZXIiLCJpc0Nvbm5lY3RlZCIsIkNvbnRleHRNZW51SGFuZGxlciIsInZpc2liaWxpdHlPYnNlcnZlciIsImNvbnRleHRNZW51IiwiY29udGV4dE1lbnVQbGFjZWhvbGRlciIsInN0YXJ0TW9uaXRvcmluZyIsInNldHVwRGlzbWlzc2FsSGFuZGxlciIsImlzSW5NYWluV2luZG93Iiwic2ltdWxhdGVNYWluQ29udGV4dE1lbnUiLCJoYW5kbGVFdmVudCIsIm1lbnVJblBpcCIsIm1haW5BcHAiLCJNb3VzZUV2ZW50IiwiY2FuY2VsYWJsZSIsInZpZXciLCJjbGllbnRYIiwiY2xpZW50WSIsIlNlZWtIYW5kbGVyIiwic2V0dXBTZWVrSGFuZGxlciIsInByb2dyZXNzQmFyIiwicGVyZm9ybVNlZWsiLCJyZWN0IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwieCIsImxlZnQiLCJwZXJjZW50IiwiTWF0aCIsIm1heCIsIm1pbiIsImR1cmF0aW9uIiwiZ2V0RHVyYXRpb24iLCJzZWVrVGltZSIsInNlZWtUbyIsInRvRml4ZWQiLCJvbk1vdXNlTW92ZSIsIm1vdmVFdmVudCIsIm9uTW91c2VVcCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJZdEFjdGlvblNlbmRlciIsInNlbmQiLCJhY3Rpb25UeXBlIiwicmVzb2x2ZUNvbW1hbmQiLCJjb21tYW5kIiwibGlrZUVuZHBvaW50Iiwic3RhdHVzIiwiWVRfQUNUSU9OU19MSUtFIiwiWVRfQUNUSU9OU19ESVNMSUtFIiwiWVRfQUNUSU9OU19SRU1PVkUiLCJMaWtlQnV0dG9uSGFuZGxlciIsInl0QWN0aW9uU2VuZGVyIiwidG9nZ2xlQnV0dG9uIiwiYnV0dG9uQ29udGFpbmVyIiwicGFyZW50RWxlbWVudCIsImlzTGlrZUJ1dHRvbiIsImNoaWxkTm9kZXMiLCJpc0Rpc2xpa2VCdXR0b24iLCJpc1ByZXNzZWQiLCJfYyIsIkFwcEluaXRpYWxpemF0aW9uRXJyb3IiLCJNZWRpYVNlc3Npb25IYW5kbGVyIiwicGlwTWFuYWdlciIsInJlZ2lzdGVyQWN0aW9uSGFuZGxlciIsInNldHVwVGl0bGVTeW5jIiwic2V0QWN0aW9uSGFuZGxlciIsImNhdGNoIiwicHJvdG90eXBlIiwiZ2V0UHJvdG90eXBlT2YiLCJkZXNjIiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwiZGVmaW5lUHJvcGVydHkiLCJ2YWx1ZSIsImNvbmZpZ3VyYWJsZSIsImVudW1lcmFibGUiLCJnZXRZb3VUdWJlVmVyc2lvbiIsInl0Y2ZnIiwiZGF0YV8iLCJJTk5FUlRVQkVfQ09OVEVYVCIsImNsaWVudCIsImNsaWVudFZlcnNpb24iLCJnZXRCcm93c2VyVmVyc2lvbiIsInVzZXJBZ2VudCIsImNocm9tZU1hdGNoIiwibWF0Y2giLCJpbmNsdWRlcyIsImVkZ2VNYXRjaCIsImZpcmVmb3hNYXRjaCIsInNhZmFyaVZlcnNpb25NYXRjaCIsImdldEdsb2JhbE1ldGFkYXRhIiwieW91dHViZVZlcnNpb24iLCJzY3JpcHRWZXJzaW9uIiwiYnJvd3NlclZlcnNpb24iLCJmZWF0dXJlRmxhZ3MiLCJkYXRhIiwiRVhQRVJJTUVOVF9GTEFHUyIsImdldFlvdVR1YmVGZWF0dXJlRmxhZ3MiLCJ5b3V0dWJlRmVhdHVyZUZsYWdzIiwiaW5pdGlhbGl6ZUFwcCIsIllvdVR1YmVQaVBBcHAiLCJyZXNpemVUcmFja2VyIiwibWVudU9ic2VydmVyIiwiY29udGV4dE1lbnVIYW5kbGVyIiwic2Vla0hhbmRsZXIiLCJsaWtlQnV0dG9uSGFuZGxlciIsImNyZWF0ZVBpUFdpbmRvd0NhbGxiYWNrIiwibWVkaWFTZXNzaW9uSGFuZGxlciIsImluaXRpYWxpemVQaVBXaW5kb3dIYW5kbGVycyIsInJlYWR5U3RhdGUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O3lCQUtPLE1BR01BLEVBQ0csSUFXSEMsRUFDQSxJQURBQSxFQUVDLElBRkRBLEVBR1UsSUFJVkMsR0FDQSxFQURBQSxFQUdGLEVBT0VDLEVBQ0wsT0FES0EsRUFFRixVQUZFQSxFQUdILGNBSUdDLEVBQ0osc0JDeENIQyxFQUFxQixJQUFJQyxLQUFLQyxlQUFlLFFBQVMsQ0FDMURDLEtBQU0sVUFDTkMsTUFBTyxVQUNQQyxJQUFLLFVBQ0xDLEtBQU0sVUFDTkMsT0FBUSxVQUNSQyxPQUFRLFVBQ1JDLFFBQVEsSUFVVixNQXdCYUMsRUFBTixNQUFNQSxFQVFILFdBQUFDLENBQVlDLEdBQ2xCQyxLQUFLRCxNQUFRQSxDQUNmLENBS0Esa0JBQWNFLENBQVlGLEdBQ25CRixFQUFPSyx1QkFDVkwsRUFBT00sUUFBVU4sRUFBT08saUJBQ3hCQyxPQUFPQyxpQkFBaUIsVUFBVyxLQUNqQ1QsRUFBT00sUUFBVU4sRUFBT08sbUJBRTFCUCxFQUFPSyxzQkFBdUIsR0FHaEMsSUFBSUssRUFBV1YsRUFBT1csVUFBVUMsSUFBSVYsR0FLcEMsT0FKS1EsSUFDSEEsRUFBVyxJQUFJVixFQUFPRSxHQUN0QkYsRUFBT1csVUFBVUUsSUFBSVgsRUFBT1EsSUFFdkJBLENBQ1QsQ0FFQSxxQkFBZUgsR0FDYixJQUNFLE1BQTRDLFNBQXJDTyxhQUFhQyxRRDNFQSxvQkM0RXRCLENBQUEsTUFDRSxPQUFPLENBQ1QsQ0FDRixDQU1BLHdCQUFjQyxDQUFrQkMsR0FDOUJqQixFQUFPa0IsZUFBaUIsSUFBS0QsRUFDL0IsQ0FFUSxNQUFBRSxDQUNOQyxFQUNBQyxFQUNBQyxFQUNBQyxHQUVBLE1BQU1DLEVBckZWLFNBQXlCQyxHQUd2QixNQUFNQyxFQUFLQyxPQUFPRixFQUFLRyxtQkFBbUJDLFNB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
