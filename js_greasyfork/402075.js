// ==UserScript==
// @name         网易云课堂全屏
// @namespace    http://tampermonkey.net/
// @version      0.21
// @description  网易云课堂视频播放页使用网页全屏播放，方便观看
// @author       DESTINY 〆(791188716@qq.com)
// @match        https://course.study.163.com/*/lecture-*
// @grant        none
// @downloadURL https://update.greasyfork.org/scripts/402075/%E7%BD%91%E6%98%93%E4%BA%91%E8%AF%BE%E5%A0%82%E5%85%A8%E5%B1%8F.user.js
// @updateURL https://update.greasyfork.org/scripts/402075/%E7%BD%91%E6%98%93%E4%BA%91%E8%AF%BE%E5%A0%82%E5%85%A8%E5%B1%8F.meta.js
// ==/UserScript==

"use strict"; (function () { var a = "playerbox_full_viewport"; setTimeout(function () { var b = document.createElement("style"); b.innerHTML = "\n            .playerbox_full_viewport {\n                position: fixed;\n                left: 0;\n                top: 0;\n                bottom: 0;\n                right: 0;\n                z-index: 999999;\n            }\n            .j-fullviewport .icon-fullscreen {\n                background-image:url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxOCAxNy43NSI+PGRlZnM+PHN0eWxlPi5he2ZpbGw6Izk5OTt9PC9zdHlsZT48L2RlZnM+PHRpdGxlPui1hOa6kCAyPC90aXRsZT48cGF0aCBjbGFzcz0iYSIgZD0iTTE1LjI4LDE3Ljc1SDIuNzJBMi43OSwyLjc5LDAsMCwxLDAsMTQuODl2LTEyQTIuNzksMi43OSwwLDAsMSwyLjcyLDBIMTUuMjhBMi43OSwyLjc5LDAsMCwxLDE4LDIuODZ2MTJBMi43OSwyLjc5LDAsMCwxLDE1LjI4LDE3Ljc1Wk0yLjcyLDEuMThBMS42MywxLjYzLDAsMCwwLDEuMTMsMi44NnYxMmExLjYzLDEuNjMsMCwwLDAsMS41OSwxLjY4SDE1LjI4YTEuNjQsMS42NCwwLDAsMCwxLjYtMS42OHYtMTJhMS42NCwxLjY0LDAsMCwwLTEuNi0xLjY4WiIvPjxwYXRoIGNsYXNzPSJhIiBkPSJNMTUuNTMsMi43NWgtMy44YS4yMi4yMiwwLDAsMC0uMTYuMzhMMTMsNC41NSwxMC43MSw2LjgybDEsMUwxNCw1LjUxbDEuNDIsMS40MmEuMjIuMjIsMCwwLDAsLjM4LS4xNlYzQS4yMi4yMiwwLDAsMCwxNS41MywyLjc1WiIvPjxwYXRoIGNsYXNzPSJhIiBkPSJNMi40NywxNS4xM2gzLjhhLjIyLjIyLDAsMCwwLC4xNi0uMzhMNSwxMy4zM2wyLjI4LTIuMjgtMS0xTDQuMDUsMTIuMzYsMi42MywxMC45NGEuMjMuMjMsMCwwLDAtLjM4LjE2djMuOEEuMjIuMjIsMCwwLDAsMi40NywxNS4xM1oiLz48L3N2Zz4=') !important;\n                background-size: 16px 16px;\n                transform:scale(1.1);\n                transform-origin: center;\n            }\n            .j-unfullvierport .icon-fullscreen {\n                background-image:url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxOCAxNy43NSI+PGRlZnM+PHN0eWxlPi5he2ZpbGw6Izk5OTt9PC9zdHlsZT48L2RlZnM+PHRpdGxlPui1hOa6kCAzPC90aXRsZT48cGF0aCBjbGFzcz0iYSIgZD0iTTE1LjI4LDE3Ljc1SDIuNzJBMi43OSwyLjc5LDAsMCwxLDAsMTQuODl2LTEyQTIuNzksMi43OSwwLDAsMSwyLjcyLDBIMTUuMjhBMi43OSwyLjc5LDAsMCwxLDE4LDIuODZ2MTJBMi43OSwyLjc5LDAsMCwxLDE1LjI4LDE3Ljc1Wk0yLjcyLDEuMThBMS42MywxLjYzLDAsMCwwLDEuMTMsMi44NnYxMmExLjYzLDEuNjMsMCwwLDAsMS41OSwxLjY4SDE1LjI4YTEuNjQsMS42NCwwLDAsMCwxLjYtMS42OHYtMTJhMS42NCwxLjY0LDAsMCwwLTEuNi0xLjY4WiIvPjxwYXRoIGNsYXNzPSJhIiBkPSJNMTAuOTMsNy43OWgzLjhhLjIyLjIyLDAsMCwwLC4xNi0uMzhMMTMuNDcsNmwyLjI4LTIuMjctMS0xTDEyLjUxLDUsMTEuMDksMy42MWEuMjIuMjIsMCwwLDAtLjM4LjE2djMuOEEuMjIuMjIsMCwwLDAsMTAuOTMsNy43OVoiLz48cGF0aCBjbGFzcz0iYSIgZD0iTTcuMDcsMTAuMDlIMy4yN2EuMjIuMjIsMCwwLDAtLjE2LjM3bDEuNDIsMS40MkwyLjI1LDE0LjE2bDEsMSwyLjI3LTIuMjgsMS40MiwxLjQyYS4yMy4yMywwLDAsMCwuMzgtLjE2di0zLjhBLjIyLjIyLDAsMCwwLDcuMDcsMTAuMDlaIi8+PC9zdmc+') !important;\n            }\n            .j-fullviewport:hover{\n                background:none !important;\n            }\n            .j-fullviewport:hover .icon-fullscreen {\n                filter: brightness(1.5);\n            }\n"; b.setAttribute("type", "text/css"); document.head.appendChild(b); var h = null; function d() { var m = 0.25; var q = document.querySelector(".playerbox"); var l = q.classList.contains(a); if (l) { q.classList.remove(a);document.documentElement.style.overflow = ''; } else { var p = q.getBoundingClientRect(), o = p.x, n = p.y, i = p.width, r = p.height; var k = i / 2 + o; var j = r / 2 + n; q.style.transition = "none"; q.classList.add(a); q.style.transformOrigin = "0px 0px"; q.style.transform = "translate(".concat(o, "px, ").concat(n, "px) scale(").concat(i / window.innerWidth, ", ").concat(r / window.innerHeight, ")"); document.documentElement.style.overflow = 'hidden';setTimeout(function () { q.style.transition = "transform ".concat(m, "s ease"); setTimeout(function () { q.style.transform = "none" }) }); setTimeout(function () { q.style.transition = "none" }, m * 1000) } } function f() { var j; var k = document.querySelector("div.controlbar_btn.j-fullviewport"); function i() { var l = document.createElement("div"); l.className = "controlbar_btn j-fullviewport"; l.innerHTML = '\n<i class="u-edu-h5player-icon icon-fullscreen"></i>\n'; l.title = "网页全屏"; l.onclick = function (m) { if (document.fullscreen) { document.exitFullscreen() } d(); l.classList.toggle("j-unfullvierport") }; j.parentElement.insertBefore(l, j) } j = document.querySelector(".j-fullscreen"); if (!j && !h) { h = setInterval(function () { j = document.querySelector(".j-fullscreen"); if (j) { i(); clearInterval(h); h = null } }, 300); setTimeout(function () { clearInterval(h); h = null }, 2000) } else { if (!k) { i() } } } f();
function onBrowserUrlChange() { setTimeout(function () { f() }, 1.2 * 1000) } var e = window.history.pushState; var c = window.history.replaceState; window.history.pushState = function () { onBrowserUrlChange(); e.call.apply(e, [window.history].concat(Array.prototype.slice.call(arguments))) }; window.history.replaceState = function () { onBrowserUrlChange(); c.call.apply(c, [window.history].concat(Array.prototype.slice.call(arguments))) } }) })();