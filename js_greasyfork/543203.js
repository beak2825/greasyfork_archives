// ==UserScript==
// @name         Allegro+
// @namespace    http://tampermonkey.net/
// @version      1.2
// @description  Pakiet usprawnien do Allegro.pl
// @author       Pawe≈Ç Kaczmarek
// @match        https://allegro.pl/uzytkownik/*/oceny*
// @match        https://allegro.pl/my-assortment*
// @match        https://allegro.pl/listing?string=*
// @match        https://allegro.pl/produkt/*
// @match        https://allegro.pl/kategoria/*
// @match        https://allegro.pl/oferty-produktu/*
// @match        https://allegro.pl/uzytkownik/*
// @match        https://allegro.pl/oferta/*
// @match        https://salescenter.allegro.com/campaigns*
// @grant        GM_download
// @grant        GM_xmlhttpRequest
// @grant        GM_setClipboard
// @require      https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js
// @downloadURL https://update.greasyfork.org/scripts/543203/Allegro%2B.user.js
// @updateURL https://update.greasyfork.org/scripts/543203/Allegro%2B.meta.js
// ==/UserScript==

!function(){const e=[{key:"oceny",label:"Raport z ocen"},{key:"filtr",label:"Lepszy filtr"},{key:"info",label:"vSprint info"},{key:"img",label:"vSprint Image Downloader"},{key:"kampanie",label:"Asystent Kampanii"},{key:"kampFiltr",label:"Filtr ofert w kampaniach"},{key:"kopiujId",label:"Kopiuj ID"},{key:"edytuj",label:"Edytuj"}];window.vSprintPlusSettings=function(){let t={};try{t=JSON.parse(localStorage.getItem("vSprintPlusSettings")||"{}")}catch(e){}return e.forEach((e=>{void 0===t[e.key]&&(t[e.key]=!0)})),t}()}(),function(){"use strict";if(window.vSprintPlusSettings&&!1===window.vSprintPlusSettings.oceny)return;if(!window.location.href.match(/^https:\/\/allegro\.pl\/uzytkownik\/[^\/]+\/oceny/))return;let e=null,t=!1,n=!1;function o(){if(document.getElementById("allegro-report-btn"))return;const t=document.createElement("button");t.id="allegro-report-btn",t.textContent="Raport",t.style.position="fixed",t.style.top="10px",t.style.right="20px",t.style.zIndex="99999",t.style.background="#23272e",t.style.color="#fff",t.style.border="1.5px solid #ff5a00",t.style.borderRadius="8px",t.style.padding="10px 20px",t.style.fontSize="16px",t.style.cursor="pointer",t.style.boxShadow="0 2px 8px rgba(0,0,0,0.10)",t.style.fontWeight="bold",t.style.transition="background 0.2s, color 0.2s",t.onmouseenter=function(){t.style.background="#ff5a00",t.style.color="#fff"},t.onmouseleave=function(){t.style.background="#23272e",t.style.color="#fff"},t.onclick=function(){n&&e?function(){if(document.getElementById("allegro-report-modal"))return;const t=document.createElement("div");t.id="allegro-report-modal",t.style.position="fixed",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.background="#fff",t.style.border="1px solid #ddd",t.style.borderRadius="10px",t.style.boxShadow="0 2px 16px rgba(0,0,0,0.18)",t.style.padding="24px",t.style.zIndex="100000",t.style.minWidth="320px";const n=document.createElement("div");n.textContent="Raport Produkt√≥w z Ocen",n.style.fontWeight="600",n.style.fontSize="20px",n.style.marginBottom="25px",n.style.color="#2c3e50",n.style.textAlign="center",n.style.borderBottom="2px solid #f8f9fa",n.style.paddingBottom="15px",t.appendChild(n);const o=document.createElement("label");o.textContent="Liczba stron do przetworzenia (max 20):",o.style.display="block",o.style.marginBottom="10px",o.style.color="#000",t.appendChild(o);const r=document.createElement("input");r.type="number",r.min="1",r.max="20",r.value="5",r.style.width="100%",r.style.padding="12px 16px",r.style.border="2px solid #e1e5e9",r.style.borderRadius="8px",r.style.marginBottom="20px",r.style.fontSize="16px",r.style.color="#333",r.style.backgroundColor="#fff",r.style.boxSizing="border-box",r.style.transition="border-color 0.2s ease, box-shadow 0.2s ease",r.style.outline="none",r.addEventListener("focus",(function(){this.style.borderColor="#ff5a00",this.style.boxShadow="0 0 0 3px rgba(255, 90, 0, 0.1)"})),r.addEventListener("blur",(function(){this.style.borderColor="#e1e5e9",this.style.boxShadow="none"})),t.appendChild(r);const a=document.createElement("button");a.textContent="Pobierz Raport",a.style.background="#ff5a00",a.style.color="#fff",a.style.border="none",a.style.borderRadius="6px",a.style.padding="10px 20px",a.style.fontSize="16px",a.style.cursor="pointer",a.style.marginRight="10px",a.onclick=function(){const t=parseInt(r.value);t<1||t>20?alert("Liczba stron musi byƒá miƒôdzy 1 a 20"):async function(t){if(!e)return void alert("Nie uda≈Ço siƒô pobraƒá ID sprzedawcy");const n=document.getElementById("allegro-report-modal"),o=n.querySelector("button");o.textContent="Pobieranie...",o.disabled=!0;const r=document.createElement("div");r.style.marginTop="15px",r.style.marginBottom="15px";const a=document.createElement("div");a.textContent="Pobieranie danych... (0/"+t+")",a.style.textAlign="center",a.style.marginBottom="10px",a.style.color="#666";const s=document.createElement("div");s.style.width="100%",s.style.height="20px",s.style.backgroundColor="#f0f0f0",s.style.borderRadius="10px",s.style.overflow="hidden";const i=document.createElement("div");i.style.width="0%",i.style.height="100%",i.style.backgroundColor="#ff5a00",i.style.transition="width 0.3s ease",s.appendChild(i),r.appendChild(a),r.appendChild(s),n.appendChild(r);try{const n=[];for(let o=1;o<=t;o++){a.textContent=`Pobieranie danych... (${o}/${t})`,i.style.width=o/t*100+"%";const r=await fetch(`https://edge.allegro.pl/ratings-api/sellers/${e}/ratings?page=${o}`,{headers:{accept:"application/vnd.allegro.public.v5+json","accept-language":"pl-PL","content-type":"application/vnd.allegro.public.v5+json",priority:"u=1, i","sec-ch-ua":'"Not)A;Brand";v="8", "Chromium";v="138", "Google Chrome";v="138"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-site"},referrer:"https://allegro.pl/",method:"GET",mode:"cors",credentials:"include"});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const s=await r.json();if(n.push(...s.content),console.log(`‚úÖ Pobrano stronƒô ${o}/${t} (${s.content.length} ocen)`),o<t){const e=3e3*Math.random()+1e3;console.log(`‚è≥ Czekam ${Math.round(e)}ms przed nastƒôpnym requestem...`),a.textContent=`Czekam... (${o}/${t})`,await new Promise((t=>setTimeout(t,e)))}}a.textContent="Analizowanie danych...",i.style.width="100%";const r={};n.forEach((e=>{if(e.offers&&e.offers.length>1)for(let t=1;t<e.offers.length;t++){const n=e.offers[t],o=`${n.id}_${n.title}`;r[o]||(r[o]={id:n.id,title:n.title,count:0}),r[o].count++}})),a.textContent="Generowanie raportu...";const s=[["ID Oferty","Nazwa Oferty","Ilo≈õƒá Dobra≈Ñ"]];Object.values(r).sort(((e,t)=>t.count-e.count)).forEach((e=>{s.push([e.id,e.title,e.count])}));const l=XLSX.utils.book_new(),d=XLSX.utils.aoa_to_sheet(s);XLSX.utils.book_append_sheet(l,d,"Raport Oceny");const c=XLSX.write(l,{bookType:"xlsx",type:"array"}),p=new Blob([c],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),u=document.createElement("a");u.href=URL.createObjectURL(p),u.download=`raport_oceny_${(new Date).toISOString().split("T")[0]}.xlsx`,u.click(),a.textContent="Raport wygenerowany!",o.textContent="Pobierz Raport",o.disabled=!1,console.log(`‚úÖ Raport wygenerowany: ${Object.keys(r).length} produkt√≥w`)}catch(e){console.error("B≈ÇƒÖd podczas generowania raportu:",e),alert("WystƒÖpi≈Ç b≈ÇƒÖd podczas generowania raportu: "+e.message),o.textContent="Pobierz Raport",o.disabled=!1}}(t)},t.appendChild(a);const s=document.createElement("button");s.textContent="Zamknij",s.style.background="#ccc",s.style.color="#000",s.style.border="none",s.style.borderRadius="6px",s.style.padding="10px 20px",s.style.fontSize="16px",s.style.cursor="pointer",s.onclick=function(){t.remove()},t.appendChild(s),document.body.appendChild(t)}():alert("Przejd≈∫ na kolejnƒÖ stronƒô aby m√≥c wygenerowaƒá raport")},document.body.appendChild(t)}function r(){console.log("üîç Sprawdzam aktywnych request√≥w...");const t=performance.getEntriesByType("resource").filter((e=>e.name.includes("ratings-api/sellers/")&&e.name.includes("/ratings")));if(console.log("Znalezione requesty ratings:",t),t.length>0){const o=t[t.length-1].name.match(/sellers\/(\d+)\/ratings/);if(o){const t=o[1];if(console.log("‚úÖ Znaleziono ID sprzedawcy w Network:",t),!e||e!==t){e=t,n=!0,console.log("‚úÖ ID sprzedawcy zaktualizowane z Network:",e);const o=document.getElementById("allegro-report-btn");o&&(o.style.background="#28a745",o.textContent="Raport (Pobierz)",console.log("‚úÖ Przycisk zmieniony na zielony z Network"))}}}}e=window.location.pathname.match(/\/uzytkownik\/([^\/]+)\/oceny/)?"92089972":null,o(),function(){const e=new URLSearchParams(window.location.search).get("page");e&&parseInt(e)>=2&&(t=!0,console.log("Wykryto drugƒÖ stronƒô, czekam na fetch..."))}(),function(){const t=window.fetch;window.fetch=function(...o){const r=o[0];console.log("=== FETCH REQUEST WYKRYTY ==="),console.log("URL:",r),console.log("Typ URL:",typeof r);const a=[/edge\.allegro\.pl\/ratings-api\/sellers\/(\d+)\/ratings/,/ratings-api\/sellers\/(\d+)\/ratings/,/sellers\/(\d+)\/ratings/];let s=null;for(const e of a)if("string"==typeof r&&(s=r.match(e),s)){console.log("Znaleziono match z patternem:",e);break}if(s){const t=s[1];if(console.log("Nowe ID sprzedawcy:",t),console.log("Aktualne ID sprzedawcy:",e),!e||e!==t){e=t,n=!0,console.log("‚úÖ ID sprzedawcy zaktualizowane:",e);const o=document.getElementById("allegro-report-btn");o?(o.style.background="#28a745",o.textContent="Raport (Pobierz)",console.log("‚úÖ Przycisk zmieniony na zielony")):console.log("‚ùå Przycisk nie zosta≈Ç znaleziony")}}else console.log("‚ùå Nie znaleziono ID sprzedawcy w URL:",r);return t.apply(this,o)}}(),function(){const t=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(o,r,...a){console.log("=== XHR REQUEST WYKRYTY ==="),console.log("URL:",r),console.log("Method:",o);const s=[/edge\.allegro\.pl\/ratings-api\/sellers\/(\d+)\/ratings/,/ratings-api\/sellers\/(\d+)\/ratings/,/sellers\/(\d+)\/ratings/];let i=null;for(const e of s)if("string"==typeof r&&(i=r.match(e),i)){console.log("Znaleziono match z patternem (XHR):",e);break}if(i){const t=i[1];if(console.log("Nowe ID sprzedawcy (XHR):",t),!e||e!==t){e=t,n=!0,console.log("‚úÖ ID sprzedawcy zaktualizowane (XHR):",e);const o=document.getElementById("allegro-report-btn");o&&(o.style.background="#28a745",o.textContent="Raport (Pobierz)",console.log("‚úÖ Przycisk zmieniony na zielony (XHR)"))}}return t.apply(this,[o,r,...a])}}(),function(){let t=window.location.href;setInterval((()=>{if(window.location.href!==t){t=window.location.href,console.log("üîÑ URL zmieniony na:",t);const o=new URLSearchParams(window.location.search).get("page");o&&parseInt(o)>=2&&(console.log("üìÑ Wykryto przej≈õcie na stronƒô:",o),setTimeout((()=>{r()}),500),setTimeout((()=>{n||(console.log("‚ö†Ô∏è Fetch nie zosta≈Ç wykryty po 1 sekundzie"),console.log("Aktualny sellerId:",e),console.log("fetchDetected:",n),r())}),1e3))}}),500)}(),console.log("üöÄ Skrypt Allegro Oceny Analizator zainicjalizowany"),console.log("üìä Aktualny sellerId:",e),console.log("üëÄ Czekam na fetch requesty...")}(),function(){"use strict";if(window.vSprintPlusSettings&&!1===window.vSprintPlusSettings.filtr)return;function e(e){if(document.getElementById("allegro-id-filter-panel")||document.getElementById("allegro-vsearch-btn"))return;const o=document.createElement("button");o.id="allegro-vsearch-btn",o.innerText="vSearch",o.style.position="absolute",o.style.top="10px",o.style.right="30px",o.style.zIndex="10001",o.style.background="#23272e",o.style.color="#fff",o.style.border="none",o.style.padding="8px 18px",o.style.fontSize="16px",o.style.borderRadius="8px",o.style.boxShadow="0 2px 8px rgba(0,0,0,0.18)",o.style.cursor="pointer",o.style.letterSpacing="1px",o.style.fontWeight="bold",o.style.transition="background 0.2s",o.onmouseenter=()=>o.style.background="#ff5a00",o.onmouseleave=()=>o.style.background="#23272e",o.onclick=function(){o.style.display="none",r.style.display="flex",setTimeout((()=>i.focus()),100)},e.parentElement.style.position="relative",e.parentElement.insertBefore(o,e);const r=document.createElement("div");r.id="allegro-id-filter-panel",r.style.background="#23272e",r.style.border="1px solid #ff5a00",r.style.padding="18px 24px",r.style.margin="16px 0",r.style.marginTop="60px",r.style.borderRadius="12px",r.style.display="none",r.style.alignItems="center",r.style.gap="16px",r.style.boxShadow="0 4px 24px rgba(0,0,0,0.18)",r.style.position="relative",r.style.zIndex="10000",r.style.removeProperty("max-width"),r.style.minWidth="340px";const a=document.createElement("button");a.innerText="‚úï",a.title="Zamknij",a.style.position="absolute",a.style.top="2px",a.style.right="2px",a.style.background="transparent",a.style.color="#fff",a.style.border="none",a.style.fontSize="22px",a.style.cursor="pointer",a.style.fontWeight="bold",a.style.padding="4px 8px",a.onmouseenter=()=>a.style.color="#ff5a00",a.onmouseleave=()=>a.style.color="#fff",a.onclick=function(){r.style.display="none",o.style.display="inline-block"},r.appendChild(a);const s=document.createElement("label");s.innerText="Filtruj ID/SKU produktu:",s.style.fontWeight="bold",s.style.marginRight="8px",s.style.color="#fff",s.htmlFor="allegro-id-filter-input";const i=document.createElement("input");i.type="text",i.id="allegro-id-filter-input",i.placeholder="np. 1772318739, SKU1234",i.title="np. 1772318739, SKU1234",i.style.padding="10px 16px",i.style.fontSize="18px",i.style.border="1px solid #ff5a00",i.style.borderRadius="6px",i.style.flex="1",i.style.background="#181a1f",i.style.color="#fff",i.style.outline="none",i.onfocus=()=>i.style.border="1.5px solid #ff5a00",i.onblur=()=>i.style.border="1px solid #ff5a00";const l=document.createElement("button");l.innerText="Filtruj",l.style.background="#ff5a00",l.style.color="#fff",l.style.border="none",l.style.padding="10px 28px",l.style.fontSize="14px",l.style.borderRadius="6px",l.style.cursor="pointer",l.style.marginLeft="8px",l.style.fontWeight="bold",l.style.boxShadow="0 2px 8px rgba(0,0,0,0.10)",l.onmouseenter=()=>l.style.background="#23272e",l.onmouseleave=()=>l.style.background="#ff5a00";const d=document.createElement("button");d.innerText="Poka≈º wszystko",d.style.background="#444",d.style.color="#fff",d.style.border="none",d.style.padding="10px 18px",d.style.fontSize="14px",d.style.borderRadius="6px",d.style.cursor="pointer",d.style.marginLeft="8px",d.style.fontWeight="bold",d.onmouseenter=()=>d.style.background="#ff5a00",d.onmouseleave=()=>d.style.background="#444",r.appendChild(s),r.appendChild(i),r.appendChild(l),r.appendChild(d),e.parentElement.insertBefore(r,e);const c=document.createElement("div");c.style.display="flex",c.style.alignItems="center",c.style.gap="8px",c.style.margin="0 0 8px 0",c.style.fontSize="15px",c.style.fontWeight="bold",c.style.color="#fff",c.style.background="transparent",c.style.userSelect="none";const p=document.createElement("input");p.type="checkbox",p.id="allegro-select-all-visible",p.style.width="18px",p.style.height="18px",p.style.cursor="pointer",p.style.accentColor="#ff5a00",p.style.margin="0";const u=document.createElement("label");function y(){p.checked=!1}function f(){const o=i.value.trim();if(!o)return t(e),void y();const r=o.replace(/\s+/g,",").split(",").map((e=>e.trim())).filter(Boolean);n(e,r),y()}u.innerText="zaznacz wyszukane",u.htmlFor="allegro-select-all-visible",u.style.cursor="pointer",c.appendChild(p),c.appendChild(u),e.parentElement.insertBefore(c,e),p.addEventListener("change",(function(){!function(t){const n=e.querySelector("tbody");n&&Array.from(n.querySelectorAll("tr")).forEach((e=>{if("none"===e.style.display)return;const n=e.querySelector("td");if(!n)return;const o=n.querySelector('input[type="checkbox"]');o&&!o.disabled&&o.checked!==t&&o.click()}))}(this.checked)})),l.onclick=f,i.addEventListener("keydown",(function(e){"Enter"===e.key&&f()})),i.addEventListener("input",function(e,t){let n;return function(...o){clearTimeout(n),n=setTimeout((()=>e.apply(this,o)),t)}}(f,500)),d.onclick=function(){i.value="",t(e)}}function t(e){const t=e.querySelector("tbody");t&&Array.from(t.querySelectorAll("tr")).forEach((e=>{e.style.display=""}))}function n(e,t){const n=e.querySelector("tbody");n&&Array.from(n.querySelectorAll("tr")).forEach((e=>{const n=e.hasAttribute("data-cy"),o=e.querySelectorAll("span._b4f97_bk6uO");if(!n&&0===o.length)return;let r=null;n&&(r=e.getAttribute("data-cy"));let a=null;o.length>1?a=o[1].innerText.trim():1===o.length&&(a=o[0].innerText.trim());let s=!1;for(const e of t)if(r&&r===e||a&&a.toLowerCase().includes(e.toLowerCase())){s=!0;break}e.style.display=s?"":"none"}))}function o(){const o=document.querySelector('table[aria-label="lista ofert"]');if(o){e(o);const r=o.querySelector("tbody");if(r&&!r._allegroFilterObserver){const e=new MutationObserver((()=>{const e=document.getElementById("allegro-id-filter-input");if(!e)return;const r=e.value.trim();if(!r)return void t(o);const a=r.replace(/\s+/g,",").split(",").map((e=>e.trim())).filter(Boolean);n(o,a)}));e.observe(r,{childList:!0,subtree:!0}),r._allegroFilterObserver=e}}}new MutationObserver((()=>{o()})).observe(document.body,{childList:!0,subtree:!0}),window.addEventListener("load",(()=>{setTimeout(o,1e3)}))}(),function(){"use strict";var e;window.vSprintPlusSettings&&!1===window.vSprintPlusSettings.info||((e=document.createElement("style")).textContent='\n\n                .date-container {\n                    margin-bottom: 20px;\n                }\n                .date-container label {\n                    display: block;\n                    margin-bottom: 5px;\n                }\n                .date-container input {\n                    width: 95%;\n                    padding: 12px;\n                    border: 1px solid #ddd;\n                    border-radius: 5px;\n                    font-size: 16px;\n                }\n                #fetch-data-btn, #showEntriesBtn, .show-successful-stats, .show-total-stats, .product-btn {\n                    padding: 10px 15px;\n                    color: #fff;\n                    border: none;\n                    border-radius: 5px;\n                    cursor: pointer;\n                    text-decoration: none;\n                }\n\n                #fetch-data-btn{\n                margin-left:5px;\n                }\n\n\n\n    .date-button {\n            padding: 10px 15px;\n            color: #fff;\n            border: none;\n            border-radius: 5px;\n            cursor: pointer;\n            margin-left: 5px;\n            margin-top: 5px;\n    }\n\n    .date-button:hover{\n    background-color: #0056b3;}\n\n    .DataButton-container{\n    padding-bottom: 10px;\n    }\n\n    .prom-efficiency {\n        margin: 40px 0px 20px 0px;\n        font-family: Arial, sans-serif;\n    }\n\n    .prom-efficiency table {\n        width: 100%;\n        border-collapse: collapse;\n        margin-top: 20px;\n    }\n\n    .prom-efficiency thead {\n        background-color: #878c91;\n        color: white;\n    }\n\n    .prom-efficiency th,\n    .prom-efficiency td {\n        padding: 12px 15px;\n        text-align: left;\n        border: 1px solid #ddd;\n    }\n\n    .prom-efficiency tr:nth-child(even) {\n        background-color: #f2f2f2;\n    }\n\n    .prom-efficiency h3 {\n        margin-bottom: 10px;\n    }\n\n    .prom-efficiency td:first-child {\n        font-weight: bold;\n    }\n    #statystyka-content h3{\n        background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);\n        color: white; /* Kolor tekstu */\n        padding: 10px; /* Wype≈Çnienie wewnƒôtrzne */\n        border-top-left-radius: 8px; /* ZaokrƒÖglenie lewego g√≥rnego rogu */\n        border-top-right-radius: 8px; /* ZaokrƒÖglenie prawego g√≥rnego rogu */\n        margin: -15px -15px 15px -15px; /* Negatywne marginesy, aby nag≈Ç√≥wek wkomponowa≈Ç siƒô w ramkƒô */\n        font-size: 0.9em; /* Zwiƒôkszenie rozmiaru czcionki */\n        font-weight: bold; /* Ustawienie czcionki na pogrubionƒÖ */\n        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); /* Cie≈Ñ tekstu */\n        }\n\n        #statystyka-content button, .product-btn {\n            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);\n        }\n\n        #statystyka-content .date-button {\n            background-color: grey !important;\n            background: none;\n        }\n\n\n        .total-stats, .successful-stats{\n            margin-top:40px;\n        }\n\n        .section-title {\n            margin-top: 0;\n            font-size: 1.2em;\n            position: relative; /* Umo≈ºliwia pozycjonowanie pseudo-elementu */\n        }\n\n        .section-title::after {\n            content: ""; /* Pusty zawarto≈õƒá, tworzy liniƒô */\n            display: block; /* Umo≈ºliwia ustawienie wysoko≈õci */\n            width: 100%; /* D≈Çugo≈õƒá linii */\n            height: 2px; /* Grubo≈õƒá linii */\n            background: #ccc; /* Kolor linii */\n            margin-top: 5px; /* Odstƒôp od nag≈Ç√≥wka */\n        }\n\n        ',document.head.appendChild(e),window.addEventListener("load",(function(){let e;t(),setInterval(t,1e3);const n=new MutationObserver((function(n){let o=!1;n.forEach((function(e){if("childList"===e.type&&e.addedNodes.length>0)for(let t of e.addedNodes)if(1===t.nodeType&&t.matches&&(t.matches("article")||t.matches("li")||t.querySelector("article"))){o=!0;break}})),o&&(clearTimeout(e),e=setTimeout((()=>{t()}),300))})),o=document.querySelector("div[data-role='rightItems']");o&&n.observe(o,{childList:!0,subtree:!0,attributes:!1,characterData:!1});const r=document.querySelector("main, [data-role='main'], .opbox-listing");r&&n.observe(r,{childList:!0,subtree:!0,attributes:!1,characterData:!1})})));function t(){document.querySelectorAll("div[data-role='rightItems'] article, .sponsored-article-selector article, li article").forEach((function(e){if(!e.querySelector("button.statystyka-btn")){var t=e.textContent.includes("Sponsorowane");if(!(window.vSprintPlusSettings&&!1!==window.vSprintPlusSettings.edytuj&&e.querySelector("button.edytuj-btn")||window.vSprintPlusSettings&&!1!==window.vSprintPlusSettings.kopiujId&&e.querySelector("button.copy-id-btn"))){var i=function(e){var t=e.querySelector("a[href*='/oferta/']");if(t){return t.getAttribute("href").split("-").pop()}for(var n=e.querySelectorAll("a"),o=0;o<n.length;o++){var r=n[o].getAttribute("href");if(r&&r.includes("redirect="))try{var a=decodeURIComponent(r).match(/allegro\.pl\/oferta\/([^?]+)/);if(a)return a[1].split("-").pop()}catch(e){}}return null}(e),l=function(e){var t=e.querySelector("h2");return t?t.textContent.trim():""}(e);if(t&&!i){console.log("‚ùå Nie mo≈ºna pobraƒá ID z oferty sponsorowanej:",e);var d=e.querySelectorAll("a");console.log("üîó Znalezione linki:",d.length),d.forEach((function(e,t){console.log(`Link ${t}:`,e.href)}))}if(i){var c=null;window.vSprintPlusSettings&&!1!==window.vSprintPlusSettings.edytuj&&((c=document.createElement("button")).className="edytuj-btn",c.innerHTML="Edytuj",c.style.position="absolute",c.style.right="0px",c.style.bottom="142px",c.style.padding="10px 16px",c.style.backgroundColor="#6c757d",c.style.color="#fff",c.style.border="none",c.style.borderRadius="5px",c.style.cursor="pointer",c.style.zIndex="200",c.style.fontSize="12px");var p=null;window.vSprintPlusSettings&&!1!==window.vSprintPlusSettings.kopiujId&&((p=document.createElement("button")).className="copy-id-btn",p.innerHTML="Kopiuj ID",p.style.position="absolute",p.style.right="0px",p.style.bottom="102px",p.style.padding="10px 16px",p.style.backgroundColor="#28a745",p.style.color="#fff",p.style.border="none",p.style.borderRadius="5px",p.style.cursor="pointer",p.style.zIndex="200",p.style.fontSize="12px");var u=document.createElement("button");u.className="statystyka-btn",u.innerHTML="Statystyka",u.style.position="absolute",u.style.right="0px",u.style.bottom="62px",u.style.padding="10px 20px",u.style.backgroundColor="#007bff",u.style.color="#fff",u.style.border="none",u.style.borderRadius="5px",u.style.cursor="pointer",u.style.zIndex="200",e.style.position="relative",c&&e.appendChild(c),p&&e.appendChild(p),e.appendChild(u),c&&c.addEventListener("click",(function(e){e.stopPropagation(),function(e){if(!e)return void o("Nie uda≈Ço siƒô pobraƒá ID oferty","error");const t=`https://salescenter.allegro.com/offer/${e}`;window.open(t,"_blank"),o("Otwieranie strony edycji oferty...","success")}(i)})),p&&p.addEventListener("click",(function(e){var t;e.stopPropagation(),t=i,"undefined"!=typeof GM_setClipboard?(GM_setClipboard(t),o("ID skopiowane do schowka!")):navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(t).then((function(){o("ID skopiowane do schowka!")})).catch((function(e){console.error("B≈ÇƒÖd kopiowania do schowka:",e),n(t)})):n(t)})),u.addEventListener("click",(function(e){e.stopPropagation(),function(e,t){var n=document.querySelector("#statystyka-modal");if(n)n.style.transform="translateX(0)";else{var o=document.createElement("div");o.id="statystyka-modal",o.style.position="fixed",o.style.top="0",o.style.right="0",o.style.width="35%",o.style.height="100%",o.style.backgroundColor="#ffffff",o.style.overflowY="auto",o.style.boxShadow="0 0 10px rgba(0, 0, 0, 0.2)",o.style.transform="translateX(100%)",o.style.transition="transform 0.3s ease",o.style.zIndex="10000",o.style.color="#333",o.style.fontFamily="Arial, sans-serif";var i=document.createElement("div");i.style.padding="20px",i.style.position="relative",i.style.lineHeight="1.6";var l=document.createElement("span");l.innerHTML="&times;",l.style.position="absolute",l.style.top="10px",l.style.right="10px",l.style.cursor="pointer",l.style.fontSize="24px",l.style.color="#007bff",l.addEventListener("click",(function(){o.style.transform="translateX(100%)",setTimeout((function(){o.remove()}),300)}));var d=document.createElement("div");if(d.id="statystyka-content",window.flatpickr&&window.Chart)f();else{var c=document.createElement("script"),p=document.createElement("script");c.src="https://cdn.jsdelivr.net/npm/flatpickr",p.src="https://cdn.jsdelivr.net/npm/chart.js",document.head.appendChild(c),document.head.appendChild(p);var u=document.createElement("script");u.src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/pl.js",document.head.appendChild(u),Promise.all([new Promise((e=>{c.onload=e})),new Promise((e=>{u.onload=e}))]).then((()=>{f()}))}function f(){var e=document.querySelector("#start-date"),t=document.querySelector("#end-date");function n(){e&&t&&(localStorage.setItem("start-date",e.value),localStorage.setItem("end-date",t.value))}function o(){var n=localStorage.getItem("start-date"),o=localStorage.getItem("end-date");n&&(e.value=n),o&&(t.value=o)}e&&flatpickr(e,{dateFormat:"Y-m-d",disableMobile:!0,locale:"pl",allowInput:!1,onChange:n}),t&&flatpickr(t,{dateFormat:"Y-m-d",disableMobile:!0,locale:"pl",allowInput:!1,onChange:n}),o();var r=document.createElement("button");r.innerText="Poprzedni tydzie≈Ñ",r.className="date-button",r.addEventListener("click",(function(){var n=new Date,o=new Date(n.setDate(n.getDate()-n.getDay()-7)),r=new Date(n.setDate(n.getDate()-6));e.value=r.toISOString().split("T")[0],t.value=o.toISOString().split("T")[0]}));var a=document.createElement("button");a.innerText="Ostatnie 7 dni",a.className="date-button";var s=document.createElement("button");s.innerText="Ostatnie 14 dni",s.className="date-button";var i=document.createElement("button");i.innerText="Ostatnie 30 dni (maksymalny zakres)",i.className="date-button",a.addEventListener("click",(function(){var n=new Date;n.setDate(n.getDate()-1);var o=new Date(n);o.setDate(o.getDate()-6),e.value=o.toISOString().split("T")[0],t.value=n.toISOString().split("T")[0]})),s.addEventListener("click",(function(){var n=new Date;n.setDate(n.getDate()-1);var o=new Date(n);o.setDate(o.getDate()-13),e.value=o.toISOString().split("T")[0],t.value=n.toISOString().split("T")[0]})),i.addEventListener("click",(function(){var n=new Date,o=new Date(n);o.setDate(o.getDate()-29),e.value=o.toISOString().split("T")[0],t.value=n.toISOString().split("T")[0]}));var l=document.createElement("button");l.innerText="Wczoraj",l.className="date-button",l.addEventListener("click",(function(){var n=new Date;n.setDate(n.getDate()-1),e.value=n.toISOString().split("T")[0],t.value=n.toISOString().split("T")[0]}));var c=document.createElement("div");c.className="DataButton-container",c.appendChild(l),c.appendChild(r),c.appendChild(a),c.appendChild(s),c.appendChild(i);var p=y.querySelector("#fetch-data-btn");y.insertBefore(c,p),d.appendChild(y)}var y=document.createElement("div");y.innerHTML='\n            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">\n\n            <div class="date-container">\n                <label for="start-date">Data poczƒÖtkowa:</label>\n                <input type="text" id="start-date" placeholder="Wybierz datƒô">\n            </div>\n            <div class="date-container">\n                <label for="end-date">Data ko≈Ñcowa:</label>\n                <input type="text" id="end-date" placeholder="Wybierz datƒô">\n            </div>\n            <button id="fetch-data-btn">Pobierz dane</button>\n        ',y.style.marginBottom="20px",i.appendChild(l),i.appendChild(y),i.appendChild(d),o.appendChild(i),document.body.appendChild(o),setTimeout((function(){o.style.transform="translateX(0)"}),10),document.querySelector("#fetch-data-btn").addEventListener("click",(function(){var n=document.querySelector("#start-date").value,o=document.querySelector("#end-date").value;!async function(e,t,n,o){var i=document.querySelector("#statystyka-content");if(!i)return;i.innerHTML=`\n        <h2 style="margin-top: 0;">Statystyki dla oferty ${e}</h2>\n\n        <div id="fetch-progress" style="border: 1px solid #ddd; border-radius: 8px; padding: 15px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 20px; background-color: #f8f9fa;">\n            <h3 style="position: relative;">\n                Pobieranie danych...\n                <button id="retry-failed-fetches" style="display: none; position: absolute; right: 0; top: 50%; transform: translateY(-50%); background-color: #28a745; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-size: 14px; font-weight: bold;">\n                    üîÑ Spr√≥buj ponownie\n                </button>\n            </h3>\n\n            <div id="fetch-status-deals" class="fetch-status" style="display: flex; align-items: center; padding: 12px 0; border-bottom: 1px solid #eee;">\n                <span style="flex: 1;">üìä Dane sprzeda≈ºy</span>\n                <span id="status-deals" style="color: #6c757d; margin-left: 15px; padding-right: 5px;">‚è≥ Oczekiwanie...</span>\n            </div>\n\n            <div id="fetch-status-prices" class="fetch-status" style="display: flex; align-items: center; padding: 12px 0; border-bottom: 1px solid #eee;">\n                <span style="flex: 1;">üí∞ Historia cen</span>\n                <span id="status-prices" style="color: #6c757d; margin-left: 15px; padding-right: 5px;">‚è≥ Oczekiwanie...</span>\n            </div>\n\n            <div id="fetch-status-conversion" class="fetch-status" style="display: flex; align-items: center; padding: 12px 0; border-bottom: 1px solid #eee;">\n                <span style="flex: 1;">üîÑ Konwersja oferty</span>\n                <span id="status-conversion" style="color: #6c757d; margin-left: 15px; padding-right: 5px;">‚è≥ Oczekiwanie...</span>\n            </div>\n\n            <div id="fetch-status-product" class="fetch-status" style="display: flex; align-items: center; padding: 12px 0; border-bottom: 1px solid #eee;">\n                <span style="flex: 1;">üìà Konwersja produktu</span>\n                <span id="status-product" style="color: #6c757d; margin-left: 15px; padding-right: 5px;">‚è≥ Oczekiwanie...</span>\n            </div>\n\n            <div id="fetch-status-promotion" class="fetch-status" style="display: flex; align-items: center; padding: 12px 0; border-bottom: 1px solid #eee;">\n                <span style="flex: 1;">üéØ Promowania</span>\n                <span id="status-promotion" style="color: #6c757d; margin-left: 15px; padding-right: 5px;">‚è≥ Oczekiwanie...</span>\n            </div>\n\n            <div id="fetch-status-keywords" class="fetch-status" style="display: flex; align-items: center; padding: 12px 0;">\n                <span style="flex: 1;">üîë S≈Çowa kluczowe</span>\n                <span id="status-keywords" style="color: #6c757d; margin-left: 15px; padding-right: 5px;">‚è≥ Oczekiwanie...</span>\n            </div>\n        </div>\n\n\n        <div id="loading-spinner" style="display: flex; justify-content: center; align-items: center;">\n            <div style="border: 4px solid #f3f3f3; border-radius: 50%; border-top: 4px solid #007bff; width: 40px; height: 40px; animation: spin 1s linear infinite;"></div>\n        </div>\n        <style>\n            @keyframes spin {\n                0% { transform: rotate(0deg); }\n                100% { transform: rotate(360deg); }\n            }\n            .fetch-status {\n                transition: all 0.3s ease;\n            }\n        </style>\n    `;const l={salesData:null,priceMonitorData:null,conversionData:null,conversionDataExtended:null,promotionData:null,keywordsData:null,errors:[],failedFetches:[]};function d(e){switch(e){case 401:return"Brak dostƒôpu, zaloguj siƒô na w≈Ça≈õciwe konto Analytics";case 429:return"Za du≈ºo zapyta≈Ñ";case 403:return"B≈ÇƒÖd 403";case 404:return"Nie znaleziono";case 500:return"B≈ÇƒÖd serwera";case 503:return"Serwis niedostƒôpny";default:return`B≈ÇƒÖd HTTP: ${e}`}}function c(e,t,n){const o=document.getElementById(`status-${e}`),r=document.getElementById(`fetch-status-${e}`);if(o&&r){let a,s;switch(t){case"loading":a="‚è≥",s="#007bff";break;case"success":a="‚úÖ",s="#28a745",l.failedFetches=l.failedFetches.filter((t=>t!==e));break;case"error":a="‚ùå",s="#dc3545",l.failedFetches.includes(e)||l.failedFetches.push(e);break;case"skipped":a="‚è≠Ô∏è",s="#6c757d","Niemo≈ºliwe"===n||l.failedFetches.includes(e)||l.failedFetches.push(e);break;default:a="‚è≥",s="#6c757d"}o.innerHTML=`${a} ${n}`,o.style.color=s,"success"===t?(r.style.backgroundColor="#d4edda",r.style.borderLeft="4px solid #28a745"):"error"===t?(r.style.backgroundColor="#f8d7da",r.style.borderLeft="4px solid #dc3545"):"skipped"===t&&(r.style.backgroundColor="#e2e3e5",r.style.borderLeft="4px solid #6c757d"),setTimeout((()=>p()),100)}}function p(){const e=document.getElementById("retry-failed-fetches");e&&(l.failedFetches.length>0?(e.style.display="block",e.textContent=`üîÑ Spr√≥buj ponownie (${l.failedFetches.length})`):e.style.display="none")}try{c("deals","loading","Pobieranie...");try{const ye=await fetch("https://edge.allegro.pl/analytics/auction/deals",{credentials:"include",headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:128.0) Gecko/20100101 Firefox/128.0",Accept:"application/vnd.allegro.internal.v1+json","Accept-Language":"pl-PL","Content-Type":"application/vnd.allegro.internal.v1+json","Sec-Fetch-Dest":"empty","Sec-Fetch-Mode":"cors","Sec-Fetch-Site":"same-site",Priority:"u=0",Pragma:"no-cache","Cache-Control":"no-cache"},referrer:"https://allegro.pl/",body:JSON.stringify({includePhrasesMode:"OfferOrProduct",excludePhrasesMode:"OfferOrProduct",auctionId:e,sellerIds:[],marketplaceIds:["allegro-pl"],startDate:n,endDate:o,startDateTime:n+"T00:00:00.000Z",endDateTime:o+"T23:59:59.999Z",reportCode:"TOP7D"}),method:"POST",mode:"cors"});if(ye.ok){const fe=await ye.json();fe&&fe.result&&fe.result.saleInfo?(l.salesData=fe,c("deals","success","Pobrano pomy≈õlnie"),console.log("‚úÖ Pobrano dane sprzeda≈ºy:",fe),console.log("üîç pmdProductIds:",fe.result.pmdProductIds)):(c("deals","error","Nieprawid≈Çowa struktura danych"),l.errors.push("Nieprawid≈Çowa struktura danych sprzeda≈ºy"))}else c("deals","error",d(ye.status)),l.errors.push(`B≈ÇƒÖd HTTP sprzeda≈ºy: ${ye.status}`)}catch(ge){c("deals","error",`B≈ÇƒÖd: ${ge.message}`),l.errors.push(`B≈ÇƒÖd pobierania danych sprzeda≈ºy: ${ge.message}`),console.error("B≈ÇƒÖd pobierania danych sprzeda≈ºy:",ge)}c("prices","loading","Pobieranie...");try{const me=await fetch("https://edge.allegro.pl/analytics/reports/auctions/pricemonitor/pricejournal",{credentials:"include",headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:128.0) Gecko/20100101 Firefox/128.0",Accept:"application/vnd.allegro.internal.v1+json","Accept-Language":"pl-PL","Content-Type":"application/vnd.allegro.internal.v1+json",Priority:"u=4",Pragma:"no-cache","Cache-Control":"no-cache","Sec-Fetch-Dest":"empty","Sec-Fetch-Mode":"cors","Sec-Fetch-Site":"same-site"},referrer:"https://allegro.pl/",body:JSON.stringify({includePhrases:t,includePhrasesMode:"OfferOrProduct",excludePhrasesMode:"OfferOrProduct",auctionType:1,sellerIds:[],skip:0,take:1e3,marketplaceIds:["allegro-pl"],startDate:n+"T00:00:00.000Z",endDate:o+"T00:00:00.000Z",startDateTime:n+"T00:00:00.000Z",endDateTime:o+"T23:59:59.999Z",reportCode:"TOP7D"}),method:"POST",mode:"cors"});if(me.ok){const he=await me.json();he&&he.entries?(l.priceMonitorData=he,c("prices","success","Pobrano pomy≈õlnie"),console.log("‚úÖ Pobrano dane monitorowania cen:",he)):(c("prices","error","Nieprawid≈Çowa struktura danych"),l.errors.push("Nieprawid≈Çowa struktura danych monitorowania cen"))}else c("prices","error",d(me.status)),l.errors.push(`B≈ÇƒÖd HTTP monitorowania cen: ${me.status}`)}catch(be){c("prices","error",`B≈ÇƒÖd: ${be.message}`),l.errors.push(`B≈ÇƒÖd pobierania danych monitorowania cen: ${be.message}`),console.error("B≈ÇƒÖd pobierania danych monitorowania cen:",be)}if(console.log("üîç Sprawdzanie productid:",l.salesData?.result?.pmdProductIds),l.salesData&&l.salesData.result.pmdProductIds&&l.salesData.result.pmdProductIds.length>0){c("conversion","loading","Pobieranie...");try{const xe=l.salesData.result.pmdProductIds[0],we=await fetch("https://edge.allegro.pl/analytics/reports/sale/byconversion",{credentials:"include",headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:130.0) Gecko/20100101 Firefox/130.0",Accept:"application/vnd.allegro.internal.v1+json","Accept-Language":"pl-PL","Content-Type":"application/vnd.allegro.internal.v1+json","Sec-Fetch-Dest":"empty","Sec-Fetch-Mode":"cors","Sec-Fetch-Site":"same-site",Priority:"u=0",Pragma:"no-cache","Cache-Control":"no-cache"},referrer:"https://allegro.pl/",body:JSON.stringify({includePhrases:xe,includePhrasesMode:"AnyId",excludePhrasesMode:"AnyId",sellerIds:[],includeCancelledAndReturned:!0,skip:0,take:1e3,marketplaceIds:["allegro-pl"],startDate:n+"T00:00:00.000Z",endDate:o+"T00:00:00.000Z",startDateTime:n+"T00:00:00.000Z",endDateTime:o+"T23:59:59.999Z",reportCode:"TOP7D"}),method:"POST",mode:"cors"});if(we.ok){const ke=await we.json();ke&&ke.result&&ke.result.entries?(l.conversionData=ke,c("conversion","success","Pobrano pomy≈õlnie"),console.log("‚úÖ Pobrano dane konwersji:",ke)):(c("conversion","error","Nieprawid≈Çowa struktura danych"),l.errors.push("Nieprawid≈Çowa struktura danych konwersji"))}else c("conversion","error",d(we.status)),l.errors.push(`B≈ÇƒÖd HTTP konwersji: ${we.status}`)}catch(ve){c("conversion","error",`B≈ÇƒÖd: ${ve.message}`),l.errors.push(`B≈ÇƒÖd pobierania danych konwersji: ${ve.message}`),console.error("B≈ÇƒÖd pobierania danych konwersji:",ve)}}else{const Se=l.salesData?.result?.pmdProductIds;Se?0===Se.length?(c("conversion","skipped","Niemo≈ºliwe"),l.errors.push("Pusta tablica pmdProductIds - pominiƒôto pobieranie danych konwersji")):(c("conversion","skipped","Niemo≈ºliwe"),l.errors.push("Nieprawid≈Çowe pmdProductIds - pominiƒôto pobieranie danych konwersji")):(c("conversion","skipped","Niemo≈ºliwe"),l.errors.push("Brak pmdProductIds w odpowiedzi - pominiƒôto pobieranie danych konwersji"))}if(l.conversionData&&l.conversionData.result&&l.conversionData.result.entries){const ze=l.conversionData.result.entries.filter((t=>t.ids.includes(e))),Pe=ze.length?ze[0].pmdProductName:null;if(Pe){c("product","loading","Pobieranie...");try{const De=await fetch("https://edge.allegro.pl/analytics/reports/sale/byconversion",{credentials:"include",headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:130.0) Gecko/20100101 Firefox/130.0",Accept:"application/vnd.allegro.internal.v1+json","Accept-Language":"pl-PL","Content-Type":"application/vnd.allegro.internal.v1+json","Sec-Fetch-Dest":"empty","Sec-Fetch-Mode":"cors","Sec-Fetch-Site":"same-site"},referrer:"https://allegro.pl/",body:JSON.stringify({includePhrases:Pe,includePhrasesMode:"Product",excludePhrasesMode:"Product",auctionType:1,sellerIds:[],skip:0,take:1e3,marketplaceIds:["allegro-pl"],startDate:n+"T00:00:00.000Z",endDate:o+"T00:00:00.000Z",startDateTime:n+"T00:00:00.000Z",endDateTime:o+"T23:59:59.999Z",reportCode:"TOP7D"}),method:"POST",mode:"cors"});if(De.ok){const Ce=await De.json();Ce&&Ce.result?(l.conversionDataExtended=Ce,c("product","success","Pobrano pomy≈õlnie"),console.log("‚úÖ Pobrano rozszerzone dane konwersji:",Ce)):(c("product","error","Nieprawid≈Çowa struktura danych"),l.errors.push("Nieprawid≈Çowa struktura rozszerzonych danych konwersji"))}else c("product","error",d(De.status)),l.errors.push(`B≈ÇƒÖd HTTP rozszerzonych danych konwersji: ${De.status}`)}catch(Te){c("product","error",`B≈ÇƒÖd: ${Te.message}`),l.errors.push(`B≈ÇƒÖd pobierania rozszerzonych danych konwersji: ${Te.message}`),console.error("B≈ÇƒÖd pobierania rozszerzonych danych konwersji:",Te)}}else c("product","skipped","Niemo≈ºliwe"),l.errors.push("Brak pmdProductName - pominiƒôto rozszerzone dane konwersji")}else c("product","skipped","Niemo≈ºliwe"),l.errors.push("Brak danych konwersji - pominiƒôto rozszerzone dane konwersji");c("promotion","loading","Pobieranie...");try{if(l.salesData&&l.salesData.result.pmdProductIds&&0!==l.salesData.result.pmdProductIds.length){const Ie=l.salesData.result.pmdProductIds[0],je=(l.salesData.result.seller,await fetch("https://edge.allegro.pl/analytics/reports/sale/bypromotion",{credentials:"include",headers:{Accept:"application/vnd.allegro.internal.v1+json","Accept-Language":"pl-PL","Content-Type":"application/vnd.allegro.internal.v1+json",Priority:"u=1, i","Sec-CH-UA":'"Google Chrome";v="129", "Not=A?Brand";v="8", "Chromium";v="129"',"Sec-CH-UA-Mobile":"?0","Sec-CH-UA-Platform":'"Windows"',"Sec-Fetch-Dest":"empty","Sec-Fetch-Mode":"cors","Sec-Fetch-Site":"same-site"},referrer:"https://allegro.pl/",referrerPolicy:"strict-origin-when-cross-origin",body:JSON.stringify({includePhrases:Ie,includePhrasesMode:"AnyId",excludePhrasesMode:"AnyId",sellerIds:[],marketplaceIds:["allegro-pl"],startDate:n+"T00:00:00.000Z",endDate:o+"T00:00:00.000Z",startDateTime:n+"T02:00:00.000Z",endDateTime:o+"T23:59:59.999Z",reportCode:"LASTFULL7DAYS"}),method:"POST",mode:"cors"}));if(je.ok){const Ee=await je.json();Ee&&Ee.result&&Ee.result.entries?(l.promotionData=Ee,c("promotion","success","Pobrano pomy≈õlnie"),console.log("‚úÖ Pobrano dane promocji:",Ee)):(c("promotion","error","Nieprawid≈Çowa struktura danych"),l.errors.push("Nieprawid≈Çowa struktura danych promocji"))}else c("promotion","error",d(je.status)),l.errors.push(`B≈ÇƒÖd HTTP promocji: ${je.status}`)}else c("promotion","skipped","Niemo≈ºliwe"),l.errors.push("Brak pmdProductIds - pominiƒôto pobieranie danych promocji")}catch($e){c("promotion","error",`B≈ÇƒÖd: ${$e.message}`),l.errors.push(`B≈ÇƒÖd pobierania danych promocji: ${$e.message}`),console.error("B≈ÇƒÖd pobierania danych promocji:",$e)}if(l.salesData&&l.salesData.result.pmdProductIds&&l.salesData.result.pmdProductIds.length>0){c("keywords","loading","Pobieranie...");try{const Le=l.salesData.result.pmdProductIds[0],Ae=await fetch("https://edge.allegro.pl/analytics/reports/sale/bykeyword",{credentials:"include",headers:{Accept:"application/vnd.allegro.internal.v1+json","Accept-Language":"pl-PL","Content-Type":"application/vnd.allegro.internal.v1+json",Priority:"u=1, i","Sec-CH-UA":'"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"',"Sec-CH-UA-Mobile":"?0","Sec-CH-UA-Platform":'"Windows"',"Sec-Fetch-Dest":"empty","Sec-Fetch-Mode":"cors","Sec-Fetch-Site":"same-site"},referrer:"https://allegro.pl/",body:JSON.stringify({includePhrases:Le,includePhrasesMode:"AnyId",excludePhrasesMode:"OfferOrProduct",auctionId:e,skip:0,take:1e3,marketplaceIds:["allegro-pl"],startDate:n+"T00:00:00.000Z",endDate:o+"T00:00:00.000Z",startDateTime:n+"T02:00:00.000Z",endDateTime:o+"T04:38:00.000Z",reportCode:"LASTFULL7DAYS"}),method:"POST",mode:"cors"});if(Ae.ok){const Fe=await Ae.json();Fe&&Fe.result&&Fe.result.entries?(l.keywordsData=Fe,c("keywords","success","Pobrano pomy≈õlnie"),console.log("‚úÖ Pobrano dane s≈Ç√≥w kluczowych:",Fe)):(c("keywords","error","Nieprawid≈Çowa struktura danych"),l.errors.push("Nieprawid≈Çowa struktura danych s≈Ç√≥w kluczowych"))}else c("keywords","error",d(Ae.status)),l.errors.push(`B≈ÇƒÖd HTTP s≈Ç√≥w kluczowych: ${Ae.status}`)}catch(Be){c("keywords","error",`B≈ÇƒÖd: ${Be.message}`),l.errors.push(`B≈ÇƒÖd pobierania danych s≈Ç√≥w kluczowych: ${Be.message}`),console.error("B≈ÇƒÖd pobierania danych s≈Ç√≥w kluczowych:",Be)}}else c("keywords","skipped","Niemo≈ºliwe"),l.errors.push("Brak pmdProductIds - pominiƒôto pobieranie danych s≈Ç√≥w kluczowych");if(!(l.salesData||l.priceMonitorData||l.conversionData||l.promotionData)){const Ne=l.errors.some((e=>e.includes("401")));throw new Error(Ne?"Brak dostƒôpu, zaloguj siƒô na w≈Ça≈õciwe konto Analytics":"Nie uda≈Ço siƒô pobraƒá ≈ºadnych danych. Sprawd≈∫ po≈ÇƒÖczenie internetowe i spr√≥buj ponownie.")}var u=0,y=0,f=0,g=[],m="",h=0,b=0,x="",w=[],k=null;if(l.salesData){const Oe=l.salesData.result;u=Oe.saleInfo?.totalSale||0,y=Oe.saleInfo?.todaySale||0,f=Oe.saleInfo?.yesterdaySale||0,g=Oe.promotionCyclesHistory||[],m=Oe.overallItemInfo?.startDate||"",h=Oe.startingQuantity||0,b=Oe.currentQuantity||0,x=Oe.seller?.name||"",(w=Oe.pmdProductIds||[]).length>0&&(k=w[0])}var v=[];l.priceMonitorData&&l.priceMonitorData.entries&&(v=l.priceMonitorData.entries.filter((t=>t.id==e)).sort(((e,t)=>new Date(e.priceChange)-new Date(t.priceChange))));var S=[],z=[],P=[];l.conversionData&&l.conversionData.result&&l.conversionData.result.entries&&(S=l.conversionData.result.entries.filter((t=>t.ids.includes(e))),(z=l.conversionData.result.entries.filter((t=>t.ids.includes(e)))).length?z[0].pmdProductName:null),l.conversionDataExtended&&l.conversionDataExtended.result&&(P=l.conversionDataExtended.result.entries.filter((e=>e.pmdProductId===String(k))));var D=[];l.promotionData&&l.promotionData.result&&l.promotionData.result.entries&&(D=l.promotionData.result.entries);var C={},T={},I={};function _(e){switch(e){case 4:return"Bardzo wysoki";case 3:return"Wysoki";case 2:return"≈öredni";case 1:return"Niski";case 0:return"Bardzo niski";default:return"Nieznany"}}function U(e){return(100*e).toFixed(2)+"%"}D.forEach((e=>{68===e.options?(C.efficiencyClass=_(e.efficiencyClass),C.sale=U(e.saleParticipation.sale),C.transactions=U(e.saleParticipation.transactions)):64===e.options?(T.efficiencyClass=_(e.efficiencyClass),T.sale=U(e.saleParticipation.sale),T.transactions=U(e.saleParticipation.transactions)):4===e.options&&(I.efficiencyClass=_(e.efficiencyClass),I.sale=U(e.saleParticipation.sale),I.transactions=U(e.saleParticipation.transactions))})),console.log("Dane dla FreeDeliveryAndPromotion:",C),console.log("Dane dla FreeDelivery:",T),console.log("Dane dla Promotion:",I),console.log(C),console.log(T);var j=P.length>0?P.reduce(((e,t)=>e+t.transactions),0):0,E=P.length>0?j/P.length:0,$=P.length>0?P.reduce(((e,t)=>e+t.conversion),0):0,L=P.length>0?$/P.length:0,A=P.length>0?P.reduce(((e,t)=>e+t.viewsCount),0):0,F=P.length>0?A/P.length:0,B=P.length>0?P.reduce(((e,t)=>e+t.averageSoldItems),0):0,N=P.length>0?B/P.length:0,O=P.length>0?P.filter((e=>e.transactions>0)):[],M=O.length>0?O.reduce(((e,t)=>e+t.transactions),0):0,q=O.length>0?M/O.length:0,R=O.length>0?O.reduce(((e,t)=>e+t.conversion),0)/O.length:0,W=O.length>0?O.reduce(((e,t)=>e+t.viewsCount),0)/O.length:0,H=O.length>0?O.reduce(((e,t)=>e+t.averageSoldItems),0)/O.length:0,Z=O.length>0?O.reduce(((e,t)=>e+t.viewsCount),0):0;const X=(e,t)=>0===t?0:((e-t)/t*100).toFixed(2),G=(e,t)=>(e-t).toFixed(2);function J(e){return e>=0?"text-success":"text-danger"}const K=(e,t)=>0===e?0:(t/e*100).toFixed(2),Y=document.createElement("style");Y.innerHTML="\n    .text-success {\n        color: green; /* Zielony kolor dla warto≈õci dodatnich */\n    }\n    .text-danger {\n        color: red; /* Czerwony kolor dla warto≈õci ujemnych */\n    }\n",document.head.appendChild(Y);let Q="";if(l.salesData?Q+=`\n                <div style="border: 1px solid #ddd; border-radius: 8px; padding: 15px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 20px;" class="conversion">\n                    <h3>üìä Warto≈õƒá sprzeda≈ºy:</h3>\n                    <p><strong>Sprzeda≈º w wybranym okresie:</strong> ${r(u)}</p>\n                    <p><strong>Sprzeda≈º dzisiaj:</strong> ${r(y)}</p>\n                    <p><strong>Sprzeda≈º wczoraj:</strong> ${r(f)}</p>\n                    <br>\n                    <h4 class="section-title">Dodatkowe informacje</h4>\n                    <p><strong>Tytu≈Ç:</strong> ${l.salesData.result.itemName||"Brak danych"} (${(l.salesData.result.itemName||"").length} znak√≥w)</p>\n                    <p><strong>Data rozpoczƒôcia oferty:</strong> ${s(m)}</p>\n                    <p><strong>PoczƒÖtkowa ilo≈õƒá:</strong> ${h}</p>\n                    <p><strong>Obecna ilo≈õƒá:</strong> ${b}</p>\n                    <p><strong>Sprzedawca:</strong> ${x}</p>\n                    ${k?`<a class="product-btn" href="https://allegro.pl/moje-allegro/sprzedaz/produkt/zglos-blad/${k}" target="_blank">Sprawd≈∫ / zg≈Ço≈õ produkt</a>`:""}\n                </div>\n            `:Q+='\n                <div style="border: 1px solid #ffa500; border-radius: 8px; padding: 15px; box-shadow: 0 2px 4px rgba(255,165,0,0.1); margin-bottom: 20px; background-color: #fff8e1;">\n                    <h3 style="color: #f57c00;">‚ö†Ô∏è Dane sprzeda≈ºy niedostƒôpne</h3>\n                    <p>Nie uda≈Ço siƒô pobraƒá danych sprzeda≈ºowych dla tej oferty.</p>\n                </div>\n            ',l.salesData&&g.length>0&&(Q+=`\n                <div style="border: 1px solid #ddd; border-radius: 8px; padding: 15px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 20px;">\n                    <h3>üéØ Cykle promowania oferty:</h3>\n                    ${g.map((e=>{let t;switch(e.promotionOptions){case 4:t="Wyr√≥≈ºnienie ";break;case 68:t="Wyr√≥≈ºnienie + darmowa dostawa";break;default:t="Wyr√≥≈ºnienie"}return`<p><strong>${t}</strong>: ${a(e.startDate)} do ${a(e.endDate)}</p>`})).join("")}\n                </div>\n            `),l.promotionData&&D.length>0?Q+=`\n                <div style="border: 1px solid #ddd; border-radius: 8px; padding: 15px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 20px;">\n                    <h3 style="margin-top: 0; color: #fff; background-color: #007bff; padding: 10px 15px; border-radius: 4px; margin: -15px -15px 15px -15px;">üéØ Potencja≈Ç wyr√≥≈ºnie≈Ñ dla tego produktu</h3>\n                    <div class="prom-efficiency">\n                        <table>\n                            <thead>\n                                <tr>\n                                    <th>Typ</th>\n                                    <th>Potencja≈Ç</th>\n                                    <th>Udzia≈Ç sprzeda≈ºy</th>\n                                    <th>Udzia≈Ç transakcji</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                ${Object.keys(C).length>0?`\n                                <tr>\n                                    <td>Wyr√≥≈ºnienie + Darmowa dostawa</td>\n                                    <td>${C.efficiencyClass}</td>\n                                    <td>${C.sale}</td>\n                                    <td>${C.transactions}</td>\n                                </tr>\n                                `:""}\n\n                                ${Object.keys(T).length>0?`\n                                <tr>\n                                    <td>Darmowa dostawa</td>\n                                    <td>${T.efficiencyClass}</td>\n                                    <td>${T.sale}</td>\n                                    <td>${T.transactions}</td>\n                                </tr>\n                                `:""}\n\n                                ${Object.keys(I).length>0?`\n                                <tr>\n                                    <td>Wyr√≥≈ºnienie</td>\n                                    <td>${I.efficiencyClass}</td>\n                                    <td>${I.sale}</td>\n                                    <td>${I.transactions}</td>\n                                </tr>\n                                `:""}\n                            </tbody>\n                        </table>\n                    </div>\n                </div>\n            `:null===l.promotionData&&(Q+='\n                <div style="border: 1px solid #ffa500; border-radius: 8px; padding: 15px; box-shadow: 0 2px 4px rgba(255,165,0,0.1); margin-bottom: 20px; background-color: #fff8e1;">\n                    <h3 style="color: #f57c00;">‚ö†Ô∏è Dane promocji niedostƒôpne</h3>\n                    <p>Nie uda≈Ço siƒô pobraƒá danych o potencjale wyr√≥≈ºnie≈Ñ dla tej oferty.</p>\n                </div>\n            '),l.priceMonitorData&&v.length>0?Q+=`\n                <div style="border: 1px solid #ddd; border-radius: 8px; padding: 15px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 20px;">\n                    <h3>üí∞ Monitorowanie cen:</h3>\n                    ${v.map((e=>`<div style="margin-bottom: 10px;">\n                            <p>${a(e.priceChange)}: Stara cena: <strong>${r(e.oldPrice)}</strong> | Nowa cena: <strong>${r(e.newPrice)}</strong></p>\n                        </div>`)).join("")}\n                    <button id="chart-button" style="margin-top: 10px; padding: 10px 15px; background-color: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer;">\n                        Poka≈º wykres\n                    </button>\n                    <canvas id="price-chart" style="display: none; margin-top: 15px;"></canvas>\n                </div>\n            `:null===l.priceMonitorData?Q+='\n                <div style="border: 1px solid #ffa500; border-radius: 8px; padding: 15px; box-shadow: 0 2px 4px rgba(255,165,0,0.1); margin-bottom: 20px; background-color: #fff8e1;">\n                    <h3 style="color: #f57c00;">‚ö†Ô∏è Dane monitorowania cen niedostƒôpne</h3>\n                    <p>Nie uda≈Ço siƒô pobraƒá danych o zmianach cen dla tej oferty.</p>\n                </div>\n            ':Q+='\n                <div style="border: 1px solid #ddd; border-radius: 8px; padding: 15px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 20px;">\n                    <h3>üí∞ Monitorowanie cen:</h3>\n                    <p>Brak danych o cenach dla tego ID.</p>\n                </div>\n            ',l.keywordsData&&l.keywordsData.result&&l.keywordsData.result.entries){const Me=l.keywordsData.result.entries.filter((e=>e.saleParticipation&&e.saleParticipation.sale>.3)).sort(((e,t)=>t.saleParticipation.sale-e.saleParticipation.sale));Me.length>0?Q+=`\n                    <div style="border: 1px solid #ddd; border-radius: 8px; padding: 15px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 20px;">\n                        <h3>üîë S≈Çowa kluczowe</h3>\n                        <div style="margin-bottom: 15px;">\n                            <label style="margin-right: 15px;">\n                                <input type="radio" name="keyword-filter" value="2" checked> 2+ znaki\n                            </label>\n                            <label>\n                                <input type="radio" name="keyword-filter" value="3"> 3+ znaki\n                            </label>\n                        </div>\n                        <div id="keywords-container">\n                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 2px solid #007bff; font-weight: bold; background-color: #f8f9fa;">\n                                <span>S≈Çowo kluczowe</span>\n                                <span>Udzia≈Ç</span>\n                            </div>\n                            <div id="keywords-list">\n                                ${Me.slice(0,5).map((e=>`\n                                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #eee;">\n                                        <span style="font-weight: bold;">${e.keyword}</span>\n                                        <span style="color: #007bff;">${(100*e.saleParticipation.sale).toFixed(1)}%</span>\n                                    </div>\n                                `)).join("")}\n                                ${Me.length>5?`\n                                    <div id="all-keywords" style="display: none;">\n                                        ${Me.slice(5).map((e=>`\n                                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #eee;">\n                                                <span style="font-weight: bold;">${e.keyword}</span>\n                                                <span style="color: #007bff;">${(100*e.saleParticipation.sale).toFixed(1)}%</span>\n                                            </div>\n                                        `)).join("")}\n                                    </div>\n                                    <button id="show-more-keywords" style="margin-top: 10px; padding: 8px 15px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;">\n                                        Poka≈º wiƒôcej (${Me.length-5} wiƒôcej)\n                                    </button>\n                                `:""}\n                            </div>\n                        </div>\n                    </div>\n                `:Q+='\n                    <div style="border: 1px solid #ddd; border-radius: 8px; padding: 15px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 20px;">\n                        <h3>üîë S≈Çowa kluczowe</h3>\n                        <p>Brak s≈Ç√≥w kluczowych z udzia≈Çem powy≈ºej 30%.</p>\n                    </div>\n                '}else null===l.keywordsData&&(Q+='\n                <div style="border: 1px solid #ffa500; border-radius: 8px; padding: 15px; box-shadow: 0 2px 4px rgba(255,165,0,0.1); margin-bottom: 20px; background-color: #fff8e1;">\n                    <h3 style="color: #f57c00;">‚ö†Ô∏è Dane s≈Ç√≥w kluczowych niedostƒôpne</h3>\n                    <p>Nie uda≈Ço siƒô pobraƒá danych o s≈Çowach kluczowych dla tej oferty.</p>\n                </div>\n            ');l.conversionData&&S.length>0?Q+=`\n                <div style="border: 1px solid #ddd; border-radius: 8px; padding: 15px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 20px;" class="conversion">\n                    <h3>üîÑ Dane konwersji:</h3>\n                    ${S.map(((e,t)=>`\n                        <div style="margin-bottom: 10px;" class="original-conversion">\n                            <p>Transakcje: <strong>${e.transactions}</strong>\n                                <span style="display: none;" class="transaction-diff ${J(K(j,e.transactions))}">\n                                    (${K(j,e.transactions)}% wszystkich transakcji)\n                                </span>\n                                <span style="display: none;" class="successful-transaction-diff ${J(K(M,e.transactions))}">\n                                    (${K(M,e.transactions)}% wszystkich transakcji)\n                                </span>\n                            </p>\n                            <p>≈örednia liczba sprzedanych sztuk: <strong>${e.averageSoldItems}</strong>\n                                <span style="display: none;" class="average-sold-items-diff ${J(X(e.averageSoldItems,N.toFixed(2)))}">\n                                    (${X(e.averageSoldItems,N.toFixed(2))}%)\n                                </span>\n                                <span style="display: none;" class="average-sold-items-successful-diff ${J(X(e.averageSoldItems,H.toFixed(2)))}">\n                                    (${X(e.averageSoldItems,H.toFixed(2))}%)\n                                </span>\n                            </p>\n                            <p>Liczba ods≈Çon: <strong>${e.viewsCount}</strong>\n                                <span style="display: none;" class="views-count-diff ${J(X(e.viewsCount,F.toFixed(2)))}">\n                                    (${K(A.toFixed(2),e.viewsCount)}% wszystkich ods≈Çon)\n                                </span>\n                                <span style="display: none;" class="views-count-successful-diff ${J(X(e.viewsCount,W.toFixed(2)))}">\n                                    (${K(Z,e.viewsCount)}% wszystkich ods≈Çon)\n                                </span>\n                            </p>\n                            <p>Wsp√≥≈Çczynnik konwersji: <strong>${(100*e.conversion).toFixed(2)}%</strong>\n                                <span style="display: none;" class="conversion-diff ${J(G((100*e.conversion).toFixed(2),(100*L).toFixed(2)))}">\n                                    (${G((100*e.conversion).toFixed(2),(100*L).toFixed(2))} pkt %)\n                                </span>\n                                <span style="display: none;" class="successful-conversion-diff ${J(G((100*e.conversion).toFixed(2),(100*R).toFixed(2)))}">\n                                    (${G((100*e.conversion).toFixed(2),(100*R).toFixed(2))} pkt %)\n                                </span>\n                            </p>\n                            <p>Dodania do ulubionych: <strong>${e.favoriteAdditionsCount}</strong></p>\n                            <p>Dodania do koszyka: <strong>${e.cartAdditionsCount}</strong></p>\n                            <button class="show-total-stats" data-index="${t}" style="margin-top: 10px;">Poka≈º ca≈Çe statystyki</button>\n                            <button class="show-successful-stats" data-index="${t}" style="margin-top: 10px;">Poka≈º udane transakcje</button>\n                            <div id="more-info-${t}" style="display: none; margin-top: 10px;">\n                                <div class="total-stats" style="display: none;">\n                                    <h3>Statystyki ofert kt√≥re mia≈Çy wizyty</h3>\n                                    <p>≈örednia liczba sprzedanych sztuk: <strong>${N.toFixed(2)}</strong></p>\n                                    <p>Wszystkich transakcji: <strong>${j}</strong></p>\n                                    <p>≈örednia liczba transakcji: <strong>${E.toFixed(2)}</strong></p>\n                                    <p>Liczba wy≈õwietle≈Ñ: <strong>${A}</strong></p>\n                                    <p>≈örednia konwersja: <strong>${(100*L).toFixed(2)}%</strong></p>\n                                    <p>≈örednia liczba ods≈Çon: <strong>${F.toFixed(2)}</strong></p>\n                                </div>\n                                <div class="successful-stats" style="display: none;">\n                                    <h3>Statystyki ofert kt√≥re mia≈Çy transakcje</h3>\n                                    <p>≈örednia liczba sprzedanych sztuk: <strong>${H.toFixed(2)}</strong></p>\n                                    <p>Wszystkich transakcji: <strong>${M}</strong></p>\n                                    <p>≈örednia liczba transakcji: <strong>${q.toFixed(2)}</strong></p>\n                                    <p>Liczba wy≈õwietle≈Ñ: <strong>${Z}</strong></p>\n                                    <p>≈örednia konwersja: <strong>${(100*R).toFixed(2)}%</strong></p>\n                                    <p>≈örednia liczba ods≈Çon: <strong>${W.toFixed(2)}</strong></p>\n                                </div>\n                            </div>\n                        </div>\n                    `)).join("")}\n                    <button id="showEntriesBtn">Poka≈º statystyki ofert</button>\n                </div>\n            `:null===l.conversionData?Q+='\n                <div style="border: 1px solid #ffa500; border-radius: 8px; padding: 15px; box-shadow: 0 2px 4px rgba(255,165,0,0.1); margin-bottom: 20px; background-color: #fff8e1;">\n                    <h3 style="color: #f57c00;">‚ö†Ô∏è Dane konwersji niedostƒôpne</h3>\n                    <p>Nie uda≈Ço siƒô pobraƒá danych konwersji dla tej oferty.</p>\n                </div>\n            ':Q+='\n                <div style="border: 1px solid #ddd; border-radius: 8px; padding: 15px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 20px;">\n                    <h3>Dane konwersji:</h3>\n                    <p>Brak danych konwersji.</p>\n                </div>\n            ';const V=document.getElementById("fetch-progress"),ee=document.querySelector("#loading-spinner");if(ee&&(ee.style.display="none"),p(),V?V.insertAdjacentHTML("afterend",Q):i.innerHTML=Q,S.length>0&&S.forEach(((e,t)=>{const n=document.querySelector(`.show-total-stats[data-index="${t}"]`),o=document.querySelector(`.show-successful-stats[data-index="${t}"]`);n&&o&&(n.addEventListener("click",(function(){const e=document.getElementById(`more-info-${t}`);e.style.display="block",e.querySelector(".total-stats").style.display="block",n.style.backgroundColor="#ff5a00",o.style.backgroundColor="#007bff",e.querySelector(".successful-stats").style.display="none";const r=document.querySelector(".transaction-diff"),a=document.querySelector(".average-sold-items-diff"),s=document.querySelector(".views-count-diff"),i=document.querySelector(".conversion-diff");r&&(r.style.display="inline"),a&&(a.style.display="inline"),s&&(s.style.display="inline"),i&&(i.style.display="inline");const l=document.querySelector(".successful-transaction-diff"),d=document.querySelector(".average-sold-items-successful-diff"),c=document.querySelector(".views-count-successful-diff"),p=document.querySelector(".successful-conversion-diff");l&&(l.style.display="none"),d&&(d.style.display="none"),c&&(c.style.display="none"),p&&(p.style.display="none")})),o.addEventListener("click",(function(){const e=document.getElementById(`more-info-${t}`);e.style.display="block",e.querySelector(".total-stats").style.display="none",e.querySelector(".successful-stats").style.display="block",o.style.backgroundColor="#ff5a00",n.style.backgroundColor="#007bff";const r=document.querySelector(".transaction-diff"),a=document.querySelector(".average-sold-items-diff"),s=document.querySelector(".views-count-diff"),i=document.querySelector(".conversion-diff");r&&(r.style.display="none"),a&&(a.style.display="none"),s&&(s.style.display="none"),i&&(i.style.display="none");const l=document.querySelector(".successful-transaction-diff"),d=document.querySelector(".average-sold-items-successful-diff"),c=document.querySelector(".views-count-successful-diff"),p=document.querySelector(".successful-conversion-diff");l&&(l.style.display="inline"),d&&(d.style.display="inline"),c&&(c.style.display="inline"),p&&(p.style.display="inline")})))})),v.length>0){!function(e){var t,n,o;if(console.log("Funkcja generatePriceChart zosta≈Ça wywo≈Çana."),console.log("Dane wej≈õciowe:",e),e.length>0){t=e.map((e=>a(e.priceChange))),n=e.map((e=>e.newPrice));const r=Math.max(...n);o=Math.ceil(1.2*r)}else t=["No data"],n=[0,1],o=2;console.log("Etykiety:",t),console.log("Dane:",n),console.log("Maksymalna warto≈õƒá osi Y:",o);var r=document.getElementById("price-chart"),s=r.getContext("2d");r.width=400,r.height=200,new Chart(s,{type:"line",data:{labels:t,datasets:[{label:"Cena",data:n,backgroundColor:"rgba(75, 192, 192, 0.2)",borderColor:"rgba(75, 192, 192, 1)",borderWidth:1,pointRadius:5,pointHoverRadius:8}]},options:{scales:{y:{beginAtZero:!0,max:o}},plugins:{tooltip:{padding:10,backgroundColor:"rgba(0, 0, 0, 0.7)",titleColor:"#fff",bodyColor:"#fff",titleFont:{size:16},bodyFont:{size:14},callbacks:{label:function(e){const t=e.raw,o=e.dataIndex;let r=0;if(o>0){const e=n[o-1];r=(t-e)/e*100}return[`Cena: ${t.toFixed(2)} z≈Ç`,`Zmiana: ${r.toFixed(2)}%`]}}}}}})}(v);const qe=document.querySelector("#chart-button");qe&&qe.addEventListener("click",(function(){const e=document.getElementById("price-chart");e&&("none"===e.style.display?e.style.display="block":e.style.display="none")}))}const te=document.querySelector("#showEntriesBtn");if(te&&P.length>0&&te.addEventListener("click",(function(){ue(P)})),l.keywordsData&&l.keywordsData.result&&l.keywordsData.result.entries){const Re=l.keywordsData.result.entries.filter((e=>e.saleParticipation&&e.saleParticipation.sale>.3)).sort(((e,t)=>t.saleParticipation.sale-e.saleParticipation.sale));document.querySelectorAll('input[name="keyword-filter"]').forEach((e=>{e.addEventListener("change",(function(){const e=parseInt(this.value),t=Re.filter((t=>t.keyword.length>=e)),n=document.getElementById("keywords-list");document.getElementById("all-keywords"),document.getElementById("show-more-keywords");n&&(n.innerHTML=t.slice(0,5).map((e=>`\n                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #eee;">\n                                <span style="font-weight: bold;">${e.keyword}</span>\n                                <span style="color: #007bff;">${(100*e.saleParticipation.sale).toFixed(1)}%</span>\n                            </div>\n                        `)).join("")+(t.length>5?`\n                            <div id="all-keywords" style="display: none;">\n                                ${t.slice(5).map((e=>`\n                                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #eee;">\n                                        <span style="font-weight: bold;">${e.keyword}</span>\n                                        <span style="color: #007bff;">${(100*e.saleParticipation.sale).toFixed(1)}%</span>\n                                    </div>\n                                `)).join("")}\n                            </div>\n                            <button id="show-more-keywords" style="margin-top: 10px; padding: 8px 15px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;">\n                                Poka≈º wiƒôcej (${t.length-5} wiƒôcej)\n                            </button>\n                        `:""))}))})),document.addEventListener("click",(function(e){if(e.target&&"show-more-keywords"===e.target.id){const t=document.getElementById("all-keywords");t&&("none"===t.style.display?(t.style.display="block",e.target.textContent="Poka≈º mniej"):(t.style.display="none",e.target.textContent=`Poka≈º wiƒôcej (${Re.length-5} wiƒôcej)`))}}))}const ne=document.getElementById("retry-failed-fetches");function oe(e,t,n,o){const r=document.getElementById("fetch-progress");if(r){let e=r.nextElementSibling;for(;e;){const t=e;e=e.nextElementSibling,t.remove()}}re(e,t,n,o)}function re(e,t,n,o){var a=0,i=0,d=0,c="",p=0,u=0,y="",f=[],g=null;if(l.salesData){const e=l.salesData.result;a=e.saleInfo?.totalSale||0,i=e.saleInfo?.todaySale||0,d=e.saleInfo?.yesterdaySale||0,c=e.overallItemInfo?.startDate||"",p=e.startingQuantity||0,u=e.currentQuantity||0,y=e.seller?.name||"",(f=e.pmdProductIds||[]).length>0&&(g=f[0])}let m="";m=l.salesData?`\n                <div style="border: 1px solid #ddd; border-radius: 8px; padding: 15px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 20px;" class="conversion">\n                    <h3>Warto≈õƒá sprzeda≈ºy:</h3>\n                    <p><strong>Sprzeda≈º w wybranym okresie:</strong> ${r(a)}</p>\n                    <p><strong>Sprzeda≈º dzisiaj:</strong> ${r(i)}</p>\n                    <p><strong>Sprzeda≈º wczoraj:</strong> ${r(d)}</p>\n                    <br>\n                    <h4 class="section-title">Dodatkowe informacje</h4>\n                    <p><strong>Tytu≈Ç:</strong> ${l.salesData.result.itemName||"Brak danych"} (${(l.salesData.result.itemName||"").length} znak√≥w)</p>\n                    <p><strong>Data rozpoczƒôcia oferty:</strong> ${s(c)}</p>\n                    <p><strong>PoczƒÖtkowa ilo≈õƒá:</strong> ${p}</p>\n                    <p><strong>Obecna ilo≈õƒá:</strong> ${u}</p>\n                    <p><strong>Sprzedawca:</strong> ${y}</p>\n                    ${g?`<a class="product-btn" href="https://allegro.pl/moje-allegro/sprzedaz/produkt/zglos-blad/${g}" target="_blank">Sprawd≈∫ / zg≈Ço≈õ produkt</a>`:""}\n                </div>\n            `:'\n                <div style="border: 1px solid #ffa500; border-radius: 8px; padding: 15px; box-shadow: 0 2px 4px rgba(255,165,0,0.1); margin-bottom: 20px; background-color: #fff8e1;">\n                    <h3 style="color: #f57c00;">‚ö†Ô∏è Dane sprzeda≈ºy niedostƒôpne</h3>\n                    <p>Nie uda≈Ço siƒô pobraƒá danych sprzeda≈ºowych dla tej oferty.</p>\n                </div>\n            ';const h=document.getElementById("fetch-progress");if(h){const e=h.nextElementSibling;e&&e.classList.contains("conversion")?e.outerHTML=m:h.insertAdjacentHTML("afterend",m)}}async function ae(e,t,n,o,r){c(e,"loading","Ponawianie...");try{switch(e){case"deals":await se(t,o,r);break;case"prices":await ie(n,o,r);break;case"conversion":await le(t,o,r);break;case"product":await de(t,o,r);break;case"promotion":await ce(o,r);break;case"keywords":await pe(t,o,r)}}catch(t){c(e,"error",`B≈ÇƒÖd: ${t.message}`),console.error(`B≈ÇƒÖd ponawiania ${e}:`,t)}}async function se(e,t,n){const o=await fetch("https://edge.allegro.pl/analytics/auction/deals",{credentials:"include",headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:128.0) Gecko/20100101 Firefox/128.0",Accept:"application/vnd.allegro.internal.v1+json","Accept-Language":"pl-PL","Content-Type":"application/vnd.allegro.internal.v1+json","Sec-Fetch-Dest":"empty","Sec-Fetch-Mode":"cors","Sec-Fetch-Site":"same-site",Priority:"u=0",Pragma:"no-cache","Cache-Control":"no-cache"},referrer:"https://allegro.pl/",body:JSON.stringify({includePhrasesMode:"OfferOrProduct",excludePhrasesMode:"OfferOrProduct",auctionId:e,sellerIds:[],marketplaceIds:["allegro-pl"],startDate:t,endDate:n,startDateTime:t+"T00:00:00.000Z",endDateTime:n+"T23:59:59.999Z",reportCode:"TOP7D"}),method:"POST",mode:"cors"});if(o.ok){const e=await o.json();e&&e.result&&e.result.saleInfo?(l.salesData=e,c("deals","success","Pobrano pomy≈õlnie")):c("deals","error","Nieprawid≈Çowa struktura danych")}else c("deals","error",`B≈ÇƒÖd HTTP: ${o.status}`)}async function ie(e,t,n){const o=await fetch("https://edge.allegro.pl/analytics/reports/auctions/pricemonitor/pricejournal",{credentials:"include",headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:128.0) Gecko/20100101 Firefox/128.0",Accept:"application/vnd.allegro.internal.v1+json","Accept-Language":"pl-PL","Content-Type":"application/vnd.allegro.internal.v1+json",Priority:"u=4",Pragma:"no-cache","Cache-Control":"no-cache","Sec-Fetch-Dest":"empty","Sec-Fetch-Mode":"cors","Sec-Fetch-Site":"same-site"},referrer:"https://allegro.pl/",body:JSON.stringify({includePhrases:e,includePhrasesMode:"OfferOrProduct",excludePhrasesMode:"OfferOrProduct",auctionType:1,sellerIds:[],skip:0,take:1e3,marketplaceIds:["allegro-pl"],startDate:t+"T00:00:00.000Z",endDate:n+"T00:00:00.000Z",startDateTime:t+"T00:00:00.000Z",endDateTime:n+"T23:59:59.999Z",reportCode:"TOP7D"}),method:"POST",mode:"cors"});if(o.ok){const e=await o.json();e&&e.entries?(l.priceMonitorData=e,c("prices","success","Pobrano pomy≈õlnie")):c("prices","error","Nieprawid≈Çowa struktura danych")}else c("prices","error",`B≈ÇƒÖd HTTP: ${o.status}`)}async function le(e,t,n){if(!l.salesData||!l.salesData.result.pmdProductIds||0===l.salesData.result.pmdProductIds.length)return void c("conversion","skipped","Brak productid");const o=l.salesData.result.pmdProductIds[0],r=await fetch("https://edge.allegro.pl/analytics/reports/sale/byconversion",{credentials:"include",headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:130.0) Gecko/20100101 Firefox/130.0",Accept:"application/vnd.allegro.internal.v1+json","Accept-Language":"pl-PL","Content-Type":"application/vnd.allegro.internal.v1+json","Sec-Fetch-Dest":"empty","Sec-Fetch-Mode":"cors","Sec-Fetch-Site":"same-site",Priority:"u=0",Pragma:"no-cache","Cache-Control":"no-cache"},referrer:"https://allegro.pl/",body:JSON.stringify({includePhrases:o,includePhrasesMode:"AnyId",excludePhrasesMode:"AnyId",sellerIds:[],includeCancelledAndReturned:!0,skip:0,take:1e3,marketplaceIds:["allegro-pl"],startDate:t+"T00:00:00.000Z",endDate:n+"T00:00:00.000Z",startDateTime:t+"T00:00:00.000Z",endDateTime:n+"T23:59:59.999Z",reportCode:"TOP7D"}),method:"POST",mode:"cors"});if(r.ok){const e=await r.json();e&&e.result&&e.result.entries?(l.conversionData=e,c("conversion","success","Pobrano pomy≈õlnie")):c("conversion","error","Nieprawid≈Çowa struktura danych")}else c("conversion","error",`B≈ÇƒÖd HTTP: ${r.status}`)}async function de(e,t,n){if(!l.conversionData||!l.conversionData.result||!l.conversionData.result.entries)return void c("product","skipped","Brak danych konwersji");const o=l.conversionData.result.entries.filter((t=>t.ids.includes(e))),r=o.length?o[0].pmdProductName:null;if(!r)return void c("product","skipped","Brak pmdProductName");const a=await fetch("https://edge.allegro.pl/analytics/reports/sale/byconversion",{credentials:"include",headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:130.0) Gecko/20100101 Firefox/130.0",Accept:"application/vnd.allegro.internal.v1+json","Accept-Language":"pl-PL","Content-Type":"application/vnd.allegro.internal.v1+json","Sec-Fetch-Dest":"empty","Sec-Fetch-Mode":"cors","Sec-Fetch-Site":"same-site"},referrer:"https://allegro.pl/",body:JSON.stringify({includePhrases:r,includePhrasesMode:"Product",excludePhrasesMode:"Product",auctionType:1,sellerIds:[],skip:0,take:1e3,marketplaceIds:["allegro-pl"],startDate:t+"T00:00:00.000Z",endDate:n+"T00:00:00.000Z",startDateTime:t+"T00:00:00.000Z",endDateTime:n+"T23:59:59.999Z",reportCode:"TOP7D"}),method:"POST",mode:"cors"});if(a.ok){const e=await a.json();e&&e.result?(l.conversionDataExtended=e,c("product","success","Pobrano pomy≈õlnie")):c("product","error","Nieprawid≈Çowa struktura danych")}else c("product","error",`B≈ÇƒÖd HTTP: ${a.status}`)}async function ce(e,t){const n=await fetch("https://edge.allegro.pl/analytics/reports/sale/bypromotion",{credentials:"include",headers:{Accept:"application/vnd.allegro.internal.v1+json","Accept-Language":"pl-PL","Content-Type":"application/vnd.allegro.internal.v1+json",Priority:"u=1, i","Sec-CH-UA":'"Google Chrome";v="129", "Not=A?Brand";v="8", "Chromium";v="129"',"Sec-CH-UA-Mobile":"?0","Sec-CH-UA-Platform":'"Windows"',"Sec-Fetch-Dest":"empty","Sec-Fetch-Mode":"cors","Sec-Fetch-Site":"same-site"},referrer:"https://allegro.pl/",referrerPolicy:"strict-origin-when-cross-origin",body:JSON.stringify({includePhrases:"2c3f3821-4408-42b8-9ce3-94103d84715e",includePhrasesMode:"AnyId",sellerIds:[],marketplaceIds:["allegro-pl"],startDate:e+"T00:00:00.000Z",endDate:t+"T00:00:00.000Z",startDateTime:e+"T02:00:00.000Z",endDateTime:t+"T23:53:00.000Z",reportCode:"LASTFULL7DAYS"}),method:"POST",mode:"cors"});if(n.ok){const e=await n.json();e&&e.result&&e.result.entries?(l.promotionData=e,c("promotion","success","Pobrano pomy≈õlnie")):c("promotion","error","Nieprawid≈Çowa struktura danych")}else c("promotion","error",`B≈ÇƒÖd HTTP: ${n.status}`)}async function pe(e,t,n){if(!l.salesData||!l.salesData.result.pmdProductIds||0===l.salesData.result.pmdProductIds.length)return void c("keywords","skipped","Niemo≈ºliwe");const o=l.salesData.result.pmdProductIds[0],r=await fetch("https://edge.allegro.pl/analytics/reports/sale/bykeyword",{credentials:"include",headers:{Accept:"application/vnd.allegro.internal.v1+json","Accept-Language":"pl-PL","Content-Type":"application/vnd.allegro.internal.v1+json",Priority:"u=1, i","Sec-CH-UA":'"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"',"Sec-CH-UA-Mobile":"?0","Sec-CH-UA-Platform":'"Windows"',"Sec-Fetch-Dest":"empty","Sec-Fetch-Mode":"cors","Sec-Fetch-Site":"same-site"},referrer:"https://allegro.pl/",body:JSON.stringify({includePhrases:o,includePhrasesMode:"AnyId",excludePhrasesMode:"OfferOrProduct",auctionId:e,skip:0,take:1e3,marketplaceIds:["allegro-pl"],startDate:t+"T00:00:00.000Z",endDate:n+"T00:00:00.000Z",startDateTime:t+"T02:00:00.000Z",endDateTime:n+"T04:38:00.000Z",reportCode:"LASTFULL7DAYS"}),method:"POST",mode:"cors"});if(r.ok){const e=await r.json();e&&e.result&&e.result.entries?(l.keywordsData=e,c("keywords","success","Pobrano pomy≈õlnie")):c("keywords","error","Nieprawid≈Çowa struktura danych")}else c("keywords","error",`B≈ÇƒÖd HTTP: ${r.status}`)}function ue(e){if(!e||0===e.length)return void alert("Brak danych do wy≈õwietlenia.");const t=`\n        <div id="modal-entries" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); display: flex; justify-content: center; align-items: center; z-index: 10001;max-width:100%">\n            <div style="background: white; padding: 30px; border-radius: 8px; width: 90%; max-width: 100%; overflow-y: auto; max-height: 80%; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);">\n                <div style="display: flex; justify-content: space-between; align-items: center;">\n                    <h2 style="margin-top: 0; text-align: center; color: #333;">Wszystkie oferty</h2>\n                    <button id="closeEntriesModalBtn" style="padding: 10px 15px; background-color: #dc3545; color: white; border: none; border-radius: 5px; cursor: pointer;">Zamknij</button>\n                </div>\n                <table style="width: 100%; border-collapse: collapse; margin-top: 20px; font-family: Arial, sans-serif;">\n                    <thead style="background-color: #007bff; color: white;">\n                        <tr>\n                            <th style="padding: 15px; text-align: center;">Oferty</th>\n                            <th style="padding: 15px; text-align: center;">Sprzedawca</th>\n                            <th style="padding: 15px; text-align: center;">Transakcji <span class="filter-icon" data-col="2">üîΩ</span></th>\n                            <th style="padding: 15px; text-align: center;">≈ör. sprzedanych sztuk <span class="filter-icon" data-col="3">üîΩ</span></th>\n                            <th style="padding: 15px; text-align: center;">Ods≈Çon <span class="filter-icon" data-col="4">üîΩ</span></th>\n                            <th style="padding: 15px; text-align: center;">Konwersja <span class="filter-icon" data-col="5">üîΩ</span></th>\n                            <th style="padding: 15px; text-align: center;">Cena <span class="filter-icon" data-col="6">üîΩ</span></th>\n                            <th style="padding: 15px; text-align: center;">Dodanych do ulubionych <span class="filter-icon" data-col="7">üîΩ</span></th>\n                            <th style="padding: 15px; text-align: center;">Dodanych do koszyka <span class="filter-icon" data-col="8">üîΩ</span></th>\n                        </tr>\n                    </thead>\n                    <tbody id="entriesTableBody">\n                        ${e.map((e=>`\n        <tr>\n<td style="text-align: center;">\n    <a href="https://allegro.pl/oferta/${e.ids.join(", ")}" target="_blank">${e.ids.join(", ")}</a>\n</td>\n<td style="text-align: center;">\n    <a href="https://allegro.pl/uzytkownik/${e.seller.name}" target="_blank">${e.seller.name}</a>\n</td>\n\n            <td style="text-align: center;">${e.transactions}</td>\n            <td style="text-align: center;">${e.averageSoldItems}</td>\n            <td style="text-align: center;">${e.viewsCount}</td>\n            <td style="text-align: center;">${(100*e.conversion).toFixed(2)}%</td>\n            <td style="text-align: center;">${e.offerPrice.toFixed(2)} z≈Ç</td>\n            <td style="text-align: center;">${e.favoriteAdditionsCount}</td>\n            <td style="text-align: center;">${e.cartAdditionsCount}</td>\n        </tr>\n    `)).join("")}\n                    </tbody>\n                </table>\n            </div>\n        </div>\n    `;document.body.insertAdjacentHTML("beforeend",t);const n=document.createElement("style");n.textContent="\n        table {\n            border-radius: 8px;\n            overflow: hidden;\n        }\n        tbody tr:nth-child(even) {\n            background-color: #f2f2f2; /* Jasnoszare t≈Ço dla parzystych wierszy */\n        }\n        tbody tr:hover {\n            background-color: #e0e0e0; /* Jasnoszare t≈Ço przy najechaniu */\n        }\n        th, td {\n            padding: 12px; /* Wiƒôksze odstƒôpy w kom√≥rkach */\n            border-bottom: 1px solid #ddd; /* Dolna granica */\n            text-align: center; /* Wy≈õrodkowanie tekstu */\n        }\n        th {\n            font-weight: bold; /* Pogrubione nag≈Ç√≥wki */\n        }\n        .filter-icon {\n            cursor: pointer;\n            font-size: 14px;\n            margin-left: 5px;\n            vertical-align: middle; /* Wyr√≥wnanie strza≈Çki w pionie */\n        }\n        .ascending::before {\n            content: 'üîº'; /* Strza≈Çka w g√≥rƒô */\n        }\n        .descending::before {\n            content: 'üîΩ'; /* Strza≈Çka w d√≥≈Ç */\n        }\n    ",document.head.appendChild(n),document.getElementById("closeEntriesModalBtn").addEventListener("click",(()=>{const e=document.getElementById("modal-entries");e&&e.remove()}));const o=document.querySelectorAll(".filter-icon");o.forEach((t=>{t.addEventListener("click",(()=>{const n=parseInt(t.getAttribute("data-col")),r=t.classList.toggle("ascending");o.forEach((e=>{e!==t&&e.classList.remove("ascending","descending")})),r?t.classList.add("ascending"):t.classList.add("descending");const a=[...e].sort(((e,t)=>{let o,a;switch(n){case 2:o=e.transactions,a=t.transactions;break;case 3:o=e.averageSoldItems,a=t.averageSoldItems;break;case 4:o=e.viewsCount,a=t.viewsCount;break;case 5:o=e.conversion,a=t.conversion;break;case 6:o=e.offerPrice,a=t.offerPrice;break;case 7:o=e.favoriteAdditionsCount,a=t.favoriteAdditionsCount;break;case 8:o=e.cartAdditionsCount,a=t.cartAdditionsCount;break;default:return 0}return r?o-a:a-o})).map((e=>`\n                <tr>\n<td style="text-align: center;">\n    <a href="https://allegro.pl/oferta/${e.ids.join(", ")}" target="_blank">${e.ids.join(", ")}</a>\n</td>\n<td style="text-align: center;">\n    <a href="https://allegro.pl/uzytkownik/${e.seller.name}" target="_blank">${e.seller.name}</a>\n</td>\n\n                    <td style="text-align: center;">${e.transactions}</td>\n                    <td style="text-align: center;">${e.averageSoldItems}</td>\n                    <td style="text-align: center;">${e.viewsCount}</td>\n                    <td style="text-align: center;">${(100*e.conversion).toFixed(2)}%</td>\n                    <td style="text-align: center;">${e.offerPrice.toFixed(2)} z≈Ç</td>\n                    <td style="text-align: center;">${e.favoriteAdditionsCount}</td>\n                    <td style="text-align: center;">${e.cartAdditionsCount}</td>\n                </tr>\n            `)).join("");document.getElementById("entriesTableBody").innerHTML=a}))}))}ne&&ne.addEventListener("click",(async function(){ne.disabled=!0,ne.textContent="üîÑ Ponawianie...";for(const r of l.failedFetches)await ae(r,e,t,n,o);0===l.failedFetches.length&&oe(e,t,n,o),ne.disabled=!1,p()}))}catch(We){console.error("WystƒÖpi≈Ç b≈ÇƒÖd podczas pobierania danych:",We);const He=l.errors.some((e=>e.includes("401"))),Ze=He?"Brak dostƒôpu, zaloguj siƒô na w≈Ça≈õciwe konto Analytics":We.message,_e=He?"Zaloguj siƒô na konto z dostƒôpem do Analytics i spr√≥buj ponownie.":"Sprawd≈∫ po≈ÇƒÖczenie internetowe i spr√≥buj ponownie.";i.innerHTML=`\n            <h2 style="margin-top: 0;">Statystyki dla oferty ${e}</h2>\n            <div style="border: 1px solid #ff6b6b; border-radius: 8px; padding: 15px; box-shadow: 0 2px 4px rgba(255,107,107,0.1); margin-bottom: 20px; background-color: #ffe0e0;">\n                <h3 style="color: #d63031; margin-top: 0;">‚ùå B≈ÇƒÖd krytyczny</h3>\n                <p style="color: #d63031;">WystƒÖpi≈Ç b≈ÇƒÖd podczas pobierania danych: ${Ze}</p>\n                <p>${_e}</p>\n            </div>\n        `}}(e,t,n,o)}))}}(i,l)}))}}}}))}function n(e){var t=document.createElement("textarea");t.value=e,t.style.top="0",t.style.left="0",t.style.position="fixed",t.style.opacity="0",document.body.appendChild(t),t.focus(),t.select();try{document.execCommand("copy")?o("ID skopiowane do schowka!"):o("Nie uda≈Ço siƒô skopiowaƒá ID","error")}catch(e){console.error("B≈ÇƒÖd kopiowania:",e),o("Nie uda≈Ço siƒô skopiowaƒá ID","error")}document.body.removeChild(t)}function o(e,t){var n=document.querySelector(".copy-notification");n&&n.remove();var o=document.createElement("div");o.className="copy-notification",o.textContent=e,o.style.position="fixed",o.style.top="20px",o.style.right="20px",o.style.backgroundColor="error"===t?"#dc3545":"#28a745",o.style.color="#fff",o.style.padding="12px 20px",o.style.borderRadius="5px",o.style.zIndex="10001",o.style.fontSize="14px",o.style.fontWeight="bold",o.style.boxShadow="0 2px 10px rgba(0,0,0,0.3)",o.style.transition="opacity 0.3s ease",document.body.appendChild(o),setTimeout((function(){o.style.opacity="0",setTimeout((function(){o.parentNode&&o.parentNode.removeChild(o)}),300)}),3e3)}function r(e){return new Intl.NumberFormat("pl-PL",{style:"currency",currency:"PLN"}).format(e)}function r(e){return new Intl.NumberFormat("pl-PL",{style:"currency",currency:"PLN"}).format(e)}function a(e){var t=new Date(e);return`${String(t.getDate()).padStart(2,"0")}.${String(t.getMonth()+1).padStart(2,"0")}`}function s(e){var t=new Date(e);return`${String(t.getDate()).padStart(2,"0")}-${String(t.getMonth()+1).padStart(2,"0")}-${t.getFullYear()} | ${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}`}}(),function(){"use strict";function e(){const e=document.querySelector('div[data-box-name="Description card"]');if(!e)return;if(document.getElementById("kopiuj-opis-btn"))return;const t=document.createElement("button");t.id="kopiuj-opis-btn",t.innerText="üìã Kopiuj opis",t.style.position="relative",t.style.zIndex="9999",t.style.marginBottom="10px",t.style.padding="10px 20px",t.style.backgroundColor="#ff5a00",t.style.color="#fff",t.style.border="none",t.style.cursor="pointer",t.style.fontSize="16px",t.style.borderRadius="5px",t.addEventListener("click",(()=>{const n=function(e){const t=["P","H1","H2","H3","H4","H5","H6","OL","LI","STRONG","EM","SPAN"];let n="";return function e(o){if(t.includes(o.tagName)){const e=o.innerText.trim();e&&(n+=e+"\n")}for(let t of o.children)e(t)}(e),n.trim()}(e);if(n){GM_setClipboard(n);const e=t.innerText;t.innerText="‚úÖ Skopiowano!",t.style.backgroundColor="#28a745",setTimeout((()=>{t.innerText=e,t.style.backgroundColor="#ff5a00"}),2e3)}else{const e=t.innerText;t.innerText="‚ùå Brak tekstu",t.style.backgroundColor="#dc3545",setTimeout((()=>{t.innerText=e,t.style.backgroundColor="#ff5a00"}),2e3)}})),e.parentElement.insertBefore(t,e)}function t(){let e=document.createElement("div");e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.backgroundColor="#fff",e.style.padding="35px",e.style.zIndex="10000",e.style.boxShadow="0px 0px 10px rgba(0, 0, 0, 0.5)",e.style.maxHeight="80%",e.style.maxWidth="80%",e.style.overflowY="auto",e.style.display="grid",e.style.gridTemplateColumns="repeat(auto-fill, minmax(150px, 1fr))",e.style.gridGap="10px",e.style.paddingBottom="60px";let t=document.createElement("button");t.innerText="x",t.style.position="absolute",t.style.top="5px",t.style.right="5px",t.style.backgroundColor="#ff5a00",t.style.color="#fff",t.style.border="none",t.style.cursor="pointer",t.style.fontSize="16px",t.style.borderRadius="50%",t.style.width="30px",t.style.height="30px",t.style.zIndex="9999",t.onclick=function(){document.body.removeChild(e)},e.appendChild(t);let o=function(){let e=[],t=document.querySelector('div[data-box-name="showoffer.gallery"]');if(t){t.querySelectorAll("button:not([aria-label])").forEach((t=>{let n=t.querySelector("img");if(n){let t=n.src.replace("/s128/","/original/")+".jpg";e.push(t)}}))}return e}();o.forEach((t=>{let o=document.createElement("div");o.style.position="relative",o.style.overflow="hidden",o.style.border="1px solid #ddd",o.style.borderRadius="5px",o.style.padding="5px",o.style.backgroundColor="#f9f9f9";let r=document.createElement("img");r.src=t,r.style.width="150px",r.style.height="230px",r.style.objectFit="cover",o.appendChild(r);let a=document.createElement("button");a.innerText="Pobierz",a.style.position="absolute",a.style.bottom="10px",a.style.left="50%",a.style.transform="translateX(-50%)",a.style.padding="5px 10px",a.style.backgroundColor="#ff5a00",a.style.color="#fff",a.style.border="none",a.style.cursor="pointer",a.style.borderRadius="3px",a.onclick=function(){GM_download(t,n(t))},o.appendChild(a),e.appendChild(o)}));let r=document.createElement("div");r.style.width="100%",r.style.display="flex",r.style.justifyContent="center",r.style.position="absolute",r.style.bottom="10px";let a=document.createElement("button");a.innerText="Pobierz wszystkie",a.style.padding="10px 20px",a.style.backgroundColor="rgb(255, 90, 0)",a.style.color="rgb(255, 255, 255)",a.style.border="none",a.style.cursor="pointer",a.style.fontSize="16px",a.style.borderRadius="5px",a.onclick=function(){o.forEach((e=>GM_download(e,n(e))))},r.appendChild(a),e.appendChild(r),document.body.appendChild(e)}function n(e){return e.split("/").pop()}window.vSprintPlusSettings&&!1===window.vSprintPlusSettings.img||(window.addEventListener("load",(()=>{setTimeout(e,2e3)})),new MutationObserver((function(e){e.forEach((function(e){if(e.addedNodes.length>0){let e=document.querySelector('div[data-box-name="showoffer.gallery"]');if(e&&!e.querySelector("button.download-button")){let n=function(){let e=document.createElement("button");return e.innerText="Pobierz zdjƒôcia",e.style.position="relative",e.style.zIndex="9999",e.style.marginTop="10px",e.style.padding="10px 20px",e.style.backgroundColor="#ff5a00",e.style.color="#fff",e.style.border="none",e.style.cursor="pointer",e.style.fontSize="16px",e.style.borderRadius="5px",e.onclick=t,e}();n.classList.add("download-button"),e.appendChild(n)}}}))})).observe(document.body,{childList:!0,subtree:!0}))}(),function(){"use strict";if(window.vSprintPlusSettings&&!1===window.vSprintPlusSettings.kampanie)return;if(!window.location.href.match(/^https:\/\/salescenter\.allegro\.com\/campaigns/))return;let e=!1,t=!1;window.addEventListener("load",(function(){!function(){const e=document.createElement("div");e.style.position="fixed",e.style.top="10px",e.style.right="10px",e.style.zIndex="9999",e.style.background="#23272e",e.style.padding="16px 20px",e.style.borderRadius="10px",e.style.boxShadow="0 4px 24px rgba(0,0,0,0.18)",e.style.display="flex",e.style.alignItems="center",e.style.gap="16px",e.style.fontFamily="inherit";const n=document.createElement("button");n.innerText="Pobierz raport",n.style.background="#23272e",n.style.color="#fff",n.style.border="1.5px solid #ff5a00",n.style.padding="10px 20px",n.style.fontSize="16px",n.style.borderRadius="8px",n.style.cursor="pointer",n.style.fontWeight="bold",n.style.boxShadow="0 2px 8px rgba(0,0,0,0.10)",n.style.transition="background 0.2s, color 0.2s",n.onmouseenter=()=>{n.style.background="#ff5a00",n.style.color="#fff"},n.onmouseleave=()=>{n.style.background="#23272e",n.style.color="#fff"},n.style.top="10px",n.style.right="20px";const o=document.createElement("input");o.type="checkbox",o.checked=t,o.style.width="20px",o.style.height="20px",o.style.cursor="pointer",o.style.accentColor="#ff5a00",o.style.margin="0 0 0 8px",o.title="Aktywuj/dezaktywuj zbieranie danych";const r=document.createElement("label");r.innerText="Aktywne",r.style.color="#fff",r.style.fontSize="15px",r.style.marginLeft="4px",r.style.cursor="pointer",r.htmlFor="allegro-days-checkbox",o.id="allegro-days-checkbox";const a=document.createElement("div");a.style.position="absolute",a.style.top="54px",a.style.left="0",a.style.width="220px",a.style.height="220px",a.style.display="none",a.style.background="#23272e",a.style.border="1.5px solid #ff5a00",a.style.fontSize="15px",a.style.padding="24px",a.style.fontWeight="bold",a.style.textAlign="center",a.style.display="none",a.style.alignItems="center",a.style.justifyContent="center",a.style.lineHeight="1.5",a.style.pointerEvents="none",a.style.userSelect="none",a.style.whiteSpace="pre-line",a.style.transition="opacity 0.2s",a.style.opacity="1",a.innerText="aby pobraƒá raport,\nwybierz kampaniƒô AlleObni≈ºka,\nzjed≈∫ na sam d√≥≈Ç i kliknij,\naby wy≈õwietla≈Ço 200 ofert\nna jednej stronie (po lewej stronie).",e.style.position="fixed",e.appendChild(a),o.addEventListener("change",(function(){t=o.checked,console.log("Checkbox jest teraz:",t?"zaznaczony":"odznaczony")})),n.onclick=function(){a.style.display="flex",a.style.opacity="1",setTimeout((()=>{a.style.opacity="0",setTimeout((()=>{a.style.display="none"}),300)}),15e3)},e.appendChild(n),e.appendChild(o),e.appendChild(r),e.appendChild(a),document.body.appendChild(e)}()})),document.addEventListener("click",(function(n){n.target.closest('button[value="200"]')&&(t?(console.log("Checkbox jest zaznaczony ‚Äì przygotowujƒô siƒô do przechwycenia ≈ºƒÖdania..."),e=!0):(console.log("Checkbox NIE jest zaznaczony ‚Äì skrypt nie zostanie uruchomiony."),e=!1))}));const n=window.fetch;window.fetch=function(...o){const r=o[0];return e&&"string"==typeof r&&r.includes("eligible?limit=200")?(console.log("[ZBIERACZ] Wykryto fetch do:",r),n(...o).then((n=>(n.clone().json().then((n=>{if(console.log("[ZBIERACZ] Odpowied≈∫:",n),n.items&&Array.isArray(n.items)){const e=n.items.map((e=>{const t=parseFloat(e.buyNowPrice.amount.replace(",",".")),n=parseFloat(e.cofinanceInfo.requiredMerchantPrice.amount.replace(",",".")),o=parseFloat(((t-n)/t*100).toFixed(2)),r=parseFloat(e.cofinanceInfo.merchantPriceDiscount.points)/100*n;return{id:e.offerId,sku:e.externalId,ean:e.ean,nazwa:e.offerTitle,cena:t,wymagana_obnizka:n,procent_obnizki:o,limit:e.cofinanceInfo.purchaseLimit,obnizka_allegro:r}})),o=XLSX.utils.json_to_sheet(e),r=XLSX.utils.book_new();XLSX.utils.book_append_sheet(r,o,"Dane");const a={cellDates:!0,cellText:!1},s={font:{bold:!1},alignment:{horizontal:"right"},numberFormat:"0.00%"};o["!cols"]=o["!cols"]||[],o["!cols"][2]=s,XLSX.writeFile(r,"AllegroDays - zestawienie.xlsx",a);const i=document.getElementById("allegro-days-checkbox");i&&(i.checked=!1,t=!1)}else console.warn('Odpowied≈∫ nie zawiera danych "items", nie mo≈ºna przetworzyƒá danych do Excela.');e=!1})),n)))):n(...o)};const o=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(t,n,...r){return this._isEligibleRequest=e&&"string"==typeof n&&n.includes("eligible?limit=200"),o.call(this,t,n,...r)};const r=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.send=function(...n){if(this._isEligibleRequest){const n=this,o=function(){try{const e=JSON.parse(n.responseText);if(console.log("[ZBIERACZ][XHR] Odpowied≈∫:",e),e.items&&Array.isArray(e.items)){const n=e.items.map((e=>{const t=parseFloat(e.buyNowPrice.amount.replace(",",".")),n=parseFloat(e.cofinanceInfo.requiredMerchantPrice.amount.replace(",",".")),o=parseFloat(((t-n)/t*100).toFixed(2)),r=parseFloat(e.cofinanceInfo.merchantPriceDiscount.points)/100*n;return{id:e.offerId,sku:e.externalId,ean:e.ean,nazwa:e.offerTitle,cena:t,wymagana_obnizka:n,procent_obnizki:o,limit:e.cofinanceInfo.purchaseLimit,obnizka_allegro:r}})),o=XLSX.utils.json_to_sheet(n),r=XLSX.utils.book_new();XLSX.utils.book_append_sheet(r,o,"Dane");const a={cellDates:!0,cellText:!1},s={font:{bold:!1},alignment:{horizontal:"right"},numberFormat:"0.00%"};o["!cols"]=o["!cols"]||[],o["!cols"][2]=s,XLSX.writeFile(r,"AllegroDays - zestawienie.xlsx",a);const i=document.getElementById("allegro-days-checkbox");i&&(i.checked=!1,t=!1)}else console.warn('Odpowied≈∫ nie zawiera danych "items", nie mo≈ºna przetworzyƒá danych do Excela.')}catch(e){console.warn("Nie uda≈Ço siƒô sparsowaƒá odpowiedzi:",e)}e=!1};this.addEventListener("load",o)}return r.apply(this,n)}}(),function(){"use strict";function e(){const o=document.querySelector('[data-testid="reco-offers"]');if(console.log("searchContainer:",o),o){const e=document.createElement("input");e.setAttribute("id","offerSearchBox"),e.setAttribute("placeholder","Wpisz numery ofert (np. 12345, 67890)"),e.style.padding="10px",e.style.margin="10px",e.style.fontSize="16px",e.style.width="100%",e.addEventListener("input",t);const r=document.createElement("button");r.textContent="Zaznacz wszystkie widoczne",r.style.padding="10px",r.style.margin="10px",r.style.fontSize="16px",r.addEventListener("click",n),o.insertAdjacentElement("beforebegin",e),o.insertAdjacentElement("beforebegin",r),console.log("Search box and mass select button added!")}else console.log("Nie znaleziono kontenera z ofertami, spr√≥bujmy ponownie za chwilƒô..."),setTimeout(e,1e3)}function t(){const e=document.getElementById("offerSearchBox").value.trim();console.log("Wyszukiwanie dla:",e);const t=e.split(/[\s,]+/).filter(Boolean);if(t.length>0){const e=document.querySelectorAll(".mpof_ki");console.log("Znalezione oferty:",e.length),e.forEach((e=>{const n=e.querySelector('[data-testid="campaigns-recolist-offerId"]');n&&t.includes(n.textContent.trim())?e.style.display="":e.style.display="none"}))}else{document.querySelectorAll(".mpof_ki").forEach((e=>{e.style.display=""}))}}function n(){document.querySelectorAll(".mpof_ki").forEach((e=>{if("none"!==e.style.display){const t=e.querySelector('input[type="checkbox"]');if(t){t.checked=!t.checked;const n=new Event("change",{bubbles:!0,cancelable:!0});t.dispatchEvent(n),console.log(`Checkbox dla oferty ${e.querySelector('[data-testid="campaigns-recolist-offerId"]').textContent} zmieniony na: ${t.checked}`)}}}))}window.vSprintPlusSettings&&!1===window.vSprintPlusSettings.kampFiltr||window.location.href.match(/^https:\/\/salescenter\.allegro\.com\/campaigns/)&&window.addEventListener("load",(()=>{console.log("Strona za≈Çadowana, dodajemy wyszukiwarkƒô..."),e()}))}(),function(){"use strict";const e=[{key:"oceny",label:"Raport z ocen"},{key:"filtr",label:"Wyszukiwarka SKU/ID"},{key:"info",label:"vSprint info"},{key:"img",label:"Image/Desc Downloader"},{key:"kampanie",label:"Asystent Kampanii"},{key:"kampFiltr",label:"Filtr ofert w kampaniach"},{key:"kopiujId",label:"Kopiuj ID"},{key:"edytuj",label:"Edytuj"}];function t(){if(document.getElementById("vsprintplus-modal"))return;const t=function(){let t={};try{t=JSON.parse(localStorage.getItem("vSprintPlusSettings")||"{}")}catch(e){}return e.forEach((e=>{void 0===t[e.key]&&(t[e.key]=!0)})),t}(),n=document.createElement("div");n.id="vsprintplus-modal",n.style.position="fixed",n.style.right="24px",n.style.bottom="70px",n.style.background="#fff",n.style.border="1.5px solid #ff5a00",n.style.borderRadius="12px",n.style.boxShadow="0 4px 24px rgba(0,0,0,0.18)",n.style.padding="28px 32px 20px 32px",n.style.zIndex="100000",n.style.minWidth="300px",n.style.fontSize="16px",n.style.display="flex",n.style.flexDirection="column",n.style.gap="14px",n.style.fontFamily="inherit";const o=document.createElement("div");o.textContent="vSprint Allegro+",o.style.fontWeight="bold",o.style.fontSize="20px",o.style.marginBottom="16px",o.style.color="#ff5a00",o.style.letterSpacing="1px",o.style.textAlign="center",n.appendChild(o),e.forEach((e=>{const o=document.createElement("label");o.style.display="flex",o.style.fontFamily='"Open Sans","Helvetica Neue",Helvetica,Arial,sans-serif',o.style.alignItems="center",o.style.gap="10px",o.style.color="#23272e",o.style.fontSize="16px",o.style.padding="4px 0";const r=document.createElement("input");r.type="checkbox",r.checked=!!t[e.key],r.style.width="20px",r.style.height="20px",r.style.accentColor="#ff5a00",r.onchange=function(){t[e.key]=r.checked,function(e){localStorage.setItem("vSprintPlusSettings",JSON.stringify(e))}(t)},o.appendChild(r),o.appendChild(document.createTextNode(e.label)),n.appendChild(o)}));const r=document.createElement("button");r.textContent="Zamknij",r.style.marginTop="22px",r.style.alignSelf="center",r.style.background="rgb(255, 90, 0)",r.style.color="#fff",r.style.border="none",r.style.borderRadius="8px",r.style.padding="10px 28px",r.style.fontSize="16px",r.style.cursor="pointer",r.style.fontWeight="bold",r.style.boxShadow="0 2px 8px rgba(0,0,0,0.10)",r.onclick=()=>n.remove(),n.appendChild(r),document.body.appendChild(n)}!function(){if(document.getElementById("vsprintplus-btn"))return;const e=document.createElement("button");e.id="vsprintplus-btn",e.textContent="vS+",e.style.position="fixed",e.style.right="0px",e.style.bottom="24px",e.style.borderRadius="16px 0 0 16px",e.style.zIndex="99999",e.style.background="rgb(255, 90, 0)",e.style.color="#fff",e.style.border="none",e.style.padding="10px 10px 10px 18px",e.style.fontSize="16px",e.style.boxShadow="0 2px 8px rgba(0,0,0,0.15)",e.style.cursor="pointer",e.style.transition="width 0.2s, min-width 0.2s, padding 0.2s, background 0.2s, color 0.2s",e.style.overflow="hidden",e.style.whiteSpace="nowrap",e.style.width="54px",e.style.minWidth="54px",e.style.textAlign="center",e.onmouseenter=function(){e.textContent="vSprint Allegro+",e.style.width="148px",e.style.minWidth="148px",e.style.padding="10px 18px 10px 18px"},e.onmouseleave=function(){e.textContent="vS+",e.style.width="54px",e.style.minWidth="54px",e.style.padding="10px 10px 10px 18px"},e.onclick=t,document.body.appendChild(e)}()}(),function(){"use strict";function e(){let e=function(){const e=document.querySelector('meta[name="description"]');if(e){const t=e.getAttribute("content").match(/Oferta (\d+)$/);if(t)return t[1]}return null}();return e||(e=function(){const e=document.querySelector('link[rel="canonical"]');if(e){const t=e.getAttribute("href").match(/-(\d+)$/);if(t)return t[1]}return null}()),e}function t(e){var t=document.createElement("textarea");t.value=e,t.style.top="0",t.style.left="0",t.style.position="fixed",t.style.opacity="0",document.body.appendChild(t),t.focus(),t.select();try{document.execCommand("copy")?n("ID skopiowane do schowka!"):n("Nie uda≈Ço siƒô skopiowaƒá ID","error")}catch(e){console.error("B≈ÇƒÖd kopiowania:",e),n("Nie uda≈Ço siƒô skopiowaƒá ID","error")}document.body.removeChild(t)}function n(e,t){var n=document.querySelector(".copy-notification");n&&n.remove();var o=document.createElement("div");o.className="copy-notification",o.textContent=e,o.style.position="fixed",o.style.top="20px",o.style.right="20px",o.style.backgroundColor="error"===t?"#dc3545":"#28a745",o.style.color="#fff",o.style.padding="12px 20px",o.style.borderRadius="5px",o.style.zIndex="10001",o.style.fontSize="14px",o.style.fontWeight="bold",o.style.boxShadow="0 2px 10px rgba(0,0,0,0.3)",o.style.transition="opacity 0.3s ease",document.body.appendChild(o),setTimeout((function(){o.style.opacity="0",setTimeout((function(){o.parentNode&&o.parentNode.removeChild(o)}),300)}),3e3)}function o(){if(document.querySelector(".offer-edytuj-btn")||document.querySelector(".offer-copy-id-btn"))return;const o=e();if(!o)return void console.log("Nie uda≈Ço siƒô pobraƒá ID oferty");const r=document.querySelector('[data-role="offer-header"]')||document.querySelector(".offer-header")||document.querySelector("h1")||document.querySelector(".offer-title")||document.body;if(!r)return void console.log("Nie znaleziono kontenera na przyciski");const a=document.createElement("div");if(a.style.position="relative",a.style.marginTop="10px",a.style.marginBottom="10px",a.style.display="flex",a.style.gap="10px",a.style.flexWrap="wrap",window.vSprintPlusSettings&&!1!==window.vSprintPlusSettings.edytuj){const e=document.createElement("button");e.className="offer-edytuj-btn",e.innerHTML="Edytuj",e.style.padding="10px 16px",e.style.backgroundColor="#6c757d",e.style.color="#fff",e.style.border="none",e.style.borderRadius="5px",e.style.cursor="pointer",e.style.fontSize="14px",e.style.fontWeight="bold",e.style.transition="background 0.2s",e.onmouseenter=function(){e.style.backgroundColor="#5a6268"},e.onmouseleave=function(){e.style.backgroundColor="#6c757d"},e.onclick=function(e){e.preventDefault(),function(e){if(!e)return void n("Nie uda≈Ço siƒô pobraƒá ID oferty","error");const t=`https://salescenter.allegro.com/offer/${e}`;window.open(t,"_blank"),n("Otwieranie strony edycji oferty...","success")}(o)},a.appendChild(e)}if(window.vSprintPlusSettings&&!1!==window.vSprintPlusSettings.kopiujId){const e=document.createElement("button");e.className="offer-copy-id-btn",e.innerHTML="Kopiuj ID",e.style.padding="10px 16px",e.style.backgroundColor="#28a745",e.style.color="#fff",e.style.border="none",e.style.borderRadius="5px",e.style.cursor="pointer",e.style.fontSize="14px",e.style.fontWeight="bold",e.style.transition="background 0.2s",e.onmouseenter=function(){e.style.backgroundColor="#218838"},e.onmouseleave=function(){e.style.backgroundColor="#28a745"},e.onclick=function(e){var r;e.preventDefault(),r=o,"undefined"!=typeof GM_setClipboard?(GM_setClipboard(r),n("ID skopiowane do schowka!")):navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(r).then((function(){n("ID skopiowane do schowka!")})).catch((function(e){console.error("B≈ÇƒÖd kopiowania do schowka:",e),t(r)})):t(r)},a.appendChild(e)}r.appendChild(a),console.log("Przyciski oferty dodane, ID:",o)}window.vSprintPlusSettings&&!1===window.vSprintPlusSettings.edytuj&&window.vSprintPlusSettings&&!1===window.vSprintPlusSettings.kopiujId||window.location.href.match(/^https:\/\/allegro\.pl\/oferta\//)&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",o):o(),setTimeout(o,1e3))}();