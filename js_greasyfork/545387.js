// ==UserScript==
// @name         Kaspersky CyberTrace 5.1 WEB CN
// @namespace    http://tampermonkey.net/
// @version      1.32
// @description  将 Kaspersky CyberTrace Web 控制台的英文界面翻译成中文。
// @author       ste
// @match        https://192.168.31.84/*
// @grant        none
// @run-at       document-idle
// @downloadURL https://update.greasyfork.org/scripts/545387/Kaspersky%20CyberTrace%2051%20WEB%20CN.user.js
// @updateURL https://update.greasyfork.org/scripts/545387/Kaspersky%20CyberTrace%2051%20WEB%20CN.meta.js
// ==/UserScript==

(function() {
    'use strict';

    // 静态翻译规则 (使用 Map 进行 O(1) 快速查找)
    // 请在此处不断添加 CyberTrace 的英文原文和中文译文
    const staticTranslations = new Map([
        // 通用词汇
        ['Sign in', '登录'],
        ['User name', '用户名'],
        ['Password', '密码'],
        ['Forgot password?', '忘记密码？'],
        ['Open CyberTrace documentation', '打开 CyberTrace 文档'],
        ['English', '简体中文'],
        ['Welcome to Kaspersky CyberTrace', '欢迎使用 Kaspersky CyberTrace'],
        ['Interface language', '界面语言'],
        ['This wizard will help you configure Kaspersky CyberTrace. Follow the provided instructions to set up connection, configure proxy settings, and select the feeds used by Kaspersky CyberTrace.', '此向导将帮助您配置 Kaspersky CyberTrace。请按照提供的说明设置连接、配置代理设置，并选择 Kaspersky CyberTrace 使用的订阅源。'],
        ['Kaspersky CyberTrace is a Threat Intelligence Platform that helps analysts make timely and better-informed decisions. Kaspersky CyberTrace operationalizes threat intelligence and seamlessly integrates threat data feeds with event sources.', 'Kaspersky CyberTrace 是一个威胁情报平台，可帮助分析师及时做出更明智的决策。Kaspersky CyberTrace 将威胁情报付诸实践，并将威胁数据订阅源与事件源无缝集成。'],
        ['Proxy settings', '代理设置'],
        ['Back', '返回'],
        ['Next', '下一步'],
        ['Specify proxy parameters for Kaspersky CyberTrace.', '为 Kaspersky CyberTrace 指定代理参数。'],
        ['Use proxy server', '使用代理服务器'],
        ['IP address or host name', 'IP 地址或主机名'],
        ['Port', '端口'],
        ['Use proxy credentials', '使用代理凭据'],
        ['Licensing settings', '许可设置'],
        ['Community Edition', '社区版'],
        ['This is a limited licensing level where Kaspersky CyberTrace can be used without a license key.', '这是一个受限的许可级别，Kaspersky CyberTrace 可以在没有许可证密钥的情况下使用。'],
        ['Community Edition can be used for evaluation purposes and has a number of limitations.', '社区版可用于评估目的，并有一些限制。'],
        ['Activation code', '激活码'],
        ['Add a license key by using an activation code.', '使用激活码添加许可证密钥。'],
        ['If you do not have an activation code, you can contact your Account Manager or add a license key by using a license key file.', '如果您没有激活码，可以联系您的客户经理或使用许可证密钥文件添加许可证密钥。'],
        ['Key file', '密钥文件'],
        ['Add a license key by using a license key file.', '使用许可证密钥文件添加许可证密钥。'],
        ['If you do not have a license key file, you can contact your Account Manager.', '如果您没有许可证密钥文件，可以联系您的客户经理。'],
        ['License key file', '许可证密钥文件'],
        ['Field cannot be empty', '字段不能为空'],
        ['Service settings', '服务设置'],
        ['System EPS limit', '系统 EPS 限制'],
        ['EPS limit', 'EPS 限制'],
        ['The system EPS limit is defined in the license and cannot be modified here', '系统 EPS 限制在许可证中定义，此处无法修改'],
        ['Calculate your available EPS', '计算您的可用 EPS'],
        ['Service alerts', '服务告警'],
        ['Settings of sending service alerts that inform another software (for example, SIEM system) about the state of Kaspersky CyberTrace Service.', '发送服务告警的设置，用于通知其他软件（例如 SIEM 系统）Kaspersky CyberTrace 服务的状态。'],
        ['Enabled', '已启用'],
        ['If you do not specify the IP address and port, service alerts will not be sent.', '如果您不指定 IP 地址和端口，将不会发送服务告警。'],
        ['Web interface', 'Web 界面'],
        ['Specify the IP address or host name of the server where Kaspersky CyberTrace is installed.', '指定安装 Kaspersky CyberTrace 的服务器的 IP 地址或主机名。'],
        ['Data management settings', '数据管理设置'],
        ['SIEM system', 'SIEM 系统'],
        ['Select the SIEM system to integrate Kaspersky CyberTrace with.', '选择要与 Kaspersky CyberTrace 集成的 SIEM 系统。'],
        ['Select SIEM system', '选择 SIEM 系统'],
        ['Incoming events', '传入事件'],
        ['Define the parameters of the socket that Kaspersky CyberTrace will use to listen to incoming events.', '定义 Kaspersky CyberTrace 将用于侦听传入事件的套接字参数。'],
        ['IP address', 'IP 地址'],
        ['IP address and port', 'IP 地址和端口'],
        ['UNIX socket', 'UNIX 套接字'],
        ['Detection alerts', '检测告警'],
        ['Define the parameters that will be used for outgoing alerts about detections.', '定义将用于传出检测告警的参数。'],
        ['Certificate settings', '证书设置'],
        ['Demo certificate', '演示证书'],
        ['This certificate allows access to the demo versions of Kaspersky Threat Data Feeds.', '此证书允许访问卡巴斯基威胁数据订阅源的演示版本。'],
        ['Commercial certificate', '商业证书'],
        ['Import a commercial Kaspersky Threat Data Feeds certificate from a .pem file.', '从 .pem 文件导入商业卡巴斯基威胁数据订阅源证书。'],
        ['Feeds settings', '订阅源设置'],
        ['Select Kaspersky Threat Data Feeds that must be used by Kaspersky CyberTrace. You can also add third-party feeds on the "Settings" tab after the initial setup is completed.', '选择 Kaspersky CyberTrace 必须使用的卡巴斯基威胁数据订阅源。您也可以在初始设置完成后，在“设置”选项卡上添加第三方订阅源。'],
        ['Clear all', '全部清除'],
        ['Kaspersky Botnet CnC URL Data Feed', '卡巴斯基僵尸网络 C&C URL 数据订阅源'],
        ['Kaspersky IP Reputation Data Feed', '卡巴斯基 IP 信誉数据订阅源'],
        ['Kaspersky Malicious Hash Data Feed', '卡巴斯基恶意哈希数据订阅源'],
        ['Kaspersky Malicious URL Data Feed', '卡巴斯基恶意 URL 数据订阅源'],
        ['Kaspersky Phishing URL Data Feed', '卡巴斯基钓鱼 URL 数据订阅源'],
        ['Kaspersky Ransomware URL Data Feed', '卡巴斯基勒索软件 URL 数据订阅源'],
        ['Initial setup is complete', '初始设置已完成'],
        ['To finish the setup, integrate Kaspersky CyberTrace with an event source.', '要完成设置，请将 Kaspersky CyberTrace 与事件源集成。'],
        ['You can also:', '您还可以：'],
        ['Steps for integrating Kaspersky CyberTrace with a SIEM system', '将 Kaspersky CyberTrace 与 SIEM 系统集成的步骤'],
        ['Configure additional tenants for the multi-tenant configuration', '为多租户配置配置额外的租户'],
        ['Read the Administrator guides', '阅读管理员指南'],
        ['Finish', '完成'],
        ['Dashboard', '仪表板'],
        ['Statistics overview', '统计概览'],
        ['Day', '天'],
        ['Week', '周'],
        ['Month', '月'],
        ['Download report', '下载报告'],
        ['3 months', '3 个月'],
        ['Custom range', '自定义范围'],
        ['Full-screen mode', '全屏模式'],
        ['Settings', '设置'],
        ['General', '通用'],
        ['Show false positives', '显示误报'],
        ['Auto-update dashboard', '自动更新仪表板'],
        ['Enable additional widgets', '启用附加小组件'],
        ['Show statistics', '显示统计信息'],
        ['API lookup', 'API 查询'],
        ['Widgets', '小组件'],
        ['Hide all', '全部隐藏'],
        ['Top indicators by detection', '按检测量统计的热门指标'],
        ['Matching statistics', '匹配统计'],
        ['Supplier statistics', '供应商统计'],
        ['Supplier intersections', '供应商交集'],
        ['Save', '保存'],
        ['Cancel', '取消'],
        // ['Incoming events', '传入事件'], // 重复了，上面已有
        ['Number of detections', '检测数量'],
        ['Number of detected indicators', '检测到的指标数量'],
        ['Checked', '已检查'],
        ['Detected', '已检测'],
        ['False positives', '误报'],
        ['Indicators', '指标'],
        ['Last update date', '上次更新日期'],
        ['Supplier name', '供应商名称'],
        ['System management', '系统管理'],
        // ['Data management', '数据管理'], // 重复了，下面已有
        ['Retrospective scan is disabled. Enable and configure it in the "Settings" → "Retroscan" section.', '回溯扫描已禁用。请在“设置”→“回溯扫描”部分启用并配置它。'],
        ['You are in System management mode', '您正处于系统管理模式'],
        ['Go to the settings', '转到设置'],
        ['Number of saved events', '已保存事件数量'],
        ['Size of saved events', '已保存事件大小'],
        ['Tasks finished', '已完成任务'],
        ['Next scheduled retroscan', '下一次计划的回溯扫描'],
        ['Start now', '立即开始'],
        ['Results', '结果'],
        ['Show only retroscan results with detection', '仅显示有检测结果的回溯扫描'],
        ['Status', '状态'],
        ['Date and time', '日期和时间'],
        ['Scanned indicators', '已扫描指标'],
        ['Detected indicators', '已检测指标'],
        ['Actions', '操作'],
        ['No data found', '未找到数据'],
        ['Retroscan', '回溯扫描'],
        ['Tasks', '任务'],
        ['Statuses', '状态'],
        ['Failed', '失败'],
        ['Canceled', '已取消'],
        ['Completed', '已完成'],
        ['In progress', '进行中'],
        ['Show system tasks', '显示系统任务'],
        ['Name', '名称'],
        ['User', '用户'],
        ['Start time', '开始时间'],
        ['End time', '结束时间'],
        ['Feeds update', '订阅源更新'],
        ['Data management', '数据管理'],
    ['Kaspersky FalsePositive', '卡巴斯基误报'],
    ['Kaspersky InternalTI', '卡巴斯基内部威胁情报'],
    ['Change password', '更改密码'],
    ['Current password', '当前密码'],
    ['New password', '新密码'],
    ['Confirm password', '确认密码'],
    ['All fields must be filled in.', '所有字段都必须填写。'],
    ['The password must contain between 6 and 30 characters.', '密码必须包含 6 到 30 个字符。'],
    ['The password must contain printable ASCII characters only, excluding spaces.', '密码只能包含可打印的 ASCII 字符，不包括空格。'],
    ['The password must contain at least one digit.', '密码必须至少包含一个数字。'],
    ['The password must contain at least one special character (!, #, %, etc.).', '密码必须至少包含一个特殊字符（!、#、% 等）。'],
    ['The password must contain uppercase and lowercase Latin letters.', '密码必须包含大小写拉丁字母。'],
    ['The new password cannot match the current one.', '新密码不能与当前密码相同。'],
    ['"New password" and "Confirm password" fields must match.', '“新密码”和“确认密码”字段必须匹配。'],
    ['Reset changes', '重置更改'],
    ['Sign out', '退出登录'],
    ['Account', '账户'],
    ['Completed', '已完成'],
    ['Service', '服务'],
    ['Service status', '服务状态'],
    ['Feeds are being updated', '订阅源正在更新'],
    ['Run self-test', '运行自检'],
    ['Restart service', '重启服务'],
    ['Reset statistics', '重置统计信息'],
    ['Export configuration files', '导出配置文件'],
    ['Connection', '连接'],
    ['Proxy server', '代理服务器'],
    ['Average system EPS', '平均系统 EPS'],
    ['Specify the IP address or host name of the server where Kaspersky CyberTrace is installed.', '指定安装 Kaspersky CyberTrace 的服务器的 IP 地址或主机名。'],
    ['Settings of service alerts that inform another software (for example, the SIEM system) about the status of Kaspersky CyberTrace Service.', '服务告警设置，用于通知其他软件（例如 SIEM 系统）Kaspersky CyberTrace 服务的状态。'],
    ['We do not recommend typing the format strings manually. Instead, configure event formats by selecting from the provided check boxes.', '我们不建议手动输入格式字符串。请通过选择提供的复选框来配置事件格式。'],
    ['View more information', '查看更多信息'],
    ['Service fields', '服务字段'],
    ['Alert—Type of service alert', '告警-服务告警类型'],
    ['RecordContext—Context of service alert', '记录上下文-服务告警上下文'],
    ['Date—Date and time when the alert was created', '日期-告警创建的日期和时间'],
    ['Format of service alerts', '服务告警格式'],
    ['Format of records context', '记录上下文格式'],
    ['You have unsaved changes', '您有未保存的更改'],
    ['If you leave this page, all changes will be lost.', '如果您离开此页面，所有更改将丢失。'],
    ['Do you want to stay on this page?', '您要留在此页面吗？'],
    ['Stay', '留下'],
    ['Leave', '离开'],
    ['Users', '用户'],
    ['Accounts of users who can manage Kaspersky CyberTrace.', '可以管理 Kaspersky CyberTrace 的用户账户。'],
    ['Local users', '本地用户'],
    ['LDAP users', 'LDAP 用户'],
    ['Add user', '添加用户'],
    ['Login', '登录名'],
    ['Full name', '全名'],
    ['Role', '角色'],
    ['Tenants', '租户'],
    ['Settings of tenants. A tenant is a client-specific set of configuration parameters. Tenants are especially useful if you are a Managed Security Service Provider, to help you differentiate your customers within a single Kaspersky CyberTrace instance.', '租户设置。租户是一组特定于客户端的配置参数。如果您是托管安全服务提供商，租户尤其有用，可以帮助您在单个 Kaspersky CyberTrace 实例中区分您的客户。'],
    ['Sum of tenant EPS limits', '租户 EPS 限制总和'],
    ['Add tenant', '添加租户'],
    ['Average tenant EPS', '平均租户 EPS'],
    ['Tenant EPS limit', '租户 EPS 限制'],
    ['Description', '描述'],
    ['Update frequency', '更新频率'],
    ['Last update', '上次更新'],
    ['Add custom feed', '添加自定义订阅源'],
    ['Import certificate', '导入证书'],
    ['OSINT', 'OSINT'],
    ['No certificate', '无证书'],
    ['Kaspersky APT Hash Data Feed', '卡巴斯基 APT 哈希数据订阅源'],
    ['Kaspersky APT IP Data Feed', '卡巴斯基 APT IP 数据订阅源'],
    ['Kaspersky APT URL Data Feed', '卡巴斯基 APT URL 数据订阅源'],
    ['Kaspersky Demo Botnet CnC URL Data Feed', '卡巴斯基演示僵尸网络 C&C URL 数据订阅源'],
    ['Kaspersky Demo IP Reputation Data Feed', '卡巴斯基演示 IP 信誉数据订阅源'],
    ['Kaspersky Demo Malicious Hash Data Feed', '卡巴斯基演示恶意哈希数据订阅源'],
    ['Kaspersky ICS Hash Data Feed', '卡巴斯基 ICS 哈希数据订阅源'],
    ['Kaspersky IoT URL Data Feed', '卡巴斯基物联网 URL 数据订阅源'],
    ['Kaspersky Mobile Botnet CnC URL Data Feed', '卡巴斯基移动僵尸网络 C&C URL 数据订阅源'],
    ['Kaspersky Mobile Malicious Hash Data Feed', '卡巴斯基移动恶意哈希数据订阅源'],
    ['A set of hashes that cover malicious artifacts used by APT actors to conduct APT campaigns.', '一组哈希，涵盖 APT 攻击者用于进行 APT 攻击活动的恶意构件。'],
    ['A set of IP addresses that belong to the infrastructure used in APT campaigns.', '一组属于 APT 攻击活动所用基础设施的 IP 地址。'],
    ['A set of domains that belong to the infrastructure used in APT campaigns.', '一组属于 APT 攻击活动所用基础设施的域名。'],
    ['A set of URLs and hashes with context that cover desktop botnet C&C servers and related malicious objects. Masked and non-masked records are available.', '一组带有上下文的 URL 和哈希，涵盖桌面僵尸网络 C&C 服务器及相关恶意对象。提供掩码和非掩码记录。'],
    ['This is a demo version of Botnet CnC URL Data Feed. Demo Botnet CnC URL Data Feed provide lower detection rates in comparison with Botnet CnC URL Data Feed.', '这是僵尸网络 C&C URL 数据订阅源的演示版本。与僵尸网络 C&C URL 数据订阅源相比，演示版提供较低的检测率。'],
    ['This is a demo version of IP Reputation Data Feed. Demo IP Reputation Data Feed provide lower detection rates in comparison with IP Reputation Data Feed.', '这是 IP 信誉数据订阅源的演示版本。与 IP 信誉数据订阅源相比，演示版提供较低的检测率。'],
    ['This is a demo version of Malicious Hash Data Feed. Demo Malicious Hash Data Feed provide lower detection rates in comparison with Malicious Hash Data Feed.', '这是恶意哈希数据订阅源的演示版本。与恶意哈希数据订阅源相比，演示版提供较低的检测率。'],
    ['A set of Hash sums of malicious applications that are used to attack the ICS infrastructure.', '一组用于攻击 ICS 基础设施的恶意应用程序的哈希总和。'],
    ['A set of IP addresses with context that cover different categories of suspicious and malicious hosts.', '一组带有上下文的 IP 地址，涵盖不同类别的可疑和恶意主机。'],
    ['A set of URLs with context covering malicious links that were used to download malware that infects Internet of Things enabled (IoT) devices.', '一组带有上下文的 URL，涵盖用于下载感染物联网（IoT）设备的恶意软件的恶意链接。'],
    ['A set of file hashes with context that cover the most dangerous, prevalent, or emerging malware.', '一组带有上下文的文件哈希，涵盖最危险、最流行或新兴的恶意软件。'],
    ['A set of URLs with context that cover malicious websites and web pages. Masked and non-masked records are available.', '一组带有上下文的 URL，涵盖恶意网站和网页。提供掩码和非掩码记录。'],
    ['A set of URLs with context that cover mobile botnet C&C servers.', '一组带有上下文的 URL，涵盖移动僵尸网络 C&C 服务器。'],
    ['A set of file hashes with context for detecting malicious objects that infect mobile Google Android and Apple iPhone devices.', '一组带有上下文的文件哈希，用于检测感染移动谷歌安卓和苹果 iPhone 设备的恶意对象。'],
    ['A set of URLs with context that cover phishing websites and web pages. Masked and non-masked records are available.', '一组带有上下文的 URL，涵盖钓鱼网站和网页。提供掩码和非掩码记录。'],
    ['A set of URLs, domains, and hosts with context that cover ransomware links and websites.', '一组带有上下文的 URL、域和主机，涵盖勒索软件链接和网站。'],
    ['Feeds', '订阅源'],
    ['Indicators export', '指标导出'],
    ['Reporting', '报告'],
    ['Detections', '检测'],
    ['Tags', '标签'],
    ['Created by', '创建者'],
    ['Size (MB)', '大小 (MB)'],
    ['Records', '记录'],
    ['Link to download', '下载链接'],
    ['Last export', '上次导出'],
    ['Next export', '下次导出'],
    ['Add task', '添加任务'],
    ['Test connection', '测试连接'],
    ['Mail client settings', '邮件客户端设置'],
    ['Feeds update frequency has been changed', '订阅源更新频率已更改'],
    ['Available fields', '可用字段'],
    ['Truncate feed', '截断订阅源'],
    ['Maximum records', '最大记录数'],
    ['Filtering rules', '筛选规则'],
    ['Certificate file', '证书文件'],
    ['Specify the IP address or host name of the server where Kaspersky CyberTrace is installed.', '指定安装 Kaspersky CyberTrace 的服务器的 IP 地址或主机名。'],
    ['Search', '搜索'],
    ['Indicator', '指标'],
    ['Log files', '日志文件'],
    ['File hashes', '文件哈希'],
    ['Recent searches', '最近搜索'],
    ['Drag & drop files here', '将文件拖放到此处'],
    ['File format: LOG, TXT, CSV', '文件格式：LOG、TXT、CSV'],
    ['Select files', '选择文件'],
    ['Files', '文件'],
    ['Checksum', '校验和'],
    ['Search string', '搜索字符串'],
    ['Indicators of compromise (IoCs) from the ingested threat data feeds, and manually added IoCs.', '来自已提取的威胁数据订阅源的失陷指标（IoC）以及手动添加的 IoC。'],
    ['If you use special characters, the string must be escaped.', '如果使用特殊字符，则必须对字符串进行转义。'],
    ['Searchable indicator attributes:', '可搜索的指标属性：'],
    ['ioc_type—Indicator type', 'ioc_type—指标类型'],
    ['ioc_value—Indicator value', 'ioc_value—指标值'],
    ['ioc_created_date—Date and time when the indicator was added to the database', 'ioc_created_date—指标添加到数据库的日期和时间'],
    ['ioc_updated_date—Date and time when the indicator was last updated', 'ioc_updated_date—指标上次更新的日期和时间'],
    ['ioc_comment—Indicator comment', 'ioc_comment—指标注释'],
    ['ioc_summary—Internal TI indicator summary information', 'ioc_summary—内部威胁情报指标摘要信息'],
    ['ioc_first_detected_date—First detection date and time', 'ioc_first_detected_date—首次检测日期和时间'],
    ['ioc_last_detected_date—Last detection date and time', 'ioc_last_detected_date—最后检测日期和时间'],
    ['username—User who added the indicator to the database', 'username—将指标添加到数据库的用户'],
    ['ioc_supplier_can_match—Whether the indicator can be used in matching', 'ioc_supplier_can_match—指标是否可用于匹配'],
    ['ioc_supplier_last_updated_date—Date and time when the indicator was last encountered in a feed', 'ioc_supplier_last_updated_date—上次在订阅源中遇到该指标的日期和时间'],
    ['ioc_supplier_send_match_event—Whether detection alerts must be sent to the SIEM system', 'ioc_supplier_send_match_event—是否必须将检测告警发送到 SIEM 系统'],
    ['supplier_name—Feed name', 'supplier_name—订阅源名称'],
    ['supplier_confidence—Confidence level of the feed', 'supplier_confidence—订阅源的置信度'],
    ['supplier_vendor_name—Name of the feed vendor', 'supplier_vendor_name—订阅源供应商的名称'],
    ['ioc_supplier_context—Indicator context; specify nested context attributes by using a period: ioc_supplier_context.any_attribute_name', 'ioc_supplier_context—指标上下文；使用句点指定嵌套的上下文属性：ioc_supplier_context.any_attribute_name'],
    ['Manage false positives list', '管理误报列表'],
    ['Add indicator', '添加指标'],
    ['Delete', '删除'],
    ['Manage Internal TI list', '管理内部威胁情报列表'],
    ['False positive', '误报'],
    ['Research graphs', '研究图谱'],
    ['Graphs visualize information about indicators of threats and their relationships, detections, reports, etc. In addition to information from Kaspersky CyberTrace, you can enrich a graph with information from external sources, such as Kaspersky Threat Intelligence Portal and VirusTotal.', '图谱可视化有关威胁指标及其关系、检测、报告等信息。除了来自 Kaspersky CyberTrace 的信息外，您还可以使用来自外部来源（如卡巴斯基威胁情报门户和 VirusTotal）的信息来丰富图谱。'],
    ['Untitled graph', '无标题图谱'],
    ['No graphs found', '未找到图谱'],
    ['Add graph', '添加图谱'],
    ['Access date', '访问日期'],
    ['Ascending', '升序'],
    ['Descending', '降序'],
    ['Event sources', '事件源'],
    ['Settings of additional event sources.', '附加事件源的设置。'],
    ['Add event source', '添加事件源'],
    ['Source ID', '源 ID'],
    ['No event sources are added. Kaspersky CyberTrace uses default regular expressions and rules.', '未添加事件源。Kaspersky CyberTrace 使用默认的正则表达式和规则。'],
    ['Specify filtering rules for detection alerts sent to the SIEM system.', '为发送到 SIEM 系统的检测告警指定筛选规则。'],
    ['Actionable fields', '可操作字段'],
    ['We do not recommend typing the format strings manually. Instead, configure alert formats by selecting from the provided check boxes.', '我们不建议手动输入格式字符串。请通过选择提供的复选框来配置告警格式。'],
    ['Values extracted from the event', '从事件中提取的值'],
    ['Alert format', '告警格式'],
    ['Select all', '全选'],
    ['Category—Category of the detected object', 'Category—检测对象的类别'],
    ['RecordContext—Context of the detection alert', 'RecordContext—检测告警的上下文'],
    ['Confidence—Feed confidence', 'Confidence—订阅源置信度'],
    ['Indicatorlnfo—Link to the Kaspersky CyberTrace page that contains information about the detected indicator', 'Indicatorlnfo—包含有关已检测指标信息的 Kaspersky CyberTrace 页面链接'],
    ['MatchedIndicator—Detected indicator (a URL, hash, or IP address) that caused the event', 'MatchedIndicator—导致事件的已检测指标（URL、哈希或 IP 地址）'],
    ['ActionableFields—Actionable fields that are added to the detection alert', 'ActionableFields—添加到检测告警的可操作字段'],
    ['SourceId—Event source identifier', 'SourceId—事件源标识符'],
    ['EventReceivedDate—Date and time when Kaspersky CyberTrace received the event from the SIEM system', 'EventReceivedDate—Kaspersky CyberTrace 从 SIEM 系统接收事件的日期和时间'],
    ['Retroscan—Whether the detection was made as a result of a retroscan', 'Retroscan—检测是否是回溯扫描的结果'],
    ['Field name', '字段名称'],
    ['Condition', '条件'],
    ['Settings of outgoing alerts about detections.', '关于检测的传出告警设置。'],
    ['Created By', '创建者'],
    ['Recipient email', '收件人电子邮件'],
    ['Period', '周期'],
    ['Last task execution', '上次任务执行'],
    ['Next task execution', '下次任务执行'],
    ['IndicatorInfo—Link to the Kaspersky CyberTrace page that contains information about the detected indicator', 'IndicatorInfo—包含有关已检测指标信息的 Kaspersky CyberTrace 页面链接'],
    ['Date—Date and time when the detection was made', 'Date—进行检测的日期和时间'],
    ['Define the parameters of the socket the tenant will use to listen to incoming events.', '定义租户将用于侦听传入事件的套接字参数。'],
    ['The EPS limit of this tenant is not controlled. This may affect other tenants (if any).', '此租户的 EPS 限制不受控制。这可能会影响其他租户（如果有）。'],
    ['Settings of sending service alerts that inform another software (for example, SIEM) about the state of the tenant.', '发送服务告警的设置，用于通知其他软件（例如 SIEM）租户的状态。'],
    ['When this setting is applied, the program saves indicator-related detections and collects statistics on indicators received\nvia public API lookup method.', '应用此设置后，程序会保存与指标相关的检测，并收集通过公共 API 查询方法接收到的指标的统计信息。'],
    ['Settings of service alerts that inform another software (for example, the SIEM system) about the status of the tenant.', '发送服务告警的设置，用于通知其他软件（例如 SIEM 系统）租户的状态。'],
    ['Detection date', '检测日期'],
    ['Source', '来源'],
    ['Category', '类别'],
    ['Type', '类型'],
    ['Value', '值'],
    ['Total tag weight', '总标签权重'],
    ['Supplier confidence', '供应商置信度'],
    ['Add indicators to the graph', '向图谱添加指标'],
    ['Manually', '手动'],
    ['From files', '从文件'],
    ['Create nodes', '创建节点'],
    ['Drag & drop to upload', '拖放上传'],
    ['You can add indicators of compromise (IoCs) by uploading text files up to 128 KB each. Each IoC in the file must be on a separate line.', '您可以通过上传每个最大 128 KB 的文本文件来添加失陷指标（IoC）。文件中的每个 IoC 必须独占一行。'],
    ['Graph settings', '图谱设置'],
    ['You can enable Kaspersky CyberTrace to group nodes of the same type automatically into one group node. All nodes in a group node must be connected to a single node (group parent node). If a node in the group connects to a node outside the group, it automatically leaves the group and is displayed on the graph outside the group.', '您可以启用 Kaspersky CyberTrace 将相同类型的节点自动分组到一个组节点中。组节点中的所有节点必须连接到单个节点（组父节点）。如果组中的节点连接到组外的节点，它将自动离开该组并显示在图谱的组外。'],
    ['Automatic grouping is enabled', '自动分组已启用'],
    ['Minimum number of nodes in a group node', '组节点中的最小节点数'],
    ['Groups', '组'],
    ['Shortcuts', '快捷键'],
    ['View', '视图'],
    ['Default mode', '默认模式'],
    ['Linking mode', '链接模式'],
    ['Zoom in', '放大'],
    ['CTRL+PLUS (+) or scroll forward with mouse wheel', 'CTRL+PLUS (+) 或向前滚动鼠标滚轮'],
    ['Zoom out', '缩小'],
    ['CTRL+MINUS (-) or scroll backward with mouse wheel', 'CTRL+MINUS (-) 或向后滚动鼠标滚轮'],
    ['Undo', '撤销'],
    ['Redo', '重做'],
    ['Save graph', '保存图谱'],
    ['Duplicate graph', '复制图谱'],
    ['Add indicators', '添加指标'],
    ['Show filters panel', '显示筛选器面板'],
    ['Full screen', '全屏'],
    ['Focus on selected', '聚焦于所选'],
    ['Close details', '关闭详情'],
    ['Format', '格式'],
    ['Filtration', '筛选'],
    ['Context', '上下文'],
    ['Your session has expired', '您的会话已过期'],
    ['Licensing', '许可'],
    ['License keys that have been added to Kaspersky CyberTrace.', '已添加到 Kaspersky CyberTrace 的许可证密钥。'],
    ['Add license key', '添加许可证密钥'],
    ['Specify the log directory in the configuration file kl_feed_service_log.conf', '在配置文件 kl_feed_service_log.conf 中指定日志目录'],
    ['Add by using an activation code.', '通过使用激活码添加。'],
    ['If you do not have an activation code, you can contact your Account Manager or add by using a license key file.', '如果您没有激活码，可以联系您的客户经理或使用许可证密钥文件添加。'],
    ['Add by using a license key file.', '通过使用许可证密钥文件添加。'],
    ['If you do not have a license key file, you can contact your Account Manager.', '如果您没有许可证密钥文件，可以联系您的客户经理。'],
    ['Enterprise TIP', '企业 TIP'],
    ['Expiration date', '到期日期'],
    ['EPS rate', 'EPS 速率'],
    ['Number of indicators', '指标数量'],
    ['Details', '详情'],
    ['Custom feeds', '自定义订阅源'],
    ['Multi-user mode', '多用户模式'],
    ['Multitenancy', '多租户'],
    ['Active', '活动'],
    ['Additional', '附加'],
    ['Graph', '图谱'],
    ['Unlimited', '无限制'],
    ['Settings of Kaspersky CyberTrace Service logging.', 'Kaspersky CyberTrace 服务日志记录设置。'],
    ['Log directory', '日志目录'],
    ['Logging type', '日志记录类型'],
    ['Logging level', '日志记录级别'],
    ['Maximum log size (MB)', '最大日志大小 (MB)'],
    ['Delete old logs when Kaspersky CyberTrace Service starts', 'Kaspersky CyberTrace 服务启动时删除旧日志'],
    ['Logging', '日志记录'],
    ['Detection details', '检测详情'],
    ['View on graph', '在图谱上查看'],
    ['Source event', '源事件'],
    ['Detection alert', '检测告警'],
    ['Confidence', '置信度'],
    ['Whole source event', '完整源事件'],
    ['Additional info', '附加信息'],
    ['category', '类别'],
    ['first_seen', '首次出现'],
    ['last_seen', '最后出现'],
    ['popularity', '流行度'],
    ['threat_score', '威胁评分'],
    ['Whole detection alert', '完整检测告警'],
    ['If you leave this page, all changes will be lost.', '如果您离开此页面，所有更改将丢失。'],
    ['Do you want to stay on this page?', '您要留在此页面吗？'],
    ['This supplier is disabled and is not used in matching', '此供应商已禁用，不用于匹配'],
    ['Added on', '添加于'],
    ['Last updated on', '最后更新于'],
    ['Back to recent searches', '返回最近搜索'],
    ['Suppliers', '供应商'],
    ['Kaspersky CyberTrace can modify any added URL by applying normalization rules.', 'Kaspersky CyberTrace 可以通过应用范化规则来修改任何已添加的 URL。'],
    ['Indicator value', '指标值'],
    ['Add', '添加'],
    ['Attribute', '属性'],
    ['Report for IP address', 'IP 地址报告'],
    ['Add attribute', '添加属性'],
    ['Click to mark indicator as a false positive', '点击以将指标标记为误报'],
    ['—Indicator type', '—指标类型'],
    ['—Indicator value', '—指标值'],
    ['—Date and time when the indicator was added to the database', '—指标添加到数据库的日期和时间'],
    ['—Date and time when the indicator was last updated', '—指标上次更新的日期和时间'],
    ['—Indicator comment', '—指标注释'],
    ['—Internal TI indicator summary information', '—内部威胁情报指标摘要信息'],
    ['—First detection date and time', '—首次检测日期和时间'],
    ['—Last detection date and time', '—最后检测日期和时间'],
    ['—User who added the indicator to the database', '—将指标添加到数据库的用户'],
    ['—Whether the indicator can be used in matching', '—指标是否可用于匹配'],
    ['—Date and time when the indicator was last encountered in a feed', '—上次在订阅源中遇到该指标的日期和时间'],
    ['—Whether detection alerts must be sent to the SIEM system', '—是否必须将检测告警发送到 SIEM 系统'],
    ['—Feed name', '—订阅源名称'],
    ['—Confidence level of the feed', '—订阅源的置信度'],
    ['—Name of the feed vendor', '—订阅源供应商的名称'],
    ['—Indicator context; specify nested context attributes by using a period: ioc_supplier_context.any_attribute_name', '—指标上下文；使用句点指定嵌套的上下文属性：ioc_supplier_context.any_attribute_name'],
    ['Save this search', '保存此搜索'],
    ['Saved searches', '已保存的搜索'],
    ['Indicator found', '已找到指标'],
    ['Switch to dark mode', '切换到深色模式'],
    ['Open documentation', '打开文档'],
    ['Download full report', '下载完整报告'],
    ['Add widget', '添加小组件'],
    ['Widget type', '小组件类型'],
    ['Detection statistics', '检测统计'],
    ['Retroscan detection statistics', '回溯扫描检测统计'],
    ['Select indicators', '选择指标'],
    ['Indicators selected', '已选择指标']
    ]);

    const TRANSLATED_MARKER = 'ct-translated'; // 用于标记已翻译元素的CSS class，避免重复翻译

    /**
     * 翻译指定DOM节点及其所有子节点中的文本内容。
     * @param {Node} node - 需要被翻译的DOM节点。
     */
    function translateNode(node) {
        // 确保我们处理的是元素节点或文档片段，因为文本节点没有子节点
        if (node.nodeType !== Node.ELEMENT_NODE && node.nodeType !== Node.DOCUMENT_FRAGMENT_NODE) {
            return;
        }

        // 使用 TreeWalker 高效遍历所有文本节点
        const walker = document.createTreeWalker(node, NodeFilter.SHOW_TEXT);
        let textNode;
        while (textNode = walker.nextNode()) {
            const parent = textNode.parentElement;
            // 检查父元素是否已被标记，或父元素是否是<script>或<style>标签，避免处理
            if (!parent || parent.closest(`.${TRANSLATED_MARKER}, script, style`)) {
                continue;
            }

            const originalText = textNode.nodeValue.trim();
            if (!originalText) continue;

            const staticResult = staticTranslations.get(originalText);
            if (staticResult) {
                // 替换文本，同时保留原始文本节点周围可能存在的空白符
                textNode.nodeValue = textNode.nodeValue.replace(originalText, staticResult);
                // 给父元素添加标记，防止其内部被重复翻译
                parent.classList.add(TRANSLATED_MARKER);
            }
        }
    }

    // --- 脚本主逻辑 ---

    // 1. 对页面加载时已存在的内容进行首次翻译
    translateNode(document.body);

    // 2. 创建并启动 MutationObserver 来监视后续的DOM变化
    const observer = new MutationObserver((mutationsList) => {
        for (const mutation of mutationsList) {
            // 检查是否有节点被添加到DOM中
            if (mutation.type === 'childList' && mutation.addedNodes.length > 0) {
                mutation.addedNodes.forEach(newNode => {
                    // 对每个新添加的节点（及其子节点）运行翻译函数
                    translateNode(newNode);
                });
            }
        }
    });

    // 3. 配置观察器：监视body及其所有后代节点的增删变化
    observer.observe(document.body, {
        childList: true,
        subtree: true
    });

})();
