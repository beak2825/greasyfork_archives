// ==UserScript==
// @name         Agarplus.io v2
// @version      2.0.0
// @namespace    Agarplus.io
// @description  Agar Enhanced
// @author       Agarplus.io
// @match        http://agar.io/*
// @grant        GM_setClipboard
// @grant        GM_xmlhttpRequest
// @downloadURL https://update.greasyfork.org/scripts/19446/Agarplusio%20v2.user.js
// @updateURL https://update.greasyfork.org/scripts/19446/Agarplusio%20v2.meta.js
// ==/UserScript==

var engine = 'KGZ1bmN0aW9uKGMsIGUpIHsNCiAgICBmdW5jdGlvbiB1YShhLCBiKSB7DQogICAgICAgIGlmIChiKSB7DQogICAgICAgICAgICB2YXIgZCA9IG5ldyBEYXRlOw0KICAgICAgICAgICAgZC5zZXRUaW1lKGQuZ2V0VGltZSgpICsgODY0RTUgKiBiKTsNCiAgICAgICAgICAgIGQgPSAiOyBleHBpcmVzPSIgKyBkLnRvR01UU3RyaW5nKCkNCiAgICAgICAgfSBlbHNlIGQgPSAiIjsNCiAgICAgICAgZG9jdW1lbnQuY29va2llID0gImFnYXJpb19yZWRpcmVjdD0iICsgYSArIGQgKyAiOyBwYXRoPS8iDQogICAgfQ0KDQogICAgZnVuY3Rpb24gdGMoKSB7DQogICAgICAgIGZvciAodmFyIGEgPSBkb2N1bWVudC5jb29raWUuc3BsaXQoIjsiKSwgYiA9IDA7IGIgPCBhLmxlbmd0aDsgYisrKSB7DQogICAgICAgICAgICBmb3IgKHZhciBkID0gYVtiXTsNCiAgICAgICAgICAgICAgICAiICIgPT0gZC5jaGFyQXQoMCk7KSBkID0gZC5zdWJzdHJpbmcoMSwgZC5sZW5ndGgpOw0KICAgICAgICAgICAgaWYgKDAgPT0gZC5pbmRleE9mKCJhZ2FyaW9fcmVkaXJlY3Q9IikpIHJldHVybiBkLnN1YnN0cmluZygxNiwgZC5sZW5ndGgpDQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIG51bGwNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBJYigpIHsNCiAgICAgICAgYy5vbmtleWRvd24gPSBmdW5jdGlvbihhKSB7DQogICAgICAgIAkvL0FHQVJCT1RPVkggQ0UgQ09ERSBBIFJBUEFUUklFUiBEQU5TIE5PVFJFS0VZRE9XTg0KICAgICAgICAgICAgMzIgIT0gYS5rZXlDb2RlIHx8IHZhIHx8ICgibmljayIgIT0gYS50YXJnZXQuaWQgJiYgYS5wcmV2ZW50RGVmYXVsdCgpLCBlYigpLCB2YSA9ICEwKTsNCiAgICAgICAgICAgIDgxID09IGEua2V5Q29kZSAmJiAoWCgxOCksIHdhID0gITApOw0KICAgICAgICAgICAgODcgIT0gYS5rZXlDb2RlIHx8IHhhIHx8IChKYigpLCB4YSA9ICEwKTsNCiAgICAgICAgICAgIDI3ID09IGEua2V5Q29kZSAmJiAoYS5wcmV2ZW50RGVmYXVsdCgpLCB5YSgzMDApLCBlKCIjb2ZlcndhbGxDb250YWluZXIiKS5pcygiOnZpc2libGUiKSAmJiBjLmNsb3NlT2ZmZXJ3YWxsKCksIGUoIiN2aWRlb0NvbnRhaW5lciIpLmlzKCI6dmlzaWJsZSIpICYmIGMuY2xvc2VWaWRlb0NvbnRhaW5lcigpKQ0KICAgICAgICB9Ow0KICAgICAgICBjLm9ua2V5dXAgPSBmdW5jdGlvbihhKSB7DQogICAgICAgICAgICAzMiA9PSBhLmtleUNvZGUgJiYgKHZhID0gITEpOw0KICAgICAgICAgICAgODcgPT0gYS5rZXlDb2RlICYmICh4YSA9ICExKTsNCiAgICAgICAgICAgIDgxID09IGEua2V5Q29kZSAmJiB3YSAmJiAoWCgxOSksIHdhID0gITEpDQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmdW5jdGlvbiBLYihhKSB7DQogICAgICAgIGEucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgLy8gQUdBUkJPVE9WSA0KICAgICAgICBQICo9IE1hdGgucG93KC45LCBhLndoZWVsRGVsdGEgLyAtMTIwIHx8IGEuZGV0YWlsIHx8IDApOw0KCQlpZigxIDwgUCkNCgkJCVAgPSAxOw0KCQkvKg0KICAgICAgICBQICo9IE1hdGgucG93KC45LCBhLndoZWVsRGVsdGEgLyAtMTIwIHx8IGEuZGV0YWlsIHx8IDApOw0KICAgICAgICAxID4gUCAmJiAoUCA9IDEpOw0KICAgICAgICBQID4gNCAvIGwgJiYgKFAgPSA0IC8gbCkqLw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHVjKCkgew0KICAgICAgICBpZiAoLjQgPiBsKSBpYSA9IG51bGw7DQogICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgZm9yICh2YXIgYSA9IE51bWJlci5QT1NJVElWRV9JTkZJTklUWSwgYiA9IE51bWJlci5QT1NJVElWRV9JTkZJTklUWSwgZCA9IE51bWJlci5ORUdBVElWRV9JTkZJTklUWSwgYyA9IE51bWJlci5ORUdBVElWRV9JTkZJTklUWSwgZyA9IDA7IGcgPCBBLmxlbmd0aDsgZysrKSB7DQogICAgICAgICAgICAgICAgdmFyIGUgPSBBW2ddOw0KICAgICAgICAgICAgICAgICFlLlIoKSB8fCBlLlYgfHwgMjAgPj0gZS5zaXplICogbCB8fCAoYSA9IE1hdGgubWluKGUueCAtIGUuc2l6ZSwgYSksIGIgPSBNYXRoLm1pbihlLnkgLSBlLnNpemUsIGIpLCBkID0gTWF0aC5tYXgoZS54ICsgZS5zaXplLCBkKSwgYyA9IE1hdGgubWF4KGUueSArIGUuc2l6ZSwgYykpDQogICAgICAgICAgICB9DQogICAgICAgICAgICBpYSA9IHZjLmluaXQoew0KICAgICAgICAgICAgICAgIHphOiBhIC0gMTAsDQogICAgICAgICAgICAgICAgQWE6IGIgLSAxMCwNCiAgICAgICAgICAgICAgICB4YTogZCArIDEwLA0KICAgICAgICAgICAgICAgIHlhOiBjICsgMTAsDQogICAgICAgICAgICAgICAgSGE6IDIsDQogICAgICAgICAgICAgICAgSWE6IDQNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgZm9yIChnID0gMDsgZyA8IEEubGVuZ3RoOyBnKyspDQogICAgICAgICAgICAgICAgaWYgKGUgPSBBW2ddLCBlLlIoKSAmJiAhKDIwID49IGUuc2l6ZSAqIGwpKQ0KICAgICAgICAgICAgICAgICAgICBmb3IgKGEgPSAwOyBhIDwgZS5hLmxlbmd0aDsgKythKSBiID0gZS5hW2FdLngsIGQgPSBlLmFbYV0ueSwgYiA8IHkgLSByIC8gMiAvIGwgfHwgZCA8IHogLSB0IC8gMiAvIGwgfHwgYiA+IHkgKyByIC8gMiAvIGwgfHwgZCA+IHogKyB0IC8gMiAvIGwgfHwgaWEudGEoZS5hW2FdKQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgZnVuY3Rpb24gZmIoKSB7DQogICAgICAgIHphID0gKFkgLSByIC8gMikgLyBsICsgeTsNCiAgICAgICAgQWEgPSAoWiAtIHQgLyAyKSAvIGwgKyB6DQogICAgfQ0KDQogICAgZnVuY3Rpb24gTGIoKSB7DQogICAgICAgIG51bGwgPT0gQmEgJiYgKEJhID0ge30sIGUoIiNyZWdpb24iKS5jaGlsZHJlbigpLmVhY2goZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB2YXIgYSA9IGUodGhpcyksDQogICAgICAgICAgICAgICAgYiA9IGEudmFsKCk7DQogICAgICAgICAgICBiICYmIChCYVtiXSA9IGEudGV4dCgpKQ0KICAgICAgICB9KSk7DQogICAgICAgIGUuZ2V0KENhICsgImluZm8iLCBmdW5jdGlvbihhKSB7DQogICAgICAgICAgICB2YXIgYiA9IHt9LA0KICAgICAgICAgICAgICAgIGQ7DQogICAgICAgICAgICBmb3IgKGQgaW4gYS5yZWdpb25zKSB7DQogICAgICAgICAgICAgICAgdmFyIGMgPSBkLnNwbGl0KCI6IilbMF07DQogICAgICAgICAgICAgICAgYltjXSA9IGJbY10gfHwgMDsNCiAgICAgICAgICAgICAgICBiW2NdICs9IGEucmVnaW9uc1tkXS5udW1QbGF5ZXJzDQogICAgICAgICAgICB9DQogICAgICAgICAgICBmb3IgKGQgaW4gYikgZSgnI3JlZ2lvbiBvcHRpb25bdmFsdWU9IicgKyBkICsgJyJdJykudGV4dChCYVtkXSArICIgKCIgKyBiW2RdICsgIiBwbGF5ZXJzKSIpDQogICAgICAgIH0sICJqc29uIikNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBNYigpIHsNCiAgICAgICAgZSgiI2Fkc0JvdHRvbSIpLmhpZGUoKTsNCiAgICAgICAgZSgiI292ZXJsYXlzIikuaGlkZSgpOw0KICAgICAgICBlKCIjc3RhdHMiKS5oaWRlKCk7DQogICAgICAgIGUoIiNtYWluUGFuZWwiKS5oaWRlKCk7DQogICAgICAgIGFhID0gamEgPSAhMTsNCiAgICAgICAgTmIoKTsNCiAgICAgICAgYy5kZXN0cm95QWQoYy5hZFNsb3RzLmFhKTsNCiAgICAgICAgYy5kZXN0cm95QWQoYy5hZFNsb3RzLmFjKQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIERhKGEpIHsNCiAgICAgICAgYSAmJiAoYSA9PSBHID8gZSgiLmJ0bi1uZWVkcy1zZXJ2ZXIiKS5wcm9wKCJkaXNhYmxlZCIsICExKSA6IChlKCIjcmVnaW9uIikudmFsKCkgIT0gYSAmJiBlKCIjcmVnaW9uIikudmFsKGEpLCBHID0gYy5sb2NhbFN0b3JhZ2UubG9jYXRpb24gPSBhLCBlKCIucmVnaW9uLW1lc3NhZ2UiKS5oaWRlKCksIGUoIi5yZWdpb24tbWVzc2FnZS4iICsgYSkuc2hvdygpLCBlKCIuYnRuLW5lZWRzLXNlcnZlciIpLnByb3AoImRpc2FibGVkIiwgITEpLCBnYiAmJiBRKCkpKQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHlhKGEpIHsNCiAgICAgICAgamEgfHwgYWEgfHwgKEVhID8gZSgiLmJ0bi1zcGVjdGF0ZSIpLnByb3AoImRpc2FibGVkIiwgITApIDogZSgiLmJ0bi1zcGVjdGF0ZSIpLnByb3AoImRpc2FibGVkIiwgITEpLCBOID0gbnVsbCwgaGIgfHwgKGUoIiNhZHNCb3R0b20iKS5zaG93KCksIGUoIiNnMzAweDI1MCIpLmhpZGUoKSwgZSgiI2EzMDB4MjUwIikuc2hvdygpLCBlKCIjZzcyOHg5MCIpLmhpZGUoKSwgZSgiI2E3Mjh4OTAiKS5zaG93KCkpLCBjLnJlZnJlc2hBZChoYiA/IGMuYWRTbG90cy5hYyA6IGMuYWRTbG90cy5hYSksIGhiID0gITEsIDFFMyA+IGEgJiYgKEIgPSAxKSwgamEgPSAhMCwgZSgiI21haW5QYW5lbCIpLnNob3coKSwgMCA8IGEgPyBlKCIjb3ZlcmxheXMiKS5mYWRlSW4oYSkgOiBlKCIjb3ZlcmxheXMiKS5zaG93KCkpDQogICAgfQ0KDQogICAgZnVuY3Rpb24ga2EoYSkgew0KICAgICAgICBlKCIjaGVsbG9Db250YWluZXIiKS5hdHRyKCJkYXRhLWdhbWVtb2RlIiwgYSk7DQogICAgICAgIGxhID0gYTsNCiAgICAgICAgZSgiI2dhbWVtb2RlIikudmFsKGEpDQogICAgfQ0KDQogICAgZnVuY3Rpb24gTmIoKSB7DQogICAgICAgIGUoIiNyZWdpb24iKS52YWwoKSA/IGMubG9jYWxTdG9yYWdlLmxvY2F0aW9uID0gZSgiI3JlZ2lvbiIpLnZhbCgpIDogYy5sb2NhbFN0b3JhZ2UubG9jYXRpb24gJiYgZSgiI3JlZ2lvbiIpLnZhbChjLmxvY2FsU3RvcmFnZS5sb2NhdGlvbik7DQogICAgICAgIGUoIiNyZWdpb24iKS52YWwoKSA/IGUoIiNsb2NhdGlvbktub3duIikuYXBwZW5kKGUoIiNyZWdpb24iKSkgOiBlKCIjbG9jYXRpb25Vbmtub3duIikuYXBwZW5kKGUoIiNyZWdpb24iKSkNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBpYihhKSB7DQogICAgICAgICJlbnZfbG9jYWwiIGluIEVudkNvbmZpZyA/ICJ0cnVlIiA9PSBFbnZDb25maWcubG9hZF9sb2NhbF9jb25maWd1cmF0aW9uID8gYy5NQy51cGRhdGVDb25maWd1cmF0aW9uSUQoImJhc2UiKSA6IGMuTUMudXBkYXRlQ29uZmlndXJhdGlvbklEKEVudkNvbmZpZy5jb25maWdJRCkgOiBjLk1DLnVwZGF0ZUNvbmZpZ3VyYXRpb25JRChhKQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHdjKCkgew0KICAgICAgICAiY29uZmlnSUQiIGluIEQgPyBpYihELmNvbmZpZ0lEKSA6IGUuZ2V0KENhICsgImdldExhdGVzdElEIiwgZnVuY3Rpb24oYSkgew0KICAgICAgICAgICAgaWIoYSk7DQogICAgICAgICAgICBjLmxvY2FsU3RvcmFnZS5sYXN0X2NvbmZpZ19pZCA9IGENCiAgICAgICAgfSkuZmFpbChmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHZhciBhOw0KICAgICAgICAgICAgaWYgKGEgPSAibGFzdF9jb25maWdfaWQiIGluIGMubG9jYWxTdG9yYWdlKSBhID0gYy5sb2NhbFN0b3JhZ2UubGFzdF9jb25maWdfaWQsIGEgPSAhKG51bGwgPT0gYSB8fCB2b2lkIDAgPT0gYSB8fCAiIiA9PT0gYSk7DQogICAgICAgICAgICBhICYmIChhID0gYy5sb2NhbFN0b3JhZ2UubGFzdF9jb25maWdfaWQsIGNvbnNvbGUubG9nKCJGYWxsYmFjayB0byBzdG9yZWQgY29uZmlnSUQ6ICIgKyBhKSwgaWIoYSkpDQogICAgICAgIH0pDQogICAgfQ0KDQogICAgZnVuY3Rpb24geGMoKSB7DQogICAgICAgIGUuZ2V0KGpiICsgIi8vZ2MuYWdhci5pbyIsIGZ1bmN0aW9uKGEpIHsNCiAgICAgICAgICAgIHZhciBiID0gYS5zcGxpdCgiICIpOw0KICAgICAgICAgICAgYSA9IGJbMF07DQogICAgICAgICAgICBiID0gYlsxXSB8fCAiIjsgLSAxID09IFsiVUEiXS5pbmRleE9mKGEpICYmIE9iLnB1c2goInVzc3IiKTsNCiAgICAgICAgICAgIG1hLmhhc093blByb3BlcnR5KGEpICYmICgic3RyaW5nIiA9PSB0eXBlb2YgbWFbYV0gPyBHIHx8IERhKG1hW2FdKSA6IG1hW2FdLmhhc093blByb3BlcnR5KGIpICYmIChHIHx8IERhKG1hW2FdW2JdKSkpDQogICAgICAgIH0sICJ0ZXh0IikNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBSKGEpIHsNCiAgICAgICAgcmV0dXJuIGMuaTE4blthXSB8fCBjLmkxOG5fZGljdC5lblthXSB8fCBhDQogICAgfQ0KDQogICAgZnVuY3Rpb24gUGIoKSB7DQogICAgICAgIHZhciBhID0gKytrYjsNCiAgICAgICAgY29uc29sZS5sb2coIkZpbmQgIiArIEcgKyBsYSk7DQogICAgICAgIFFiKCk7DQogICAgICAgIGUuYWpheChDYSArICJmaW5kU2VydmVyIiwgew0KICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJGYWlsZWQgdG8gZ2V0IHNlcnZlci4gV2lsbCByZXRyeSBpbiAzMCBzZWNvbmRzIik7DQogICAgICAgICAgICAgICAgc2V0VGltZW91dChQYiwgM0U0KQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKGIpIHsNCiAgICAgICAgICAgICAgICBpZiAoYSA9PSBrYikgew0KICAgICAgICAgICAgICAgICAgICBiLmFsZXJ0ICYmIGFsZXJ0KGIuYWxlcnQpOw0KICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IGIuaXA7DQogICAgICAgICAgICAgICAgICAgICJnYW1lX3NlcnZlcl9wb3J0IiBpbiBFbnZDb25maWcgJiYgKGQgPSBjLmxvY2F0aW9uLmhvc3RuYW1lICsgIjoiICsNCiAgICAgICAgICAgICAgICAgICAgICAgIEVudkNvbmZpZy5nYW1lX3NlcnZlcl9wb3J0KTsNCiAgICAgICAgICAgICAgICAgICAgbGIoIndzIiArIChtYiA/ICJzIiA6ICIiKSArICI6Ly8iICsgZCwgYi50b2tlbikNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgZGF0YVR5cGU6ICJqc29uIiwNCiAgICAgICAgICAgIG1ldGhvZDogIlBPU1QiLA0KICAgICAgICAgICAgY2FjaGU6ICExLA0KICAgICAgICAgICAgY3Jvc3NEb21haW46ICEwLA0KICAgICAgICAgICAgZGF0YTogKEcgKyBsYSB8fCAiPyIpICsgIlxuMTU0NjY5NjAzIg0KICAgICAgICB9KQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIFEoKSB7DQogICAgICAgIGdiICYmIEcgJiYgKGUoIiNjb25uZWN0aW5nIikuc2hvdygpLCBQYigpKQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIFFiKCkgew0KICAgICAgICBpZiAodykgew0KICAgICAgICAgICAgdy5vbm9wZW4gPSBudWxsOw0KICAgICAgICAgICAgdy5vbm1lc3NhZ2UgPSBudWxsOw0KICAgICAgICAgICAgdy5vbmNsb3NlID0gbnVsbDsNCiAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgdy5jbG9zZSgpDQogICAgICAgICAgICB9IGNhdGNoIChhKSB7fQ0KICAgICAgICAgICAgdyA9IG51bGwNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGxiKGEsIGIpIHsNCiAgICAgICAgUWIoKTsNCiAgICAgICAgRC5pcCAmJiAoYSA9ICJ3cyIgKyAobWIgPyAicyIgOiAiIikgKyAiOi8vIiArIEQuaXApOw0KICAgICAgICBpZiAobnVsbCAhPSBTKSB7DQogICAgICAgICAgICB2YXIgZCA9IFM7DQogICAgICAgICAgICBTID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgZChiKQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGlmIChtYiAmJiAhRW52Q29uZmlnLmVudl9kZXZlbG9wbWVudCAmJiAhRW52Q29uZmlnLmVudl9sb2NhbCkgew0KICAgICAgICAgICAgdmFyIGMgPSBhLnNwbGl0KCI6Iik7DQogICAgICAgICAgICBhID0gIndzczovL2lwLSIgKyBjWzFdLnJlcGxhY2UoL1wuL2csICItIikucmVwbGFjZSgvXC8vZywgIiIpICsgIi50ZWNoLmFnYXIuaW86IiArICtjWzJdDQogICAgICAgIH0NCiAgICAgICAgRSA9IFtdOw0KICAgICAgICBxID0gW107DQogICAgICAgIEsgPSB7fTsNCiAgICAgICAgQSA9IFtdOw0KICAgICAgICBiYSA9IFtdOw0KICAgICAgICBDID0gW107DQogICAgICAgIEggPSBJID0gbnVsbDsNCiAgICAgICAgVCA9IDA7DQogICAgICAgIG5hID0gITE7DQogICAgICAgIGNvbnNvbGUubG9nKCJDb25uZWN0aW5nIHRvICIgKyBhKTsNCiAgICAgICAgbS5jYWNoZS5zZW50R2FtZVNlcnZlckxvZ2luID0gITE7DQogICAgICAgIHcgPSBuZXcgV2ViU29ja2V0KGEpOw0KICAgICAgICB3LmJpbmFyeVR5cGUgPSAiYXJyYXlidWZmZXIiOw0KICAgICAgICAvLyBBR0FSQk9UT1ZIDQogICAgICAgIGlwID0gYTsNCiAgICAgICAgcm9vbSA9IGI7DQogICAgICAgIGNoYW5nZUdhbWVNb2RlKCk7DQogICAgICAgIHcub25vcGVuID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB2YXIgYTsNCiAgICAgICAgICAgIEZhID0geCA9IERhdGUubm93KCk7DQogICAgICAgICAgICBvYSA9IDEyMDsNCiAgICAgICAgICAgIEdhID0gMDsNCiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJzb2NrZXQgb3BlbiIpOw0KICAgICAgICAgICAgYSA9IFUoNSk7DQogICAgICAgICAgICBhLnNldFVpbnQ4KDAsIDI1NCk7DQogICAgICAgICAgICBhLnNldFVpbnQzMigxLCA1LCAhMCk7DQogICAgICAgICAgICBWKGEpOw0KICAgICAgICAgICAgYSA9IFUoNSk7DQogICAgICAgICAgICBhLnNldFVpbnQ4KDAsIDI1NSk7DQogICAgICAgICAgICBhLnNldFVpbnQzMigxLCAxNTQ2Njk2MDMsICEwKTsNCiAgICAgICAgICAgIFYoYSk7DQogICAgICAgICAgICBhID0gVSgxICsgYi5sZW5ndGgpOw0KICAgICAgICAgICAgYS5zZXRVaW50OCgwLCA4MCk7DQogICAgICAgICAgICBmb3IgKHZhciBkID0gMDsgZCA8IGIubGVuZ3RoOyArK2QpIGEuc2V0VWludDgoZCArIDEsIGIuY2hhckNvZGVBdChkKSk7DQogICAgICAgICAgICBWKGEpOw0KICAgICAgICAgICAgbS5jb3JlLnByb3h5Lm9uU29ja2V0T3BlbigpDQogICAgICAgIH07DQogICAgICAgIHcub25tZXNzYWdlID0geWM7DQogICAgICAgIHcub25jbG9zZSA9IHpjOw0KICAgICAgICB3Lm9uZXJyb3IgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIGNvbnNvbGUubG9nKEhhLkwoKSArICIgc29ja2V0IGVycm9yIiwgYXJndW1lbnRzKQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgZnVuY3Rpb24gVShhKSB7DQogICAgICAgIHJldHVybiBuZXcgRGF0YVZpZXcobmV3IEFycmF5QnVmZmVyKGEpKQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIFYoYSkgew0KICAgICAgICB3LnNlbmQoYS5idWZmZXIpDQogICAgfQ0KDQogICAgZnVuY3Rpb24gemMoKSB7DQogICAgICAgIG5hICYmIChJYSA9IDUwMCk7DQogICAgICAgIG0uY29yZS5wcm94eS5vblNvY2tldENsb3NlZCgpOw0KICAgICAgICBjb25zb2xlLmxvZyhIYS5MKCkgKyAiIHNvY2tldCBjbG9zZSIpOw0KICAgICAgICBzZXRUaW1lb3V0KFEsIElhKTsNCiAgICAgICAgSWEgKj0gMg0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHljKGEpIHsNCiAgICAgICAgQWMobmV3IERhdGFWaWV3KGEuZGF0YSkpDQogICAgfQ0KDQogICAgZnVuY3Rpb24gQWMoYSkgew0KICAgICAgICBmdW5jdGlvbiBiKCkgew0KICAgICAgICAgICAgZm9yICh2YXIgYiA9ICIiOzspIHsNCiAgICAgICAgICAgICAgICB2YXIgYyA9IGEuZ2V0VWludDE2KGQsICEwKTsNCiAgICAgICAgICAgICAgICBkICs9IDI7DQogICAgICAgICAgICAgICAgaWYgKDAgPT0gYykgYnJlYWs7DQogICAgICAgICAgICAgICAgYiArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGMpDQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gYg0KICAgICAgICB9DQogICAgICAgIHZhciBkID0gMDsNCiAgICAgICAgaWYgKDI0MCA9PSBhLmdldFVpbnQ4KGQpKSBKYSgpOw0KICAgICAgICBlbHNlIHN3aXRjaCAoYS5nZXRVaW50OChkKyspKSB7DQogICAgICAgICAgICBjYXNlIDE2Og0KICAgICAgICAgICAgICAgIEJjKGEsIGQpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAxNzoNCiAgICAgICAgICAgICAgICBwYSA9IGEuZ2V0RmxvYXQzMihkLCAhMCk7DQogICAgICAgICAgICAgICAgZCArPSA0Ow0KICAgICAgICAgICAgICAgIHFhID0gYS5nZXRGbG9hdDMyKGQsICEwKTsNCiAgICAgICAgICAgICAgICBkICs9IDQ7DQogICAgICAgICAgICAgICAgcmEgPSBhLmdldEZsb2F0MzIoZCwgITApOw0KICAgICAgICAgICAgICAgIGQgKz0gNDsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgMTg6DQogICAgICAgICAgICAgICAgRSA9IFtdOw0KICAgICAgICAgICAgICAgIHEgPSBbXTsNCiAgICAgICAgICAgICAgICBLID0ge307DQogICAgICAgICAgICAgICAgQSA9IFtdOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAyMDoNCiAgICAgICAgICAgICAgICBxID0gW107DQogICAgICAgICAgICAgICAgRSA9IFtdOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAyMToNCiAgICAgICAgICAgICAgICBuYiA9IGEuZ2V0SW50MTYoZCwgITApOw0KICAgICAgICAgICAgICAgIGQgKz0gMjsNCiAgICAgICAgICAgICAgICBvYiA9IGEuZ2V0SW50MTYoZCwgITApOw0KICAgICAgICAgICAgICAgIGQgKz0gMjsNCiAgICAgICAgICAgICAgICBwYiB8fCAocGIgPSAhMCwgS2EgPSBuYiwgTGEgPSBvYik7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlIDMyOg0KICAgICAgICAgICAgICAgIEUucHVzaChhLmdldFVpbnQzMihkLCAhMCkpOw0KICAgICAgICAgICAgICAgIGQgKz0gNDsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgNDk6DQogICAgICAgICAgICAgICAgaWYgKG51bGwgIT0gSSkgYnJlYWs7DQogICAgICAgICAgICAgICAgdmFyIHUgPSBhLmdldFVpbnQzMihkLCAhMCksDQogICAgICAgICAgICAgICAgICAgIGQgPSBkICsgNDsNCiAgICAgICAgICAgICAgICBDID0gW107DQogICAgICAgICAgICAgICAgZm9yICh2YXIgZyA9IDA7IGcgPCB1OyArK2cpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSBhLmdldFVpbnQzMihkLCAhMCksDQogICAgICAgICAgICAgICAgICAgICAgICBkID0gZCArIDQ7DQogICAgICAgICAgICAgICAgICAgIEMucHVzaCh7DQogICAgICAgICAgICAgICAgICAgICAgICBpZDogZSwNCiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGIoKQ0KICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoeHQpIHsNCiAgICAgICAgICAgICAgICAgICAgLy8gQUdBUkJPVE9WSA0KCQkJCQl2YXIgYWJvID0ge307DQoJCQkJCWFiby5hY3Rpb24gPSA0Ow0KCQkJCQlhYm8ubGVhZGVyQm9hcmQgPSBDOw0KICAgICAgICAgICAgICAgICAgICBidC5zZW5kKEpTT04uc3RyaW5naWZ5KGFibykpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBSYigpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSA1MDoNCiAgICAgICAgICAgICAgICBJID0gW107DQogICAgICAgICAgICAgICAgdSA9IGEuZ2V0VWludDMyKGQsICEwKTsNCiAgICAgICAgICAgICAgICBkICs9IDQ7DQogICAgICAgICAgICAgICAgZm9yIChnID0gMDsgZyA8IHU7ICsrZykgSS5wdXNoKGEuZ2V0RmxvYXQzMihkLCAhMCkpLCBkICs9IDQ7DQogICAgICAgICAgICAgICAgUmIoKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgNjQ6DQogICAgICAgICAgICAgICAgTWEgPSBhLmdldEZsb2F0NjQoZCwgITApOw0KICAgICAgICAgICAgICAgIGQgKz0gODsNCiAgICAgICAgICAgICAgICBOYSA9IGEuZ2V0RmxvYXQ2NChkLCAhMCk7DQogICAgICAgICAgICAgICAgZCArPSA4Ow0KICAgICAgICAgICAgICAgIE9hID0gYS5nZXRGbG9hdDY0KGQsICEwKTsNCiAgICAgICAgICAgICAgICBkICs9IDg7DQogICAgICAgICAgICAgICAgUGEgPSBhLmdldEZsb2F0NjQoZCwgITApOw0KICAgICAgICAgICAgICAgIG1hcENvb3JkcyhNYSxOYSxPYSxQYSk7DQogICAgICAgICAgICAgICAgZCArPSA4Ow0KICAgICAgICAgICAgICAgIHBhID0gKE9hICsgTWEpIC8gMjsNCiAgICAgICAgICAgICAgICBxYSA9IChQYSArIE5hKSAvIDI7DQogICAgICAgICAgICAgICAgcmEgPSAxOw0KICAgICAgICAgICAgICAgIDAgPT0gcS5sZW5ndGggJiYgKHkgPSBwYSwgeiA9IHFhLCBsID0gcmEpOw0KICAgICAgICAgICAgICAgIGEuYnl0ZUxlbmd0aCA+IGQgJiYgKHUgPSBhLmdldFVpbnQzMihkLCAhMCksIGQgKz0gNCwgcWIgPSAhISh1ICYgMSksIHJiID0gYigpLCBjLk1DLnVwZGF0ZVNlcnZlclZlcnNpb24ocmIpLCBjb25zb2xlLmxvZygiU2VydmVyIHZlcnNpb24gIiArIHJiKSk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlIDEwMjoNCiAgICAgICAgICAgICAgICB1ID0gYS5idWZmZXIuc2xpY2UoZCk7DQogICAgICAgICAgICAgICAgbS5jb3JlLnByb3h5LmZvcndhcmRQcm90b01lc3NhZ2UodSk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlIDEwNDoNCiAgICAgICAgICAgICAgICBjLmxvZ291dCgpDQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmdW5jdGlvbiBCYyhhLCBiKSB7DQogICAgICAgIGZ1bmN0aW9uIGQoKSB7DQogICAgICAgICAgICBmb3IgKHZhciBkID0gIiI7Oykgew0KICAgICAgICAgICAgICAgIHZhciBjID0gYS5nZXRVaW50MTYoYiwgITApOw0KICAgICAgICAgICAgICAgIGIgKz0gMjsNCiAgICAgICAgICAgICAgICBpZiAoMCA9PQ0KICAgICAgICAgICAgICAgICAgICBjKSBicmVhazsNCiAgICAgICAgICAgICAgICBkICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYykNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBkDQogICAgICAgIH0NCg0KICAgICAgICBmdW5jdGlvbiB1KCkgew0KICAgICAgICAgICAgZm9yICh2YXIgZCA9ICIiOzspIHsNCiAgICAgICAgICAgICAgICB2YXIgYyA9IGEuZ2V0VWludDgoYisrKTsNCiAgICAgICAgICAgICAgICBpZiAoMCA9PSBjKSBicmVhazsNCiAgICAgICAgICAgICAgICBkICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYykNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBkDQogICAgICAgIH0NCiAgICAgICAgeCA9IERhdGUubm93KCk7DQogICAgICAgIHZhciBnID0geCAtIEZhOw0KICAgICAgICBGYSA9IHg7DQogICAgICAgIG9hID0gQ2MgKiBvYSArIERjICogZzsNCiAgICAgICAgR2EgPSBFYyAqIEdhICsgRmMgKiBNYXRoLmFicyhnIC0gb2EpOw0KICAgICAgICBtLmNvcmUuZGVidWcgJiYgKG0uZGVidWcudXBkYXRlQ2hhcnQoIm5ldHdvcmtVcGRhdGUiLCB4LCBnKSwgbS5kZWJ1Zy51cGRhdGVDaGFydCgicnR0TWVhbiIsIHgsIG9hKSwgbS5kZWJ1Zy51cGRhdGVDaGFydCgicnR0U0RldiIsIHgsIEdhKSk7DQogICAgICAgIG5hIHx8IChuYSA9ICEwLCBlKCIjY29ubmVjdGluZyIpLmhpZGUoKSwgU2IoKSwgUyAmJiAoUygpLCBTID0gbnVsbCkpOw0KICAgICAgICBzYiA9ICExOw0KICAgICAgICBnID0gYS5nZXRVaW50MTYoYiwgITApOw0KICAgICAgICBiICs9IDI7DQogICAgICAgIGZvciAodmFyIHAgPSAwOyBwIDwgZzsgKytwKSB7DQogICAgICAgICAgICB2YXIgTCA9IEtbYS5nZXRVaW50MzIoYiwgITApXSwNCiAgICAgICAgICAgICAgICBrID0gS1thLmdldFVpbnQzMihiICsgNCwgITApXTsNCiAgICAgICAgICAgIGIgKz0gODsNCiAgICAgICAgICAgIEwgJiYgayAmJiAoay5jYSgpLCBrLnMgPSBrLngsIGsudSA9IGsueSwgay5vID0gay5zaXplLCBrLm5hKEwueCwgTC55KSwgay5nID0gay5zaXplLCBrLlUgPSB4LCBHYyhMLCBrKSkNCiAgICAgICAgfQ0KICAgICAgICBmb3IgKHAgPSAwOzspIHsNCiAgICAgICAgICAgIGcgPSBhLmdldFVpbnQzMihiLCAhMCk7DQogICAgICAgICAgICBiICs9IDQ7DQogICAgICAgICAgICBpZiAoMCA9PSBnKSBicmVhazsNCiAgICAgICAgICAgICsrcDsNCiAgICAgICAgICAgIHZhciB0YiwgTCA9IGEuZ2V0SW50MzIoYiwgITApOw0KICAgICAgICAgICAgYiArPSA0Ow0KICAgICAgICAgICAgayA9IGEuZ2V0SW50MzIoYiwgITApOw0KICAgICAgICAgICAgYiArPSA0Ow0KICAgICAgICAgICAgdGIgPSBhLmdldEludDE2KGIsICEwKTsNCiAgICAgICAgICAgIGIgKz0gMjsNCiAgICAgICAgICAgIHZhciBuID0gYS5nZXRVaW50OChiKyspLA0KICAgICAgICAgICAgICAgIGYgPSBhLmdldFVpbnQ4KGIrKyksDQogICAgICAgICAgICAgICAgaCA9IGEuZ2V0VWludDgoYisrKSwNCiAgICAgICAgICAgICAgICBmID0gSGMobiA8PCAxNiB8IGYgPDwgOCB8IGgpLA0KICAgICAgICAgICAgICAgIGggPSBhLmdldFVpbnQ4KGIrKyksDQogICAgICAgICAgICAgICAgbCA9ICEhKGggJiAxKSwNCiAgICAgICAgICAgICAgICByID0gISEoaCAmIDE2KSwNCiAgICAgICAgICAgICAgICB0ID0gbnVsbDsNCiAgICAgICAgICAgIGggJiAyICYmIChiICs9IDQgKyBhLmdldFVpbnQzMihiLCAhMCkpOw0KICAgICAgICAgICAgaCAmIDQgJiYgKHQgPSB1KCkpOw0KICAgICAgICAgICAgdmFyIHYgPSBkKCksDQogICAgICAgICAgICAgICAgbiA9IG51bGw7DQogICAgICAgICAgICBLLmhhc093blByb3BlcnR5KGcpID8gKG4gPSBLW2ddLCBuLlQoKSwgbi5zID0gbi54LCBuLnUgPSBuLnksIG4ubyA9IG4uc2l6ZSwgbi5jb2xvciA9IGYpIDogKG4gPSBuZXcgY2EoZywgTCwgaywgdGIsIGYsIHYpLCBBLnB1c2gobiksIEtbZ10gPSBuKTsNCiAgICAgICAgICAgIG4uYyA9IGw7DQogICAgICAgICAgICBuLmggPSByOw0KICAgICAgICAgICAgbi5uYShMLCBrKTsNCiAgICAgICAgICAgIG4uZyA9IHRiOw0KICAgICAgICAgICAgbi5VID0geDsNCiAgICAgICAgICAgIG4uZWEgPSBoOw0KICAgICAgICAgICAgdCAmJiAobi5DID0gdCk7DQogICAgICAgICAgICB2ICYmIG4uQSh2KTsgLSAxICE9IEUuaW5kZXhPZihnKSAmJiAtMSA9PSBxLmluZGV4T2YobikgJiYgKHEucHVzaChuKSwgbi5JID0gITAsIDEgPT0gcS5sZW5ndGggJiYgKG4udWEgPSAhMCwgeSA9IG4ueCwgeiA9IG4ueSwgVGIoKSwgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm92ZXJsYXlzIikuc3R5bGUuZGlzcGxheSA9ICJub25lIiwgRiA9IFtdLCB1YiA9IDAsIHZiID0gcVswXS5jb2xvciwgRWEgPSAhMCwgUmEgPSBEYXRlLm5vdygpLCBXID0gd2IgPSB4YiA9IDApKQ0KICAgICAgICB9DQogICAgICAgIEwgPSBhLmdldFVpbnQzMihiLCAhMCk7DQogICAgICAgIGIgKz0gNDsNCiAgICAgICAgZm9yIChwID0gMDsgcCA8IEw7IHArKykgZyA9IGEuZ2V0VWludDMyKGIsICEwKSwgYiArPSA0LCBuID0gS1tnXSwgbnVsbCAhPSBuICYmIG4uY2EoKTsNCiAgICAgICAgc2IgJiYgMCA9PSBxLmxlbmd0aCAmJiAoMCA9PSBjLk1DLmlzVXNlckxvZ2dlZEluKCkgPyBKYSgpIDogVWIgPSBzZXRUaW1lb3V0KEphLCAyRTMpKQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIFNhKCkgew0KICAgICAgICBpZiAoZGEoKSkgew0KICAgICAgICAgICAgdmFyIGEgPSBZIC0gciAvIDIsDQogICAgICAgICAgICAgICAgYiA9IFogLSB0IC8gMjsNCiAgICAgICAgICAgIA0KICAgICAgICAgLy8gQUdBUkJPVE9WSA0KCQkJIGlmICg2NCA+IGEgKiBhICsgYiAqIGIgfHwgLjAxID4gTWF0aC5hYnMoVmIgLSB6YSkgJiYgLjAxID4gTWF0aC5hYnMoV2IgLSBBYSkgfHwgKFZiID0gemEsIFdiID0gQWEsIGEgPSBVKDEzKSwgYS5zZXRVaW50OCgwLCAxNiksIGhleShhLHphLEFhKSwgeHQpKSB7DQoJCQkJIA0KCQkJIH0NCgkJCQkvLyBBR0FSQk9UT1ZIDQogICAgICAgICAgICANCiAgICAgICAgICAgLyogNjQgPiBhICogYSArIGIgKiBiIHx8IC4wMSA+IE1hdGguYWJzKFZiIC0NCiAgICAgICAgICAgICAgICB6YSkgJiYgLjAxID4gTWF0aC5hYnMoV2IgLSBBYSkgfHwgKFZiID0gemEsIFdiID0gQWEsIGEgPSBVKDEzKSwgYS5zZXRVaW50OCgwLCAxNiksIGEuc2V0SW50MzIoMSwgemEsICEwKSwgYS5zZXRJbnQzMig1LCBBYSwgITApLCBhLnNldFVpbnQzMig5LCAwLCAhMCksIFYoYSkpDQogICAgICAgICovDQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmdW5jdGlvbiBTYigpIHsNCiAgICAgICAgaWYgKGRhKCkgJiYgbmEgJiYgbnVsbCAhPSBOKSB7DQogICAgICAgICAgICB2YXIgYSA9IFUoMSArIDIgKiBOLmxlbmd0aCk7DQogICAgICAgICAgICAvLyBBR0FSQk9UT1ZIDQoJCQlzdG9wTW92ZSA9IGZhbHNlOw0KCQkJY2xlYXJJbnRlcnZhbChhdXRvRmVlZEludGVydmFsKTsNCgkJCWF1dG9GZWVkSW50ZXJ2YWwgPSB1bmRlZmluZWQ7DQoJCQlyZWZyZXNoKCk7DQoJCQkvLyBBR0FSQk9UT1ZIDQogICAgICAgICAgICBhLnNldFVpbnQ4KDAsIDApOw0KICAgICAgICAgICAgZm9yICh2YXIgYiA9IDA7IGIgPCBOLmxlbmd0aDsgKytiKSBhLnNldFVpbnQxNigxICsgMiAqIGIsIE4uY2hhckNvZGVBdChiKSwgITApOw0KICAgICAgICAgICAgVihhKTsNCiAgICAgICAgICAgIE4gPSBudWxsDQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmdW5jdGlvbiBlYigpIHsNCiAgICAgICAgU2EoKTsNCiAgICAgICAgWCgxNykNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBKYigpIHsNCiAgICAgICAgU2EoKTsNCiAgICAgICAgWCgyMSkNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBkYSgpIHsNCiAgICAgICAgcmV0dXJuIG51bGwgIT0gdyAmJiB3LnJlYWR5U3RhdGUgPT0gdy5PUEVODQogICAgfQ0KDQogICAgZnVuY3Rpb24gWChhKSB7DQogICAgICAgIGlmIChkYSgpKSB7DQogICAgICAgICAgICB2YXIgYiA9IFUoMSk7DQogICAgICAgICAgICBiLnNldFVpbnQ4KDAsIGEpOw0KICAgICAgICAgICAgVihiKQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgZnVuY3Rpb24gWGIoKSB7DQogICAgICAgIHIgPSAxICogYy5pbm5lcldpZHRoOw0KICAgICAgICB0ID0gMSAqIGMuaW5uZXJIZWlnaHQ7DQogICAgICAgIHliLndpZHRoID0gTy53aWR0aCA9IHI7DQogICAgICAgIHliLmhlaWdodCA9IE8uaGVpZ2h0ID0gdDsNCiAgICAgICAgdmFyIGEgPSBlKCIjaGVsbG9Db250YWluZXIiKTsNCiAgICAgICAgYS5jc3MoInRyYW5zZm9ybSIsICJub25lIik7DQogICAgICAgIHZhciBiID0gYS5oZWlnaHQoKSwNCiAgICAgICAgICAgIGQgPSBjLmlubmVySGVpZ2h0Ow0KICAgICAgICAwICE9IGIgLyAyICUgMiAmJiAoYisrLCBhLmhlaWdodChiKSk7DQogICAgICAgIGIgPiBkIC8gMS4xID8gYS5jc3MoInRyYW5zZm9ybSIsICJ0cmFuc2xhdGUoLTUwJSwgLTUwJSkgc2NhbGUoIiArIGQgLyBiIC8gMS4xICsgIikiKSA6IGEuY3NzKCJ0cmFuc2Zvcm0iLCAidHJhbnNsYXRlKC01MCUsIC01MCUpIik7DQogICAgICAgIFliKCkNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBaYigpIHsNCiAgICAgICAgdmFyIGE7DQogICAgICAgIGEgPSAxICogTWF0aC5tYXgodCAvIDEwODAsIHIgLyAxOTIwKTsNCiAgICAgICAgcmV0dXJuIGEgKj0gUA0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIEljKCkgew0KICAgICAgICBpZiAoMCAhPSBxLmxlbmd0aCkgew0KICAgICAgICAgICAgZm9yICh2YXIgYSA9IDAsIGIgPSAwOyBiIDwgcS5sZW5ndGg7IGIrKykgYSArPSBxW2JdLnNpemU7DQogICAgICAgICAgICBsID0gKDkgKiBsICsgTWF0aC5wb3coTWF0aC5taW4oNjQgLyBhLCAxKSwgLjQpICogWmIoKSkgLyAxMA0KICAgICAgICB9DQogICAgfQ0KDQogICAgZnVuY3Rpb24gWWIoKSB7DQogICAgICAgIHZhciBhLCBiID0gRGF0ZS5ub3coKTsNCiAgICAgICAgKytKYzsNCiAgICAgICAgJGIgJiYgKCsrVGEsIDE4MCA8IFRhICYmIChUYSA9IDApKTsNCiAgICAgICAgeCA9DQogICAgICAgICAgICBiOw0KICAgICAgICBpZiAoMCA8IHEubGVuZ3RoKSB7DQogICAgICAgICAgICBJYygpOw0KICAgICAgICAgICAgZm9yICh2YXIgZCA9IGEgPSAwLCBjID0gMDsgYyA8IHEubGVuZ3RoOyBjKyspIHFbY10uVCgpLCBhICs9IHFbY10ueCAvIHEubGVuZ3RoLCBkICs9IHFbY10ueSAvIHEubGVuZ3RoOw0KICAgICAgICAgICAgcGEgPSBhOw0KICAgICAgICAgICAgcWEgPSBkOw0KICAgICAgICAgICAgcmEgPSBsOw0KICAgICAgICAgICAgeSA9ICh5ICsgYSkgLyAyOw0KICAgICAgICAgICAgeiA9ICh6ICsgZCkgLyAyDQogICAgICAgIH0gZWxzZSB5ID0gKDI5ICogeSArIHBhKSAvIDMwLCB6ID0gKDI5ICogeiArIHFhKSAvIDMwLCBsID0gKDkgKiBsICsgcmEgKiBaYigpKSAvIDEwOw0KICAgICAgICB1YygpOw0KICAgICAgICBmYigpOw0KICAgICAgICB6YiB8fCBmLmNsZWFyUmVjdCgwLCAwLCByLCB0KTsNCiAgICAgICAgemIgPyAoZi5maWxsU3R5bGUgPSBlYSA/ICIjMTExMTExIiA6ICIjRjJGQkZGIiwgZi5nbG9iYWxBbHBoYSA9IC4wNSwgZi5maWxsUmVjdCgwLCAwLCByLCB0KSwgZi5nbG9iYWxBbHBoYSA9IDEpIDogS2MoKTsNCiAgICAgICAgQS5zb3J0KGZ1bmN0aW9uKGEsIGIpIHsNCiAgICAgICAgICAgIHJldHVybiBhLnNpemUgPT0gYi5zaXplID8gYS5pZCAtIGIuaWQgOiBhLnNpemUgLSBiLnNpemUNCiAgICAgICAgfSk7DQogICAgICAgIGYuc2F2ZSgpOw0KICAgICAgICBmLnRyYW5zbGF0ZShyIC8gMiwgdCAvIDIpOw0KICAgICAgICBmLnNjYWxlKGwsIGwpOw0KICAgICAgICBmLnRyYW5zbGF0ZSgteSwgLXopOw0KICAgICAgICBmb3IgKGMgPSAwOyBjIDwgYmEubGVuZ3RoOyBjKyspIGJhW2NdLncoZik7DQogICAgICAgIGZvciAoYyA9IDA7IGMgPA0KICAgICAgICAgICAgQS5sZW5ndGg7IGMrKykgQVtjXS53KGYpOw0KICAgICAgICBpZiAocGIpIHsNCiAgICAgICAgICAgIEthID0gKDMgKiBLYSArIG5iKSAvIDQ7DQogICAgICAgICAgICBMYSA9ICgzICogTGEgKyBvYikgLyA0Ow0KICAgICAgICAgICAgZi5zYXZlKCk7DQogICAgICAgICAgICBmLnN0cm9rZVN0eWxlID0gIiNGRkFBQUEiOw0KICAgICAgICAgICAgZi5saW5lV2lkdGggPSAxMDsNCiAgICAgICAgICAgIGYubGluZUNhcCA9ICJyb3VuZCI7DQogICAgICAgICAgICBmLmxpbmVKb2luID0gInJvdW5kIjsNCiAgICAgICAgICAgIGYuZ2xvYmFsQWxwaGEgPSAuNTsNCiAgICAgICAgICAgIGYuYmVnaW5QYXRoKCk7DQogICAgICAgICAgICBmb3IgKGMgPSAwOyBjIDwgcS5sZW5ndGg7IGMrKykgZi5tb3ZlVG8ocVtjXS54LCBxW2NdLnkpLCBmLmxpbmVUbyhLYSwgTGEpOw0KICAgICAgICAgICAgZi5zdHJva2UoKTsNCiAgICAgICAgICAgIGYucmVzdG9yZSgpDQogICAgICAgIH0NCiAgICAgICAgZi5yZXN0b3JlKCk7DQogICAgICAgIEggJiYgSC53aWR0aCAmJiBmLmRyYXdJbWFnZShILCByIC0gSC53aWR0aCAtIDEwLCAxMCk7DQogICAgICAgIFQgPSBNYXRoLm1heChULCBhYygpKTsNCiAgICAgICAgMCAhPSBUICYmIChudWxsID09IFVhICYmIChVYSA9IG5ldyBWYSgyNCwgIiNGRkZGRkYiKSksIFVhLkIoUigic2NvcmUiKSArICI6ICIgKyB+fihUIC8gMTAwKSksIGQgPSBVYS5PKCksIGEgPSBkLndpZHRoLCBmLmdsb2JhbEFscGhhID0gLjIsIGYuZmlsbFN0eWxlID0gIiMwMDAwMDAiLCBmLmZpbGxSZWN0KDEwLCB0IC0gMTAgLSAyNCAtIDEwLCBhICsgMTAsIDM0KSwNCiAgICAgICAgICAgIGYuZ2xvYmFsQWxwaGEgPSAxLCBmLmRyYXdJbWFnZShkLCAxNSwgdCAtIDEwIC0gMjQgLSA1KSk7DQogICAgICAgIExjKCk7DQogICAgICAgIGIgPSBEYXRlLm5vdygpIC0gYjsNCiAgICAgICAgYiA+IDFFMyAvIDYwID8gTSAtPSAuMDEgOiBiIDwgMUUzIC8gNjUgJiYgKE0gKz0gLjAxKTsNCiAgICAgICAgLjQgPiBNICYmIChNID0gLjQpOw0KICAgICAgICAxIDwgTSAmJiAoTSA9IDEpOw0KICAgICAgICBiID0geCAtIGJjOw0KICAgICAgICAhZGEoKSB8fCBqYSB8fCBhYSA/IChCICs9IGIgLyAyRTMsIDEgPCBCICYmIChCID0gMSkpIDogKEIgLT0gYiAvIDMwMCwgMCA+IEIgJiYgKEIgPSAwKSk7DQogICAgICAgIDAgPCBCID8gKGYuZmlsbFN0eWxlID0gIiMwMDAwMDAiLCBjYyA/IChmLmdsb2JhbEFscGhhID0gQiwgZi5maWxsUmVjdCgwLCAwLCByLCB0KSwgSi5jb21wbGV0ZSAmJiBKLndpZHRoICYmIChKLndpZHRoIC8gSi5oZWlnaHQgPCByIC8gdCA/IChiID0gciwgYSA9IEouaGVpZ2h0ICogciAvIEoud2lkdGgpIDogKGIgPSBKLndpZHRoICogdCAvIEouaGVpZ2h0LCBhID0gdCksIGYuZHJhd0ltYWdlKEosIChyIC0gYikgLyAyLCAodCAtIGEpIC8gMiwgYiwgYSksIGYuZ2xvYmFsQWxwaGEgPSAuNSAqIEIsIGYuZmlsbFJlY3QoMCwgMCwgciwgdCkpKSA6IChmLmdsb2JhbEFscGhhID0gLjUgKiBCLCBmLmZpbGxSZWN0KDAsIDAsIHIsIHQpKSwgZi5nbG9iYWxBbHBoYSA9IDEpIDogY2MgPSAhMTsNCiAgICAgICAgYmMgPSB4DQogICAgfQ0KDQogICAgZnVuY3Rpb24gS2MoKSB7DQogICAgICAgIGYuZmlsbFN0eWxlID0NCiAgICAgICAgICAgIGVhID8gIiMxMTExMTEiIDogIiNGMkZCRkYiOw0KICAgICAgICBmLmZpbGxSZWN0KDAsIDAsIHIsIHQpOw0KICAgICAgICBmLnNhdmUoKTsNCiAgICAgICAgZi5zdHJva2VTdHlsZSA9IGVhID8gIiNBQUFBQUEiIDogIiMwMDAwMDAiOw0KICAgICAgICBmLmdsb2JhbEFscGhhID0gLjIgKiBsOw0KICAgICAgICBmb3IgKHZhciBhID0gciAvIGwsIGIgPSB0IC8gbCwgZCA9ICgteSArIGEgLyAyKSAlIDUwOyBkIDwgYTsgZCArPSA1MCkgZi5iZWdpblBhdGgoKSwgZi5tb3ZlVG8oZCAqIGwgLSAuNSwgMCksIGYubGluZVRvKGQgKiBsIC0gLjUsIGIgKiBsKSwgZi5zdHJva2UoKTsNCiAgICAgICAgZm9yIChkID0gKC16ICsgYiAvIDIpICUgNTA7IGQgPCBiOyBkICs9IDUwKSBmLmJlZ2luUGF0aCgpLCBmLm1vdmVUbygwLCBkICogbCAtIC41KSwgZi5saW5lVG8oYSAqIGwsIGQgKiBsIC0gLjUpLCBmLnN0cm9rZSgpOw0KICAgICAgICBmLnJlc3RvcmUoKQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIExjKCkgew0KICAgICAgICBpZiAoZGMgJiYgQWIud2lkdGgpIHsNCiAgICAgICAgICAgIHZhciBhID0gciAvIDU7DQogICAgICAgICAgICBmLmRyYXdJbWFnZShBYiwgNSwgNSwgYSwgYSkNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGFjKCkgew0KICAgICAgICBmb3IgKHZhciBhID0gMCwgYiA9IDA7IGIgPCBxLmxlbmd0aDsgYisrKSBhICs9IHFbYl0uZyAqIHFbYl0uZzsNCiAgICAgICAgcmV0dXJuIGENCiAgICB9DQoNCiAgICBmdW5jdGlvbiBSYigpIHsNCiAgICAgICAgSCA9IG51bGw7DQogICAgICAgIGlmIChudWxsICE9IEkgfHwgMCAhPSBDLmxlbmd0aCkNCiAgICAgICAgICAgIGlmIChudWxsICE9IEkgfHwgZmEpIHsNCiAgICAgICAgICAgICAgICBIID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiY2FudmFzIik7DQogICAgICAgICAgICAgICAgdmFyIGEgPSBILmdldENvbnRleHQoIjJkIiksDQogICAgICAgICAgICAgICAgICAgIGIgPSA2MCwNCiAgICAgICAgICAgICAgICAgICAgYiA9IG51bGwgPT0gSSA/IGIgKyAyNCAqIEMubGVuZ3RoIDogYiArIDE4MCwNCiAgICAgICAgICAgICAgICAgICAgZCA9IE1hdGgubWluKDIwMCwgLjMgKiByKSAvIDIwMDsNCiAgICAgICAgICAgICAgICBILndpZHRoID0gMjAwICogZDsNCiAgICAgICAgICAgICAgICBILmhlaWdodCA9IGIgKiBkOw0KICAgICAgICAgICAgICAgIGEuc2NhbGUoZCwgZCk7DQogICAgICAgICAgICAgICAgYS5nbG9iYWxBbHBoYSA9IC40Ow0KICAgICAgICAgICAgICAgIGEuZmlsbFN0eWxlID0gIiMwMDAwMDAiOw0KICAgICAgICAgICAgICAgIGEuZmlsbFJlY3QoMCwgMCwgMjAwLCBiKTsNCiAgICAgICAgICAgICAgICBhLmdsb2JhbEFscGhhID0gMTsNCiAgICAgICAgICAgICAgICBhLmZpbGxTdHlsZSA9ICIjRkZGRkZGIjsNCiAgICAgICAgICAgICAgICBkID0gbnVsbDsNCiAgICAgICAgICAgICAgICBkID0gUigibGVhZGVyYm9hcmQiKTsNCiAgICAgICAgICAgICAgICBhLmZvbnQgPSAiMzBweCBVYnVudHUiOw0KICAgICAgICAgICAgICAgIGEuZmlsbFRleHQoZCwgMTAwIC0gYS5tZWFzdXJlVGV4dChkKS53aWR0aCAvIDIsIDQwKTsNCiAgICAgICAgICAgICAgICB2YXIgYywgZTsNCiAgICAgICAgICAgICAgICBpZiAobnVsbCA9PSBJKQ0KICAgICAgICAgICAgICAgICAgICBmb3IgKGEuZm9udCA9ICIyMHB4IFVidW50dSIsIGIgPSAwOyBiIDwgQy5sZW5ndGg7ICsrYikgZCA9IENbYl0ubmFtZSB8fCBSKCJ1bm5hbWVkX2NlbGwiKSwgZmEgfHwgKGQgPSBSKCJ1bm5hbWVkX2NlbGwiKSksIDEgPT0gQ1tiXS5pZCB8fCAtMSAhPSBFLmluZGV4T2YoQ1tiXS5pZCkgPw0KICAgICAgICAgICAgICAgICAgICAgICAgKHFbMF0ubmFtZSAmJiAoZCA9IHFbMF0ubmFtZSksIGEuZmlsbFN0eWxlID0gIiNGRkFBQUEiKSA6IGEuZmlsbFN0eWxlID0gIiNGRkZGRkYiLCBkID0gYiArIDEgKyAiLiAiICsgZCwgZSA9IGEubWVhc3VyZVRleHQoZCkud2lkdGgsIGMgPSA3MCArIDI0ICogYiwgMjAwIDwgZSA/IGEuZmlsbFRleHQoZCwgMTAsIGMpIDogYS5maWxsVGV4dChkLCAoMjAwIC0gZSkgLyAyLCBjKTsNCiAgICAgICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgICAgIGZvciAoYiA9IGQgPSAwOyBiIDwgSS5sZW5ndGg7ICsrYikgYyA9IGQgKyBJW2JdICogTWF0aC5QSSAqIDIsIGEuZmlsbFN0eWxlID0gTWNbYiArIDFdLCBhLmJlZ2luUGF0aCgpLCBhLm1vdmVUbygxMDAsIDE0MCksIGEuYXJjKDEwMCwgMTQwLCA4MCwgZCwgYywgITEpLCBhLmZpbGwoKSwgZCA9IGMNCiAgICAgICAgICAgIH0NCiAgICB9DQoNCiAgICBmdW5jdGlvbiBOYyhhKSB7DQogICAgICAgIGlmIChudWxsID09IGEgfHwgMCA9PSBhLmxlbmd0aCkgcmV0dXJuIG51bGw7DQogICAgICAgIGlmICgiJSIgPT0gYVswXSkgew0KICAgICAgICAgICAgaWYgKCFjLk1DIHx8ICFjLk1DLmdldFNraW5JbmZvKSByZXR1cm4gbnVsbDsNCiAgICAgICAgICAgIGEgPSBjLk1DLmdldFNraW5JbmZvKCJza2luXyIgKyBhLnNsaWNlKDEpKTsNCiAgICAgICAgICAgIGlmIChudWxsID09IGEpIHJldHVybiBudWxsOw0KICAgICAgICAgICAgZm9yIChhID0gKCthLmNvbG9yKS50b1N0cmluZygxNik7IDYgPg0KICAgICAgICAgICAgICAgIGEubGVuZ3RoOykgYSA9ICIwIiArIGE7DQogICAgICAgICAgICByZXR1cm4gIiMiICsgYQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiBudWxsDQogICAgfQ0KDQogICAgZnVuY3Rpb24gZWMoYSkgew0KICAgICAgICBpZiAobnVsbCA9PSBhIHx8IDAgPT0gYS5sZW5ndGgpIHJldHVybiBudWxsOw0KICAgICAgICBpZiAoIXNhLmhhc093blByb3BlcnR5KGEpKSB7DQogICAgICAgICAgICB2YXIgYiA9IG5ldyBJbWFnZTsNCiAgICAgICAgICAgIGlmICgiOiIgPT0gYVswXSkgYi5zcmMgPSBhLnNsaWNlKDEpOw0KICAgICAgICAgICAgZWxzZSBpZiAoIiUiID09IGFbMF0pIHsNCiAgICAgICAgICAgICAgICBpZiAoIWMuTUMgfHwgIWMuTUMuZ2V0U2tpbkluZm8pIHJldHVybiBudWxsOw0KICAgICAgICAgICAgICAgIHZhciBkID0gYy5NQy5nZXRTa2luSW5mbygic2tpbl8iICsgYS5zbGljZSgxKSk7DQogICAgICAgICAgICAgICAgaWYgKG51bGwgPT0gZCkgcmV0dXJuIG51bGw7DQogICAgICAgICAgICAgICAgYi5zcmMgPSBjLkFTU0VUU19ST09UICsgZC51cmwNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHNhW2FdID0gYg0KICAgICAgICB9DQogICAgICAgIHJldHVybiAwICE9IHNhW2FdLndpZHRoICYmIHNhW2FdLmNvbXBsZXRlID8gc2FbYV0gOiBudWxsDQogICAgfQ0KDQogICAgZnVuY3Rpb24gQmIoYSwgYiwgZCwgYywgZSkgew0KICAgICAgICB0aGlzLiQgPSBhOw0KICAgICAgICB0aGlzLnggPSBiOw0KICAgICAgICB0aGlzLnkgPSBkOw0KICAgICAgICB0aGlzLmYgPSBjOw0KICAgICAgICB0aGlzLmIgPSBlDQogICAgfQ0KDQogICAgZnVuY3Rpb24gY2EoYSwgYiwgZCwgYywgZSwgcCkgew0KICAgICAgICB0aGlzLmlkID0gYTsNCiAgICAgICAgdGhpcy5zID0gdGhpcy54ID0gdGhpcy5NID0gdGhpcy5KID0gYjsNCiAgICAgICAgdGhpcy51ID0gdGhpcy55ID0gdGhpcy5OID0gdGhpcy5LID0gZDsNCiAgICAgICAgdGhpcy5vID0gdGhpcy5zaXplID0gYzsNCiAgICAgICAgdGhpcy5jb2xvciA9IGU7DQogICAgICAgIHRoaXMuYSA9IFtdOw0KICAgICAgICB0aGlzLmJhKCk7DQogICAgICAgIHRoaXMuQShwKQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIEhjKGEpIHsNCiAgICAgICAgZm9yIChhID0gYS50b1N0cmluZygxNik7IDYgPiBhLmxlbmd0aDspIGEgPSAiMCIgKyBhOw0KICAgICAgICByZXR1cm4gIiMiICsgYQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIFZhKGEsIGIsIGQsIGMpIHsNCiAgICAgICAgYSAmJiAodGhpcy52ID0gYSk7DQogICAgICAgIGIgJiYgKHRoaXMuVyA9IGIpOw0KICAgICAgICB0aGlzLlkgPSAhIWQ7DQogICAgICAgIGMgJiYgKHRoaXMuWiA9IGMpDQogICAgfQ0KDQogICAgZnVuY3Rpb24gT2MoYSkgew0KICAgICAgICBmb3IgKHZhciBiID0gYS5sZW5ndGgsIGQsIGM7IDAgPCBiOykgYyA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGIpLCBiLS0sIGQgPSBhW2JdLCBhW2JdID0gYVtjXSwgYVtjXSA9IGQNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBQYygpIHsNCiAgICAgICAgaCA9IFdhDQogICAgfQ0KDQogICAgZnVuY3Rpb24gZmMoYSkgew0KICAgICAgICBoLmNvbnRleHQgPSAiZ29vZ2xlIiA9PSBhID8gImdvb2dsZSIgOiAiZmFjZWJvb2siOw0KICAgICAgICBYYSgpDQogICAgfQ0KDQogICAgZnVuY3Rpb24gWGEoKSB7DQogICAgICAgIGMubG9jYWxTdG9yYWdlLnN0b3JlT2JqZWN0SW5mbyA9IEpTT04uc3RyaW5naWZ5KGgpOw0KICAgICAgICBoID0gSlNPTi5wYXJzZShjLmxvY2FsU3RvcmFnZS5zdG9yZU9iamVjdEluZm8pOw0KICAgICAgICBjLnN0b3JhZ2VJbmZvID0gaDsNCiAgICAgICAgImdvb2dsZSIgPT0gaC5jb250ZXh0ID8gKGUoIiNnUGx1c1NoYXJlIikuc2hvdygpLCBlKCIjZmJTaGFyZSIpLmhpZGUoKSkgOiAoZSgiI2dQbHVzU2hhcmUiKS5oaWRlKCksIGUoIiNmYlNoYXJlIikuc2hvdygpKQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGdjKGEpIHsNCiAgICAgICAgZSgiI2hlbGxvQ29udGFpbmVyIikuYXR0cigiZGF0YS1oYXMtYWNjb3VudC1kYXRhIik7DQogICAgICAgICIiICE9IGEuZGlzcGxheU5hbWUgJiYgKGEubmFtZSA9IGEuZGlzcGxheU5hbWUpOw0KICAgICAgICBpZiAobnVsbCA9PSBhLm5hbWUgfHwgdm9pZCAwID09IGEubmFtZSkgYS5uYW1lID0gIiI7DQogICAgICAgIHZhciBiID0gYS5uYW1lLmxhc3RJbmRleE9mKCJfIik7IC0gMSAhPSBiICYmIChhLm5hbWUgPSBhLm5hbWUuc3Vic3RyaW5nKDAsIGIpKTsNCiAgICAgICAgZSgiI2hlbGxvQ29udGFpbmVyIikuYXR0cigiZGF0YS1oYXMtYWNjb3VudC1kYXRhIiwgIjEiKTsNCiAgICAgICAgZSgiI2hlbGxvQ29udGFpbmVyIikuYXR0cigiZGF0YS1sb2dnZWQtaW4iLCAiMSIpOw0KICAgICAgICBlKCIuYWdhcmlvLXByb2ZpbGUtcGFuZWwgLnByb2dyZXNzLWJhci1zdGFyIikudGV4dChhLmxldmVsKTsNCiAgICAgICAgZSgiLmFnYXJpby1leHAtYmFyIC5wcm9ncmVzcy1iYXItdGV4dCIpLnRleHQoYS54cCArICIvIiArIGEueHBOZWVkZWQgKyAiIFhQIik7DQogICAgICAgIGUoIi5hZ2FyaW8tZXhwLWJhciAucHJvZ3Jlc3MtYmFyIikuY3NzKCJ3aWR0aCIsICg4OCAqIGEueHAgLyBhLnhwTmVlZGVkKS50b0ZpeGVkKDIpICsgIiUiKTsNCiAgICAgICAgZSgiLmFnYXJpby1wcm9maWxlLW5hbWUiKS50ZXh0KGEubmFtZSk7DQogICAgICAgICIiICE9IGEucGljdHVyZSAmJiBlKCIuYWdhcmlvLXByb2ZpbGUtcGljdHVyZSIpLmF0dHIoInNyYyIsIGEucGljdHVyZSk7DQogICAgICAgIENiKCk7DQogICAgICAgIGgudXNlckluZm8ubGV2ZWwgPSBhLmxldmVsOw0KICAgICAgICBoLnVzZXJJbmZvLnhwID0gYS54cDsNCiAgICAgICAgaC51c2VySW5mby54cE5lZWRlZCA9IGEueHBOZWVkZWQ7DQogICAgICAgIGgudXNlckluZm8uZGlzcGxheU5hbWUgPSBhLm5hbWU7DQogICAgICAgIGgudXNlckluZm8ubG9nZ2VkSW4gPSAiMSI7DQogICAgICAgIGMudXBkYXRlU3RvcmFnZSgpDQogICAgfQ0KDQogICAgZnVuY3Rpb24gZ2EoYSwgYikgew0KICAgICAgICB2YXIgZCA9IGE7DQogICAgICAgIGlmIChoLnVzZXJJbmZvLmxvZ2dlZEluKSB7DQogICAgICAgICAgICB2YXIgdSA9IGUoIiNoZWxsb0NvbnRhaW5lciIpLmlzKCI6dmlzaWJsZSIpICYmICIxIiA9PSBlKCIjaGVsbG9Db250YWluZXIiKS5hdHRyKCJkYXRhLWhhcy1hY2NvdW50LWRhdGEiKTsNCiAgICAgICAgICAgIGlmIChudWxsID09IGQgfHwgdm9pZCAwID09IGQpIGQgPSBoLnVzZXJJbmZvOw0KICAgICAgICAgICAgaWYgKHUpIHsNCiAgICAgICAgICAgICAgICB2YXIgZyA9ICtlKCIuYWdhcmlvLWV4cC1iYXIgLnByb2dyZXNzLWJhci10ZXh0IikuZmlyc3QoKS50ZXh0KCkuc3BsaXQoIi8iKVswXSwNCiAgICAgICAgICAgICAgICAgICAgdSA9ICtlKCIuYWdhcmlvLWV4cC1iYXIgLnByb2dyZXNzLWJhci10ZXh0IikuZmlyc3QoKS50ZXh0KCkuc3BsaXQoIi8iKVsxXS5zcGxpdCgiICIpWzBdLA0KICAgICAgICAgICAgICAgICAgICBwID0gZSgiLmFnYXJpby1wcm9maWxlLXBhbmVsIC5wcm9ncmVzcy1iYXItc3RhciIpLmZpcnN0KCkudGV4dCgpOw0KICAgICAgICAgICAgICAgIGlmIChwICE9IGQubGV2ZWwpIGdhKHsNCiAgICAgICAgICAgICAgICAgICAgeHA6IHUsDQogICAgICAgICAgICAgICAgICAgIHhwTmVlZGVkOiB1LA0KICAgICAgICAgICAgICAgICAgICBsZXZlbDogcA0KICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICBlKCIuYWdhcmlvLXByb2ZpbGUtcGFuZWwgLnByb2dyZXNzLWJhci1zdGFyIikudGV4dChkLmxldmVsKTsNCiAgICAgICAgICAgICAgICAgICAgZSgiLmFnYXJpby1leHAtYmFyIC5wcm9ncmVzcy1iYXIiKS5jc3MoIndpZHRoIiwgIjEwMCUiKTsNCiAgICAgICAgICAgICAgICAgICAgZSgiLnByb2dyZXNzLWJhci1zdGFyIikuYWRkQ2xhc3MoImFuaW1hdGVkIHRhZGEiKS5vbmUoIndlYmtpdEFuaW1hdGlvbkVuZCBtb3pBbmltYXRpb25FbmQgTVNBbmltYXRpb25FbmQgb2FuaW1hdGlvbmVuZCBhbmltYXRpb25lbmQiLCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGUoIi5wcm9ncmVzcy1iYXItc3RhciIpLnJlbW92ZUNsYXNzKCJhbmltYXRlZCB0YWRhIikNCiAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBlKCIuYWdhcmlvLWV4cC1iYXIgLnByb2dyZXNzLWJhci10ZXh0IikudGV4dChkLnhwTmVlZGVkICsgIi8iICsgZC54cE5lZWRlZCArICIgWFAiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGdhKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4cDogMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4cE5lZWRlZDogZC54cE5lZWRlZCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXZlbDogZC5sZXZlbA0KICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2EoZCkNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAgIH0sIDFFMykNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGYgPSBEYXRlLm5vdygpLA0KICAgICAgICAgICAgICAgICAgICAgICAgayA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgPSAoRGF0ZS5ub3coKSAtIGYpIC8gMUUzOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgPSAwID4gYSA/IDAgOiAxIDwgYSA/IDEgOiBhOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgPSBhICogYSAqICgzIC0gMiAqIGEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUoIi5hZ2FyaW8tZXhwLWJhciAucHJvZ3Jlc3MtYmFyLXRleHQiKS50ZXh0KH5+KGcgKyAoZC54cCAtIGcpICogYSkgKyAiLyIgKyBkLnhwTmVlZGVkICsgIiBYUCIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUoIi5hZ2FyaW8tZXhwLWJhciAucHJvZ3Jlc3MtYmFyIikuY3NzKCJ3aWR0aCIsICg4OCAqIChnICsgKGQueHAgLSBnKSAqIGEpIC8gZC54cE5lZWRlZCkudG9GaXhlZCgyKSArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIlIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYiAmJiBiKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgMSA+IGEgJiYgYy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoaykNCiAgICAgICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgIGMucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGspDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgZnVuY3Rpb24gQ2IoKSB7DQogICAgICAgIHZhciBhOw0KICAgICAgICAoInVuZGVmaW5lZCIgIT09IHR5cGVvZiBhICYmIGEgfHwgIm5vbmUiID09IGUoIiNzZXR0aW5ncyIpLmNzcygiZGlzcGxheSIpICYmICJub25lIiA9PSBlKCIjc29jaWFsTG9naW5Db250YWluZXIiKS5jc3MoImRpc3BsYXkiKSkgJiYgZSgiI2luc3RydWN0aW9ucyIpLnNob3coKQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGhjKGEpIHsNCiAgICAgICAgaWYgKCJjb25uZWN0ZWQiID09IGEuc3RhdHVzKSB7DQogICAgICAgICAgICB2YXIgYiA9IGEuYXV0aFJlc3BvbnNlLmFjY2Vzc1Rva2VuOw0KICAgICAgICAgICAgbnVsbCA9PSBiIHx8ICJ1bmRlZmluZWQiID09IGIgfHwgIiIgPT0gYiA/ICgzID4gaWMgJiYgKGljKyssIGMuZmFjZWJvb2tSZWxvZ2luKCkpLCBjLmxvZ291dCgpKSA6IChjLk1DLmRvTG9naW5XaXRoRkIoYiksIG0uY2FjaGUubG9naW5faW5mbyA9IFtiLCAiZmFjZWJvb2siXSwgYy5GQi5hcGkoIi9tZS9waWN0dXJlP3dpZHRoPTE4MCZoZWlnaHQ9MTgwIiwgZnVuY3Rpb24oYikgew0KICAgICAgICAgICAgICAgIGgudXNlckluZm8ucGljdHVyZSA9IGIuZGF0YS51cmw7DQogICAgICAgICAgICAgICAgYy51cGRhdGVTdG9yYWdlKCk7DQogICAgICAgICAgICAgICAgZSgiLmFnYXJpby1wcm9maWxlLXBpY3R1cmUiKS5hdHRyKCJzcmMiLCBiLmRhdGEudXJsKTsNCiAgICAgICAgICAgICAgICBoLnVzZXJJbmZvLnNvY2lhbElkID0gYS5hdXRoUmVzcG9uc2UudXNlcklEOw0KICAgICAgICAgICAgICAgIFlhKCkNCiAgICAgICAgICAgIH0pLCBlKCIjaGVsbG9Db250YWluZXIiKS5hdHRyKCJkYXRhLWxvZ2dlZC1pbiIsICIxIiksIGguY29udGV4dCA9ICJmYWNlYm9vayIsIGgubG9naW5JbnRlbnQgPSAiMSIsIGMudXBkYXRlU3RvcmFnZSgpKQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgZnVuY3Rpb24gamMoYSkgew0KICAgICAgICBrYSgiOnBhcnR5Iik7DQogICAgICAgIGUoIiNoZWxsb0NvbnRhaW5lciIpLmF0dHIoImRhdGEtcGFydHktc3RhdGUiLCAiNCIpOw0KICAgICAgICBhID0gZGVjb2RlVVJJQ29tcG9uZW50KGEpLnJlcGxhY2UoLy4qIy9naW0sICIiKTsNCiAgICAgICAgRGIoIiMiICsgYy5lbmNvZGVVUklDb21wb25lbnQoYSkpOw0KICAgICAgICBlLmFqYXgoQ2EgKyAiZ2V0VG9rZW4iLCB7DQogICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgZSgiI2hlbGxvQ29udGFpbmVyIikuYXR0cigiZGF0YS1wYXJ0eS1zdGF0ZSIsICI2IikNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihiKSB7DQogICAgICAgICAgICAgICAgYiA9IGIuc3BsaXQoIlxuIik7DQogICAgICAgICAgICAgICAgZSgiLnBhcnR5VG9rZW4iKS52YWwoImFnYXIuaW8vIyIgKyBjLmVuY29kZVVSSUNvbXBvbmVudChhKSk7DQogICAgICAgICAgICAgICAgZSgiI2hlbGxvQ29udGFpbmVyIikuYXR0cigiZGF0YS1wYXJ0eS1zdGF0ZSIsICI1Iik7DQogICAgICAgICAgICAgICAga2EoIjpwYXJ0eSIpOw0KICAgICAgICAgICAgICAgIGxiKCJ3czovLyIgKyBiWzBdLCBhKQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIGRhdGFUeXBlOiAidGV4dCIsDQogICAgICAgICAgICBtZXRob2Q6ICJQT1NUIiwNCiAgICAgICAgICAgIGNhY2hlOiAhMSwNCiAgICAgICAgICAgIGNyb3NzRG9tYWluOiAhMCwNCiAgICAgICAgICAgIGRhdGE6IGENCiAgICAgICAgfSkNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBEYihhKSB7DQogICAgICAgIGMuaGlzdG9yeSAmJiBjLmhpc3RvcnkucmVwbGFjZVN0YXRlICYmIGMuaGlzdG9yeS5yZXBsYWNlU3RhdGUoe30sIGMuZG9jdW1lbnQudGl0bGUsIGEpDQogICAgfQ0KDQogICAgZnVuY3Rpb24gSmEoKSB7DQogICAgICAgIGNsZWFyVGltZW91dChVYik7DQogICAgICAgIG51bGwgPT0gYy5zdG9yYWdlSW5mbyAmJiBjLmNyZWF0ZURlZmF1bHRTdG9yYWdlKCk7DQogICAgICAgIEViID0gRGF0ZS5ub3coKTsNCiAgICAgICAgMCA+PSBSYSAmJiAoUmEgPSBFYik7DQogICAgICAgIEVhID0gITE7DQogICAgICAgIFFjKCkNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBHYyhhLCBiKSB7DQogICAgICAgIHZhciBkID0gLTEgIT0gRS5pbmRleE9mKGEuaWQpLA0KICAgICAgICAgICAgYyA9IC0xICE9IEUuaW5kZXhPZihiLmlkKSwNCiAgICAgICAgICAgIGUgPSAzMCA+IGIuc2l6ZTsNCiAgICAgICAgZCAmJiBlICYmICsrdWI7DQogICAgICAgIGUgfHwgIWQgfHwgYyB8fCBiLmVhICYgMzIgfHwgKyt3Yg0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGtjKGEpIHsNCiAgICAgICAgYSA9IH5+YTsNCiAgICAgICAgdmFyIGIgPSAoYSAlIDYwKS50b1N0cmluZygpOw0KICAgICAgICBhID0gKH5+KGEgLyA2MCkpLnRvU3RyaW5nKCk7DQogICAgICAgIDIgPiBiLmxlbmd0aCAmJiAoYiA9ICIwIiArIGIpOw0KICAgICAgICByZXR1cm4gYSArICI6IiArIGINCiAgICB9DQoNCiAgICBmdW5jdGlvbiBSYygpIHsNCiAgICAgICAgaWYgKG51bGwgPT0gQykgcmV0dXJuIDA7DQogICAgICAgIGZvciAodmFyIGEgPSAwOyBhIDwgQy5sZW5ndGg7ICsrYSkNCiAgICAgICAgICAgIGlmICgtMSAhPSBFLmluZGV4T2YoQ1thXS5pZCkpIHJldHVybiBhICsgMTsNCiAgICAgICAgcmV0dXJuIDANCiAgICB9DQoNCiAgICBmdW5jdGlvbiBTYygpIHsNCiAgICAgICAgZSgiLnN0YXRzLWZvb2QtZWF0ZW4iKS50ZXh0KHViKTsNCiAgICAgICAgZSgiLnN0YXRzLXRpbWUtYWxpdmUiKS50ZXh0KGtjKChFYiAtIFJhKSAvIDFFMykpOw0KICAgICAgICBlKCIuc3RhdHMtbGVhZGVyYm9hcmQtdGltZSIpLnRleHQoa2MoeGIpKTsNCiAgICAgICAgZSgiLnN0YXRzLWhpZ2hlc3QtbWFzcyIpLnRleHQofn4oVCAvIDEwMCkpOw0KICAgICAgICBlKCIuc3RhdHMtY2VsbHMtZWF0ZW4iKS50ZXh0KHdiKTsNCiAgICAgICAgZSgiLnN0YXRzLXRvcC1wb3NpdGlvbiIpLnRleHQoMCA9PSBXID8gIjooIiA6DQogICAgICAgICAgICBXKTsNCiAgICAgICAgdmFyIGEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgic3RhdHNHcmFwaCIpOw0KICAgICAgICBpZiAoYSkgew0KICAgICAgICAgICAgdmFyIGIgPSBhLmdldENvbnRleHQoIjJkIiksDQogICAgICAgICAgICAgICAgZCA9IGEud2lkdGgsDQogICAgICAgICAgICAgICAgYSA9IGEuaGVpZ2h0Ow0KICAgICAgICAgICAgYi5jbGVhclJlY3QoMCwgMCwgZCwgYSk7DQogICAgICAgICAgICBpZiAoMiA8IEYubGVuZ3RoKSB7DQogICAgICAgICAgICAgICAgZm9yICh2YXIgYyA9IDIwMCwgZyA9IDA7IGcgPCBGLmxlbmd0aDsgZysrKSBjID0gTWF0aC5tYXgoRltnXSwgYyk7DQogICAgICAgICAgICAgICAgYi5saW5lV2lkdGggPSAzOw0KICAgICAgICAgICAgICAgIGIubGluZUNhcCA9ICJyb3VuZCI7DQogICAgICAgICAgICAgICAgYi5saW5lSm9pbiA9ICJyb3VuZCI7DQogICAgICAgICAgICAgICAgYi5zdHJva2VTdHlsZSA9IHZiOw0KICAgICAgICAgICAgICAgIGIuZmlsbFN0eWxlID0gdmI7DQogICAgICAgICAgICAgICAgYi5iZWdpblBhdGgoKTsNCiAgICAgICAgICAgICAgICBiLm1vdmVUbygwLCBhIC0gRlswXSAvIGMgKiAoYSAtIDEwKSArIDEwKTsNCiAgICAgICAgICAgICAgICBmb3IgKGcgPSAxOyBnIDwgRi5sZW5ndGg7IGcgKz0gTWF0aC5tYXgofn4oRi5sZW5ndGggLyBkKSwgMSkpIHsNCiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgcCA9IGcgLyAoRi5sZW5ndGggLSAxKSAqIGQsIGYgPSBbXSwgayA9IC0yMDsgMjAgPj0gazsgKytrKSAwID4gZyArIGsgfHwgZyArIGsgPj0gRi5sZW5ndGggfHwgZi5wdXNoKEZbZyArIGtdKTsNCiAgICAgICAgICAgICAgICAgICAgZiA9IGYucmVkdWNlKGZ1bmN0aW9uKGEsIGIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhICsgYg0KICAgICAgICAgICAgICAgICAgICB9KSAvIGYubGVuZ3RoIC8gYzsNCiAgICAgICAgICAgICAgICAgICAgYi5saW5lVG8ocCwNCiAgICAgICAgICAgICAgICAgICAgICAgIGEgLSBmICogKGEgLSAxMCkgKyAxMCkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgYi5zdHJva2UoKTsNCiAgICAgICAgICAgICAgICBiLmdsb2JhbEFscGhhID0gLjU7DQogICAgICAgICAgICAgICAgYi5saW5lVG8oZCwgYSk7DQogICAgICAgICAgICAgICAgYi5saW5lVG8oMCwgYSk7DQogICAgICAgICAgICAgICAgYi5maWxsKCk7DQogICAgICAgICAgICAgICAgYi5nbG9iYWxBbHBoYSA9IDENCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIFFjKCkgew0KICAgICAgICBqYSB8fCBhYSB8fCAoWmEgPyAoYy5yZWZyZXNoQWQoYy5hZFNsb3RzLmFiKSwgU2MoKSwgYWEgPSAhMCwgc2V0VGltZW91dChmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIGUoIiNvdmVybGF5cyIpLmZhZGVJbig1MDAsIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIGdhKCkNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgZSgiI3N0YXRzIikuc2hvdygpOw0KICAgICAgICAgICAgdmFyIGEgPSBsYygiZ19wbHVzX3NoYXJlX3N0YXRzIik7DQogICAgICAgICAgICBjLmZpbGxTb2NpYWxWYWx1ZXMoYSwgImdQbHVzU2hhcmUiKQ0KICAgICAgICB9LCAxNTAwKSkgOiB5YSg1MDApKQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGxjKGEpIHsNCiAgICAgICAgdmFyIGIgPSBlKCIuc3RhdHMtdGltZS1hbGl2ZSIpLnRleHQoKTsNCiAgICAgICAgcmV0dXJuIGMucGFyc2VTdHJpbmcoYSwgIiVAIiwgW2Iuc3BsaXQoIjoiKVswXSwgYi5zcGxpdCgiOiIpWzFdLCBlKCIuc3RhdHMtaGlnaGVzdC1tYXNzIikudGV4dCgpXSkNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBUYygpIHsNCiAgICAgICAgYy5vcGVuKCJodHRwczovL3BsdXMuZ29vZ2xlLmNvbS9zaGFyZT91cmw9d3d3LmFnYXIuaW8maGw9ZW4tVVMiLCAiQWdhci5pbyIsICJ3aWR0aD00ODQsaGVpZ2h0PTU4MCxtZW51YmFyPW5vLHRvb2xiYXI9bm8scmVzaXphYmxlPXllcyxzY3JvbGxiYXJzPW5vLGxlZnQ9IiArIChjLnNjcmVlblggKyBjLmlubmVyV2lkdGggLyAyIC0gMjQyKSArICIsdG9wPSIgKyAoYy5pbm5lckhlaWdodCAtIDU4MCkgLyAyKQ0KICAgIH0NCiAgICB2YXIgbWMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJjYW52YXMiKTsNCiAgICBpZiAoInVuZGVmaW5lZCIgPT0gdHlwZW9mIGNvbnNvbGUgfHwgInVuZGVmaW5lZCIgPT0gdHlwZW9mIERhdGFWaWV3IHx8ICJ1bmRlZmluZWQiID09IHR5cGVvZiBXZWJTb2NrZXQgfHwgbnVsbCA9PSBtYyB8fCBudWxsID09IG1jLmdldENvbnRleHQgfHwgbnVsbCA9PSBjLmxvY2FsU3RvcmFnZSkgYWxlcnQoIllvdSBicm93c2VyIGRvZXMgbm90IHN1cHBvcnQgdGhpcyBnYW1lLCB3ZSByZWNvbW1lbmQgeW91IHRvIHVzZSBGaXJlZm94IHRvIHBsYXkgdGhpcyIpOw0KICAgIGVsc2Ugew0KICAgICAgICB2YXIgRCA9IHt9Ow0KICAgICAgICAoZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB2YXIgYSA9IGMubG9jYXRpb24uc2VhcmNoOw0KICAgICAgICAgICAgIj8iID09IGEuY2hhckF0KDApICYmIChhID0NCiAgICAgICAgICAgICAgICBhLnNsaWNlKDEpKTsNCiAgICAgICAgICAgIGZvciAodmFyIGEgPSBhLnNwbGl0KCImIiksIGIgPSAwOyBiIDwgYS5sZW5ndGg7IGIrKykgew0KICAgICAgICAgICAgICAgIHZhciBkID0gYVtiXS5zcGxpdCgiPSIpOw0KICAgICAgICAgICAgICAgIERbZFswXV0gPSBkWzFdDQogICAgICAgICAgICB9DQogICAgICAgIH0pKCk7DQogICAgICAgIGMucXVlcnlTdHJpbmcgPSBEOw0KICAgICAgICB2YXIgbmMgPSAiZmIiIGluIEQsDQogICAgICAgICAgICBVYyA9ICJtaW5pY2xpcCIgaW4gRCwNCiAgICAgICAgICAgIHYgPSB7DQogICAgICAgICAgICAgICAgc2tpbnNFbmFibGVkOiAiMCIsDQogICAgICAgICAgICAgICAgbmFtZXNFbmFibGVkOiAiMCIsDQogICAgICAgICAgICAgICAgbm9Db2xvcnM6ICIwIiwNCiAgICAgICAgICAgICAgICBibGFja1RoZW1lOiAiMCIsDQogICAgICAgICAgICAgICAgc2hvd01hc3M6ICIwIiwNCiAgICAgICAgICAgICAgICBzdGF0c0VuYWJsZWQ6ICIwIg0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIFZjID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgdWEoIiIsIC0xKQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIG9jID0gImh0dHA6IiAhPSBjLmxvY2F0aW9uLnByb3RvY29sLA0KICAgICAgICAgICAgV2MgPSAiMSIgPT0gdGMoKSwNCiAgICAgICAgICAgIHBjID0gITE7DQogICAgICAgIG5jIHx8IFVjIHx8IChvYyAmJiAhV2MgPyAodWEoIjEiLCAxKSwgYy5sb2NhdGlvbi5ocmVmID0gImh0dHA6IiArIGMubG9jYXRpb24uaHJlZi5zdWJzdHJpbmcoYy5sb2NhdGlvbi5wcm90b2NvbC5sZW5ndGgpLCBwYyA9ICEwKSA6IHVhKCIiLCAtMSkpOw0KICAgICAgICBvYyB8fCB1YSgiIiwgLTEpOw0KICAgICAgICBwYyB8fCBzZXRUaW1lb3V0KFZjLCAzRTMpOw0KICAgICAgICBpZiAoIWMuYWdhcmlvTm9Jbml0KSB7DQogICAgICAgICAgICB2YXIgamIgPSBjLmxvY2F0aW9uLnByb3RvY29sLA0KICAgICAgICAgICAgICAgIG1iID0gImh0dHBzOiIgPT0gamI7DQogICAgICAgICAgICBELm1hc3RlciAmJiAoRW52Q29uZmlnLm1hc3Rlcl91cmwgPSBELm1hc3Rlcik7DQogICAgICAgICAgICB2YXIgQ2EgPSBqYiArICIvLyIgKyBFbnZDb25maWcubWFzdGVyX3VybCArICIvIiwNCiAgICAgICAgICAgICAgICAkYSA9IGMubmF2aWdhdG9yLnVzZXJBZ2VudDsNCiAgICAgICAgICAgIGlmICgtMSAhPSAkYS5pbmRleE9mKCJBbmRyb2lkIikpIGMuZ2EgJiYgYy5nYSgic2VuZCIsICJldmVudCIsICJNb2JpbGVSZWRpcmVjdCIsICJQbGF5U3RvcmUiKSwgc2V0VGltZW91dChmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICBjLmxvY2F0aW9uLmhyZWYgPSAiaHR0cHM6Ly9wbGF5Lmdvb2dsZS5jb20vc3RvcmUvYXBwcy9kZXRhaWxzP2lkPWNvbS5taW5pY2xpcC5hZ2FyLmlvIg0KICAgICAgICAgICAgfSwgMUUzKTsNCiAgICAgICAgICAgIGVsc2UgaWYgKC0xICE9ICRhLmluZGV4T2YoImlQaG9uZSIpIHx8IC0xICE9ICRhLmluZGV4T2YoImlQYWQiKSB8fCAtMSAhPSAkYS5pbmRleE9mKCJpUG9kIikpIGMuZ2EgJiYgYy5nYSgic2VuZCIsICJldmVudCIsICJNb2JpbGVSZWRpcmVjdCIsICJBcHBTdG9yZSIpLCBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIGMubG9jYXRpb24uaHJlZiA9ICJodHRwczovL2l0dW5lcy5hcHBsZS5jb20vYXBwL2FnYXIuaW8vaWQ5OTU5OTk3MDM/bXQ9OCZhdD0xbDN2YWpwIg0KICAgICAgICAgICAgfSwgMUUzKTsNCiAgICAgICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgICAgIHZhciBtID0ge307DQogICAgICAgICAgICAgICAgYy5hZ2FyQXBwID0gbTsNCiAgICAgICAgICAgICAgICB2YXIgeWIsIGYsIE8sIHIsIHQsIGlhID0gbnVsbCwNCiAgICAgICAgICAgICAgICAgICAgdyA9IG51bGwsDQogICAgICAgICAgICAgICAgICAgIHkgPSAwLA0KICAgICAgICAgICAgICAgICAgICB6ID0gMCwNCiAgICAgICAgICAgICAgICAgICAgRSA9IFtdLA0KICAgICAgICAgICAgICAgICAgICBxID0gW10sDQogICAgICAgICAgICAgICAgICAgIEsgPSB7fSwNCiAgICAgICAgICAgICAgICAgICAgQSA9IFtdLA0KICAgICAgICAgICAgICAgICAgICBiYSA9IFtdLA0KICAgICAgICAgICAgICAgICAgICBDID0gW10sDQogICAgICAgICAgICAgICAgICAgIFkgPSAwLA0KICAgICAgICAgICAgICAgICAgICBaID0gMCwNCiAgICAgICAgICAgICAgICAgICAgemEgPSAtMSwNCiAgICAgICAgICAgICAgICAgICAgQWEgPSAtMSwNCiAgICAgICAgICAgICAgICAgICAgSmMgPSAwLA0KICAgICAgICAgICAgICAgICAgICB4ID0gMCwNCiAgICAgICAgICAgICAgICAgICAgYmMgPSAwLA0KICAgICAgICAgICAgICAgICAgICBOID0gbnVsbCwNCiAgICAgICAgICAgICAgICAgICAgTWEgPSAwLA0KICAgICAgICAgICAgICAgICAgICBOYSA9IDAsDQogICAgICAgICAgICAgICAgICAgIE9hID0gMUU0LA0KICAgICAgICAgICAgICAgICAgICBQYSA9IDFFNCwNCiAgICAgICAgICAgICAgICAgICAgbCA9IDEsDQogICAgICAgICAgICAgICAgICAgIEcgPSBudWxsLA0KICAgICAgICAgICAgICAgICAgICBhYiA9ICEwLA0KICAgICAgICAgICAgICAgICAgICBmYSA9ICEwLA0KICAgICAgICAgICAgICAgICAgICB0YSA9ICExLA0KICAgICAgICAgICAgICAgICAgICBzYiA9ICExLA0KICAgICAgICAgICAgICAgICAgICBUID0gMCwNCiAgICAgICAgICAgICAgICAgICAgZWEgPSAhMSwNCiAgICAgICAgICAgICAgICAgICAgYmIgPSAhMSwNCiAgICAgICAgICAgICAgICAgICAgcGEgPSB5ID0gfn4oKE1hICsgT2EpIC8gMiksDQogICAgICAgICAgICAgICAgICAgIHFhID0geiA9IH5+KChOYSArIFBhKSAvIDIpLA0KICAgICAgICAgICAgICAgICAgICByYSA9IDEsDQogICAgICAgICAgICAgICAgICAgIGxhID0gIiIsDQogICAgICAgICAgICAgICAgICAgIEkgPSBudWxsLA0KICAgICAgICAgICAgICAgICAgICBnYiA9ICExLA0KICAgICAgICAgICAgICAgICAgICBwYiA9ICExLA0KICAgICAgICAgICAgICAgICAgICBuYiA9IDAsDQogICAgICAgICAgICAgICAgICAgIG9iID0gMCwNCiAgICAgICAgICAgICAgICAgICAgS2EgPSAwLA0KICAgICAgICAgICAgICAgICAgICBMYSA9IDAsDQogICAgICAgICAgICAgICAgICAgIE1jID0gWyIjMzMzMzMzIiwgIiNGRjMzMzMiLCAiIzMzRkYzMyIsICIjMzMzM0ZGIl0sDQogICAgICAgICAgICAgICAgICAgIHpiID0gITEsDQogICAgICAgICAgICAgICAgICAgIG5hID0gITEsDQogICAgICAgICAgICAgICAgICAgIEZhID0gMCwNCiAgICAgICAgICAgICAgICAgICAgUCA9IDEsDQogICAgICAgICAgICAgICAgICAgIEIgPSAxLA0KICAgICAgICAgICAgICAgICAgICBqYSA9ICExLA0KICAgICAgICAgICAgICAgICAgICBrYiA9IDAsDQogICAgICAgICAgICAgICAgICAgIGNjID0gITAsDQogICAgICAgICAgICAgICAgICAgIHJiID0gbnVsbCwNCiAgICAgICAgICAgICAgICAgICAgcWIgPSAhMSwNCiAgICAgICAgICAgICAgICAgICAgSiA9IG5ldyBJbWFnZTsNCiAgICAgICAgICAgICAgICBKLnNyYyA9ICIvaW1nL2JhY2tncm91bmQucG5nIjsNCiAgICAgICAgICAgICAgICB2YXIgZGMgPSAib250b3VjaHN0YXJ0IiBpbiBjICYmIC9BbmRyb2lkfHdlYk9TfGlQaG9uZXxpUGFkfGlQb2R8QmxhY2tCZXJyeXxJRU1vYmlsZXxPcGVyYSBNaW5pL2kudGVzdChjLm5hdmlnYXRvci51c2VyQWdlbnQpLA0KICAgICAgICAgICAgICAgICAgICBBYiA9IG5ldyBJbWFnZTsNCiAgICAgICAgICAgICAgICBBYi5zcmMgPSAiL2ltZy9zcGxpdC5wbmciOw0KICAgICAgICAgICAgICAgIHZhciB2YSA9ICExLA0KICAgICAgICAgICAgICAgICAgICB3YSA9ICExLA0KICAgICAgICAgICAgICAgICAgICB4YSA9ICExLA0KICAgICAgICAgICAgICAgICAgICBjYiA9ICExLA0KICAgICAgICAgICAgICAgICAgICBGYiwgR2I7DQogICAgICAgICAgICAgICAgImdhbWVwYWQiIGluIEQgJiYgc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgIGNiICYmIChZID0gZGIuaGEoWSwgRmIpLCBaID0gZGIuaGEoWiwgR2IpKQ0KICAgICAgICAgICAgICAgIH0sIDI1KTsNCiAgICAgICAgICAgICAgICBjLmdhbWVwYWRBeGlzVXBkYXRlID0gZnVuY3Rpb24oYSwgYikgew0KICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IC4xID4gYiAqIGI7DQogICAgICAgICAgICAgICAgICAgIDAgPT0gYSAmJiAoZCA/IEZiID0gciAvIDIgOiAoRmIgPSAoYiArIDEpIC8gMiAqIHIsIGNiID0gITApKTsNCiAgICAgICAgICAgICAgICAgICAgMSA9PSBhICYmIChkID8gR2IgPSB0IC8gMiA6IChHYiA9IChiICsgMSkgLyAyICogdCwgY2IgPSAhMCkpDQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICBjLmFnYXJpb0luaXQgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgZ2IgPSAhMDsNCiAgICAgICAgICAgICAgICAgICAgeGMoKTsNCiAgICAgICAgICAgICAgICAgICAgd2MoKTsNCiAgICAgICAgICAgICAgICAgICAgbS5jb3JlLmluaXQoKTsNCiAgICAgICAgICAgICAgICAgICAgbnVsbCAhPSBjLmxvY2FsU3RvcmFnZS5zZXR0aW5ncyAmJiAodiA9IEpTT04ucGFyc2UoYy5sb2NhbFN0b3JhZ2Uuc2V0dGluZ3MpLA0KICAgICAgICAgICAgICAgICAgICAgICAgYmIgPSB2LnNob3dNYXNzLCBlYSA9IHYuYmxhY2tUaGVtZSwgZmEgPSB2Lm5hbWVzRW5hYmxlZCwgdGEgPSB2Lm5vQ29sb3JzLCBaYSA9IHYuc3RhdHNFbmFibGVkLCBhYiA9IHYuc2tpbnNFbmFibGVkKTsNCiAgICAgICAgICAgICAgICAgICAgZSgiI3Nob3dNYXNzIikucHJvcCgiY2hlY2tlZCIsIHYuc2hvd01hc3MpOw0KICAgICAgICAgICAgICAgICAgICBlKCIjbm9Ta2lucyIpLnByb3AoImNoZWNrZWQiLCAhdi5za2luc0VuYWJsZWQpOw0KICAgICAgICAgICAgICAgICAgICBlKCIjc2tpcFN0YXRzIikucHJvcCgiY2hlY2tlZCIsICF2LnN0YXRzRW5hYmxlZCk7DQogICAgICAgICAgICAgICAgICAgIGUoIiNub0NvbG9ycyIpLnByb3AoImNoZWNrZWQiLCB2Lm5vQ29sb3JzKTsNCiAgICAgICAgICAgICAgICAgICAgZSgiI25vTmFtZXMiKS5wcm9wKCJjaGVja2VkIiwgIXYubmFtZXNFbmFibGVkKTsNCiAgICAgICAgICAgICAgICAgICAgZSgiI2RhcmtUaGVtZSIpLnByb3AoImNoZWNrZWQiLCB2LmJsYWNrVGhlbWUpOw0KICAgICAgICAgICAgICAgICAgICBMYigpOw0KICAgICAgICAgICAgICAgICAgICBzZXRJbnRlcnZhbChMYiwgMThFNCk7DQogICAgICAgICAgICAgICAgICAgIE8gPSB5YiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjYW52YXMiKTsNCiAgICAgICAgICAgICAgICAgICAgbnVsbCAhPSBPICYmIChmID0gTy5nZXRDb250ZXh0KCIyZCIpLCBPLm9ubW91c2Vkb3duID0gZnVuY3Rpb24oYSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRjKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSBhLmNsaWVudFggLSAoNSArIHIgLyA1IC8gMiksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQgPSBhLmNsaWVudFkgLSAoNSArIHIgLyA1IC8gMik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKE1hdGguc3FydChiICogYiArIGQgKiBkKSA8PSByIC8gNSAvIDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgWSA9IDEgKiBhLmNsaWVudFg7DQogICAgICAgICAgICAgICAgICAgICAgICBaID0gMSAqIGEuY2xpZW50WTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZiKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBTYSgpDQogICAgICAgICAgICAgICAgICAgIH0sIE8ub25tb3VzZW1vdmUgPSBmdW5jdGlvbihhKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjYiA9ICExOw0KICAgICAgICAgICAgICAgICAgICAgICAgWSA9IDEgKiBhLmNsaWVudFg7DQogICAgICAgICAgICAgICAgICAgICAgICBaID0gMSAqIGEuY2xpZW50WTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZiKCkNCiAgICAgICAgICAgICAgICAgICAgfSwgTy5vbm1vdXNldXAgPSBmdW5jdGlvbigpIHt9LCAvZmlyZWZveC9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkgPyBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJET01Nb3VzZVNjcm9sbCIsIEtiLCAhMSkgOiBkb2N1bWVudC5ib2R5Lm9ubW91c2V3aGVlbCA9IEtiLCBjLm9uYmx1ciA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgWCgxOSk7DQogICAgICAgICAgICAgICAgICAgICAgICB4YSA9IHdhID0gdmEgPSAhMQ0KICAgICAgICAgICAgICAgICAgICB9LCBjLm9ucmVzaXplID0gWGIsIGMucmVxdWVzdEFuaW1hdGlvbkZyYW1lKHFjKSwgc2V0SW50ZXJ2YWwoU2EsIDQwKSwgRyAmJiBlKCIjcmVnaW9uIikudmFsKEcpLCBOYigpLCBEYShlKCIjcmVnaW9uIikudmFsKCkpLCAwID09IGtiICYmIEcgJiYgUSgpLCB5YSgwKSwgWGIoKSwgYy5sb2NhdGlvbi5oYXNoICYmIDYgPD0gYy5sb2NhdGlvbi5oYXNoLmxlbmd0aCAmJiBqYyhjLmxvY2F0aW9uLmhhc2gpKQ0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgdmFyIEJhID0gbnVsbDsNCiAgICAgICAgICAgICAgICBjLnNldE5pY2sgPSBmdW5jdGlvbihhKSB7DQogICAgICAgICAgICAgICAgICAgIGMuZ2EgJiYgYy5nYSgic2VuZCIsICJldmVudCIsICJOaWNrIiwgYS50b0xvd2VyQ2FzZSgpKTsNCiAgICAgICAgICAgICAgICAgICAgTWIoKTsNCiAgICAgICAgICAgICAgICAgICAgTiA9IGE7DQogICAgICAgICAgICAgICAgICAgIFNiKCk7DQogICAgICAgICAgICAgICAgICAgIFQgPSAwOw0KICAgICAgICAgICAgICAgICAgICB2LnNraW5zRW5hYmxlZCA9IGFiOw0KICAgICAgICAgICAgICAgICAgICB2Lm5hbWVzRW5hYmxlZCA9IGZhOw0KICAgICAgICAgICAgICAgICAgICB2Lm5vQ29sb3JzID0gdGE7DQogICAgICAgICAgICAgICAgICAgIHYuYmxhY2tUaGVtZSA9IGVhOw0KICAgICAgICAgICAgICAgICAgICB2LnNob3dNYXNzID0gYmI7DQogICAgICAgICAgICAgICAgICAgIHYuc3RhdHNFbmFibGVkID0gWmE7DQogICAgICAgICAgICAgICAgICAgIGMubG9jYWxTdG9yYWdlLnNldHRpbmdzID0gSlNPTi5zdHJpbmdpZnkodik7DQogICAgICAgICAgICAgICAgICAgIEliKCkNCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgIGMuc2V0U2tpbnMgPSBmdW5jdGlvbihhKSB7DQogICAgICAgICAgICAgICAgICAgIGFiID0gYQ0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgYy5zZXROYW1lcyA9IGZ1bmN0aW9uKGEpIHsNCiAgICAgICAgICAgICAgICAgICAgZmEgPSBhDQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICBjLnNldERhcmtUaGVtZSA9IGZ1bmN0aW9uKGEpIHsNCiAgICAgICAgICAgICAgICAgICAgZWEgPSBhDQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICBjLnNldENvbG9ycyA9IGZ1bmN0aW9uKGEpIHsNCiAgICAgICAgICAgICAgICAgICAgdGEgPSBhDQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICBjLnNldFNob3dNYXNzID0gZnVuY3Rpb24oYSkgew0KICAgICAgICAgICAgICAgICAgICBiYiA9IGENCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgIGMuc3BlY3RhdGUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgTiA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIEliKCk7DQogICAgICAgICAgICAgICAgICAgIFgoMSk7DQogICAgICAgICAgICAgICAgICAgIE1iKCkNCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgIGMuc2V0UmVnaW9uID0gRGE7DQogICAgICAgICAgICAgICAgdmFyIGhiID0gITA7DQogICAgICAgICAgICAgICAgYy5zZXRHYW1lTW9kZSA9IGZ1bmN0aW9uKGEpIHsNCiAgICAgICAgICAgICAgICAgICAgYSAhPSBsYSAmJiAoIjpwYXJ0eSIgPT0gbGEgJiYgZSgiI2hlbGxvQ29udGFpbmVyIikuYXR0cigiZGF0YS1wYXJ0eS1zdGF0ZSIsICIwIiksIGthKGEpLCAiOnBhcnR5IiAhPSBhICYmIFEoKSkNCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgIGMuc2V0QWNpZCA9IGZ1bmN0aW9uKGEpIHsNCiAgICAgICAgICAgICAgICAgICAgemIgPSBhDQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICB2YXIgWGMgPSBmdW5jdGlvbihhKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBiID0ge30sDQogICAgICAgICAgICAgICAgICAgICAgICBkID0gITEsDQogICAgICAgICAgICAgICAgICAgICAgICB1ID0gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNraXBEcmF3OiAhMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmVkaWN0aW9uTW9kaWZpZXI6IDEuMQ0KICAgICAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgYS5pbml0ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBtLmFjY291bnQuaW5pdCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgbS5nb29nbGUudmEoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIG0uZmEuaW5pdCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgKGQgPSAiZGVidWciIGluIGMucXVlcnlTdHJpbmcpICYmIG0uZGVidWcuc2hvd0RlYnVnKCkNCiAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgYS5iaW5kID0gZnVuY3Rpb24oYSwgZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZShiKS5iaW5kKGEsIGQpDQogICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgIGEudW5iaW5kID0gZnVuY3Rpb24oYSwgZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZShiKS51bmJpbmQoYSwgZCkNCiAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgYS50cmlnZ2VyID0gZnVuY3Rpb24oYSwgZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZShiKS50cmlnZ2VyKGEsIGQpDQogICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgIGEuX19kZWZpbmVHZXR0ZXJfXygiZGVidWciLCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkDQogICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICBhLl9fZGVmaW5lU2V0dGVyX18oImRlYnVnIiwgZnVuY3Rpb24oYSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQgPSBhDQogICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICBhLl9fZGVmaW5lR2V0dGVyX18oInByb3h5IiwgZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYy5NQw0KICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgYS5fX2RlZmluZUdldHRlcl9fKCJjb25maWciLCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB1DQogICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gYQ0KICAgICAgICAgICAgICAgIH0oe30pOw0KICAgICAgICAgICAgICAgIG0uY29yZSA9IFhjOw0KICAgICAgICAgICAgICAgIG0uY2FjaGUgPSB7fTsNCiAgICAgICAgICAgICAgICB2YXIgWWMgPSBmdW5jdGlvbihhKSB7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGIoYSwgYiwgZCwgYykgew0KICAgICAgICAgICAgICAgICAgICAgICAgYSA9IGEgKyAiQ2FudmFzIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnID0gZSgiPGNhbnZhcz4iLCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGENCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgcC5hcHBlbmQoZyk7DQogICAgICAgICAgICAgICAgICAgICAgICBkID0gbmV3IFNtb290aGllQ2hhcnQoZCk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGcgPSAwOyBnIDwgYi5sZW5ndGg7IGcrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1ID0gYltnXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZiA9IF8uZXh0ZW5kKGgsIGNbZ10pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQuYWRkVGltZVNlcmllcyh1LCBmKQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZC5zdHJlYW1Ubyhkb2N1bWVudC5nZXRFbGVtZW50QnlJZChhKSwgMCkNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGQoYSwgZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAga1thXSA9IGMoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGIoYSwgW2tbYV1dLCBkLCBbew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cm9rZVN0eWxlOiAicmdiYSgwLCAyNTUsIDAsIDEpIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxsU3R5bGU6ICJyZ2JhKDAsIDI1NSwgMCwgMC4yKSIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluZVdpZHRoOiAyDQogICAgICAgICAgICAgICAgICAgICAgICB9XSkNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGMoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFRpbWVTZXJpZXMoew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEthOiAhMQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB2YXIgZyA9ICExLA0KICAgICAgICAgICAgICAgICAgICAgICAgcCwgZiA9ICExLA0KICAgICAgICAgICAgICAgICAgICAgICAgayA9IHt9LA0KICAgICAgICAgICAgICAgICAgICAgICAgaCA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJva2VTdHlsZTogInJnYmEoMCwgMjU1LCAwLCAxKSIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsbFN0eWxlOiAicmdiYSgwLCAyNTUsIDAsIDAuMikiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVXaWR0aDogMg0KICAgICAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgYS5zaG93RGVidWcgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGcgfHwgKHAgPSBlKCIjZGVidWctb3ZlcmxheSIpLCBkKCJuZXR3b3JrVXBkYXRlIiwgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICJuZXR3b3JrIHVwZGF0ZXMiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pblZhbHVlOiAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heFZhbHVlOiAxMjANCiAgICAgICAgICAgICAgICAgICAgICAgIH0pLCBkKCJmcHMiLCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogImZwcyIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWluVmFsdWU6IDAsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4VmFsdWU6IDEyMA0KICAgICAgICAgICAgICAgICAgICAgICAgfSksIGsucnR0U0RldiA9IGMoKSwgay5ydHRNZWFuID0gYygpLCBiKCJydHRNZWFuIiwgW2sucnR0U0Rldiwgay5ydHRNZWFuXSwgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICJydHQiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pblZhbHVlOiAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heFZhbHVlOiAxMjANCiAgICAgICAgICAgICAgICAgICAgICAgIH0sIFt7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Ryb2tlU3R5bGU6ICJyZ2JhKDI1NSwgMCwgMCwgMSkiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGxTdHlsZTogInJnYmEoMCwgMjU1LCAwLCAwLjIpIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lV2lkdGg6IDINCiAgICAgICAgICAgICAgICAgICAgICAgIH0sIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJva2VTdHlsZTogInJnYmEoMCwgMjU1LCAwLCAxKSIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsbFN0eWxlOiAicmdiYSgwLCAyNTUsIDAsIDApIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lV2lkdGg6IDINCiAgICAgICAgICAgICAgICAgICAgICAgIH1dKSwgZyA9ICEwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIG0uY29yZS5kZWJ1ZyA9ICEwOw0KICAgICAgICAgICAgICAgICAgICAgICAgcC5zaG93KCkNCiAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgYS5oaWRlRGVidWcgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHAuaGlkZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgbS5jb3JlLmRlYnVnID0gITENCiAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgYS51cGRhdGVDaGFydCA9IGZ1bmN0aW9uKGEsIGIsIGQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGcgJiYgYSBpbiBrICYmIGtbYV0uYXBwZW5kKGIsIGQpDQogICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgIGEuX19kZWZpbmVHZXR0ZXJfXygic2hvd1ByZWRpY3Rpb24iLCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmDQogICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICBhLl9fZGVmaW5lU2V0dGVyX18oInNob3dQcmVkaWN0aW9uIiwgZnVuY3Rpb24oYSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGYgPSBhDQogICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gYQ0KICAgICAgICAgICAgICAgIH0oe30pOw0KICAgICAgICAgICAgICAgIG0uZGVidWcgPSBZYzsNCiAgICAgICAgICAgICAgICB2YXIgbWEgPSB7DQogICAgICAgICAgICAgICAgICAgICAgICBBRjogIkpQLVRva3lvIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIEFYOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIEFMOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIERaOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIEFTOiAiU0ctU2luZ2Fwb3JlIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIEFEOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIEFPOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIEFJOiAiVVMtQXRsYW50YSIsDQogICAgICAgICAgICAgICAgICAgICAgICBBRzogIlVTLUF0bGFudGEiLA0KICAgICAgICAgICAgICAgICAgICAgICAgQVI6ICJCUi1CcmF6aWwiLA0KICAgICAgICAgICAgICAgICAgICAgICAgQU06ICJKUC1Ub2t5byIsDQogICAgICAgICAgICAgICAgICAgICAgICBBVzogIlVTLUF0bGFudGEiLA0KICAgICAgICAgICAgICAgICAgICAgICAgQVU6ICJTRy1TaW5nYXBvcmUiLA0KICAgICAgICAgICAgICAgICAgICAgICAgQVQ6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgQVo6ICJKUC1Ub2t5byIsDQogICAgICAgICAgICAgICAgICAgICAgICBCUzogIlVTLUF0bGFudGEiLA0KICAgICAgICAgICAgICAgICAgICAgICAgQkg6ICJKUC1Ub2t5byIsDQogICAgICAgICAgICAgICAgICAgICAgICBCRDogIkpQLVRva3lvIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIEJCOiAiVVMtQXRsYW50YSIsDQogICAgICAgICAgICAgICAgICAgICAgICBCWTogIkVVLUxvbmRvbiIsDQogICAgICAgICAgICAgICAgICAgICAgICBCRTogIkVVLUxvbmRvbiIsDQogICAgICAgICAgICAgICAgICAgICAgICBCWjogIlVTLUF0bGFudGEiLA0KICAgICAgICAgICAgICAgICAgICAgICAgQko6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgQk06ICJVUy1BdGxhbnRhIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIEJUOiAiSlAtVG9reW8iLA0KICAgICAgICAgICAgICAgICAgICAgICAgQk86ICJCUi1CcmF6aWwiLA0KICAgICAgICAgICAgICAgICAgICAgICAgQlE6ICJVUy1BdGxhbnRhIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIEJBOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIEJXOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIEJSOiAiQlItQnJhemlsIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIElPOiAiSlAtVG9reW8iLA0KICAgICAgICAgICAgICAgICAgICAgICAgVkc6ICJVUy1BdGxhbnRhIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIEJOOiAiSlAtVG9reW8iLA0KICAgICAgICAgICAgICAgICAgICAgICAgQkc6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgQkY6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgQkk6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgS0g6ICJKUC1Ub2t5byIsDQogICAgICAgICAgICAgICAgICAgICAgICBDTTogIkVVLUxvbmRvbiIsDQogICAgICAgICAgICAgICAgICAgICAgICBDQTogIlVTLUF0bGFudGEiLA0KICAgICAgICAgICAgICAgICAgICAgICAgQ1Y6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgS1k6ICJVUy1BdGxhbnRhIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIENGOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIFREOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIENMOiAiQlItQnJhemlsIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIENOOiAiQ04tQ2hpbmEiLA0KICAgICAgICAgICAgICAgICAgICAgICAgQ1g6ICJKUC1Ub2t5byIsDQogICAgICAgICAgICAgICAgICAgICAgICBDQzogIkpQLVRva3lvIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIENPOiAiQlItQnJhemlsIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIEtNOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIENEOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIENHOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIENLOiAiU0ctU2luZ2Fwb3JlIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIENSOiAiVVMtQXRsYW50YSIsDQogICAgICAgICAgICAgICAgICAgICAgICBDSTogIkVVLUxvbmRvbiIsDQogICAgICAgICAgICAgICAgICAgICAgICBIUjogIkVVLUxvbmRvbiIsDQogICAgICAgICAgICAgICAgICAgICAgICBDVTogIlVTLUF0bGFudGEiLA0KICAgICAgICAgICAgICAgICAgICAgICAgQ1c6ICJVUy1BdGxhbnRhIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIENZOiAiSlAtVG9reW8iLA0KICAgICAgICAgICAgICAgICAgICAgICAgQ1o6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgREs6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgREo6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgRE06ICJVUy1BdGxhbnRhIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIERPOiAiVVMtQXRsYW50YSIsDQogICAgICAgICAgICAgICAgICAgICAgICBFQzogIkJSLUJyYXppbCIsDQogICAgICAgICAgICAgICAgICAgICAgICBFRzogIkVVLUxvbmRvbiIsDQogICAgICAgICAgICAgICAgICAgICAgICBTVjogIlVTLUF0bGFudGEiLA0KICAgICAgICAgICAgICAgICAgICAgICAgR1E6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgRVI6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgRUU6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgRVQ6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgRk86ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgRks6ICJCUi1CcmF6aWwiLA0KICAgICAgICAgICAgICAgICAgICAgICAgRko6ICJTRy1TaW5nYXBvcmUiLA0KICAgICAgICAgICAgICAgICAgICAgICAgRkk6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgRlI6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgR0Y6ICJCUi1CcmF6aWwiLA0KICAgICAgICAgICAgICAgICAgICAgICAgUEY6ICJTRy1TaW5nYXBvcmUiLA0KICAgICAgICAgICAgICAgICAgICAgICAgR0E6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgR006ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgR0U6ICJKUC1Ub2t5byIsDQogICAgICAgICAgICAgICAgICAgICAgICBERTogIkVVLUxvbmRvbiIsDQogICAgICAgICAgICAgICAgICAgICAgICBHSDogIkVVLUxvbmRvbiIsDQogICAgICAgICAgICAgICAgICAgICAgICBHSTogIkVVLUxvbmRvbiIsDQogICAgICAgICAgICAgICAgICAgICAgICBHUjogIkVVLUxvbmRvbiIsDQogICAgICAgICAgICAgICAgICAgICAgICBHTDogIlVTLUF0bGFudGEiLA0KICAgICAgICAgICAgICAgICAgICAgICAgR0Q6ICJVUy1BdGxhbnRhIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIEdQOiAiVVMtQXRsYW50YSIsDQogICAgICAgICAgICAgICAgICAgICAgICBHVTogIlNHLVNpbmdhcG9yZSIsDQogICAgICAgICAgICAgICAgICAgICAgICBHVDogIlVTLUF0bGFudGEiLA0KICAgICAgICAgICAgICAgICAgICAgICAgR0c6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgR046ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgR1c6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgR1k6ICJCUi1CcmF6aWwiLA0KICAgICAgICAgICAgICAgICAgICAgICAgSFQ6ICJVUy1BdGxhbnRhIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIFZBOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIEhOOiAiVVMtQXRsYW50YSIsDQogICAgICAgICAgICAgICAgICAgICAgICBISzogIkpQLVRva3lvIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIEhVOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIElTOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIElOOiAiSlAtVG9reW8iLA0KICAgICAgICAgICAgICAgICAgICAgICAgSUQ6ICJKUC1Ub2t5byIsDQogICAgICAgICAgICAgICAgICAgICAgICBJUjogIkpQLVRva3lvIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIElROiAiSlAtVG9reW8iLA0KICAgICAgICAgICAgICAgICAgICAgICAgSUU6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgSU06ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgSUw6ICJKUC1Ub2t5byIsDQogICAgICAgICAgICAgICAgICAgICAgICBJVDogIkVVLUxvbmRvbiIsDQogICAgICAgICAgICAgICAgICAgICAgICBKTTogIlVTLUF0bGFudGEiLA0KICAgICAgICAgICAgICAgICAgICAgICAgSlA6ICJKUC1Ub2t5byIsDQogICAgICAgICAgICAgICAgICAgICAgICBKRTogIkVVLUxvbmRvbiIsDQogICAgICAgICAgICAgICAgICAgICAgICBKTzogIkpQLVRva3lvIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIEtaOiAiSlAtVG9reW8iLA0KICAgICAgICAgICAgICAgICAgICAgICAgS0U6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgS0k6ICJTRy1TaW5nYXBvcmUiLA0KICAgICAgICAgICAgICAgICAgICAgICAgS1A6ICJKUC1Ub2t5byIsDQogICAgICAgICAgICAgICAgICAgICAgICBLUjogIkpQLVRva3lvIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIEtXOiAiSlAtVG9reW8iLA0KICAgICAgICAgICAgICAgICAgICAgICAgS0c6ICJKUC1Ub2t5byIsDQogICAgICAgICAgICAgICAgICAgICAgICBMQTogIkpQLVRva3lvIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIExWOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIExCOiAiSlAtVG9reW8iLA0KICAgICAgICAgICAgICAgICAgICAgICAgTFM6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgTFI6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgTFk6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgTEk6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgTFQ6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgTFU6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgTU86ICJKUC1Ub2t5byIsDQogICAgICAgICAgICAgICAgICAgICAgICBNSzogIkVVLUxvbmRvbiIsDQogICAgICAgICAgICAgICAgICAgICAgICBNRzogIkVVLUxvbmRvbiIsDQogICAgICAgICAgICAgICAgICAgICAgICBNVzogIkVVLUxvbmRvbiIsDQogICAgICAgICAgICAgICAgICAgICAgICBNWTogIkpQLVRva3lvIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIE1WOiAiSlAtVG9reW8iLA0KICAgICAgICAgICAgICAgICAgICAgICAgTUw6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgTVQ6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgTUg6ICJTRy1TaW5nYXBvcmUiLA0KICAgICAgICAgICAgICAgICAgICAgICAgTVE6ICJVUy1BdGxhbnRhIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIE1SOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIE1VOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIFlUOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIE1YOiAiVVMtQXRsYW50YSIsDQogICAgICAgICAgICAgICAgICAgICAgICBGTTogIlNHLVNpbmdhcG9yZSIsDQogICAgICAgICAgICAgICAgICAgICAgICBNRDogIkVVLUxvbmRvbiIsDQogICAgICAgICAgICAgICAgICAgICAgICBNQzogIkVVLUxvbmRvbiIsDQogICAgICAgICAgICAgICAgICAgICAgICBNTjogIkpQLVRva3lvIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIE1FOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIE1TOiAiVVMtQXRsYW50YSIsDQogICAgICAgICAgICAgICAgICAgICAgICBNQTogIkVVLUxvbmRvbiIsDQogICAgICAgICAgICAgICAgICAgICAgICBNWjogIkVVLUxvbmRvbiIsDQogICAgICAgICAgICAgICAgICAgICAgICBNTTogIkpQLVRva3lvIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIE5BOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIE5SOiAiU0ctU2luZ2Fwb3JlIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIE5QOiAiSlAtVG9reW8iLA0KICAgICAgICAgICAgICAgICAgICAgICAgTkw6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgTkM6ICJTRy1TaW5nYXBvcmUiLA0KICAgICAgICAgICAgICAgICAgICAgICAgTlo6ICJTRy1TaW5nYXBvcmUiLA0KICAgICAgICAgICAgICAgICAgICAgICAgTkk6ICJVUy1BdGxhbnRhIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIE5FOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIE5HOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIE5VOiAiU0ctU2luZ2Fwb3JlIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIE5GOiAiU0ctU2luZ2Fwb3JlIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIE1QOiAiU0ctU2luZ2Fwb3JlIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIE5POiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIE9NOiAiSlAtVG9reW8iLA0KICAgICAgICAgICAgICAgICAgICAgICAgUEs6ICJKUC1Ub2t5byIsDQogICAgICAgICAgICAgICAgICAgICAgICBQVzogIlNHLVNpbmdhcG9yZSIsDQogICAgICAgICAgICAgICAgICAgICAgICBQUzogIkpQLVRva3lvIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIFBBOiAiVVMtQXRsYW50YSIsDQogICAgICAgICAgICAgICAgICAgICAgICBQRzogIlNHLVNpbmdhcG9yZSIsDQogICAgICAgICAgICAgICAgICAgICAgICBQWTogIkJSLUJyYXppbCIsDQogICAgICAgICAgICAgICAgICAgICAgICBQRTogIkJSLUJyYXppbCIsDQogICAgICAgICAgICAgICAgICAgICAgICBQSDogIkpQLVRva3lvIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIFBOOiAiU0ctU2luZ2Fwb3JlIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIFBMOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIFBUOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIFBSOiAiVVMtQXRsYW50YSIsDQogICAgICAgICAgICAgICAgICAgICAgICBRQTogIkpQLVRva3lvIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIFJFOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIFJPOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIFJVOiAiUlUtUnVzc2lhIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIFJXOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIEJMOiAiVVMtQXRsYW50YSIsDQogICAgICAgICAgICAgICAgICAgICAgICBTSDogIkVVLUxvbmRvbiIsDQogICAgICAgICAgICAgICAgICAgICAgICBLTjogIlVTLUF0bGFudGEiLA0KICAgICAgICAgICAgICAgICAgICAgICAgTEM6ICJVUy1BdGxhbnRhIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIE1GOiAiVVMtQXRsYW50YSIsDQogICAgICAgICAgICAgICAgICAgICAgICBQTTogIlVTLUF0bGFudGEiLA0KICAgICAgICAgICAgICAgICAgICAgICAgVkM6ICJVUy1BdGxhbnRhIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIFdTOiAiU0ctU2luZ2Fwb3JlIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIFNNOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIFNUOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIFNBOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIFNOOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIFJTOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIFNDOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIFNMOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIFNHOiAiSlAtVG9reW8iLA0KICAgICAgICAgICAgICAgICAgICAgICAgU1g6ICJVUy1BdGxhbnRhIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIFNLOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIFNJOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIFNCOiAiU0ctU2luZ2Fwb3JlIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIFNPOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIFpBOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIFNTOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIEVTOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIExLOiAiSlAtVG9reW8iLA0KICAgICAgICAgICAgICAgICAgICAgICAgU0Q6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgU1I6ICJCUi1CcmF6aWwiLA0KICAgICAgICAgICAgICAgICAgICAgICAgU0o6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgU1o6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgU0U6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgQ0g6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgU1k6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgVFc6ICJKUC1Ub2t5byIsDQogICAgICAgICAgICAgICAgICAgICAgICBUSjogIkpQLVRva3lvIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIFRaOiAiRVUtTG9uZG9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIFRIOiAiSlAtVG9reW8iLA0KICAgICAgICAgICAgICAgICAgICAgICAgVEw6ICJKUC1Ub2t5byIsDQogICAgICAgICAgICAgICAgICAgICAgICBURzogIkVVLUxvbmRvbiIsDQogICAgICAgICAgICAgICAgICAgICAgICBUSzogIlNHLVNpbmdhcG9yZSIsDQogICAgICAgICAgICAgICAgICAgICAgICBUTzogIlNHLVNpbmdhcG9yZSIsDQogICAgICAgICAgICAgICAgICAgICAgICBUVDogIlVTLUF0bGFudGEiLA0KICAgICAgICAgICAgICAgICAgICAgICAgVE46ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgVFI6ICJUSy1UdXJrZXkiLA0KICAgICAgICAgICAgICAgICAgICAgICAgVE06ICJKUC1Ub2t5byIsDQogICAgICAgICAgICAgICAgICAgICAgICBUQzogIlVTLUF0bGFudGEiLA0KICAgICAgICAgICAgICAgICAgICAgICAgVFY6ICJTRy1TaW5nYXBvcmUiLA0KICAgICAgICAgICAgICAgICAgICAgICAgVUc6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgVUE6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgQUU6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgR0I6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgVVM6ICJVUy1BdGxhbnRhIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIFVNOiAiU0ctU2luZ2Fwb3JlIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIFZJOiAiVVMtQXRsYW50YSIsDQogICAgICAgICAgICAgICAgICAgICAgICBVWTogIkJSLUJyYXppbCIsDQogICAgICAgICAgICAgICAgICAgICAgICBVWjogIkpQLVRva3lvIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIFZVOiAiU0ctU2luZ2Fwb3JlIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIFZFOiAiQlItQnJhemlsIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIFZOOiAiSlAtVG9reW8iLA0KICAgICAgICAgICAgICAgICAgICAgICAgV0Y6ICJTRy1TaW5nYXBvcmUiLA0KICAgICAgICAgICAgICAgICAgICAgICAgRUg6ICJFVS1Mb25kb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgWUU6ICJKUC1Ub2t5byIsDQogICAgICAgICAgICAgICAgICAgICAgICBaTTogIkVVLUxvbmRvbiIsDQogICAgICAgICAgICAgICAgICAgICAgICBaVzogIkVVLUxvbmRvbiINCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgb2EgPSAwLA0KICAgICAgICAgICAgICAgICAgICBHYSA9IDAsDQogICAgICAgICAgICAgICAgICAgIFMgPSBudWxsLA0KICAgICAgICAgICAgICAgICAgICBVYjsNCiAgICAgICAgICAgICAgICBjLmNvbm5lY3QgPSBsYjsNCiAgICAgICAgICAgICAgICB2YXIgSWEgPSA1MDAsDQogICAgICAgICAgICAgICAgICAgIENjID0gLjg3NSwNCiAgICAgICAgICAgICAgICAgICAgRWMgPSAuNzUsDQogICAgICAgICAgICAgICAgICAgIEZjID0gLjI1LA0KICAgICAgICAgICAgICAgICAgICBEYyA9IC4xMjUsDQogICAgICAgICAgICAgICAgICAgIFZiID0gLTEsDQogICAgICAgICAgICAgICAgICAgIFdiID0gLTE7DQogICAgICAgICAgICAgICAgYy5zZW5kTWl0b3NpcyA9IGViOw0KICAgICAgICAgICAgICAgIGMuc2VuZEVqZWN0ID0gSmI7DQogICAgICAgICAgICAgICAgbS5uZXR3b3JraW5nID0gZnVuY3Rpb24oYSkgew0KICAgICAgICAgICAgICAgICAgICBhLmxvZ2luUmVhbG0gPSB7DQogICAgICAgICAgICAgICAgICAgICAgICBHRzogImdvb2dsZSIsDQogICAgICAgICAgICAgICAgICAgICAgICBGQjogImZhY2Vib29rIg0KICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICBhLnNlbmRNZXNzYWdlID0gZnVuY3Rpb24oYSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IGEuYnl0ZVZpZXc7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgIT0gZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhID0gVSgxICsgYS5sZW5ndGgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLnNldFVpbnQ4KDAsIDEwMik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGMgPSAwOyBjIDwgZC5sZW5ndGg7ICsrYykgYS5zZXRVaW50OCgxICsgYywgZFtjXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0eHQgPSAnJzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYyA9IDA7IGMgPCBkLmxlbmd0aDsgKytjKSB0eHQgKz0gJ1snK2MrJy0nK2RbY10rJ10nK1N0cmluZy5mcm9tQ2hhckNvZGUoZFtjXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ1BBQ0tFVCAxMDInLGQubGVuZ3RoLGQubGVuZ3RoLTMwLGQsdHh0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9zZW5kVG9rZW4oZCk7Ly9BR0FSQk9UT1ZIDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFYoYSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBhDQogICAgICAgICAgICAgICAgfSh7fSk7DQogICAgICAgICAgICAgICAgdmFyIEggPSBudWxsLA0KICAgICAgICAgICAgICAgICAgICBNID0gMSwNCiAgICAgICAgICAgICAgICAgICAgVWEgPSBudWxsLA0KICAgICAgICAgICAgICAgICAgICByYyA9IDAsDQogICAgICAgICAgICAgICAgICAgIHFjID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYSA9IERhdGUubm93KCksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYiA9IDFFMyAvIDYwOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMucmVxdWVzdEFuaW1hdGlvbkZyYW1lKHFjKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IERhdGUubm93KCksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUgPSBkIC0gYTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZSA+IGIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYSA9IGQgLSBlICUgYjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGcgPSBEYXRlLm5vdygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAhZGEoKSB8fCAyNDAgPiBnIC0gRmEgfHwgIW0uY29yZS5jb25maWcuc2tpcERyYXcgPyBZYigpIDogY29uc29sZS53YXJuKCJTa2lwcGluZyBkcmF3Iik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFpjKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJjID0gMUUzIC8gZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbS5kZWJ1Zy51cGRhdGVDaGFydCgiZnBzIiwgZCwgcmMpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9KCksDQogICAgICAgICAgICAgICAgICAgIGhhID0ge30sDQogICAgICAgICAgICAgICAgICAgIE9iID0gInBvbGFuZDt1c2E7Y2hpbmE7cnVzc2lhO2NhbmFkYTthdXN0cmFsaWE7c3BhaW47YnJhemlsO2dlcm1hbnk7dWtyYWluZTtmcmFuY2U7c3dlZGVuO2NoYXBsaW47bm9ydGgga29yZWE7c291dGgga29yZWE7amFwYW47dW5pdGVkIGtpbmdkb207ZWFydGg7Z3JlZWNlO2xhdHZpYTtsaXRodWFuaWE7ZXN0b25pYTtmaW5sYW5kO25vcndheTtjaWE7bWFsZGl2YXM7YXVzdHJpYTtuaWdlcmlhO3JlZGRpdDt5YXJhbmFpa2E7Y29uZmVkZXJhdGU7OWdhZztpbmRpYW5hOzRjaGFuO2l0YWx5O2J1bGdhcmlhO3R1bWJscjsyY2guaGs7aG9uZyBrb25nO3BvcnR1Z2FsO2phbWFpY2E7Z2VybWFuIGVtcGlyZTttZXhpY287c2FuaWs7c3dpdHplcmxhbmQ7Y3JvYXRpYTtjaGlsZTtpbmRvbmVzaWE7YmFuZ2xhZGVzaDt0aGFpbGFuZDtpcmFuO2lyYXE7cGVydTttb29uO2JvdHN3YW5hO2Jvc25pYTtuZXRoZXJsYW5kcztldXJvcGVhbiB1bmlvbjt0YWl3YW47cGFraXN0YW47aHVuZ2FyeTtzYXRhbmlzdDtxaW5nIGR5bmFzdHk7bWF0cmlhcmNoeTtwYXRyaWFyY2h5O2ZlbWluaXNtO2lyZWxhbmQ7dGV4YXM7ZmFjZXB1bmNoO3Byb2RvdGE7Y2FtYm9kaWE7c3RlYW07cGljY29sbztlYTtpbmRpYTtrYztkZW5tYXJrO3F1ZWJlYztheXkgbG1hbztzZWFsYW5kO2JhaXQ7dHNhcmlzdCBydXNzaWE7b3JpZ2luO3ZpbmVzYXVjZTtzdGFsaW47YmVsZ2l1bTtsdXhlbWJvdXJnO3N0dXNzeTtwcnVzc2lhOzhjaDthcmdlbnRpbmE7c2NvdGxhbmQ7c2lyO3JvbWFuaWE7d29qYWs7ZG9nZTtuYXNhO2J5emFudGl1bTtpbXBlcmlhbCBqYXBhbjtmcmVuY2gga2luZ2RvbTtzb21hbGlhO3R1cmtleTttYXJzO3Bva2VyZmFjZTs4O2lycztyZWNlaXRhIGZlZGVyYWw7ZmFjZWJvb2s7cHV0aW47bWVya2VsO3RzaXByYXM7b2JhbWE7a2ltIGpvbmctdW47ZGlsbWE7aG9sbGFuZGU7YmVybHVzY29uaTtjYW1lcm9uO2NsaW50b247aGlsbGFyeTt2ZW5lenVlbGE7YmxhdHRlcjtjaGF2ZXo7Y3ViYTtmaWRlbDttZXJrZWw7cGFsaW47cXVlZW47Ym9yaXM7YnVzaDt0cnVtcCIuc3BsaXQoIjsiKSwNCiAgICAgICAgICAgICAgICAgICAgJGMgPSAiODtuYXNhO3B1dGluO21lcmtlbDt0c2lwcmFzO29iYW1hO2tpbSBqb25nLXVuO2RpbG1hO2hvbGxhbmRlO2Jlcmx1c2Nvbmk7Y2FtZXJvbjtjbGludG9uO2hpbGxhcnk7YmxhdHRlcjtjaGF2ZXo7ZmlkZWw7bWVya2VsO3BhbGluO3F1ZWVuO2JvcmlzO2J1c2g7dHJ1bXAiLnNwbGl0KCI7IiksDQogICAgICAgICAgICAgICAgICAgIHNhID0ge307DQogICAgICAgICAgICAgICAgQmIucHJvdG90eXBlID0gew0KICAgICAgICAgICAgICAgICAgICAkOiBudWxsLA0KICAgICAgICAgICAgICAgICAgICB4OiAwLA0KICAgICAgICAgICAgICAgICAgICB5OiAwLA0KICAgICAgICAgICAgICAgICAgICBmOiAwLA0KICAgICAgICAgICAgICAgICAgICBiOiAwDQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICB2YXIgVGEgPSAtMSwNCiAgICAgICAgICAgICAgICAgICAgJGIgPSAhMTsNCiAgICAgICAgICAgICAgICBjYS5wcm90b3R5cGUgPSB7DQogICAgICAgICAgICAgICAgICAgIGlkOiAwLA0KICAgICAgICAgICAgICAgICAgICBhOiBudWxsLA0KICAgICAgICAgICAgICAgICAgICBuYW1lOiBudWxsLA0KICAgICAgICAgICAgICAgICAgICBpOiBudWxsLA0KICAgICAgICAgICAgICAgICAgICBTOiBudWxsLA0KICAgICAgICAgICAgICAgICAgICB4OiAwLA0KICAgICAgICAgICAgICAgICAgICB5OiAwLA0KICAgICAgICAgICAgICAgICAgICBzaXplOiAwLA0KICAgICAgICAgICAgICAgICAgICBzOiAwLA0KICAgICAgICAgICAgICAgICAgICB1OiAwLA0KICAgICAgICAgICAgICAgICAgICBvOiAwLA0KICAgICAgICAgICAgICAgICAgICBqYTogMCwNCiAgICAgICAgICAgICAgICAgICAga2E6IDAsDQogICAgICAgICAgICAgICAgICAgIGc6IDAsDQogICAgICAgICAgICAgICAgICAgIE06IDAsDQogICAgICAgICAgICAgICAgICAgIE46IDAsDQogICAgICAgICAgICAgICAgICAgIEo6IDAsDQogICAgICAgICAgICAgICAgICAgIEs6IDAsDQogICAgICAgICAgICAgICAgICAgIGVhOiAwLA0KICAgICAgICAgICAgICAgICAgICBVOiAwLA0KICAgICAgICAgICAgICAgICAgICByYTogMCwNCiAgICAgICAgICAgICAgICAgICAgRzogITEsDQogICAgICAgICAgICAgICAgICAgIGM6ICExLA0KICAgICAgICAgICAgICAgICAgICBoOiAhMSwNCiAgICAgICAgICAgICAgICAgICAgVjogITAsDQogICAgICAgICAgICAgICAgICAgIGRhOiAwLA0KICAgICAgICAgICAgICAgICAgICBDOiBudWxsLA0KICAgICAgICAgICAgICAgICAgICBpYTogMCwNCiAgICAgICAgICAgICAgICAgICAgdWE6ICExLA0KICAgICAgICAgICAgICAgICAgICBJOiAhMSwNCiAgICAgICAgICAgICAgICAgICAgY2E6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGEgPSAwOyBhIDwgQS5sZW5ndGg7IGErKykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoQVthXSA9PSB0aGlzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEEuc3BsaWNlKGEsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBLW3RoaXMuaWRdOw0KICAgICAgICAgICAgICAgICAgICAgICAgYSA9IHEuaW5kZXhPZih0aGlzKTsgLSAxICE9IGEgJiYgKHNiID0gITAsIHEuc3BsaWNlKGEsIDEpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGEgPSBFLmluZGV4T2YodGhpcy5pZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAvL0FHQVJCT1RPVkgNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKC0gMSAhPSBhKXsgDQogICAgICAgICAgICAgICAgICAgICAgICAJRS5zcGxpY2UoYSwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICAJcmVtb3ZlTXlCYWxsKHRoaXMuaWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgLy9BR0FSQk9UT1ZIDQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLkcgPSAhMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIDAgPCB0aGlzLmRhICYmIGJhLnB1c2godGhpcykNCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgbTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5tYXgofn4oLjMgKiB0aGlzLnNpemUpLCAyNCkNCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgQTogZnVuY3Rpb24oYSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubmFtZSA9IGEpIG51bGwgPT0gdGhpcy5pID8gdGhpcy5pID0gbmV3IFZhKHRoaXMubSgpLCAiI0ZGRkZGRiIsICEwLCAiIzAwMDAwMCIpIDogdGhpcy5pLlAodGhpcy5tKCkpLCB0aGlzLmkuQih0aGlzLm5hbWUpDQogICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgIGJhOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGEgPSB0aGlzLkgoKTsgdGhpcy5hLmxlbmd0aCA+IGE7KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSB+fihNYXRoLnJhbmRvbSgpICogdGhpcy5hLmxlbmd0aCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hLnNwbGljZShiLCAxKQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICgwID09IHRoaXMuYS5sZW5ndGggJiYgMCA8IGEgJiYgdGhpcy5hLnB1c2gobmV3IEJiKHRoaXMsIHRoaXMueCwgdGhpcy55LCB0aGlzLnNpemUsIE1hdGgucmFuZG9tKCkgLSAuNSkpOyB0aGlzLmEubGVuZ3RoIDwgYTspIGIgPSB+fihNYXRoLnJhbmRvbSgpICogdGhpcy5hLmxlbmd0aCksIGIgPSB0aGlzLmFbYl0sIHRoaXMuYS5wdXNoKG5ldyBCYih0aGlzLCBiLngsIGIueSwgYi5mLCBiLmIpKQ0KICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICBIOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhID0gMTA7DQogICAgICAgICAgICAgICAgICAgICAgICAyMCA+IHRoaXMuc2l6ZSAmJiAoYSA9IDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jICYmIChhID0gMzApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSB0aGlzLnNpemU7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmMgfHwgKGIgKj0gbCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiICo9IE07DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gfn5NYXRoLm1heChiLCBhKQ0KICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICBCYTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJhKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhID0gdGhpcy5hLCBiID0gYS5sZW5ndGgsIGQgPSB0aGlzLCBjID0gdGhpcy5jID8gMCA6ICh0aGlzLmlkIC8gMUUzICsgeCAvIDFFNCkgJSAoMiAqIE1hdGguUEkpLCBlID0gMCwgcCA9IDA7IHAgPCBiOyArK3ApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZiA9IGFbKHAgLSAxICsgYikgJSBiXS5iLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrID0gYVsocCArIDEpICUgYl0uYiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaCA9IGFbcF07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaC5iICs9IChNYXRoLnJhbmRvbSgpIC0gLjUpICogKHRoaXMuaCA/IDMgOiAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoLmIgKj0gLjc7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgMTAgPCBoLmIgJiYgKGguYiA9IDEwKTsgLSAxMCA+IGguYiAmJiAoaC5iID0gLTEwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoLmIgPSAoZiArIGsgKyA4ICogaC5iKSAvIDEwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuID0gaC5mLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmID0gYVsocCAtIDEgKyBiKSAlIGJdLmYsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGsgPSBhWyhwICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEpICUgYl0uZjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoMTUgPCB0aGlzLnNpemUgJiYgbnVsbCAhPSBpYSAmJiAyMCA8IHRoaXMuc2l6ZSAqIGwgJiYgMCA8IHRoaXMuaWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIFFhID0gITEsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtID0gaC54LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcSA9IGgueTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWEuRWEobSAtIDUsIHEgLSA1LCAxMCwgMTAsIGZ1bmN0aW9uKGEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuJCAhPSBkICYmIDI1ID4gKG0gLSBhLngpICogKG0gLSBhLngpICsgKHEgLSBhLnkpICogKHEgLSBhLnkpICYmIChRYSA9ICEwKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIVFhICYmIChoLnggPCBNYSB8fCBoLnkgPCBOYSB8fCBoLnggPiBPYSB8fCBoLnkgPiBQYSkgJiYgKFFhID0gITApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBRYSAmJiAoMCA8IGguYiAmJiAoaC5iID0gMCksIC0taC5iKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuICs9IGguYjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAwID4gbiAmJiAobiA9IDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4gPSB0aGlzLmggPyAoMTkgKiBuICsgdGhpcy5zaXplKSAvIDIwIDogKDEyICogbiArIHRoaXMuc2l6ZSkgLyAxMzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoLmYgPSAoZiArIGsgKyA4ICogbikgLyAxMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmID0gMiAqIE1hdGguUEkgLyBiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGsgPSBoLmY7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jICYmIDAgPT0gcCAlIDIgJiYgKGsgKz0gNSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaC54ID0gdGhpcy54ICsgTWF0aC5jb3MoZiAqIHAgKyBjKSAqIGs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaC55ID0gdGhpcy55ICsgTWF0aC5zaW4oZiAqIHAgKyBjKSAqIGs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZSA9IE1hdGgubWF4KGUsIGspDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlhID0gZQ0KICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICBuYTogZnVuY3Rpb24oYSwgYikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5NID0gYTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuTiA9IGI7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLkogPSBhOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5LID0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5qYSA9IGE7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmthID0gYg0KICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICBUOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgwID49IHRoaXMuaWQpIHJldHVybiAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSBkYi5wYSgoeCAtIHRoaXMuVSkgLyAxMjAsIDAsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuRyAmJiAxIDw9IGEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IGJhLmluZGV4T2YodGhpcyk7IC0gMSAhPSBiICYmIGJhLnNwbGljZShiLCAxKQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy54ID0gYSAqICh0aGlzLmphIC0gdGhpcy5zKSArIHRoaXMuczsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMueSA9IGEgKiAodGhpcy5rYSAtIHRoaXMudSkgKyB0aGlzLnU7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNpemUgPSBhICogKHRoaXMuZyAtIHRoaXMubykgKyB0aGlzLm87DQogICAgICAgICAgICAgICAgICAgICAgICAuMDEgPiBNYXRoLmFicyh0aGlzLnNpemUgLSB0aGlzLmcpICYmICh0aGlzLnNpemUgPSB0aGlzLmcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGENCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgUjogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMCA+PSB0aGlzLmlkID8gITAgOiB0aGlzLnggKyB0aGlzLnNpemUgKyA0MCA8IHkgLSByIC8gMiAvIGwgfHwgdGhpcy55ICsgdGhpcy5zaXplICsgNDAgPCB6IC0gdCAvIDIgLyBsIHx8IHRoaXMueCAtIHRoaXMuc2l6ZSAtIDQwID4geSArIHIgLyAyIC8gbCB8fCB0aGlzLnkgLSB0aGlzLnNpemUgLSA0MCA+IHogKyB0IC8gMiAvIGwgPyAhMSA6ICEwDQogICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgIHFhOiBmdW5jdGlvbihhKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhLmJlZ2luUGF0aCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGIgPQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuSCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYS5tb3ZlVG8odGhpcy5hWzBdLngsIHRoaXMuYVswXS55KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGQgPSAxOyBkIDw9IGI7ICsrZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjID0gZCAlIGI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5saW5lVG8odGhpcy5hW2NdLngsIHRoaXMuYVtjXS55KQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYS5jbG9zZVBhdGgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGEuc3Ryb2tlKCkNCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgdzogZnVuY3Rpb24oYSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuUigpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKyt0aGlzLmRhOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiID0gMCA8IHRoaXMuaWQgJiYgIXRoaXMuYyAmJiAhdGhpcy5oICYmIC40ID4gbDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA1ID4gdGhpcy5IKCkgJiYgMCA8IHRoaXMuaWQgJiYgKGIgPSAhMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuViAmJiAhYikNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgZCA9IDA7IGQgPCB0aGlzLmEubGVuZ3RoOyBkKyspIHRoaXMuYVtkXS5mID0gdGhpcy5zaXplOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuViA9IGI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5zYXZlKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yYSA9IHg7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZCA9IHRoaXMuVCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuRyAmJiAoYS5nbG9iYWxBbHBoYSAqPSAxIC0gZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5saW5lV2lkdGggPSAxMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLmxpbmVDYXAgPSAicm91bmQiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEubGluZUpvaW4gPSB0aGlzLmMgPyAibWl0ZXIiIDogInJvdW5kIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IHRoaXMubmFtZS50b0xvd2VyQ2FzZSgpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnID0gbnVsbCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcCA9IG51bGwsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQgPSAhMSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZiA9IHRoaXMuY29sb3IsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGggPSAhMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmggfHwgIWFiIHx8IHFiIHx8ICgtMSAhPSBPYi5pbmRleE9mKGUpID8gKGhhLmhhc093blByb3BlcnR5KGUpIHx8IChoYVtlXSA9IG5ldyBJbWFnZSwgaGFbZV0uc3JjID0gYy5BU1NFVFNfUk9PVCArICJza2lucy8iICsgZSArICIucG5nIiksIGcgPSAwICE9IGhhW2VdLndpZHRoICYmIGhhW2VdLmNvbXBsZXRlID8gaGFbZV0gOiBudWxsKSA6IGcgPSBudWxsLCBudWxsICE9IGcgPyAtMSAhPSAkYy5pbmRleE9mKGUpICYmIChkID0gITApIDogKHRoaXMuSSAmJiAiJXN0YXJiYWxsIiA9PSB0aGlzLkMgJiYgInNoZW5yb24iID09IGUgJiYgNyA8PSBxLmxlbmd0aCAmJiAoJGIgPSBkID0gITAsIHAgPSBlYygiJXN0YXJiYWxsMSIpKSwgZyA9IGVjKHRoaXMuQyksIG51bGwgIT0gZyAmJiAoaCA9ICEwLCBmID0gTmModGhpcy5DKSB8fCBmKSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0uY29yZS5kZWJ1ZyAmJiBtLmRlYnVnLnNob3dQcmVkaWN0aW9uICYmIHRoaXMuSSAmJiAoYS5zdHJva2VTdHlsZSA9ICIjMDAwMEZGIiwgYS5iZWdpblBhdGgoKSwgYS5hcmModGhpcy5NLCB0aGlzLk4sIHRoaXMuc2l6ZSArIDUsIDAsIDIgKiBNYXRoLlBJLCAhMSksIGEuY2xvc2VQYXRoKCksIGEuc3Ryb2tlKCksIGEuc3Ryb2tlU3R5bGUgPSAiIzAwRkYwMCIsIGEuYmVnaW5QYXRoKCksIGEuYXJjKHRoaXMuSiwgdGhpcy5LLCB0aGlzLnNpemUgKyA1LCAwLCAyICogTWF0aC5QSSwgITEpLCBhLmNsb3NlUGF0aCgpLCBhLnN0cm9rZSgpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YSAmJiAhcWIgPyAoYS5maWxsU3R5bGUgPSAiI0ZGRkZGRiIsIGEuc3Ryb2tlU3R5bGUgPSAiI0FBQUFBQSIpIDogKGEuZmlsbFN0eWxlID0gZiwgYS5zdHJva2VTdHlsZSA9IGYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIgPyAoYS5iZWdpblBhdGgoKSwgYS5hcmModGhpcy54LCB0aGlzLnksIHRoaXMuc2l6ZSArIDUsIDAsIDIgKiBNYXRoLlBJLCAhMSksIGEuY2xvc2VQYXRoKCkpIDogKHRoaXMuQmEoKSwgdGhpcy5xYShhKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaCB8fCBhLmZpbGwoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBudWxsICE9IGcgJiYgKHRoaXMubGEoYSwgZyksIG51bGwgIT0gcCAmJiB0aGlzLmxhKGEsIHAsIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxwaGE6IE1hdGguc2luKC4wMTc0ICogVGEpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICh0YSB8fCAxNSA8IHRoaXMuc2l6ZSkgJiYgIWIgJiYgKGEuc3Ryb2tlU3R5bGUgPSAiIzAwMDAwMCIsIGEuZ2xvYmFsQWxwaGEgKj0gLjEsIGEuc3Ryb2tlKCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuZ2xvYmFsQWxwaGEgPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUgPSAtMSAhPSBxLmluZGV4T2YodGhpcyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYiA9IH5+dGhpcy55Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAgIT0gdGhpcy5pZCAmJiAoZmEgfHwgZSkgJiYgdGhpcy5uYW1lICYmIHRoaXMuaSAmJiAhZCAmJiAoZyA9IHRoaXMuaSwgZy5CKHRoaXMubmFtZSksIGcuUCh0aGlzLm0oKSksIGQgPSAwID49IHRoaXMuaWQgPyAxIDogTWF0aC5jZWlsKDEwICogbCkgLyAxMCwgZy5tYShkKSwgZyA9IGcuTygpLCBwID0gTWF0aC5jZWlsKGcud2lkdGggLyBkKSwgZiA9IE1hdGguY2VpbChnLmhlaWdodCAvIGQpLCBhLmRyYXdJbWFnZShnLCB+fnRoaXMueCAtIH5+KHAgLyAyKSwgYiAtIH5+KGYgLyAyKSwgcCwgZiksIGIgKz0gZy5oZWlnaHQgLyAyIC8gZCArIDQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAgPCB0aGlzLmlkICYmIGJiICYmIChlIHx8IDAgPT0gcS5sZW5ndGggJiYgKCF0aGlzLmMgfHwgdGhpcy5oKSAmJiAyMCA8IHRoaXMuc2l6ZSkgJiYgKG51bGwgPT0gdGhpcy5TICYmICh0aGlzLlMgPSBuZXcgVmEodGhpcy5tKCkgLyAyLCAiI0ZGRkZGRiIsICEwLCAiIzAwMDAwMCIpKSwgZSA9IHRoaXMuUywgZS5QKHRoaXMubSgpIC8gMiksIGUuQih+fih0aGlzLnNpemUgKiB0aGlzLnNpemUgLyAxMDApKSwgZCA9IE1hdGguY2VpbCgxMCAqIGwpIC8gMTAsIGUubWEoZCksIGcgPSBlLk8oKSwgcCA9IE1hdGguY2VpbChnLndpZHRoIC8NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZCksIGYgPSBNYXRoLmNlaWwoZy5oZWlnaHQgLyBkKSwgYS5kcmF3SW1hZ2UoZywgfn50aGlzLnggLSB+fihwIC8gMiksIGIgLSB+fihmIC8gMiksIHAsIGYpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLnJlc3RvcmUoKQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICBsYTogZnVuY3Rpb24oYSwgYiwgZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYS5zYXZlKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhLmNsaXAoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjID0gTWF0aC5tYXgodGhpcy5zaXplLCB0aGlzLmlhKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIG51bGwgIT0gZCAmJiBudWxsICE9IGQuYWxwaGEgJiYgKGEuZ2xvYmFsQWxwaGEgPSBkLmFscGhhKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGEuZHJhd0ltYWdlKGIsIHRoaXMueCAtIGMgLSA1LCB0aGlzLnkgLSBjIC0gNSwgMiAqIGMgKyAxMCwgMiAqIGMgKyAxMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhLnJlc3RvcmUoKQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICB2YXIgZGIgPSBmdW5jdGlvbihhKSB7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGIoYSwgYiwgYykgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEgPCBiID8gYiA6IGEgPiBjID8gYyA6IGENCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBhLmhhID0gZnVuY3Rpb24oYSwgYykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGU7DQogICAgICAgICAgICAgICAgICAgICAgICBlID0gYiguNSwgMCwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYSArIGUgKiAoYyAtIGEpDQogICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgIGEucGEgPSBiOw0KICAgICAgICAgICAgICAgICAgICBhLmZpeGVkID0gZnVuY3Rpb24oYSwgYikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSBNYXRoLnBvdygxMCwgYik7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gfn4oYSAqIGMpIC8gYw0KICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gYQ0KICAgICAgICAgICAgICAgIH0oe30pOw0KICAgICAgICAgICAgICAgIGMuTWF0aHMgPSBkYjsNCiAgICAgICAgICAgICAgICB2YXIgSGEgPSBmdW5jdGlvbihhKSB7DQogICAgICAgICAgICAgICAgICAgIGEuTCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYSA9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBEYXRlLCBjID0gW2EuZ2V0TW9udGgoKSArIDEsIGEuZ2V0RGF0ZSgpLCBhLmdldEZ1bGxZZWFyKCldLCBhID0gW2EuZ2V0SG91cnMoKSwgYS5nZXRNaW51dGVzKCksIGEuZ2V0U2Vjb25kcygpXSwgZSA9IDE7IDMgPiBlOyBlKyspIDEwID4gYVtlXSAmJiAoYVtlXSA9ICIwIiArIGFbZV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICJbIiArIGMuam9pbigiLyIpICsgIiAiICsgYS5qb2luKCI6IikgKyAiXSINCiAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGENCiAgICAgICAgICAgICAgICB9KHt9KTsNCiAgICAgICAgICAgICAgICBjLlV0aWxzID0gSGE7DQogICAgICAgICAgICAgICAgVmEucHJvdG90eXBlID0gew0KICAgICAgICAgICAgICAgICAgICBGOiAiIiwNCiAgICAgICAgICAgICAgICAgICAgVzogIiMwMDAwMDAiLA0KICAgICAgICAgICAgICAgICAgICBZOiAhMSwNCiAgICAgICAgICAgICAgICAgICAgWjogIiMwMDAwMDAiLA0KICAgICAgICAgICAgICAgICAgICB2OiAxNiwNCiAgICAgICAgICAgICAgICAgICAgajogbnVsbCwNCiAgICAgICAgICAgICAgICAgICAgWDogbnVsbCwNCiAgICAgICAgICAgICAgICAgICAgbDogITEsDQogICAgICAgICAgICAgICAgICAgIEQ6IDEsDQogICAgICAgICAgICAgICAgICAgIFA6IGZ1bmN0aW9uKGEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudiAhPSBhICYmICh0aGlzLnYgPSBhLCB0aGlzLmwgPSAhMCkNCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgbWE6IGZ1bmN0aW9uKGEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuRCAhPSBhICYmICh0aGlzLkQgPSBhLCB0aGlzLmwgPSAhMCkNCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgQjogZnVuY3Rpb24oYSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYSAhPSB0aGlzLkYgJiYgKHRoaXMuRiA9IGEsIHRoaXMubCA9ICEwKQ0KICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICBPOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG51bGwgPT0gdGhpcy5qICYmICh0aGlzLmogPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJjYW52YXMiKSwgdGhpcy5YID0gdGhpcy5qLmdldENvbnRleHQoIjJkIikpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubCA9ICExOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhID0gdGhpcy5qLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiID0gdGhpcy5YLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjID0gdGhpcy5GLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlID0gdGhpcy5ELA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnID0gdGhpcy52LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmID0gZyArICJweCBVYnVudHUiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIuZm9udCA9IGY7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGggPSB+figuMiAqIGcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEud2lkdGggPSAoYi5tZWFzdXJlVGV4dChjKS53aWR0aCArIDYpICogZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLmhlaWdodCA9IChnICsgaCkgKiBlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIuZm9udCA9IGY7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYi5zY2FsZShlLCBlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiLmdsb2JhbEFscGhhID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiLmxpbmVXaWR0aCA9IDM7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYi5zdHJva2VTdHlsZSA9IHRoaXMuWjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiLmZpbGxTdHlsZSA9IHRoaXMuVzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLlkgJiYgYi5zdHJva2VUZXh0KGMsIDMsIGcgLSBoIC8gMik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYi5maWxsVGV4dChjLCAzLCBnIC0gaCAvIDIpDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5qDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgIERhdGUubm93IHx8IChEYXRlLm5vdyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gKG5ldyBEYXRlKS5nZXRUaW1lKCkNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAoZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGEgPSBbIm1zIiwgIm1veiIsICJ3ZWJraXQiLCAibyJdLCBiID0gMDsgYiA8IGEubGVuZ3RoICYmICFjLnJlcXVlc3RBbmltYXRpb25GcmFtZTsgKytiKSBjLnJlcXVlc3RBbmltYXRpb25GcmFtZSA9IGNbYVtiXSArICJSZXF1ZXN0QW5pbWF0aW9uRnJhbWUiXSwgYy5jYW5jZWxBbmltYXRpb25GcmFtZSA9IGNbYVtiXSArICJDYW5jZWxBbmltYXRpb25GcmFtZSJdIHx8IGNbYVtiXSArICJDYW5jZWxSZXF1ZXN0QW5pbWF0aW9uRnJhbWUiXTsNCiAgICAgICAgICAgICAgICAgICAgYy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHwgKGMucmVxdWVzdEFuaW1hdGlvbkZyYW1lID0gZnVuY3Rpb24oYSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoYSwgMUUzIC8gNjApDQogICAgICAgICAgICAgICAgICAgIH0sIGMuY2FuY2VsQW5pbWF0aW9uRnJhbWUgPSBmdW5jdGlvbihhKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoYSkNCiAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICB9KSgpOw0KICAgICAgICAgICAgICAgIHZhciB2YyA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGluaXQ6IGZ1bmN0aW9uKGEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBiKGEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYSA8IGUgJiYgKGEgPSBlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYSA+IGYgJiYgKGEgPSBmKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIH5+KChhIC0gZSkgLyAzMikNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBjKGEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYSA8IGcgJiYgKGEgPSBnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYSA+IGggJiYgKGEgPSBoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIH5+KChhIC0gZykgLyAzMikNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSBhLnphLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnID0gYS5BYSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZiA9IGEueGEsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGggPSBhLnlhLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrID0gfn4oKGYgLSBlKSAvIDMyKSArIDEsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0gPSB+figoaCAtIGcpIC8gMzIpICsgMSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbiA9IEFycmF5KGsgKiBtKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YTogZnVuY3Rpb24oYSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUgPQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIoYS54KSArIGMoYS55KSAqIGs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudWxsID09IG5bZV0gPyBuW2VdID0gYSA6IEFycmF5LmlzQXJyYXkobltlXSkgPyBuW2VdLnB1c2goYSkgOiBuW2VdID0gW25bZV0sIGFdDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEVhOiBmdW5jdGlvbihhLCBlLCBnLCBmLCBoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcCA9IGIoYSksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdSA9IGMoZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhID0gYihhICsgZyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlID0gYyhlICsgZik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoMCA+IHAgfHwgcCA+PSBrIHx8IDAgPiB1IHx8IHUgPj0gbSkgZGVidWdnZXI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKDsgdSA8PSBlOyArK3UpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChmID0gcDsgZiA8PSBhOyArK2YpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnID0gbltmICsgdSAqIGtdLCBudWxsICE9IGcpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShnKSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBsID0gMDsgbCA8IGcubGVuZ3RoOyBsKyspIGgoZ1tsXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGgoZykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgVGIgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhID0gbmV3IGNhKDAsIDAsIDAsIDMyLCAiI0VEMUMyNCIsICIiKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiY2FudmFzIik7DQogICAgICAgICAgICAgICAgICAgICAgICBiLndpZHRoID0gMzI7DQogICAgICAgICAgICAgICAgICAgICAgICBiLmhlaWdodCA9IDMyOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSBiLmdldENvbnRleHQoIjJkIik7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgMCA8IHEubGVuZ3RoICYmIChhLmNvbG9yID0gcVswXS5jb2xvciwgYS5BKHFbMF0ubmFtZSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMuY2xlYXJSZWN0KDAsIDAsIDMyLCAzMik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYy5zYXZlKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYy50cmFuc2xhdGUoMTYsIDE2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjLnNjYWxlKC40LCAuNCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYS53KGMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMucmVzdG9yZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImZhdmljb24iKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZyA9IGUuY2xvbmVOb2RlKCEwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnLnNldEF0dHJpYnV0ZSgiaHJlZiIsIGIudG9EYXRhVVJMKCJpbWFnZS9wbmciKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZChnLCBlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9KCk7DQogICAgICAgICAgICAgICAgZShmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgVGIoKQ0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIHZhciBXYSA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQ6IG51bGwsDQogICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0UHJvdmlkZXI6ICJmYWNlYm9vayIsDQogICAgICAgICAgICAgICAgICAgICAgICBsb2dpbkludGVudDogIjAiLA0KICAgICAgICAgICAgICAgICAgICAgICAgdXNlckluZm86IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb2NpYWxUb2tlbjogbnVsbCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2tlbkV4cGlyZXM6ICIiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldmVsOiAiIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4cDogIiIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgeHBOZWVkZWQ6ICIiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICIiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBpY3R1cmU6ICIiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAiIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dnZWRJbjogIjAiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvY2lhbElkOiAiIg0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICBoID0gYy5kZWZhdWx0U3QgPSBXYTsNCiAgICAgICAgICAgICAgICBjLnN0b3JhZ2VJbmZvID0gaDsNCiAgICAgICAgICAgICAgICBjLmNyZWF0ZURlZmF1bHRTdG9yYWdlID0gUGM7DQogICAgICAgICAgICAgICAgYy51cGRhdGVTdG9yYWdlID0gWGE7DQogICAgICAgICAgICAgICAgZShmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgbnVsbCAhPSBjLmxvY2FsU3RvcmFnZS5zdG9yZU9iamVjdEluZm8gJiYgKGggPSBKU09OLnBhcnNlKGMubG9jYWxTdG9yYWdlLnN0b3JlT2JqZWN0SW5mbykpOw0KICAgICAgICAgICAgICAgICAgICAiMSIgPT0gaC5sb2dpbkludGVudCAmJiBmYyhoLmNvbnRleHQpOw0KICAgICAgICAgICAgICAgICAgICAiIiA9PSBoLnVzZXJJbmZvLm5hbWUgJiYgIiIgPT0gaC51c2VySW5mby5kaXNwbGF5TmFtZSB8fCBnYyhoLnVzZXJJbmZvKQ0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIGMuY2hlY2tMb2dpblN0YXR1cyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAiMSIgPT0gaC5sb2dpbkludGVudCAmJiAoWWEoKSwgZmMoaC5jb250ZXh0KSkNCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgIHZhciBZYSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICBjLk1DLnNldFByb2ZpbGVQaWN0dXJlKGgudXNlckluZm8ucGljdHVyZSk7DQogICAgICAgICAgICAgICAgICAgIGMuTUMuc2V0U29jaWFsSWQoaC51c2VySW5mby5zb2NpYWxJZCkNCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgIGMubG9nb3V0ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgIGggPSBXYTsNCiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGMubG9jYWxTdG9yYWdlLnN0b3JlT2JqZWN0SW5mbzsNCiAgICAgICAgICAgICAgICAgICAgYy5sb2NhbFN0b3JhZ2Uuc3RvcmVPYmplY3RJbmZvID0gSlNPTi5zdHJpbmdpZnkoV2EpOw0KICAgICAgICAgICAgICAgICAgICBYYSgpOw0KICAgICAgICAgICAgICAgICAgICBzYygpOw0KICAgICAgICAgICAgICAgICAgICBtLmNhY2hlLnNlbnRHYW1lU2VydmVyTG9naW4gPSAhMTsNCiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG0uY2FjaGUubG9naW5faW5mbzsNCiAgICAgICAgICAgICAgICAgICAgZSgiI2hlbGxvQ29udGFpbmVyIikuYXR0cigiZGF0YS1sb2dnZWQtaW4iLCAiMCIpOw0KICAgICAgICAgICAgICAgICAgICBlKCIjaGVsbG9Db250YWluZXIiKS5hdHRyKCJkYXRhLWhhcy1hY2NvdW50LWRhdGEiLCAiMCIpOw0KICAgICAgICAgICAgICAgICAgICBlKCIudGltZXIiKS50ZXh0KCIiKTsNCiAgICAgICAgICAgICAgICAgICAgZSgiI2dQbHVzU2hhcmUiKS5oaWRlKCk7DQogICAgICAgICAgICAgICAgICAgIGUoIiNmYlNoYXJlIikuc2hvdygpOw0KICAgICAgICAgICAgICAgICAgICBlKCIjdXNlci1pZC10YWciKS50ZXh0KCIiKTsNCiAgICAgICAgICAgICAgICAgICAgUSgpOw0KICAgICAgICAgICAgICAgICAgICBjLk1DLmRvTG9nb3V0KCkNCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgIGMudG9nZ2xlU29jaWFsTG9naW4gPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgZSgiI3NvY2lhbExvZ2luQ29udGFpbmVyIikudG9nZ2xlKCk7DQogICAgICAgICAgICAgICAgICAgIGUoIiNzZXR0aW5ncyIpLmhpZGUoKTsNCiAgICAgICAgICAgICAgICAgICAgZSgiI2luc3RydWN0aW9ucyIpLmhpZGUoKTsNCiAgICAgICAgICAgICAgICAgICAgQ2IoKQ0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgYy50b2dnbGVTZXR0aW5ncyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICBlKCIjc2V0dGluZ3MiKS50b2dnbGUoKTsNCiAgICAgICAgICAgICAgICAgICAgZSgiI3NvY2lhbExvZ2luQ29udGFpbmVyIikuaGlkZSgpOw0KICAgICAgICAgICAgICAgICAgICBlKCIjaW5zdHJ1Y3Rpb25zIikuaGlkZSgpOw0KICAgICAgICAgICAgICAgICAgICBDYigpDQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICBtLmFjY291bnQgPSBmdW5jdGlvbihhKSB7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGIoKSB7fQ0KDQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGQoYSwgYikgew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coSGEuTCgpICsgIiBnb3QgdXNlciBsb2dpbiIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgPT0gZiB8fCBmLmlkICE9IGIuaWQpIGYgPSBiLCBudWxsICE9IGMuc3NhX2pzb24gJiYgKGMuc3NhX2pzb24uYXBwbGljYXRpb25Vc2VySWQgPSAiIiArIGIuaWQsIGMuc3NhX2pzb24uY3VzdG9tX3VzZXJfaWQgPSAiIiArIGIuaWQpLCAidW5kZWZpbmVkIiAhPSB0eXBlb2YgU1NBX0NPUkUgJiYgU1NBX0NPUkUuc3RhcnQoKSwgZSgiI29mZmVyd2FsbElmcmFtZSIpLmF0dHIoInNyYyIsICJodHRwOi8vd3d3LnN1cGVyc29uaWNhZHMuY29tL2RlbGl2ZXJ5L3BhbmVsLnBocD9hcHBsaWNhdGlvbktleT0iICsgRW52Q29uZmlnLnN1cGVyc29uaWNfYXBwX2tleSArICImYXBwbGljYXRpb25Vc2VySWQ9IiArIGIuaWQgKyAiJmN1c3RvbV91c2VyX2lkPSIgKyBiLmlkICsgIiZhcHBsaWNhdGlvblVzZXJJZFNpZ25hdHVyZT1vcHRpb25hbCIpDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdmFyIGYgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICBhLmluaXQgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG0uY29yZS5iaW5kKCJ1c2VyX2xvZ2luIiwgZCk7DQogICAgICAgICAgICAgICAgICAgICAgICBtLmNvcmUuYmluZCgidXNlcl9sb2dvdXQiLCBiKQ0KICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICBhLnNldFVzZXJEYXRhID0gZnVuY3Rpb24oYSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZ2MoYSkNCiAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgYS5zZXRBY2NvdW50RGF0YSA9IGZ1bmN0aW9uKGEsIGIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjID0gZSgiI2hlbGxvQ29udGFpbmVyIikuYXR0cigiZGF0YS1oYXMtYWNjb3VudC1kYXRhIiwgIjEiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGgudXNlckluZm8ueHAgPSBhLnhwOw0KICAgICAgICAgICAgICAgICAgICAgICAgaC51c2VySW5mby54cE5lZWRlZCA9IGEueHBOZWVkZWQ7DQogICAgICAgICAgICAgICAgICAgICAgICBoLnVzZXJJbmZvLmxldmVsID0gYS5sZXZlbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIFhhKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBjICYmIGIgPyBnYShhKSA6IChlKCIuYWdhcmlvLXByb2ZpbGUtcGFuZWwgLnByb2dyZXNzLWJhci1zdGFyIikudGV4dChhLmxldmVsKSwgZSgiLmFnYXJpby1leHAtYmFyIC5wcm9ncmVzcy1iYXItdGV4dCIpLnRleHQoYS54cCArICIvIiArIGEueHBOZWVkZWQgKyAiIFhQIiksIGUoIi5hZ2FyaW8tZXhwLWJhciAucHJvZ3Jlc3MtYmFyIikuY3NzKCJ3aWR0aCIsICg4OCAqIGEueHAgLyBhLnhwTmVlZGVkKS50b0ZpeGVkKDIpICsgIiUiKSkNCiAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgYS5HYSA9IGZ1bmN0aW9uKGEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGdhKGEpDQogICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBhDQogICAgICAgICAgICAgICAgfSh7fSk7DQogICAgICAgICAgICAgICAgdmFyIGljID0gMDsNCiAgICAgICAgICAgICAgICBjLmZiQXN5bmNJbml0ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGEoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBudWxsID09IGMuRkIgPyBhbGVydCgiWW91IHNlZW0gdG8gaGF2ZSBzb21ldGhpbmcgYmxvY2tpbmcgRmFjZWJvb2sgb24geW91ciBicm93c2VyLCBwbGVhc2UgY2hlY2sgZm9yIGFueSBleHRlbnNpb25zIikgOiAoaC5sb2dpbkludGVudCA9ICIxIiwgYy51cGRhdGVTdG9yYWdlKCksIGMuRkIubG9naW4oZnVuY3Rpb24oYSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhjKGEpDQogICAgICAgICAgICAgICAgICAgICAgICB9LCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGU6ICJwdWJsaWNfcHJvZmlsZSwgZW1haWwiDQogICAgICAgICAgICAgICAgICAgICAgICB9KSkNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBjLkZCLmluaXQoew0KICAgICAgICAgICAgICAgICAgICAgICAgYXBwSWQ6IEVudkNvbmZpZy5mYl9hcHBfaWQsDQogICAgICAgICAgICAgICAgICAgICAgICBjb29raWU6ICEwLA0KICAgICAgICAgICAgICAgICAgICAgICAgeGZibWw6ICEwLA0KICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiAhMCwNCiAgICAgICAgICAgICAgICAgICAgICAgIHZlcnNpb246ICJ2Mi4yIg0KICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgKCIxIiA9PSBjLnN0b3JhZ2VJbmZvLmxvZ2luSW50ZW50ICYmICJmYWNlYm9vayIgPT0gYy5zdG9yYWdlSW5mby5jb250ZXh0IHx8IG5jKSAmJiBjLkZCLmdldExvZ2luU3RhdHVzKGZ1bmN0aW9uKGIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICJjb25uZWN0ZWQiID09PSBiLnN0YXR1cyA/IGhjKGIpIDogIm5vdF9hdXRob3JpemVkIiA9PT0gYi5zdGF0dXMgPyAoYy5sb2dvdXQoKSwgYSgpKSA6IGMubG9nb3V0KCkNCiAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIGMuZmFjZWJvb2tSZWxvZ2luID0gYTsNCiAgICAgICAgICAgICAgICAgICAgYy5mYWNlYm9va0xvZ2luID0gYQ0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgdmFyIEhiID0gITE7DQogICAgICAgICAgICAgICAgKGZ1bmN0aW9uKGEpIHsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7DQogICAgICAgICAgICAgICAgICAgICAgICBhLnR5cGUgPSAidGV4dC9qYXZhc2NyaXB0IjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGEuYXN5bmMgPSAhMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGEuc3JjID0gIi8vYXBpcy5nb29nbGUuY29tL2pzL2NsaWVudDpwbGF0Zm9ybS5qcz9vbmxvYWQ9Z2FwaUFzeW5jSW5pdCI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJzY3JpcHQiKVswXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGIucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoYSwgYik7DQogICAgICAgICAgICAgICAgICAgICAgICBmID0gITANCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IHt9LA0KICAgICAgICAgICAgICAgICAgICAgICAgZiA9ICExOw0KICAgICAgICAgICAgICAgICAgICBjLmdhcGlBc3luY0luaXQgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGUoZCkudHJpZ2dlcigiaW5pdGlhbGl6ZWQiKQ0KICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICBhLmdvb2dsZSA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiKCkNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICAgICBzYTogZnVuY3Rpb24oYSwgYikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMuZ2FwaS5jbGllbnQubG9hZCgicGx1cyIsICJ2MSIsIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiZmV0Y2hpbmcgbWUgcHJvZmlsZSIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYXBpLmNsaWVudC5wbHVzLnBlb3BsZS5nZXQoew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiAibWUiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmV4ZWN1dGUoZnVuY3Rpb24oYSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYihhKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgIGEuRGEgPSBmdW5jdGlvbihhKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmIHx8IGIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICJ1bmRlZmluZWQiICE9PSB0eXBlb2YgZ2FwaSA/IGEoKSA6IGUoZCkuYmluZCgiaW5pdGlhbGl6ZWQiLCBhKQ0KICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gYQ0KICAgICAgICAgICAgICAgIH0pKG0pOw0KICAgICAgICAgICAgICAgIHZhciBhZCA9IGZ1bmN0aW9uKGEpIHsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYihhKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjLk1DLmRvTG9naW5XaXRoR1BsdXMoYSk7DQogICAgICAgICAgICAgICAgICAgICAgICBtLmNhY2hlLmxvZ2luX2luZm8gPSBbYSwgImdvb2dsZSJdDQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBkKGEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGgudXNlckluZm8ucGljdHVyZSA9IGE7DQogICAgICAgICAgICAgICAgICAgICAgICBlKCIuYWdhcmlvLXByb2ZpbGUtcGljdHVyZSIpLmF0dHIoInNyYyIsIGEpDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdmFyIGYgPSBudWxsLA0KICAgICAgICAgICAgICAgICAgICAgICAgZyA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGllbnRfaWQ6IEVudkNvbmZpZy5ncGx1c19jbGllbnRfaWQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29va2llX3BvbGljeTogInNpbmdsZV9ob3N0X29yaWdpbiIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGU6ICJwcm9maWxlIGVtYWlsIg0KICAgICAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgYS5mYSA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG9hOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZg0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGluaXQ6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhID0gdGhpcywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYiA9IGggJiYgIjEiID09IGgubG9naW5JbnRlbnQgJiYgImdvb2dsZSIgPT0gaC5jb250ZXh0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0uRGEoZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMuZ2FwaS55dHN1YnNjcmliZS5nbygiYWdhcllvdXR1YmUiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYy5nYXBpLmxvYWQoImF1dGgyIiwgZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmID0gYy5nYXBpLmF1dGgyLmluaXQoZyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmLmF0dGFjaENsaWNrSGFuZGxlcihkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZ3BsdXNMb2dpbiIpLCB7fSwgZnVuY3Rpb24oYSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJnb29nbGVVc2VyIDogIiArIGEpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihhKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coImZhaWxlZCB0byBsb2dpbiBpbiBnb29nbGUgcGx1czogIiwgSlNPTi5zdHJpbmdpZnkoYSwgdm9pZCAwLCAyKSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZi5jdXJyZW50VXNlci5saXN0ZW4oXy5iaW5kKGEuQ2EsIGEpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIgJiYgMSA9PSBmLmlzU2lnbmVkSW4uZ2V0KCkgJiYgZi5zaWduSW4oKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICAgICAgQ2E6IGZ1bmN0aW9uKGEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZiAmJiBhICYmIGYuaXNTaWduZWRJbi5nZXQoKSAmJiAhSGIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSGIgPSAhMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaC5sb2dpbkludGVudCA9ICIxIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSBhLmdldEF1dGhSZXNwb25zZSgpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZyA9IGUuYWNjZXNzX3Rva2VuOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjLm9hID0gZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coImxvZ2dlZEluIHdpdGggRyshIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsID0gYS5nZXRCYXNpY1Byb2ZpbGUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYSA9IGwuZ2V0SW1hZ2VVcmwoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCAwID09IGEgPyBtLmdvb2dsZS5zYShlLCBmdW5jdGlvbihhKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLnJlc3VsdC5pc1BsdXNVc2VyID8gKGEgJiYgZChhLmltYWdlLnVybCksIGIoZyksIGEgJiYgKGgudXNlckluZm8ucGljdHVyZSA9IGEuaW1hZ2UudXJsKSwgaC51c2VySW5mby5zb2NpYWxJZCA9IGwuZ2V0SWQoKSwgWWEoKSkgOiAoYWxlcnQoIlBsZWFzZSBhZGQgR29vZ2xlKyB0byB5b3VyIEdvb2dsZSBhY2NvdW50IGFuZCB0cnkgYWdhaW4uXG5PciB5b3UgY2FuIGxvZ2luIHdpdGggYW5vdGhlciBhY2NvdW50LiIpLCBjLmxvZ291dCgpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSA6IChkKGEpLCBoLnVzZXJJbmZvLnBpY3R1cmUgPSBhLCBoLnVzZXJJbmZvLnNvY2lhbElkID0gbC5nZXRJZCgpLCBZYSgpLCBiKGcpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaC5jb250ZXh0ID0gImdvb2dsZSI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMudXBkYXRlU3RvcmFnZSgpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHdhOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmICYmIChmLnNpZ25PdXQoKSwgSGIgPSAhMSkNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGENCiAgICAgICAgICAgICAgICB9KG0pOw0KICAgICAgICAgICAgICAgIGMuZ3BsdXNNb2R1bGUgPSBhZDsNCiAgICAgICAgICAgICAgICB2YXIgc2MgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgbS5mYS53YSgpDQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICBjLmxvZ291dEdvb2dsZVBsdXMgPSBzYzsNCiAgICAgICAgICAgICAgICB2YXIgWmMgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYShhLCBiLCBjLCBkLCBlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZiA9IGIuZ2V0Q29udGV4dCgiMmQiKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnID0gYi53aWR0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGIgPSBiLmhlaWdodDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGEuY29sb3IgPSBlOw0KICAgICAgICAgICAgICAgICAgICAgICAgYS5BKGMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYS5zaXplID0gZDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGYuc2F2ZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZi50cmFuc2xhdGUoZyAvIDIsIGIgLyAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGEudyhmKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGYucmVzdG9yZSgpDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYiA9IG5ldyBjYSgtMSwgMCwgMCwgMzIsICIjNWJjMGRlIiwgIiIpLCBjID0gbmV3IGNhKC0xLCAwLCAwLCAzMiwgIiM1YmMwZGUiLCAiIiksIGYgPSAiIzA3OTFmZiAjNWEwN2ZmICNmZjA3ZmUgI2ZmYTUwNyAjZmYwNzc0ICMwNzdmZmYgIzNhZmYwNyAjZmYwN2VkICMwN2E4ZmYgI2ZmMDc2ZSAjM2ZmZjA3ICNmZjA3MzQgIzA3ZmYyMCAjZmYwN2EyICNmZjgyMDcgIzA3ZmYwZSIuc3BsaXQoIiAiKSwgZyA9IFtdLCBoID0gMDsgaCA8IGYubGVuZ3RoOyArK2gpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsID0gaCAvIGYubGVuZ3RoICogMTIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgayA9IDMwICogTWF0aC5zcXJ0KGggLyBmLmxlbmd0aCk7DQogICAgICAgICAgICAgICAgICAgICAgICBnLnB1c2gobmV3IGNhKC0xLCBNYXRoLmNvcyhsKSAqIGssIE1hdGguc2luKGwpICogaywgMTAsIGZbaF0sICIiKSkNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBPYyhnKTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIG0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJjYW52YXMiKTsNCiAgICAgICAgICAgICAgICAgICAgbS5nZXRDb250ZXh0KCIyZCIpOw0KICAgICAgICAgICAgICAgICAgICBtLndpZHRoID0gbS5oZWlnaHQgPSA3MDsNCiAgICAgICAgICAgICAgICAgICAgYShjLCBtLCAiIiwgMjYsICIjZWJjMGRlIik7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGUoIi5jZWxsLXNwaW5uZXIiKS5maWx0ZXIoIjp2aXNpYmxlIikuZWFjaChmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYyA9IGUodGhpcyksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQgPSBEYXRlLm5vdygpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmID0gdGhpcy53aWR0aCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZyA9IHRoaXMuaGVpZ2h0LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoID0gdGhpcy5nZXRDb250ZXh0KCIyZCIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGguY2xlYXJSZWN0KDAsIDAsIGYsIGcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGguc2F2ZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGgudHJhbnNsYXRlKGYgLyAyLCBnIC8gMik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IDEwID4gazsgKytrKSBoLmRyYXdJbWFnZShtLCAoLjEgKiBkICsgODAgKiBrKSAlIChmICsgMTQwKSAtIGYgLyAyIC0gNzAgLSAzNSwgZyAvIDIgKiBNYXRoLnNpbigoLjAwMSAqIGQgKyBrKSAlIE1hdGguUEkgKiAyKSAtIDM1LCA3MCwgNzApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGgucmVzdG9yZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIChjID0gYy5hdHRyKCJkYXRhLWl0ciIpKSAmJiAoYyA9IFIoYykpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEoYiwgdGhpcywgYyB8fCAiIiwgK2UodGhpcykuYXR0cigiZGF0YS1zaXplIiksICIjNWJjMGRlIikNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgZSgiI3N0YXRzUGVsbGV0cyIpLmZpbHRlcigiOnZpc2libGUiKS5lYWNoKGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUodGhpcyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSB0aGlzLndpZHRoLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjID0gdGhpcy5oZWlnaHQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRDb250ZXh0KCIyZCIpLmNsZWFyUmVjdCgwLCAwLCBiLCBjKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGIgPSAwOyBiIDwgZy5sZW5ndGg7IGIrKykgYShnW2JdLCB0aGlzLCAiIiwgZ1tiXS5zaXplLCBnW2JdLmNvbG9yKQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0oKTsNCiAgICAgICAgICAgICAgICBjLmNyZWF0ZVBhcnR5ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgIGthKCI6cGFydHkiKTsNCiAgICAgICAgICAgICAgICAgICAgUyA9IGZ1bmN0aW9uKGEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIERiKCIvIyIgKyBjLmVuY29kZVVSSUNvbXBvbmVudChhKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBlKCIucGFydHlUb2tlbiIpLnZhbCgiYWdhci5pby8jIiArIGMuZW5jb2RlVVJJQ29tcG9uZW50KGEpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGUoIiNoZWxsb0NvbnRhaW5lciIpLmF0dHIoImRhdGEtcGFydHktc3RhdGUiLCAiMSIpDQogICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgIFEoKQ0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgYy5qb2luUGFydHkgPSBqYzsNCiAgICAgICAgICAgICAgICBjLmNhbmNlbFBhcnR5ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgIERiKCIvIik7DQogICAgICAgICAgICAgICAgICAgIGUoIiNoZWxsb0NvbnRhaW5lciIpLmF0dHIoImRhdGEtcGFydHktc3RhdGUiLCAiMCIpOw0KICAgICAgICAgICAgICAgICAgICBrYSgiIik7DQogICAgICAgICAgICAgICAgICAgIFEoKQ0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgdmFyIEYgPSBbXSwNCiAgICAgICAgICAgICAgICAgICAgdWIgPSAwLA0KICAgICAgICAgICAgICAgICAgICB2YiA9ICIjMDAwMDAwIiwNCiAgICAgICAgICAgICAgICAgICAgYWEgPSAhMSwNCiAgICAgICAgICAgICAgICAgICAgRWEgPSAhMSwNCiAgICAgICAgICAgICAgICAgICAgUmEgPSAwLA0KICAgICAgICAgICAgICAgICAgICBFYiA9IDAsDQogICAgICAgICAgICAgICAgICAgIHhiID0gMCwNCiAgICAgICAgICAgICAgICAgICAgd2IgPSAwLA0KICAgICAgICAgICAgICAgICAgICBXID0gMCwNCiAgICAgICAgICAgICAgICAgICAgWmEgPSAhMDsNCiAgICAgICAgICAgICAgICBjLm9uUGxheWVyRGVhdGggPSBKYTsNCiAgICAgICAgICAgICAgICBzZXRJbnRlcnZhbChmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgRWEgJiYgRi5wdXNoKGFjKCkgLyAxMDApDQogICAgICAgICAgICAgICAgfSwgMUUzIC8gNjApOw0KICAgICAgICAgICAgICAgIHNldEludGVydmFsKGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgYSA9IFJjKCk7DQogICAgICAgICAgICAgICAgICAgIDAgIT0gYSAmJiAoKyt4YiwgMCA9PSBXICYmIChXID0gYSksIFcgPSBNYXRoLm1pbihXLCBhKSkNCiAgICAgICAgICAgICAgICB9LCAxRTMpOw0KICAgICAgICAgICAgICAgIGMuY2xvc2VTdGF0cyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICBhYSA9ICExOw0KICAgICAgICAgICAgICAgICAgICBlKCIjc3RhdHMiKS5oaWRlKCk7DQogICAgICAgICAgICAgICAgICAgIGMuZGVzdHJveUFkKGMuYWRTbG90cy5hYik7DQogICAgICAgICAgICAgICAgICAgIHlhKDApDQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICBjLnNldFNraXBTdGF0cyA9IGZ1bmN0aW9uKGEpIHsNCiAgICAgICAgICAgICAgICAgICAgWmEgPSAhYQ0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgYy5nZXRTdGF0c1N0cmluZyA9IGxjOw0KICAgICAgICAgICAgICAgIGMuZ1BsdXNTaGFyZSA9IFRjOw0KICAgICAgICAgICAgICAgIGMudHdpdHRlclNoYXJlU3RhdHMgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSBjLmdldFN0YXRzU3RyaW5nKCJ0dF9zaGFyZV9zdGF0cyIpOw0KICAgICAgICAgICAgICAgICAgICBjLm9wZW4oImh0dHBzOi8vdHdpdHRlci5jb20vaW50ZW50L3R3ZWV0P3RleHQ9IiArDQogICAgICAgICAgICAgICAgICAgICAgICBhLCAiQWdhci5pbyIsICJ3aWR0aD02NjAsaGVpZ2h0PTMxMCxtZW51YmFyPW5vLHRvb2xiYXI9bm8scmVzaXphYmxlPXllcyxzY3JvbGxiYXJzPW5vLGxlZnQ9IiArIChjLnNjcmVlblggKyBjLmlubmVyV2lkdGggLyAyIC0gMzMwKSArICIsdG9wPSIgKyAoYy5pbm5lckhlaWdodCAtIDMxMCkgLyAyKQ0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgYy5mYlNoYXJlU3RhdHMgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSBjLmdldFN0YXRzU3RyaW5nKCJmYl9tYXRjaHJlc3VsdHNfc3VidGl0bGUiKTsNCiAgICAgICAgICAgICAgICAgICAgYy5GQi51aSh7DQogICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICJmZWVkIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6ICJpZnJhbWUiLA0KICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogUigiZmJfbWF0Y2hyZXN1bHRzX3RpdGxlIiksDQogICAgICAgICAgICAgICAgICAgICAgICBjYXB0aW9uOiBSKCJmYl9tYXRjaHJlc3VsdHNfZGVzY3JpcHRpb24iKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBhLA0KICAgICAgICAgICAgICAgICAgICAgICAgbGluazogImh0dHA6Ly9hZ2FyLmlvIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIEphOiAiaHR0cDovL3N0YXRpYzIubWluaWNsaXBjZG4uY29tL21vYmlsZS9hZ2FyL0FnYXIuaW9fbWF0Y2hyZXN1bHRzX2ZiXzEyMDB4NjMwLnBuZyIsDQogICAgICAgICAgICAgICAgICAgICAgICBGYTogew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICJwbGF5IG5vdyEiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbms6ICJodHRwOi8vYWdhci5pbyINCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgIGMuZmlsbFNvY2lhbFZhbHVlcyA9IGZ1bmN0aW9uKGEsIGIpIHsNCiAgICAgICAgICAgICAgICAgICAgMSA9PSBjLmlzQ2hyb21lICYmICJnb29nbGUiID09IGMuc3RvcmFnZUluZm8uY29udGV4dCAmJiBjLmdhcGkuaW50ZXJhY3RpdmVwb3N0LnJlbmRlcihiLCB7DQogICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50dXJsOiBFbnZDb25maWcuZ2FtZV91cmwsDQogICAgICAgICAgICAgICAgICAgICAgICBjbGllbnRpZDogRW52Q29uZmlnLmdwbHVzX2NsaWVudF9pZCwNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvb2tpZXBvbGljeTogImh0dHA6Ly9hZ2FyLmlvIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIHByZWZpbGx0ZXh0OiBhLA0KICAgICAgICAgICAgICAgICAgICAgICAgY2FsbHRvYWN0aW9ubGFiZWw6ICJCRUFUIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGx0b2FjdGlvbnVybDogRW52Q29uZmlnLmdhbWVfdXJsDQogICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICBlKGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAiTUFzeW5jSW5pdCIgaW4gYyAmJiBjLk1Bc3luY0luaXQoKQ0KICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIE9SSUdJTkFMIFNDUklQVA0KICAgICAgICB2YXIgd2luZG8gPSBjOw0KICAgIAl2YXIgc3RvcE1vdmUgPSBmYWxzZTsNCiAgICAJdmFyIGF1dG9GZWVkSW50ZXJ2YWwgPSB1bmRlZmluZWQ7DQogICAgCXZhciBhdXRvU3BsaXRJbnRlcnZhbCA9IHVuZGVmaW5lZDsNCiAgICAJdmFyIHNlbmRCdWZmZXIgPSBWOw0KICAgIAl2YXIgc2VuZFZhbCA9IFg7DQogICAgCS8vQUdBUkJPVE9WSCBtb2RpZiBJYiBwb3VyIGxhIG3DqXRob2RlIHF1aSBmYWl0IGxlcyBvbmtleXVwIG9ua2V5ZG93bg0KICAgIAlJYiA9IGZ1bmN0aW9uKCl7DQogICAgCQl3aW5kby5vbmtleXVwID0gZnVuY3Rpb24oYSl7DQoJICAgICAgICAgICAgMzIgPT0gYS5rZXlDb2RlICYmICh2YSA9ICExKTsNCgkgICAgICAgICAgICA4NyA9PSBhLmtleUNvZGUgJiYgKHhhID0gITEpOw0KCSAgICAgICAgICAgIDgxID09IGEua2V5Q29kZSAmJiB3YSAmJiAoWCgxOSksIHdhID0gITEpDQogICAgCQl9DQogICAgCQl3aW5kby5vbmtleWRvd24gPSBmdW5jdGlvbihhKSB7DQogICAgCQkJY29uc29sZS5sb2coJ2tleURvd24nLGEpOw0KICAgIAkJCTMyICE9IGEua2V5Q29kZSB8fCB2YSB8fCAoIm5pY2siICE9IGEudGFyZ2V0LmlkICYmIGEucHJldmVudERlZmF1bHQoKSwgZWIoKSwgdmEgPSAhMCk7DQogICAgICAgICAgICAgICAgODEgPT0gYS5rZXlDb2RlICYmIChYKDE4KSwgd2EgPSAhMCk7DQogICAgICAgICAgICAgICAgODcgIT0gYS5rZXlDb2RlIHx8IHhhIHx8IChKYigpLCB4YSA9ICEwKTsNCiAgICAgICAgICAgICAgICAyNyA9PSBhLmtleUNvZGUgJiYgKGEucHJldmVudERlZmF1bHQoKSwgeWEoMzAwKSwgZSgiI29mZXJ3YWxsQ29udGFpbmVyIikuaXMoIjp2aXNpYmxlIikgJiYgYy5jbG9zZU9mZmVyd2FsbCgpLCBlKCIjdmlkZW9Db250YWluZXIiKS5pcygiOnZpc2libGUiKSAmJiBjLmNsb3NlVmlkZW9Db250YWluZXIoKSkNCiAgICAJCQlpZihhLmtleUNvZGUgPT0gODgpey8vIHgNCiAgICAJCQkJLy8gY29uc29sZS5sb2coJ3gnLGJ0KTsNCiAgICAJCQkJaWYoYS5zaGlmdEtleSl7DQogICAgCQkJCQlpZihidCAhPSB1bmRlZmluZWQgJiYgYnQucmVhZHlTdGF0ZSA9PSBXZWJTb2NrZXQuT1BFTikNCiAgICAJCQkJCQlidC5zZW5kKEpTT04uc3RyaW5naWZ5KHthY3Rpb246MTl9KSk7DQogICAgCQkJCX0NCiAgICAJCQkJZWxzZXsNCiAgICAJCQkJCWlmKGJ0ICE9IHVuZGVmaW5lZCAmJiBidC5yZWFkeVN0YXRlID09IFdlYlNvY2tldC5PUEVOKQ0KICAgIAkJCQkJCWJ0LnNlbmQoSlNPTi5zdHJpbmdpZnkoe2FjdGlvbjoxNX0pKTsNCiAgICAJCQkJfQ0KICAgIAkJCX1lbHNlIGlmKGEua2V5Q29kZSA9PSA2Nyl7Ly8gYw0KICAgIAkJCQkvLyBjb25zb2xlLmxvZygnYycpOw0KICAgIAkJCQlpZihidCAhPSB1bmRlZmluZWQgJiYgYnQucmVhZHlTdGF0ZSA9PSBXZWJTb2NrZXQuT1BFTikNCiAgICAJCQkJCWJ0LnNlbmQoSlNPTi5zdHJpbmdpZnkoe2FjdGlvbjoxNn0pKTsNCiAgICAJCQl9ZWxzZSBpZihhLmtleUNvZGUgPT0gODYpey8vIHYNCiAgICAJCQkJLy8gY29uc29sZS5sb2coJ2MnKTsNCiAgICAJCQkJaWYoYnQgIT0gdW5kZWZpbmVkICYmIGJ0LnJlYWR5U3RhdGUgPT0gV2ViU29ja2V0Lk9QRU4pDQogICAgCQkJCQlidC5zZW5kKEpTT04uc3RyaW5naWZ5KHthY3Rpb246MTd9KSk7DQogICAgCQkJfWVsc2UgaWYoYS5rZXlDb2RlID09IDY2KXsvLyBiDQogICAgCQkJCS8vIGNvbnNvbGUubG9nKCdjJyk7DQogICAgCQkJCWlmKGJ0ICE9IHVuZGVmaW5lZCAmJiBidC5yZWFkeVN0YXRlID09IFdlYlNvY2tldC5PUEVOKQ0KICAgIAkJCQkJYnQuc2VuZChKU09OLnN0cmluZ2lmeSh7YWN0aW9uOjE4fSkpOw0KICAgIAkJCX1lbHNlIGlmKGEua2V5Q29kZSA9PSA4MyAmJiAibmljayIgIT0gYS50YXJnZXQuaWQpey8vIHMNCiAgICAJCQkJY29uc29sZS5sb2coJ3MnKTsNCiAgICAJCQkJaWYoYXV0b0ZlZWRJbnRlcnZhbCA9PSB1bmRlZmluZWQpDQogICAgCQkJCQlhdXRvRmVlZEludGVydmFsID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKXsNCiAgICAJCQkJCQlzZW5kVmFsKDIxKTsNCiAgICAJCQkJCX0sMTAwKTsNCiAgICAJCQkJZWxzZXsNCiAgICAJCQkJCWNsZWFySW50ZXJ2YWwoYXV0b0ZlZWRJbnRlcnZhbCk7DQogICAgCQkJCQlhdXRvRmVlZEludGVydmFsID0gdW5kZWZpbmVkOw0KICAgIAkJCQl9DQogICAgCQkJCXJlZnJlc2goKTsNCiAgICAJCQl9ZWxzZSBpZihhLmtleUNvZGUgPT0gMzIgJiYgYS5zaGlmdEtleSAmJiAibmljayIgIT0gYS50YXJnZXQuaWQpey8vIHMNCiAgICAJCQkJLy8gY29uc29sZS5sb2coJ3NwYWNlJyk7DQogICAgCQkJCXZhciBudW1iZXIgPSAwOw0KICAgIAkJCQlpZihhdXRvU3BsaXRJbnRlcnZhbCA9PSB1bmRlZmluZWQpDQogICAgCQkJCQlhdXRvU3BsaXRJbnRlcnZhbCA9IHNldEludGVydmFsKGZ1bmN0aW9uKCl7DQogICAgCQkJCQkJc2VuZFZhbCgxNyk7DQogICAgCQkJCQkJbnVtYmVyKys7DQogICAgCQkJCQkJaWYobnVtYmVyID09IDcpew0KICAgIAkJCQkJCQljbGVhckludGVydmFsKGF1dG9TcGxpdEludGVydmFsKTsNCiAgICAJICAgIAkJCQkJYXV0b1NwbGl0SW50ZXJ2YWwgPSB1bmRlZmluZWQ7DQogICAgCSAgICAJCQkJCW51bWJlciA9IDA7DQogICAgCQkJCQkJfQ0KICAgIAkJCQkJfSwxMDApOw0KICAgIAkJCQllbHNlew0KICAgIAkJCQkJY2xlYXJJbnRlcnZhbChhdXRvU3BsaXRJbnRlcnZhbCk7DQogICAgCQkJCQlhdXRvU3BsaXRJbnRlcnZhbCA9IHVuZGVmaW5lZDsNCiAgICAJCQkJfQ0KICAgIAkJCQlyZWZyZXNoKCk7DQogICAgCQkJfWVsc2UgaWYoYS5rZXlDb2RlID09IDY4ICYmICJuaWNrIiAhPSBhLnRhcmdldC5pZCl7Ly8gRA0KICAgIAkJCQlzdG9wTW92ZSA9ICFzdG9wTW92ZTsNCiAgICAJCQkJLy9jb25zb2xlLmxvZygnU1RPUE1PVkUnKTsNCiAgICAJCQkJLyoNCiAgICAJCQkJICogY29uc29sZS5sb2coJ0x0JyxMdCk7IGNvbnNvbGUubG9nKCdFdCcsRXQpOyBjb25zb2xlLmxvZygnVHQnLFR0KTsNCiAgICAJCQkJICogY29uc29sZS5sb2coJ3d0Jyx3dCk7IGNvbnNvbGUubG9nKCdQdCcsUHQpOyBjb25zb2xlLmxvZygnQ3QnLEN0KTsNCiAgICAJCQkJICovDQogICAgCQkJCXJlZnJlc2goKTsNCiAgICAJCQl9ZWxzZSBpZihhLmtleUNvZGUgPT0gNjkgJiYgIm5pY2siICE9IGEudGFyZ2V0LmlkKXsvLyBFDQoJICAgIAkJCWlmKHh0KQ0KCSAgICAgICAgICAgICAgICAJYnQuc2VuZChKU09OLnN0cmluZ2lmeSh7DQoJICAgICAgICAgICAgICAgIAkJYWN0aW9uOjUNCgkgICAgICAgICAgICAgICAgCX0pKTsNCgkgICAgCQkJcmVmcmVzaCgpOw0KICAgIAkJCX1lbHNlIGlmKGEua2V5Q29kZSA9PSA3MCAmJiAibmljayIgIT0gYS50YXJnZXQuaWQpey8vIEYNCiAgICAJCQkJY29uc29sZS5sb2cocSk7Ly9BR0FSQk9UT1ZIIHBhcyBvdWJsaWVyIG1vZGlmIHENCiAgICAJCQl9DQogICAgCSAgICB9Ow0KICAgIAl9Ow0KICAgIAl2YXIgYnQgPSB1bmRlZmluZWQ7DQogICAgCXZhciBpcCA9IHVuZGVmaW5lZDsNCiAgICAJdmFyIHJvb20gPSB1bmRlZmluZWQ7DQogICAgCXZhciBvcGVuU29ja2V0ID0gZnVuY3Rpb24oKXsNCiAgICAJCWJ0ICYmIGJ0LmNsb3NlKCk7DQogICAgCQlidCA9IG5ldyBXZWJTb2NrZXQoIndzOi8vc2VydmVyLWJldGEuYWdhcmJvdC5vdmg6OTAiKTsNCiAgICAJCWJ0LmJpbmFyeVR5cGUgPSAiYXJyYXlidWZmZXIiOw0KICAgIAkJYnQub25vcGVuID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgeHQgPSB0cnVlOw0KICAgICAgICAgICAgICAgIGNoYW5nZUdhbWVNb2RlKCk7DQogICAgICAgICAgICB9Ow0KICAgIAkJYnQub25lcnJvciA9IGZ1bmN0aW9uKGUpew0KICAgIAkJCWNvbnNvbGUuZXJyb3IoJ0FnYXJCb3Qub3ZoIDogVEhFIFNFTlRFTkNFIEJFRk9SRSBJUyBUSEUgUkVBU09OIFdIWSBZT1UgSEFWRSBUUk9VQkxFUyBDT05ORUNUSU5HJyxlLCdjb25uZWN0aW9uIGVycm9yJyk7DQogICAgCQkJc2V0SW5mb3MoJ0FnYXJCb3Qub3ZoIDogQ29ubmV4aW9uIGVycm9yLCBjaGVjayBGMTIgPiBjb25zb2xlIHRvIGhhdmUgbW9yZSBpbmZvcycpOw0KICAgIAkJCXNldFR4dChnZXRJbmZvcygpKTsNCiAgICAJCX07DQogICAgCQlidC5vbm1lc3NhZ2UgPSBmdW5jdGlvbih0KSB7DQogICAgCQkJaWYodC5kYXRhLnN0YXJ0c1dpdGgoJ3BpbmcnKSl7DQogICAgCQkJCXZhciBkYXRhID0gdC5kYXRhLnNwbGl0KCd8Jyk7DQogICAgCQkJCXdpbmRvdy5waW5nID0gZGF0YVsxXTsNCiAgICAJCQkJaWYoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BpbmcnKSAhPSB1bmRlZmluZWQpDQogICAgCQkJCQlkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGluZycpLmlubmVySFRNTCA9IHdpbmRvdy5waW5nOw0KICAgIAkJCQkNCiAgICAJCQkJYnQuc2VuZCgncG9uZycpOw0KICAgIAkJCQlyZXR1cm47DQogICAgCQkJfQ0KICAgICAgICAgICAgICAgIHQgPSBKU09OLnBhcnNlKHQuZGF0YSk7DQogICAgCQkJd2luZG93Lmxhc3RNZXNzYWdlID0gdDsNCiAgICAJCQlyZWZyZXNoKCk7DQogICAgICAgICAgICB9Ow0KICAgIAkJYnQub25jbG9zZSA9IGZ1bmN0aW9uKGUpIHsNCiAgICAJCQljb25zb2xlLmVycm9yKCdXRUJTT0NLRVQgVE8gQk9UIFNFUlZFUiBDTE9TRUQnLCdjb2RlIDogJyxlLmNvZGUsJ3JlYXNvbicsZS5yZWFzb24pOw0KICAgIAkJCS8qdmFyIGluZm9zID0gZ2V0SW5mb3MoKTsNCiAgICAJCQlpZihpbmZvcy5jbG9zZU1lc3MgPT0gdW5kZWZpbmVkIHx8IGluZm9zLmNsb3NlTWVzcyA9PSB0cnVlKXsNCiAgICAJCQkJc2V0SW5mb3MoJ0Nvbm5lY3Rpb24gY2xvc2VkJyx0cnVlKTsNCiAgICAJCQkJc2V0VHh0KGdldEluZm9zKCkpOw0KICAgIAkJCX0qLw0KICAgICAgICAgICAgICAgIHh0ID0gZmFsc2U7DQogICAgICAgICAgICB9Ow0KICAgIAl9Ow0KICAgIAl2YXIgc2VuZFRva2VuID0gZnVuY3Rpb24odWludGFycmF5KXsNCiAgICAJCWlmKHh0KXsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdzZW5kVG9rZW4nLHVpbnRhcnJheSx1aW50YXJyYXkubGVuZ3RoKTsNCiAgICAJCQlhID0gbmV3IERhdGFWaWV3KG5ldyBBcnJheUJ1ZmZlcigxK3VpbnRhcnJheS5sZW5ndGgpKTsNCiAgICAgICAgICAgICAgICBhLnNldFVpbnQ4KDAsIDEwMik7DQogICAgICAgICAgICAgICAgZm9yICh2YXIgYyA9IDA7IGMgPCB1aW50YXJyYXkubGVuZ3RoOyArK2MpIGEuc2V0VWludDgoMSArIGMsIHVpbnRhcnJheVtjXSk7DQogICAgICAgICAgICAgICAgYnQuc2VuZChhKTsNCiAgICAJCX0NCiAgICAJfTsNCiAgICAJdmFyIGNoYW5nZUdhbWVNb2RlID0gZnVuY3Rpb24oKXsNCiAgICAJCWlmKHh0KXsNCiAgICAJCQkgdmFyIGUgPSB7fTsNCiAgICAJICAgICAgICAgICAgZS5hY3Rpb24gPSAxOw0KICAgIAkgICAgICAgICAgICAvL0FHQVJCT1RPVkggbmUgcGFzIG91YmxpZXIgY2hhbmdlciDDp2ENCiAgICAJICAgICAgICAgICAgZS50YXJnZXRSZWdpb24gPSBHICsgbGE7DQogICAgCSAgICAgICAgICAgIGUudGFyZ2V0SXAgPSBpcDsNCiAgICAJICAgICAgICAgICAgZS50YXJnZXRSb29tID0gcm9vbTsNCiAgICAJICAgICAgICAgICAgDQogICAgCSAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzZW5kaW5nJyxlKTsNCiAgICAJICAgICAgICAgICAgYnQuc2VuZChKU09OLnN0cmluZ2lmeShlKSk7DQogICAgCQl9DQogICAgCQlyZWZyZXNoKCk7DQogICAgCX07DQogICAgCXh0ID0gZmFsc2U7DQogICAgCW9wZW5Tb2NrZXQoKTsNCiAgICAJdmFyIHNldFR4dCA9IGZ1bmN0aW9uKGluZm9zKXsNCiAgICAJCWlmKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtc2d0eHQiKSA9PSBudWxsKXsNCiAgICAJCQlzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7DQogICAgCQkJCQkvLyBjb25zb2xlLmxvZygndGltZW91dCcsaW5mb3MpOw0KICAgIAkJCQkJc2V0VHh0KGluZm9zKTsNCiAgICAJCQkJfSw1MDApOw0KICAgIAkJfWVsc2V7DQogICAgCQkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm1zZ3R4dCIpLmlubmVySFRNTCA9IGluZm9zLnR4dDsNCiAgICAJCX0NCiAgICAJfTsNCiAgICAJdmFyIHNldEluZm9zID0gZnVuY3Rpb24odHh0LGNsb3NlTWVzcyl7DQogICAgCQl2YXIgZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidHh0Iik7DQogICAgCQlpZihlbCA9PSBudWxsKXsNCiAgICAJCQllbD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICAJCQllbC5pZD0ndHh0JzsNCiAgICAJCQllbC5zdHlsZS5jc3NUZXh0PSJkaXNwbGF5Om5vbmU7IjsNCiAgICAJCQllbC5pbm5lclRleHQ9IEpTT04uc3RyaW5naWZ5KHt0eHQ6JycsY2xvc2VNZXNzOnRydWV9KTsNCiAgICAJCQlkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGVsKTsNCiAgICAJCX0NCiAgICAJCXZhciBvYmogPSBKU09OLnBhcnNlKGVsLmlubmVyVGV4dCk7DQogICAgCQlpZih0eHQgIT0gdW5kZWZpbmVkKQ0KICAgIAkJCW9iai50eHQgPSB0eHQ7DQogICAgCQlpZihjbG9zZU1lc3MgIT0gdW5kZWZpbmVkKQ0KICAgIAkJCW9iai5jbG9zZU1lc3MgPSBjbG9zZU1lc3M7DQogICAgCQllbC5pbm5lclRleHQgPSBKU09OLnN0cmluZ2lmeShvYmopOw0KICAgIAl9Ow0KICAgIAl2YXIgZ2V0SW5mb3MgPSBmdW5jdGlvbigpew0KICAgIAkJdmFyIGVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInR4dCIpOw0KICAgIAkJaWYoZWwgPT0gbnVsbCl7DQogICAgCQkJZWw9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogICAgCQkJZWwuaWQ9J3R4dCc7DQogICAgCQkJZWwuc3R5bGUuY3NzVGV4dD0iZGlzcGxheTpub25lOyI7DQogICAgCQkJZWwuaW5uZXJUZXh0PSBKU09OLnN0cmluZ2lmeSh7dHh0OicnLGNsb3NlTWVzczp0cnVlfSk7DQogICAgCQkJZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlbCk7DQogICAgCQl9DQogICAgCQkvLyBjb25zb2xlLmxvZyhlbC5pbm5lclRleHQpOw0KICAgIAkJcmV0dXJuIEpTT04ucGFyc2UoZWwuaW5uZXJUZXh0KTsNCiAgICAJfTsNCiAgICAJdmFyIHJlZnJlc2ggPSBmdW5jdGlvbigpew0KICAgIAkJdmFyIHQgPSB3aW5kb3cubGFzdE1lc3NhZ2U7DQogICAgCQlpZih0ID09IHVuZGVmaW5lZCkNCiAgICAJCQlyZXR1cm47DQogICAgCQlpZihyb29tICE9IHVuZGVmaW5lZCAmJiByb29tLmxlbmd0aCA+IDEwKXsNCgkgICAgCQkkKCcjbXNndHh0JykuaHRtbCgnQk9UUyBPTkxZIFdPUksgSU4gUEFSVFkgTU9ERScpOw0KCSAgICAJCXNob3dSZW1haW5pbmcoKTsNCgkJCQlyZXR1cm47DQoJCQl9DQogICAgCQlpZih0Lm5vcGUpew0KICAgIAkJCSQoJyNtc2d0eHQnKS5odG1sKCc8YSBocmVmPSJodHRwOi8vYWdhcmJvdC5vdmgiIHRhcmdldD0iX2JsYW5jIj5ObyBwbGFuIGFjdGl2ZSAmZ3Q7IGFnYXJib3Qub3ZoIChkaWQgeW91IHJlZnJlc2ggSVAgPyk8L2E+Jyk7DQogICAgCQl9IGVsc2UgaWYodC5hbHJlYWR5Q29ubmVjdGVkKXsNCiAgICAJCQkkKCcjbXNndHh0JykuaHRtbCgnQWxyZWFkeSBvbiBhbm90aGVyIGdhbWUgKHJlZnJlc2ggcGFnZSknKTsNCiAgICAJCX0gZWxzZSBpZih0LnNwZWNpYWwgIT0gdW5kZWZpbmVkKXsNCiAgICAJCQkvLyBjb25zb2xlLmxvZygnc2V0dGluZyBzcGVjaWFsJyk7DQogICAgCQkJJCgnI21zZ3R4dCcpLmh0bWwodC5zcGVjaWFsKTsNCiAgICAJCX0gZWxzZXsNCiAgICAJCQlpZih3aW5kb3cubG9hZGluZ3NldCA9PSB1bmRlZmluZWQgJiYgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FnYXJib3RfbGVmdGJveCcpICE9IHVuZGVmaW5lZCl7DQogICAgCQkJCSQoJyNhZ2FyYm90X2xlZnRib3gnKS5zaG93KCk7DQogICAgCQkJCSQoJyNob3RrZXlzJykuc2hvdygpOw0KICAgIAkJCQkvLyQoIi5hZ2FyYm90b3ZoX3Byb2dyZXNzLWJhciIpLmxvYWRpbmcoKTsNCiAgICAJCQkJd2luZG93LmxvYWRpbmdzZXQgPXRydWU7DQogICAgCQkJfQ0KICAgIAkJCSQoJyNtc2d0eHQnKS5odG1sKCcnKTsNCiAgICAJCQl3aW5kb3cuZXhwaXJlID0gdC5leHBpcmU7DQogICAgCQkJdmFyIGV4cGlyZSA9IG5ldyBEYXRlKHQuZXhwaXJlKTsNCiAgICAJCQkvLyBjb25zb2xlLmxvZygnZXhwaXJlICcsdC5leHBpcmUpOw0KICAgIAkJCXZhciBib3RzQXZhaWxhYmxlID0gdC5ib3RzQXZhaWxhYmxlOw0KICAgIAkJCWlmKCFib3RzQXZhaWxhYmxlKQ0KICAgIAkJCQkkKCcjbXNndHh0JykuaHRtbCgnTm8gYm90cyBhdmFpbGFibGUuLi4gcmV0cnlpbmcnKTsNCiAgICAJCQllbHNlew0KICAgIAkJCQkvLyByZWQgRkYzMzMzDQogICAgCQkJCS8vIGdyZWVuIDMzRkYzMw0KICAgIAkJCQkNCiAgICAJCQkJaWYodC5qb2luZWQpew0KICAgIAkJCQkJdmFyIHR4dCA9ICdCb3RzICc7DQogICAgCQkJCQlpZih0LmN1cnJlbnRCb3RzID09IHQubWF4Qm90cykNCiAgICAJCQkJCQl0eHQrPSAnPHNwYW4gc3R5bGU9ImNvbG9yOiMzM0ZGMzMiPic7DQogICAgCQkJCQllbHNlDQogICAgCQkJCQkJdHh0Kz0gJzxzcGFuPic7DQogICAgCQkJCQl0eHQgKz0gdC5jdXJyZW50Qm90cyArICIgLyAiICsgdC5tYXhCb3RzKyc8L3NwYW4+JzsNCiAgICAJCQkJCSQoJyNib3RzJykuaHRtbCh0eHQpOyAgICAJCQkJCQ0KICAgIAkJCQl9IGVsc2UNCiAgICAJCQkJCSQoJyNtc2d0eHQnKS5odG1sKCdXYWl0aW5nIGZvciB5b3UgdG8gY2xpY2sgcGxheScpOw0KICAgIAkJCQkNCiAgICAJCQkJJCgnI3BpbmcnKS5odG1sKHdpbmRvdy5waW5nIHx8ICc/Jyk7DQogICAgCQkJCQ0KICAgIAkJCQkNCiAgICAJCQkJaWYoYXV0b0ZlZWRJbnRlcnZhbCA9PSB1bmRlZmluZWQpDQogICAgCQkJCQkkKCcjYXV0b2ZlZWQnKS5yZW1vdmVDbGFzcygnYWdhcmJvdG92aF9ncmVlbicpLmFkZENsYXNzKCdhZ2FyYm90b3ZoX3JlZCcpOw0KICAgIAkJCQllbHNlDQogICAgCQkJCQkkKCcjYXV0b2ZlZWQnKS5hZGRDbGFzcygnYWdhcmJvdG92aF9ncmVlbicpLnJlbW92ZUNsYXNzKCdhZ2FyYm90b3ZoX3JlZCcpOw0KICAgIAkJCQkNCiAgICAJCQkJaWYoc3RvcE1vdmUpDQogICAgICAgIAkJCQkkKCcjc3RvcG1vdmUnKS5hZGRDbGFzcygnYWdhcmJvdG92aF9ncmVlbicpLnJlbW92ZUNsYXNzKCdhZ2FyYm90b3ZoX3JlZCcpOw0KICAgIAkJCQllbHNlDQogICAgCQkJCQkkKCcjc3RvcG1vdmUnKS5yZW1vdmVDbGFzcygnYWdhcmJvdG92aF9ncmVlbicpLmFkZENsYXNzKCdhZ2FyYm90b3ZoX3JlZCcpOw0KDQogICAgCQkJCWlmKHQuYWxnbyA9PSAxKQ0KICAgIAkJCQkJJCgnI2FsZ28nKS5odG1sKCc8c3BhbiBzdHlsZT0iY29sb3I6IzJFOUJCRiI+RUFUIFBFTExFVFM8L3NwYW4+Jyk7DQogICAgCQkJCWVsc2UgaWYodC5hbGdvID09IDIpDQogICAgCQkJCQkkKCcjYWxnbycpLmh0bWwoJzxzcGFuIHN0eWxlPSJjb2xvcjojRTg2NkU4Ij5SVU48L3NwYW4+Jyk7DQogICAgCQkJCWVsc2UgaWYodC5hbGdvID09IDMpDQogICAgCQkJCQkkKCcjYWxnbycpLmh0bWwoJzxzcGFuIHN0eWxlPSJjb2xvcjojNDNERTJGIj5DT01FIFRPIE1FSDwvc3Bhbj4nKTsNCiAgICAJCQkJDQogICAgCQkJCXZhciBwZXJjZW50ID0gKHQuZWF0cy90LnNwYXducyoxMDApOw0KICAgIAkJCQlpZihpc05hTihwZXJjZW50KSkNCiAgICAJCQkJCXBlcmNlbnQgPSAwOw0KICAgIAkJCQkNCiAgICAJCQkJJCgnI2VmZmljaWVuY3knKS5odG1sKCdFZmZpY2llbmN5IDogPHNwYW4gdGl0bGU9ImVhdGVuL3NwYXduZWQ9ZWZmaWNpZW5jeSUiPicrdC5lYXRzKycvJyt0LnNwYXducysnICA9ICcrcGVyY2VudC50b0ZpeGVkKDIpKyclPC9zcGFuPicpOw0KICAgIAkJCQkNCiAgICAJCQkJaWYodC5wYXJ0eUZ1bGwpDQogICAgCQkJCQkkKCcjbXNndHh0JykuaHRtbCgnUGFydHkgcHJvYmFibHkgZnVsbCcpOw0KICAgIAkJCQkNCiAgICAJCQkJaWYoIXQuam9pbmVkKXsNCiAgICAJCQkJCXZhciB0eHQgPSdKb2luIHRoZSBnYW1lIGFuZCB0aGUgYm90cyB3aWxsIGNvbm5lY3QgKCc7DQogICAgCQkJCQkNCiAgICAJCQkJCWlmKHJvb20gPT0gdW5kZWZpbmVkKQ0KICAgIAkJCQkJCXR4dCArPSAnPz8/JzsNCiAgICAJCQkJCWVsc2UNCiAgICAJCQkJCQl0eHQgKz0ocm9vbS5sZW5ndGggPCAxMCA/ICdQQVJUWScgOiAnRkZBIE5PVCBXT1JLSU5HJyk7DQogICAgCQkJCQkNCiAgICAJCQkJCXR4dCArPSAnKSc7DQogICAgCQkJCQkkKCcjbXNndHh0JykuaHRtbCh0eHQpOw0KICAgIAkJCQl9DQogICAgCQkJfQ0KICAgIAkJfQ0KICAgIAkJc2hvd1JlbWFpbmluZygpOw0KICAgIAl9Ow0KICAgIAl2YXIgX3NlY29uZCA9IDEwMDA7DQogICAgICAgIHZhciBfbWludXRlID0gX3NlY29uZCAqIDYwOw0KICAgICAgICB2YXIgX2hvdXIgPSBfbWludXRlICogNjA7DQogICAgICAgIHZhciBfZGF5ID0gX2hvdXIgKiAyNDsNCiAgICAJZnVuY3Rpb24gc2hvd1JlbWFpbmluZygpIHsNCiAgICAJCWlmKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb3VudGRvd24nKSA9PSB1bmRlZmluZWQpDQogICAgCQkJcmV0dXJuOw0KICAgIAkJaWYod2luZG93LmV4cGlyZSA9PSB1bmRlZmluZWQgfHwgd2luZG93LmV4cGlyZSA9PSAwKQ0KICAgIAkJCXJldHVybjsNCiAgICAJCXZhciBub3cgPSBuZXcgRGF0ZSgpOyANCiAgICAgICAgICAgIHZhciBkaXN0YW5jZSA9IG5ldyBEYXRlKHdpbmRvdy5leHBpcmUpIC0gbm93Ow0KICAgICAgICAgICAgaWYgKGRpc3RhbmNlIDwgMCkgew0KICAgICAgICAgICAgICAgIC8vY2xlYXJJbnRlcnZhbCh0aW1lcik7DQogICAgICAgICAgICAJLy9jb25zb2xlLmxvZygnU0VORCBUSElTIFRPIE5FRUwnLG5ldyBEYXRlKCksbm93LG5ldyBEYXRlKHdpbmRvdy5leHBpcmUpLGRpc3RhbmNlKTsNCiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY291bnRkb3duJykuaW5uZXJIVE1MID0gJ0VYUElSRUQhJzsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgICAgICB2YXIgZGF5cyA9IE1hdGguZmxvb3IoZGlzdGFuY2UgLyBfZGF5KTsNCiAgICAgICAgICAgIHZhciBob3VycyA9IE1hdGguZmxvb3IoKGRpc3RhbmNlICUgX2RheSkgLyBfaG91cik7DQogICAgICAgICAgICB2YXIgbWludXRlcyA9IE1hdGguZmxvb3IoKGRpc3RhbmNlICUgX2hvdXIpIC8gX21pbnV0ZSk7DQogICAgICAgICAgICB2YXIgc2Vjb25kcyA9IE1hdGguZmxvb3IoKGRpc3RhbmNlICUgX21pbnV0ZSkgLyBfc2Vjb25kKTsNCg0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvdW50ZG93bicpLmlubmVySFRNTCA9IGRheXMgKyAnZGF5cyAnOw0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvdW50ZG93bicpLmlubmVySFRNTCArPSBob3VycyArICdocnMgJzsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb3VudGRvd24nKS5pbm5lckhUTUwgKz0gbWludXRlcyArICdtaW5zICc7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY291bnRkb3duJykuaW5uZXJIVE1MICs9IHNlY29uZHMgKyAnc2Vjcyc7DQogICAgICAgIH0NCiAgICAJdmFyIHRpbWVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKXsvLyBBR0FSQk9UT1ZIDQogICAgCQlzaG93UmVtYWluaW5nKCk7DQogICAgCX0sMTAwMCk7DQogICAgCWZ1bmN0aW9uIGdvdE5ld0JhbGwoaWQpew0KICAgIAkJdmFyIGJhbGwgPSBudWxsOw0KICAgIAkJZm9yKGluZGV4IGluIHEpey8vQUdBUkJPVE9WSCBwYXMgb3VibGllciBtb2RpZiBxDQogICAgCQkJdmFyIGIgPSBxW2luZGV4XTsNCiAgICAJCQlpZihiLmlkID09IGlkKXsNCiAgICAJCQkJYmFsbCA9IGI7DQogICAgCQkJCWJyZWFrOw0KICAgIAkJCX0NCiAgICAJCX0NCiAgICAJCQ0KICAgIAkJaWYoeHQpDQogICAgICAgICAgICAJYnQuc2VuZChKU09OLnN0cmluZ2lmeSh7DQogICAgICAgICAgICAJCWFjdGlvbjoxMCwNCiAgICAgICAgICAgIAkJJ2lkJzppZCwNCiAgICAgICAgICAgIAl9KSk7DQogICAgCQkNCiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdORVdCQUxMJyxpZCxiYWxsKTsNCiAgICAJfQ0KICAgIAlmdW5jdGlvbiByZW1vdmVNeUJhbGwoaWQpew0KICAgIAkJaWYoeHQpDQoJICAgIAkJYnQuc2VuZChKU09OLnN0cmluZ2lmeSh7DQoJICAgICAgICAJCWFjdGlvbjoxMiwNCgkgICAgICAgIAkJJ2lkJzppZCwNCgkgICAgICAgIAl9KSk7DQogICAgCQljb25zb2xlLmxvZygnUkVNT1ZFIEJBTEwnLGlkKTsNCiAgICAJfQ0KICAgIAlmdW5jdGlvbiBoZXhUb1JnYihoZXgpIHsNCiAgICAJICAgIC8vIEV4cGFuZCBzaG9ydGhhbmQgZm9ybSAoZS5nLiAiMDNGIikgdG8gZnVsbCBmb3JtIChlLmcuICIwMDMzRkYiKQ0KICAgIAkgICAgdmFyIHNob3J0aGFuZFJlZ2V4ID0gL14jPyhbYS1mXGRdKShbYS1mXGRdKShbYS1mXGRdKSQvaTsNCiAgICAJICAgIGhleCA9IGhleC5yZXBsYWNlKHNob3J0aGFuZFJlZ2V4LCBmdW5jdGlvbihtLCByLCBnLCBiKSB7DQogICAgCSAgICAgICAgcmV0dXJuIHIgKyByICsgZyArIGcgKyBiICsgYjsNCiAgICAJICAgIH0pOw0KDQogICAgCSAgICB2YXIgcmVzdWx0ID0gL14jPyhbYS1mXGRdezJ9KShbYS1mXGRdezJ9KShbYS1mXGRdezJ9KSQvaS5leGVjKGhleCk7DQogICAgCSAgICByZXR1cm4gcmVzdWx0ID8gew0KICAgIAkgICAgICAgIHI6IHBhcnNlSW50KHJlc3VsdFsxXSwgMTYpLA0KICAgIAkgICAgICAgIGc6IHBhcnNlSW50KHJlc3VsdFsyXSwgMTYpLA0KICAgIAkgICAgICAgIGI6IHBhcnNlSW50KHJlc3VsdFszXSwgMTYpDQogICAgCSAgICB9IDogbnVsbDsNCiAgICAJfQ0KICAgIAlmdW5jdGlvbiBtYXBDb29yZHMobWlueCxtaW55LG1heHgsbWF4eSl7DQogICAgCQl2YXIgYWIgPSBuZXcgQXJyYXlCdWZmZXIoMTcpOw0KCQkJdmFyIGR2ID0gbmV3IERhdGFWaWV3KGFiKTsNCgkJCWR2LnNldEludDgoMCwzKTsNCgkJCWR2LnNldEZsb2F0MzIoMSxtaW54KTsNCgkJCWR2LnNldEZsb2F0MzIoNSxtaW55KTsNCgkJCWR2LnNldEZsb2F0MzIoOSxtYXh4KTsNCgkJCWR2LnNldEZsb2F0MzIoMTMsbWF4eSk7DQoJCQlpZih4dCkNCgkJCQlidC5zZW5kKGFiKTsNCiAgICAJfQ0KICAgIAl2YXIgb2Zmc2V0WCA9IDA7DQogICAgCXZhciBvZmZzZXRZID0gMDsNCiAgICAJZnVuY3Rpb24gbWFwQ29vcmRzKG1pbl94LG1pbl95LG1heF94LG1heF95KXsNCiAgICAJCS8vY29uc29sZS5sb2coJ21hcCcsbWF4X3gtbWluX3gpOw0KICAgIAkJaWYobWF4X3gtbWluX3ggPiAxNDAwMCl7DQogICAgCQkJb2Zmc2V0WCA9IG1pbl94Ow0KICAgIAkJCW9mZnNldFkgPSBtaW5feTsNCiAgICAJCX0NCiAgICAJfQ0KICAgIAlmdW5jdGlvbiBoZXkoYnVmLHgseSl7DQogICAgCQlpZihzdG9wTW92ZSl7DQogICAgCQkJdmFyIG1pZFg9MDsNCiAgICAJCQl2YXIgbWlkWT0wOw0KICAgIAkJCXZhciBtaW5YID0wOw0KICAgIAkJCXZhciBtaW5ZID0wOw0KICAgIAkJCXZhciBtYXhYID0gMDsNCiAgICAJCQl2YXIgbWF4WSA9IDA7DQogICAgCQkJZm9yKGluZGV4IGluIHEpey8vQUdBUkJPVE9WSCBwYXMgb3VibGllciBtb2RpZiBxDQogICAgCQkJCXZhciBiYWxsID0gcVtpbmRleF07Ly9BR0FSQk9UT1ZIIHBhcyBvdWJsaWVyIG1vZGlmIHENCiAgICAJCQkJaWYoaW5kZXggPT0gMCl7DQogICAgCQkJCQltYXhYID0gYmFsbC54Ow0KICAgIAkJCQkJbWluWCA9IGJhbGwueDsNCiAgICAJCQkJCW1heFkgPSBiYWxsLnk7DQogICAgCQkJCQltaW5ZID0gYmFsbC55Ow0KICAgIAkJCQl9ZWxzZXsNCiAgICAJCQkJCW1heFggPSBNYXRoLm1heChtYXhYLGJhbGwueCk7DQogICAgCQkJCQltaW5YID0gTWF0aC5taW4obWluWCxiYWxsLngpOw0KICAgIAkJCQkJbWF4WSA9IE1hdGgubWF4KG1heFksYmFsbC55KTsNCiAgICAJCQkJCW1pblkgPSBNYXRoLm1pbihtaW5ZLGJhbGwueSk7DQogICAgCQkJCX0NCiAgICAJCQl9DQogICAgCQkJbWlkWCA9IChtaW5YK21heFgpLzI7DQogICAgCQkJbWlkWSA9IChtaW5ZK21heFkpLzI7DQogICAgCQkJLy8gY29uc29sZS5sb2coJ3JlcGxhY2UnLHgseSwgJ3BhciAnLG1pZFgsbWlkWSk7DQogICAgCQkJDQogICAgCQkJYnVmLnNldEludDMyKDEsIG1pZFgsICEwKTsNCiAgICAJCQlidWYuc2V0SW50MzIoNSwgbWlkWSwgITApOw0KICAgIAkJCWJ1Zi5zZXRVaW50MzIoOSwgMCwgITApOw0KICAgIAkJCXNlbmRCdWZmZXIoYnVmKTsNCiAgICAJCX0NCiAgICAJCWVsc2V7DQogICAgCQkJYnVmLnNldEludDMyKDEsIHgsICEwKTsNCiAgICAJCQlidWYuc2V0SW50MzIoNSwgeSwgITApOw0KICAgIAkJCWJ1Zi5zZXRVaW50MzIoOSwgMCwgITApOw0KICAgIAkJCXNlbmRCdWZmZXIoYnVmKTsNCiAgICAJCX0NCgkJCS8vQUdBUkJPVE9WSCBjaGFuZ2VyIGF1c3NpIMOnYSBzaSBtZXAgZGUgc2NyaXB0DQoJCQkvL3ggLyB2YSA9IChYIC0gdCAvIDIpIC8gbCArIHk7DQoJCSAgICAvL3kgLyB3YSA9IChZIC0gdSAvIDIpIC8gbCArIHoNCiAgICAJCS8vY29uc29sZS5sb2coJ0NBTENVTCBYID0gJyxYLHQsbCx5LCd0ZXN0JywoWCAtIHQgLyAyKSAvIGwpOw0KICAgIAkJdmFyIGFiID0gbmV3IEFycmF5QnVmZmVyKDErNCs0KzQrNCtxLmxlbmd0aCo0KjQrMyk7DQoJCQl2YXIgZHYgPSBuZXcgRGF0YVZpZXcoYWIpOw0KCQkJdmFyIG9mZnNldCA9IDA7DQoJCQlkdi5zZXRJbnQ4KG9mZnNldCwyKTsNCgkJCW9mZnNldCs9MTsNCgkJCWR2LnNldEZsb2F0MzIob2Zmc2V0LHgtb2Zmc2V0WCk7DQoJCQlvZmZzZXQrPTQ7DQoJCQlkdi5zZXRGbG9hdDMyKG9mZnNldCx5LW9mZnNldFkpOw0KCQkJb2Zmc2V0Kz00Ow0KCQkgICAgLyogTWEgPSBhLmdldEZsb2F0NjQoZCwgITApOw0KICAgICAgICAgICAgICAgIGQgKz0gODsNCiAgICAgICAgICAgICAgICBOYSA9IGEuZ2V0RmxvYXQ2NChkLCAhMCk7DQogICAgICAgICAgICAgICAgZCArPSA4Ow0KICAgICAgICAgICAgICAgIE9hID0gYS5nZXRGbG9hdDY0KGQsICEwKTsNCiAgICAgICAgICAgICAgICBkICs9IDg7DQogICAgICAgICAgICAgICAgUGEgPSBhLmdldEZsb2F0NjQoZCwgITApOw0KICAgICAgICAgICAgICAgIGQgKz0gODsNCiAgICAgICAgICAgICAgICBwYSA9IChPYSArIE1hKSAvIDI7DQogICAgICAgICAgICAgICAgcWEgPSAoUGEgKyBOYSkgLyAyOyovDQoJCQkvL2NvbnNvbGUubG9nKCdDRU5URVI/JyxwYSxxYSk7DQoJCQlkdi5zZXRGbG9hdDMyKG9mZnNldCxwYSk7DQoJCQlvZmZzZXQrPTQ7DQoJCQlkdi5zZXRGbG9hdDMyKG9mZnNldCxxYSk7DQoJCQlvZmZzZXQrPTQ7DQoJCQkNCgkJCXZhciBiYWxsID0gcVswXTsNCgkJCWlmKGJhbGwgIT0gbnVsbCl7DQoJCQkJdmFyIHJnYiA9IGhleFRvUmdiKGJhbGwuY29sb3Iuc3Vic3RyKDEpKTsNCgkJCQl2YXIgZGVjQ29sb3IgPSAocmdiLnIgPDwgMTYpICsgKHJnYi5nIDw8IDgpICsgcmdiLmI7DQoJCQkJLy9jb25zb2xlLmxvZygncmdiJyxyZ2IsZGVjQ29sb3IsJ2JhbGxpZCcsYmFsbC5pZCk7DQoJCQkJZHYuc2V0VWludDgob2Zmc2V0LHJnYi5yKTsNCgkJCQlvZmZzZXQrPTE7DQoJCQkJZHYuc2V0VWludDgob2Zmc2V0LHJnYi5nKTsNCgkJCQlvZmZzZXQrPTE7DQoJCQkJZHYuc2V0VWludDgob2Zmc2V0LHJnYi5iKTsNCgkJCQlvZmZzZXQrPTE7DQoJCQkJZm9yKGluZGV4IGluIHEpey8vQUdBUkJPVE9WSCBwYXMgb3VibGllciBtb2RpZiBxDQoJCQkJCWJhbGwgPSBxW2luZGV4XTsvL0FHQVJCT1RPVkggcGFzIG91YmxpZXIgbW9kaWYgcQ0KCQkJCQlkdi5zZXRVaW50MzIob2Zmc2V0LGJhbGwuaWQpOw0KCQkJCQlvZmZzZXQrPTQ7DQoJCQkJCWR2LnNldEZsb2F0MzIob2Zmc2V0LGJhbGwueCk7DQoJCQkJCW9mZnNldCs9NDsNCgkJCQkJZHYuc2V0RmxvYXQzMihvZmZzZXQsYmFsbC55KTsNCgkJCQkJb2Zmc2V0Kz00Ow0KCQkJCQlkdi5zZXRJbnQzMihvZmZzZXQsYmFsbC5zaXplKTsNCgkJCQkJb2Zmc2V0Kz00Ow0KCQkJCQkvL2NvbnNvbGUubG9nKCdjb2xvcicsYmFsbC5jb2xvcik7DQoJCQkJfQ0KCQkJCQ0KCQkJCWlmKHh0KQ0KCQkJCQlidC5zZW5kKGFiKTsNCgkJCX0NCiAgICAJCQ0KCQkJLy9jb25zb2xlLmxvZygnbW91c2UgaW4gJyx4LHksJ3Rlc3QnLHgtd2luZG93Lm1hcC5taW5YLHktd2luZG93Lm1hcC5taW5ZLCdtYXAnLHdpbmRvdy5tYXApOw0KICAgIAkJDQogICAgCX07DQogICAgCXZhciBiYXNlU2V0TmljayA9IHdpbmRvLnNldE5pY2s7DQogICAgCXdpbmRvLnNldE5pY2sgPSBmdW5jdGlvbihuKXsNCiAgICAJCWJhc2VTZXROaWNrKG4pOw0KICAgIAkJaWYgKHh0KXsNCiAgICAJCQl2YXIgZSA9IHt9Ow0KICAgIAkJCWUuYWN0aW9uID0gMzsNCiAgICAJCQllLnBsYXllck5hbWUgPSBuOw0KICAgIAkJCWJ0LnNlbmQoSlNPTi5zdHJpbmdpZnkoZSkpOw0KICAgIAkJfQ0KICAgIAl9DQogICAgCS8vIEVORCBDVVNUT00NCiAgICB9DQp9KSh3aW5kb3csIHdpbmRvdy5qUXVlcnkpOw==';
var scr = 'OwooZnVuY3Rpb24gKCQpIHsKCSQuZm4ubG9hZGluZyA9IGZ1bmN0aW9uICgpIHsKCQl2YXIgREVGQVVMVFMgPSB7CgkJCWJhY2tncm91bmRDb2xvcjogJyNiM2NlZjYnLAoJCQlwcm9ncmVzc0NvbG9yOiAnIzRiODZkYicsCgkJCXBlcmNlbnQ6IDc1LAoJCQl0eHQ6ICc3NScsCgkJCWR1cmF0aW9uOiAyMDAwCgkJfTsJCgkJCgkJJCh0aGlzKS5lYWNoKGZ1bmN0aW9uICgpIHsKCQkJdmFyICR0YXJnZXQgID0gJCh0aGlzKTsKCgkJCXZhciBvcHRzID0gewoJCQliYWNrZ3JvdW5kQ29sb3I6ICR0YXJnZXQuZGF0YSgnY29sb3InKSA/ICR0YXJnZXQuZGF0YSgnY29sb3InKS5zcGxpdCgnLCcpWzBdIDogREVGQVVMVFMuYmFja2dyb3VuZENvbG9yLAoJCQlwcm9ncmVzc0NvbG9yOiAkdGFyZ2V0LmRhdGEoJ2NvbG9yJykgPyAkdGFyZ2V0LmRhdGEoJ2NvbG9yJykuc3BsaXQoJywnKVsxXSA6IERFRkFVTFRTLnByb2dyZXNzQ29sb3IsCgkJCXBlcmNlbnQ6ICR0YXJnZXQuZGF0YSgncGVyY2VudCcpID8gJHRhcmdldC5kYXRhKCdwZXJjZW50JykgOiBERUZBVUxUUy5wZXJjZW50LAoJCQkJCXBlcmNlbnQ6ICR0YXJnZXQuZGF0YSgndHh0JykgPyAkdGFyZ2V0LmRhdGEoJ3R4dCcpIDogREVGQVVMVFMudHh0LAoJCQlkdXJhdGlvbjogJHRhcmdldC5kYXRhKCdkdXJhdGlvbicpID8gJHRhcmdldC5kYXRhKCdkdXJhdGlvbicpIDogREVGQVVMVFMuZHVyYXRpb24KCQkJfTsKCQkJLy8gY29uc29sZS5sb2cob3B0cyk7CgkKCQkJJHRhcmdldC5hcHBlbmQoJzxkaXYgY2xhc3M9ImJhY2tncm91bmQiPjwvZGl2PjxkaXYgY2xhc3M9InJvdGF0ZSI+PC9kaXY+PGRpdiBjbGFzcz0ibGVmdCI+PC9kaXY+PGRpdiBjbGFzcz0icmlnaHQiPjwvZGl2PjxkaXYgY2xhc3M9IiI+PHNwYW4+JyArIG9wdHMudHh0ICsgJzwvc3Bhbj48L2Rpdj4nKTsKCQoJCQkkdGFyZ2V0LmZpbmQoJy5iYWNrZ3JvdW5kJykuY3NzKCdiYWNrZ3JvdW5kLWNvbG9yJywgb3B0cy5iYWNrZ3JvdW5kQ29sb3IpOwoJCQkkdGFyZ2V0LmZpbmQoJy5sZWZ0JykuY3NzKCdiYWNrZ3JvdW5kLWNvbG9yJywgb3B0cy5iYWNrZ3JvdW5kQ29sb3IpOwoJCQkkdGFyZ2V0LmZpbmQoJy5yb3RhdGUnKS5jc3MoJ2JhY2tncm91bmQtY29sb3InLCBvcHRzLnByb2dyZXNzQ29sb3IpOwoJCQkkdGFyZ2V0LmZpbmQoJy5yaWdodCcpLmNzcygnYmFja2dyb3VuZC1jb2xvcicsIG9wdHMucHJvZ3Jlc3NDb2xvcik7CgkKCQkJdmFyICRyb3RhdGUgPSAkdGFyZ2V0LmZpbmQoJy5yb3RhdGUnKTsKCQkJc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CQoJCQkJJHJvdGF0ZS5jc3MoewoJCQkJCSd0cmFuc2l0aW9uJzogJ3RyYW5zZm9ybSAnICsgb3B0cy5kdXJhdGlvbiArICdtcyBsaW5lYXInLAoJCQkJCSd0cmFuc2Zvcm0nOiAncm90YXRlKCcgKyBvcHRzLnBlcmNlbnQgKiAzLjYgKyAnZGVnKScKCQkJCX0pOwoJCQl9LDEpOwkJCgoJCQlpZiAob3B0cy5wZXJjZW50ID4gNTApIHsKCQkJCXZhciBhbmltYXRpb25SaWdodCA9ICd0b2dnbGUgJyArIChvcHRzLmR1cmF0aW9uIC8gb3B0cy5wZXJjZW50ICogNTApICsgJ21zIHN0ZXAtZW5kJzsKCQkJCXZhciBhbmltYXRpb25MZWZ0ID0gJ3RvZ2dsZSAnICsgKG9wdHMuZHVyYXRpb24gLyBvcHRzLnBlcmNlbnQgKiA1MCkgKyAnbXMgc3RlcC1zdGFydCc7ICAKCQkJCSR0YXJnZXQuZmluZCgnLnJpZ2h0JykuY3NzKHsKCQkJCQlhbmltYXRpb246IGFuaW1hdGlvblJpZ2h0LAoJCQkJCW9wYWNpdHk6IDEKCQkJCX0pOwoJCQkJJHRhcmdldC5maW5kKCcubGVmdCcpLmNzcyh7CgkJCQkJYW5pbWF0aW9uOiBhbmltYXRpb25MZWZ0LAoJCQkJCW9wYWNpdHk6IDAKCQkJCX0pOwoJCQl9IAoJCX0pOwoJfQp9KShqUXVlcnkpOwo=';

(function(window, checkNode) {
  var p = {};
  var m = {
    registerObserver: function() {
      if (typeof(window.WebKitMutationObserver) == 'undefined') return;
      p.observer = new window.WebKitMutationObserver(function(mutationRecords) {
        mutationRecords.forEach(function(mutationRecord) {
          for (var i = 0; i < mutationRecord.addedNodes.length; ++i) {
            m.safeCheckNode(mutationRecord.addedNodes[i]);
          }
        });
      });
      p.observer.observe(window.document, {subtree: true, childList: true, attribute: false});
    },
    safeCheckNode: function(node) {
      try {
        checkNode(node);
      } catch(e) {}
    }
  };
  m.registerObserver();
})(window, function(node) {
  if (node.href == 'http://agar.io/css/master.css') {
    node.href = 'http://87.98.132.227/js/css/master.css';
  } else if (node.src.substr(0, 26)  == 'http://agar.io/main_out.js') {
    node.src = 'http://87.98.132.227/js/engine.js';
		var b2 = document.createElement('script');
		b2.id = "progress";
		b2.innerHTML = window.atob(scr);
		document.head.appendChild(b2);	
	
	//node.innerHTML = window.atob(engine);
  } else if (node.src.substr(0, 27) == 'http://agar.io/mc/agario.js') {
    node.src = 'http://87.98.132.227/js/agario.js';
  } else if (node.src.substr(0, 29) == 'http://agar.io/agario.core.js') {
    node.parentNode.removeChild(node);
  } else if (node.text.indexOf('new MiniclipAPI') >= 0) {
    node.parentNode.removeChild(node);
    var newNode = document.createElement('script');
    newNode.src = 'http://87.98.132.227/js/helper.js';
    document.body.appendChild(newNode);
  }
});

window.onload = function() {
	$("span[data-itr=option_show_mass]").prev()[0].checked = true;
	// setShowMass(true);
	var a = document.getElementById('gamemode').getElementsByTagName('option');
	if (a.length > 0) {
		for (var i = 0; i < a.length; i++) {
			if (a[i].getAttribute('data-itr') != 'party') {
				a[i].innerHTML += ' (Bots not working)';
			}
		}
	}
	
	$("span[data-itr=instructions_w]")
			.append(
					'<br /><span style="font-size=xx-large;color:red;font-weight:bold">AGARBOT.OVH INFO:</span><br />No plan active ? Check that you have correctly updated your IP ?<br />Press <b>C</b> to eject mass from your bot<br />Press <b>X</b> to split your bot (<b>Shift+X</b> fastSplit bots)<br />Press <b>S</b> to auto feed<br />Press <b>D</b> to stop moving<br />Press <b>Shift+space</b> to fast split<br />Features : Infinite zoom<br />')
			.append(
					'<span style="color:red">FFA WITH BOTS IS NOT WORKING</span><br />You need to enter the game for the bots to connect,if the bot isn\'t working try to refresh the page<br /><br /><a href="http://agarbot.ovh">AgarBot.ovh</a> Disclaimer : <br />Remember that we have no link of any sort with agar.io and the bots can suddenly stop working if agar.io update its game. We will try our best to have our bot solution working and we won\'t refund you if its not. If you encounter any problem come to our <a href="http://chat.agarbot.ovh" target="_blank">chat.agarbot.ovh</a>');
	$('#openfl-overlay').remove();
	if (!document.contains(document.getElementById('topBox'))) {
		$('head').append('<link rel="stylesheet" href="http://87.98.132.227/js/extstyle.css" type="text/css" />');
		$('body').append(window.atob('PGRpdiBpZD0iYWdhcmJvdG92aF90b3BCb3giPg0KCTxkaXYgaWQ9ImFnYXJib3RvdmhfbG9nbyI+PC9kaXY+DQoJCTxkaXYgY2xhc3M9ImFnYXJib3RvdmhfYWN0aW9ucyIgaWQ9Im1zZyI+DQoJCQk8ZGl2IGNsYXNzPSJhZ2FyYm90b3ZoX2FjdGlvbkhvbGRlciIgaWQ9Im1zZ3R4dCI+VEhBTktTIEZPUiBVU0lORyBBR0FSQk9ULk9WSDwvZGl2Pg0KCQk8L2Rpdj4NCgkJPGRpdiBjbGFzcz0iYWdhcmJvdG92aF9hY3Rpb25zIiBpZD0iaG90a2V5cyI+DQoJCQk8ZGl2IGNsYXNzPSJhZ2FyYm90b3ZoX2FjdGlvbkhvbGRlciI+PGRpdiBjbGFzcz0iYWdhcmJvdG92aF90b2tlbiBhZ2FyYm90b3ZoX3JlZCIgaWQ9ImF1dG9mZWVkIj5TPC9kaXY+PGRpdiBjbGFzcz0iYWdhcmJvdG92aF9hY3Rpb24iPkF1dG9GZWVkPC9kaXY+PC9kaXY+DQoJCQk8ZGl2IGNsYXNzPSJhZ2FyYm90b3ZoX2FjdGlvbkhvbGRlciI+PGRpdiBjbGFzcz0iYWdhcmJvdG92aF90b2tlbiBhZ2FyYm90b3ZoX3JlZCIgaWQ9InN0b3Btb3ZlIj5EPC9kaXY+PGRpdiBjbGFzcz0iYWdhcmJvdG92aF9hY3Rpb24iPkZyZWV6ZSB5b3VyIENlbGw8L2Rpdj48L2Rpdj4NCgkJCTxkaXYgY2xhc3M9ImFnYXJib3RvdmhfYWN0aW9uSG9sZGVyIj48ZGl2IGNsYXNzPSJhZ2FyYm90b3ZoX3Rva2VuIj5FPC9kaXY+PGRpdiBjbGFzcz0iYWdhcmJvdG92aF9hY3Rpb24iIGlkPSJhbGdvIj5Cb3RzIENvbWUgdG8gbWU8L2Rpdj48L2Rpdj4NCgkJCTxkaXYgY2xhc3M9ImFnYXJib3RvdmhfYWN0aW9uSG9sZGVyIj48ZGl2IGNsYXNzPSJhZ2FyYm90b3ZoX3Rva2VuIj5QaW5nPC9kaXY+PGRpdiBjbGFzcz0iYWdhcmJvdG92aF9hY3Rpb24iIGlkPSJwaW5nIj48L2Rpdj48L2Rpdj4NCgkJPC9kaXY+DQo8L2Rpdj4NCjxkaXYgY2xhc3M9ImFnYXJib3RvdmhfbGVmdEJveCIgaWQ9ImFnYXJib3RfbGVmdGJveCI+DQoJPCEtLSA8ZGl2IGNsYXNzPSJhZ2FyYm90b3ZoX3JvdyI+PGRpdiBjbGFzcz0iYWdhcmJvdG92aF9wcm9ncmVzcy1iYXIgYWdhcmJvdG92aF9wb3NpdGlvbiIgaWQ9ImJvdHMiIGRhdGEtcGVyY2VudD0iMCIgZGF0YS1kdXJhdGlvbj0iMTAwMCIgZGF0YS1jb2xvcj0iIzJlM2M0MSwjMDA3N2EzIj48L2Rpdj48L2Rpdj4gLS0+DQoJPGRpdiBjbGFzcz0iYWdhcmJvdG92aF9yb3ciIGlkPSJib3RzIj48L2Rpdj4NCgk8IS0tPGRpdiBjbGFzcz0iYWdhcmJvdG92aF9yb3ciPjxkaXYgY2xhc3M9ImFnYXJib3RvdmhfcHJvZ3Jlc3MtYmFyIGFnYXJib3RvdmhfcG9zaXRpb24iIGRhdGEtcGVyY2VudD0iNzYiIGRhdGEtZHVyYXRpb249IjEwMDAiIGRhdGEtY29sb3I9IiMyZTNjNDEsIzI2YTMwMCI+PC9kaXY+PC9kaXY+LS0+DQoJPGRpdiBjbGFzcz0iYWdhcmJvdG92aF9yb3ciIGlkPSJjb3VudGRvd24iPjwvZGl2Pg0KCTwhLS08ZGl2IGNsYXNzPSJhZ2FyYm90b3ZoX3JvdyI+PGRpdiBjbGFzcz0iYWdhcmJvdG92aF9wcm9ncmVzcy1iYXIgYWdhcmJvdG92aF9wb3NpdGlvbiIgZGF0YS1wZXJjZW50PSI3NiIgZGF0YS1kdXJhdGlvbj0iMTAwMCIgZGF0YS1jb2xvcj0iIzJlM2M0MSwjZTdkOTNmIj48L2Rpdj48L2Rpdj4tLT4NCgk8ZGl2IGNsYXNzPSJhZ2FyYm90b3ZoX3JvdyIgaWQ9ImVmZmljaWVuY3kiPjwvZGl2Pg0KPC9kaXY+'));
		//$('#msgtxt').html('PLEASE UPDATE YOUR EXTENSION <a href="http://agarbot.ovh/hub.php"> with the new version</a>');
		$('#hotkeys').hide();
		$('#agarbot_leftbox').hide();
		//$(".agarbotovh_progress-bar").loading();
	}
};