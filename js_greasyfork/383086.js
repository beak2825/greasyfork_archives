// ==UserScript==
// @name          Eternity Tower Energy Minder
// @icon          https://www.eternitytower.net/favicon.png
// @namespace     Energy-Minder
// @version       1.0.7
// @description   Minds Energy usage and gives quick access to increasing food consumption
// @match         *://*.eternitytower.net/*
// @author        b0ing0, with framework from meancloud/psouza4@gmail.com
// @copyright     b0ing0
// @grant         GM_addStyle
// @downloadURL https://update.greasyfork.org/scripts/383086/Eternity%20Tower%20Energy%20Minder.user.js
// @updateURL https://update.greasyfork.org/scripts/383086/Eternity%20Tower%20Energy%20Minder.meta.js
// ==/UserScript==


////////////////////////////////////////////////////////////////
////////////// ** SCRIPT GLOBAL INITIALIZATION ** //////////////
function startup() { ET_EnergyMinderMod.StartUp(); }
////////////////////////////////////////////////////////////////


ET_EnergyMinderMod = {
    StartUp: function() {
        ET.MCMF.Loaded(function() {
            ET_EnergyMinderMod.TestUI();

            ET.MCMF.Ready(function() {
                setInterval(ET_EnergyMinderMod.UpdateMetrics, 250);
            });
        }, "Energy Minder mod");
    },

    WhatAreWeEating: function() {
        let whatWereEating = undefined;

        try {
            jQ.makeArray(Meteor.connection._stores.combat._getCollection().findOne({'owner' : Meteor.userId()}).buffs).forEach((thisBuff) => {
                if ((thisBuff.data.duplicateTag === "eatingFood") && (thisBuff.id.indexOf("food_") === 0)) {
                    whatWereEating = thisBuff;
                }
            });
        }
        catch (err) {
        }

        return whatWereEating;
    },

    IsEatingAnything: function() {
        return (ET_EnergyMinderMod.WhatAreWeEating() !== undefined);
    },

    IsEatingThis: function(item) {
        const whatWeAreEating = ET_EnergyMinderMod.WhatAreWeEating();

        return (whatWeAreEating ? (whatWeAreEating.id.substring(5).replace("-", "_") === item.replace("-", "_")) : false);
    },

    EatingDuration: function() {
        const whatWeAreEating = ET_EnergyMinderMod.WhatAreWeEating();

        if (whatWeAreEating) {
            try {
                const endDate = new Date(whatWeAreEating.data.endDate);
                const timeLeft = ((endDate) > (new Date())) ? CDbl(Math.abs(endDate - (new Date())) / 1000.0) : 0.0;

                if (timeLeft > 0.0) {
                  return timeLeft;
                }
            } catch (err) {
            }
        }

        return 0.0;
    },

    GetPlayerEnergy: function() {
        const playerUnitData = Meteor.connection._stores.combat._getCollection().findOne({'owner' : Meteor.userId()});

        return ((playerUnitData && playerUnitData.stats) ? CInt(playerUnitData.stats.energy) : 0);
    },

    UpdateMetrics: function() {
        try {
            jQ("#em-energy-val").text(ET_EnergyMinderMod.GetPlayerEnergy());

            const currentFoodDuration = CDbl(ET_EnergyMinderMod.EatingDuration());

            (['lemonade', 'lemon-honey', 'rockmelon', 'lemon']).forEach((thisFood) => {
                if (jQ(`#em-energy-${thisFood}-text`).length === 1) {
                    jQ(`#em-energy-${thisFood}-text`).text(Math.ceil(currentFoodDuration));
                }

                const foodData = Meteor.connection._stores.items._getCollection().findOne({'name' : thisFood.replace('-', ' ')});
                if (foodData) {
                  ET_EnergyMinderMod.CreateTooltip(`em-energy-${thisFood}`, foodData.name, CInt(foodData.amount));
                }
            });

            ET_EnergyMinderMod.Enable_Energy_Buttons((!ET_EnergyMinderMod.IsEatingAnything()) || (currentFoodDuration <= 0));
        }
        catch (err) {
          ET.MCMF.Log(err);
        }
    },

    CreateTooltip: function(elementTarget, foodName, foodQuantity) {
        oEl = jQ(`#${elementTarget}`).get(0);
        if (!oEl) {
            return;
        }

        oElCount = jQ(`#tooltip-quantity-${elementTarget}`);
        if (oElCount.length > 0) {
            if (CInt(oElCount.text()) == foodQuantity) {
                return;
            }
        }

        if (oEl._tippy) {
            oEl._tippy.destroy();
        }

        jQ(`#tooltip-${elementTarget}`).remove();
        jQ("body").append(`<div class="item-tooltip-content my-tooltip-inner" id="tooltip-${elementTarget}"></div>`);

        jQ(`#tooltip-${elementTarget}`).html(
            "    <h3 class=\"popover-title\">" +
            "        Energy Minder Mod" +
            "    </h3>" +
            "    <div class=\"popover-content\">" +
            ((foodQuantity == 0) ? ("You are out of <b>" + foodName + "</b>!") : ("You have <b>" + foodQuantity + "</b> <b>" + foodName + "</b> remaining.")) +
            `        <span style="display: none; visibility: hidden;" id="tooltip-quantity-${elementTarget}">${foodQuantity}</span>` +
            "    </div>"
        );

        tippy(`#${elementTarget}`, {
            html: jQ(`#tooltip-${elementTarget}`)[0],
            performance: !0,
            animateFill: !1,
            distance: 5
        });
    },

    Enable_Energy_Buttons: function(wantEnabled) {
        const enabledClass  = "btn-success";
        const disabledClass = "btn-danger btn-default";

        (['lemonade', 'lemon-honey', 'rockmelon', 'lemon']).forEach((thisFood) => {
            const oEl = jQ(`#em-energy-${thisFood}`);
            if (oEl.length > 0) {
                //oEl.prop('disabled', !wantEnabled); // disabled for now, we can't use tippy tooltips on disabled DOM elements
                oEl.removeClass((wantEnabled) ? disabledClass : enabledClass).addClass((wantEnabled) ? enabledClass : disabledClass);
                if (wantEnabled) {
                    jQ(`#em-energy-${thisFood}-icon`).removeClass( "em-icon-hidden" ).addClass( `em-icon-${thisFood}` );
                    jQ(`#em-energy-${thisFood}-text`).removeClass( "em-energy-text" ).addClass( "em-energy-text-hidden" );
                } else if (ET_EnergyMinderMod.IsEatingThis(thisFood)) {
                    jQ(`#em-energy-${thisFood}-icon`).removeClass( `em-icon-${thisFood}` ).addClass( "em-icon-hidden" );
                    jQ(`#em-energy-${thisFood}-text`).removeClass( "em-energy-text-hidden" ).addClass( "em-energy-text" );
                }
            };
        });
    },

    EatFood: function(foodName) {
        try {
            const foodData = Meteor.connection._stores.items._getCollection().findOne({'name': foodName});

            Package.meteor.Meteor.call("items.eat", foodData._id, foodData.itemId, (err, res) => {
                if (err) {
                    ET.MCMF.ToastMessageWarning(`Couldn't eat ${foodName}.  ${err.reason}.`);
                } else if (!ET_EnergyMinderMod.IsEatingAnything() && (foodName !== 'lemonade')) {
                    ET.MCMF.ToastMessageWarning(`Couldn't eat ${foodName}.  You may be out of ${foodName}.`);
                }
            });
        } catch (err) {
        }
    },

    TestUI: function() {
        if (jQ("#em-energy").length > 0) {
            return; // if the UI exists, don't test for it again
        }

        if (jQ("#navbarSupportedContent").length > 0) {
            ET_EnergyMinderMod.CreateUI();
        }

        setTimeout(ET_EnergyMinderMod.TestUI, 1000); // keep testing the UI for existence and create it until it exists
    },

    CreateUI: function() {
        GM_addStyle('.em-button { opacity:1 }');
        GM_addStyle('.em-icon { background-size:cover;display:inline-block;height:24px;width:24px; }');
        GM_addStyle('.em-icon-hidden { background-image:none }');
        GM_addStyle('.em-icon-lemonade { background-image:url("data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjZmZmZmZmIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIiB4PSIwcHgiIHk9IjBweCI+PHRpdGxlPkxlbW9uYWRlPC90aXRsZT48cGF0aCBkPSJNNzguMTYsNTcuNDFsLTItMTUuNGE3LjYsNy42LDAsMCwwLTcuNTktNy40OEg2MS44NmwtLjE3LTEuNzUsMS40NC03LjkyYTEuNDcsMS40NywwLDAsMC0xLjQ1LTEuNzNIMzUuODNsLTUuNDYtMi4zMWExLjQ3LDEuNDcsMCwwLDAtLjU3LS4xMkgyMy4yOWExLjQ3LDEuNDcsMCwwLDAtMS4xMiwyLjQybDguNTYsMTBMMjYuOSw3Mi40N2E2LjIyLDYuMjIsMCwwLDAsNi4yLDYuODNINTkuMzZhNi4yMiw2LjIyLDAsMCwwLDYuMi02LjgzTDYyLjcyLDQzLjM0aDQuNjNsMiwxNC4zN2E0LjQxLDQuNDEsMCwwLDAsOC44MS0uMTFBMS40OCwxLjQ4LDAsMCwwLDc4LjE2LDU3LjQxWk01MC44MSw0OC41NGwtLjg5LjM2TDQ5LjU2LDQ4bC44OS0uMzZabS02LjcxLTRhMS40NywxLjQ3LDAsMCwwLTEuMjYtMS4zMkwzOSw0Mi42N2ExLjQ3LDEuNDcsMCwwLDAtMS42MSwxLDI5Ljc2LDI5Ljc2LDAsMCwxLTQuMjgtMS4xNmMyLjY4LTEuNSw2LTEuMjEsNy45Mi0uODdhNDYsNDYsMCwwLDEsNS4zNCwxLjQyYy44NC4yNiwxLjY5LjUyLDIuNTYuNzZ2LjcxbC0xLjgyLDBDNDYuMDcsNDQuNiw0NS4wNyw0NC41Nyw0NC4wOSw0NC41MlpNNDAsNDUuNzhsLjk1LjEzLS4xMy45NS0uOTUtLjEzWk0zMy41OSwzNC4xMkg1OC44N2wuNyw3LjE1YTEwLjQ1LDEwLjQ1LDAsMCwxLTMuODMuNzFWNDAuODdhMS40NywxLjQ3LDAsMCwwLTEuNDctMS40N2gtMy45YTEuNDcsMS40NywwLDAsMC0xLjQ3LDEuNGwtMS43LS41MmE0OC45Miw0OC45MiwwLDAsMC01LjY5LTEuNSwxNiwxNiwwLDAsMC04LjQzLjUyWk01MS44NCw0My4zdi0xaDF2MVpNMjkuNSwyMy42NCwzNSwyNS45NWExLjQ3LDEuNDcsMCwwLDAsLjU3LjEySDU5LjkyTDU5LDMxLjE4SDMyLjkzbC02LjQ1LTcuNTRaTTYxLjgsNzUuMjhhMy4yNSwzLjI1LDAsMCwxLTIuNDMsMS4wOEgzMy4wOWEzLjI5LDMuMjksMCwwLDEtMy4yNy0zLjYxbDIuNjYtMjcuMjlhMzMuMTksMzMuMTksMCwwLDAsNC40NiwxLjE2bC0uMTYsMS4xNkExLjQ3LDEuNDcsMCwwLDAsMzgsNDkuNDRMNDEuOSw1MGguMmExLjQ3LDEuNDcsMCwwLDAsMS40NS0xLjI3bC4xOC0xLjI3Yy44MiwwLDEuNjUuMDcsMi40OS4wOGExLjQ3LDEuNDcsMCwwLDAsLjA2LjIxbDEuNDUsMy42MmExLjQ3LDEuNDcsMCwwLDAsMS45MS44MmwzLjYyLTEuNDVhMS40NywxLjQ3LDAsMCwwLC44Mi0xLjkxbC0uNjQtMS42MUE0My4zNCw0My4zNCwwLDAsMCw2MCw0NmwyLjYxLDI2Ljc1QTMuMjUsMy4yNSwwLDAsMSw2MS44LDc1LjI4Wm0xMi0xNi4yMUExLjQ3LDEuNDcsMCwwLDEsNzIuMyw1Ny42YTEuNDcsMS40NywwLDAsMCwwLS4ybC0yLTE0LjY0YTIuNDgsMi40OCwwLDAsMC0yLjQ4LTIuMzZINjIuNDNsLS4yOS0yLjk0aDYuMzlhNC42NSw0LjY1LDAsMCwxLDQuNjUsNC42NSwxLjQ4LDEuNDgsMCwwLDAsMCwuMTlsMiwxNS4zOEExLjQ3LDEuNDcsMCwwLDEsNzMuNzcsNTkuMDdaTTUwLjkzLDU2LjE2QTEuNDcsMS40NywwLDAsMCw1MCw1NC4zTDM1LjQ2LDQ5LjM2YTEuNDcsMS40NywwLDAsMC0xLjg2LjkyLDkuMTYsOS4xNiwwLDEsMCwxNy4zNCw1Ljg4Wk0zNi4wNyw1Mi42N2wzLjE4LDEuMDgtMi42NywyQTYuMTYsNi4xNiwwLDAsMSwzNi4wNyw1Mi42N1ptMi4yOSw1LjM5LDMuMDgtMi4yNy44LDMuNjVhNi4yNSw2LjI1LDAsMCwxLTMuODktMS4zOFptNi43NC42OS0uNzItMy4yNiwzLjEzLDEuMDZBNi4xNyw2LjE3LDAsMCwxLDQ1LjEsNTguNzVabTkuOC01LjNhMS40NywxLjQ3LDAsMCwwLTEuOTQuNzRsLTYuMjksMTRhMS40NywxLjQ3LDAsMCwwLC43NCwxLjk0QTkuMTYsOS4xNiwwLDAsMCw1NC45LDUzLjQ1Wk01NSw1Ni44OWE2LjE3LDYuMTcsMCwwLDEsMiwyLjYxbC0zLjMxLjQxWk01MCw2Ny45MmwxLjM3LTMuMDYsMS43MSwyLjg1QTYuMTYsNi4xNiwwLDAsMSw1MCw2Ny45MlptNS41OC0xLjc3LTItMy4yOCwzLjcxLS40NWE2LjI1LDYuMjUsMCwwLDEtMS43NCwzLjc0WiI+PC9wYXRoPjwvc3ZnPg==")}');
        GM_addStyle('.em-icon-lemon-honey { background-image:url("data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjRkZGRkZGIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgMTAwIDEwMCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMTAwIDEwMCIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PGc+PHBhdGggZD0iTTU0LjIzOCw1Mi4yMTJjLTAuODk5LDAtMS44OTQtMC45NTQtMi4yOTctMS44MzljLTAuNjM4LTEuMzk3LTEuNzk5LTEuNDEyLTMuNTM0LTAuMjI5ICAgYy0xLjA2NywwLjcyNy0yLjE0MSwwLjU4OC0yLjg2LTAuMzMyYy0wLjc4OC0xLjAwOS0xLjA2NS0yLjgwMi0wLjY3Ni00LjM1OWMwLjE5OC0wLjc5LDAuMTU0LTEuNTctMC4xMzItMi4zMiAgIGMtMS4xMjUsMC4zNzUtMi4zNjksMC4yMDEtMy4zMjYtMC40MjhjLTEuMTY2LDEuMDE5LTIuOTgzLDEuMTA1LTQuMjQ0LDAuMjA4Yy0wLjU5NiwwLjg1MS0xLjQxMSwxLjMyOS0yLjI5MSwxLjMyOSAgIGMtMC43MzMsMC0xLjQyMS0wLjMyNi0xLjk3OS0wLjkzMWMtMC44NzksMC45MzctMi4yMDcsMS40ODMtMy42NTQsMS40ODNjLTEuMzU2LDAtMi42MS0wLjQ3Ny0zLjQ5Ni0xLjMxNyAgIGMtMC43NzgsMC40OTUtMS43MTYsMC43NjUtMi42ODMsMC43NjVjLTIuNDc1LDAtNC40ODktMS43MDUtNC40ODktMy43OTljMC0wLjU0OSwwLjE0NC0xLjA4MiwwLjQyOS0xLjU5MiAgIGMtMC43MjItMC43NTItMS4xMy0xLjc0OC0xLjEzLTIuNzgzYzAtMi4yMjcsMS44MTMtNC4wMzksNC4wNDEtNC4wMzloMzUuMDE3YzIuMjI5LDAsNC4wNDEsMS44MTMsNC4wNDEsNC4wMzkgICBjMCwxLjM2NS0wLjcwMSwyLjYzMi0xLjg0OSwzLjM3NWMwLjA0MiwwLjIyOSwwLjA2MywwLjQ0MiwwLjA2MywwLjY1NGMwLDIuMDA4LTEuNTExLDMuNjMxLTMuMzEzLDMuNDM5ICAgYy0wLjU2MSwxLjY0NC0wLjQ4NCwzLjIxNC0wLjQwNCw0Ljg2OWMwLjAyOCwwLjU5NCwwLjA1NywxLjE4OSwwLjA1NywxLjc5NUM1NS41MjksNTIuMDE2LDU0LjYyNiw1Mi4yMTIsNTQuMjM4LDUyLjIxMnogICAgTTUwLjUyMSw0OC40NjJjMC42NjUsMCwxLjU4NCwwLjI3MiwyLjE3NCwxLjU2NWMwLjMxMiwwLjY4NCwxLjA3NiwxLjM1NSwxLjU0MywxLjM1NWMwLjQxNywwLDAuNDY0LTAuODI3LDAuNDY0LTEuMTgyICAgYzAtMC41OTItMC4wMjktMS4xNzYtMC4wNTktMS43NTRjLTAuMDg1LTEuNzcxLTAuMTc0LTMuNjA0LDAuNTc4LTUuNTI4bDAuMTMyLTAuMzM4bDAuMzUyLDAuMDg2ICAgYzEuNDEsMC4zNDUsMi42NTYtMC45NDksMi42NTYtMi41NjljMC0wLjIzMi0wLjAzMy0wLjQ3Mi0wLjEwNS0wLjc1NWwtMC4wNzktMC4zMTJsMC4yODMtMC4xNTQgICBjMS4wNC0wLjU2NiwxLjY4Ny0xLjY0MiwxLjY4Ny0yLjgwOWMwLTEuNzcxLTEuNDQxLTMuMjExLTMuMjEyLTMuMjExSDIxLjkxOGMtMS43NzEsMC0zLjIxMiwxLjQ0LTMuMjEyLDMuMjExICAgYzAsMC45MTMsMC40MDMsMS43ODksMS4xMDQsMi40MDRsMC4yNzcsMC4yNDJsLTAuMjA3LDAuMzAzYy0wLjMxMywwLjQ1OS0wLjQ3MiwwLjkzOC0wLjQ3MiwxLjQyNmMwLDEuNjM3LDEuNjQzLDIuOTY5LDMuNjYsMi45NjkgICBjMC45MTYsMCwxLjc5OS0wLjI4NSwyLjQ4NS0wLjgwN2wwLjMwNi0wLjIzbDAuMjU0LDAuMjg3YzAuNzI1LDAuODE2LDEuODk1LDEuMzAzLDMuMTMzLDEuMzAzYzEuMzYxLDAsMi42MzQtMC41OTQsMy4zMjEtMS41NTEgICBsMC4zNDMtMC40NzdsMC4zMzQsMC40OGMwLjQ0NywwLjY0MywxLjAyNywwLjk5NCwxLjYzNSwwLjk5NGMwLjcwNCwwLDEuMzY4LTAuNDgsMS44MjQtMS4zMThsMC4yNTktMC40NzVsMC4zOTIsMC4zNzMgICBjMS4wMjcsMC45OCwyLjc0OCwwLjkzMSwzLjcyLTAuMTA5bDAuMjY0LTAuMjgybDAuMywwLjI0M2MwLjg1NCwwLjY5LDIuMDgxLDAuODYzLDMuMTUyLDAuMzc5bDAuMzY4LTAuMTY1bDAuMTc2LDAuMzYyICAgYzAuNDk4LDEuMDIzLDAuNjE2LDIuMTQxLDAuMzQyLDMuMjM0Yy0wLjMyLDEuMjg0LTAuMDk1LDIuODUzLDAuNTI1LDMuNjQ4YzAuNDYyLDAuNTksMS4wNDIsMC42MzMsMS43NCwwLjE1NiAgIEM0OC45MTEsNDguNzk4LDQ5Ljc3OCw0OC40NjIsNTAuNTIxLDQ4LjQ2MnoiPjwvcGF0aD48L2c+PGc+PGc+PHBhdGggZD0iTTM4LjkyNCw2OC4zMTNsMy4zMzYtNS43NzZsLTMuMzM2LTUuNzc0aC02LjY2OGwtMy4zMzQsNS43NzRsMy4zMzQsNS43NzZIMzguOTI0eiBNMzIuMjI0LDYzLjM0NmwxLjcwNSwyLjg5NyAgICBsMS42NjItMC4wMTVsMS42NiwwLjAxNWwxLjcwNS0yLjg5N2wwLjA3MiwwLjA0MWMtMC4wNTYsMC4yOTYtMC4xMjYsMC41ODItMC4yMSwwLjg2MWMtMC4wODIsMC4yNzktMC4xNzIsMC41NTYtMC4yNzMsMC44MjMgICAgYy0wLjA5MiwwLjI3NC0wLjIwNiwwLjUzNy0wLjMxNiwwLjgwMWMtMC4xMDUsMC4yNjctMC4yMjgsMC41MjEtMC4zNTIsMC43NzdsLTAuMTQ2LDAuMzAzbC0wLjQzOSwwLjAzNSAgICBjLTAuMjg0LDAuMDIzLTAuNTY3LDAuMDQ4LTAuODUsMC4wNDlsLTAuODUxLDAuMDIxbC0wLjg1Mi0wLjAyMmMtMC4yODMsMC0wLjU2Ni0wLjAyNy0wLjg1MS0wLjA1bC0wLjQzNS0wLjAzMmwtMC4xNDgtMC4zMDQgICAgYy0wLjEyNS0wLjI1Ni0wLjI0Ny0wLjUxNC0wLjM1Mi0wLjc3OGMtMC4xMTEtMC4yNjQtMC4yMjMtMC41MjYtMC4zMTYtMC44Yy0wLjEwMi0wLjI2OS0wLjE5LTAuNTQ0LTAuMjc0LTAuODI0ICAgIGMtMC4wODQtMC4yNzgtMC4xNTQtMC41NjUtMC4yMTEtMC44NkwzMi4yMjQsNjMuMzQ2eiI+PC9wYXRoPjwvZz48Zz48cGF0aCBkPSJNNDMuNzk5LDYzLjQxOWwtMy4zMzUsNS43NzRsMy4zMzUsNS43NzZoNi42NjlsMy4zMzQtNS43NzZsLTMuMzM0LTUuNzc0SDQzLjc5OXogTTUwLjU3MSw3MC4wNDMgICAgYy0wLjA1NywwLjI5Ni0wLjEyNiwwLjU4My0wLjIwOSwwLjg2MWMtMC4wODMsMC4yNzktMC4xNzIsMC41NTYtMC4yNzQsMC44MjRjLTAuMDk0LDAuMjczLTAuMjA2LDAuNTM2LTAuMzE2LDAuOCAgICBjLTAuMTA2LDAuMjY3LTAuMjMsMC41MjEtMC4zNTMsMC43NzdsLTAuMTQ2LDAuMzA0bC0wLjQzOCwwLjAzNGMtMC4yODQsMC4wMjMtMC41NjgsMC4wNDgtMC44NTIsMC4wNDlsLTAuODUsMC4wMjFsLTAuODUyLTAuMDIyICAgIGMtMC4yODIsMC0wLjU2NS0wLjAyNi0wLjg0OS0wLjA0OWwtMC40MzYtMC4wMzNsLTAuMTQ4LTAuMzA0Yy0wLjEyNC0wLjI1Ni0wLjI0Ni0wLjUxNC0wLjM1Mi0wLjc3OCAgICBjLTAuMTExLTAuMjY0LTAuMjI0LTAuNTI2LTAuMzE2LTAuOGMtMC4xMDItMC4yNjktMC4xOTItMC41NDQtMC4yNzUtMC44MjRjLTAuMDg0LTAuMjc3LTAuMTU0LTAuNTY1LTAuMjExLTAuODZsMC4wNzItMC4wNCAgICBsMS43MDQsMi44OTdsMS42NjItMC4wMTRsMS42NjEsMC4wMTRsMS43MDUtMi44OTdMNTAuNTcxLDcwLjA0M3oiPjwvcGF0aD48L2c+PGc+PHBhdGggZD0iTTMyLjI1Niw2OS45OTFsLTMuMzM0LDUuNzc1bDMuMzM0LDUuNzc2aDYuNjY4bDMuMzM2LTUuNzc2bC0zLjMzNi01Ljc3NUgzMi4yNTZ6IE0zOS4wMjgsNzYuNjE1ICAgIGMtMC4wNTYsMC4yOTctMC4xMjYsMC41ODMtMC4yMSwwLjg2MmMtMC4wODIsMC4yNzktMC4xNzIsMC41NTUtMC4yNzMsMC44MjNjLTAuMDkyLDAuMjc0LTAuMjA2LDAuNTM2LTAuMzE2LDAuOCAgICBjLTAuMTA1LDAuMjY5LTAuMjI4LDAuNTIyLTAuMzUyLDAuNzc4bC0wLjE0NiwwLjMwM2wtMC40MzksMC4wMzVjLTAuMjg0LDAuMDIzLTAuNTY3LDAuMDQ5LTAuODUsMC4wNWwtMC44NTEsMC4wMjFsLTAuODUyLTAuMDIxICAgIGMtMC4yODMsMC0wLjU2Ni0wLjAyOS0wLjg1MS0wLjA1MWwtMC40MzUtMC4wMzJsLTAuMTQ4LTAuMzA0Yy0wLjEyNS0wLjI1Ni0wLjI0Ny0wLjUxNC0wLjM1Mi0wLjc3OSAgICBjLTAuMTExLTAuMjY0LTAuMjIzLTAuNTI2LTAuMzE2LTAuOGMtMC4xMDItMC4yNjktMC4xOS0wLjU0NC0wLjI3NC0wLjgyNGMtMC4wODQtMC4yNzctMC4xNTQtMC41NjUtMC4yMTEtMC44NmwwLjA3MS0wLjA0ICAgIGwxLjcwNSwyLjg5N2wxLjY2Mi0wLjAxNGwxLjY2LDAuMDE0bDEuNzA1LTIuODk3TDM5LjAyOCw3Ni42MTV6Ij48L3BhdGg+PC9nPjxnPjxwYXRoIGQ9Ik01OC4yNzEsNDMuNjU4Yy0wLjUyMSwwLjM4MS0xLjExOSwwLjY0MS0xLjc3MywwLjcwNWMtMC4zMjksMS4zMTMtMC4yNjYsMi42MjctMC4xOTcsNC4wMDIgICAgYzAuMDI5LDAuNjA2LDAuMDU4LDEuMjE2LDAuMDU4LDEuODM2YzAsMi43MDItMS43NjcsMi44MzktMi4xMiwyLjgzOWMtMS4yOTQsMC0yLjUzNy0xLjE5Ny0zLjA1Mi0yLjMyMyAgICBjLTAuMjcxLTAuNTk3LTAuNTI4LTAuNTk3LTAuNjY1LTAuNTk3Yy0wLjIyOCwwLTAuNzQzLDAuMDkyLTEuNjQ2LDAuNzA4Yy0xLjQyMSwwLjk2OS0zLjAwNCwwLjc0NC0zLjk4Mi0wLjUwNiAgICBjLTAuOTM0LTEuMTk1LTEuMjczLTMuMjgxLTAuODI2LTUuMDdjMC4wOTUtMC4zODEsMC4xMTktMC43NTksMC4wNzEtMS4xMzJjLTAuOTA3LDAuMTIyLTEuODQ2LTAuMDMyLTIuNjYtMC40MjcgICAgYy0xLjIwMSwwLjc4My0yLjgyMSwwLjg5Ny00LjEyNSwwLjI4NGMtMC42OTYsMC42OTgtMS41NjUsMS4wOTMtMi40NzUsMS4wOTNjLTAuNjk5LDAtMS4zNzUtMC4yMjktMS45NjktMC42NTIgICAgYy0wLjk5MSwwLjc2OS0yLjI4NCwxLjIwNS0zLjY2NCwxLjIwNWMtMS4zNDMsMC0yLjYwMy0wLjQwOC0zLjU5LTEuMTQ1Yy0wLjc5LDAuMzg1LTEuNjc5LDAuNTkyLTIuNTg4LDAuNTkyICAgIGMtMS4xMTIsMC0yLjE0NS0wLjMwMS0zLTAuODExYy0zLjg4Nyw0Ljc2Mi02LjQ2NiwxMy4xMDQtNi40NjYsMjIuNjA2YzAsMTQuODA5LDYuMjU4LDI2LjgxMywxMy45NzgsMjYuODEzaDIzLjY5NSAgICBjNy43MiwwLDEzLjk3OS0xMi4wMDUsMTMuOTc5LTI2LjgxM0M2NS4yNTIsNTYuOTUxLDYyLjQ0Myw0OC4yOTgsNTguMjcxLDQzLjY1OHogTTUxLjE4Nyw3Ni4yMTRoLTcuNzQ5bC0zLjc5NSw2LjU3MmgtOC4xMDQgICAgbC00LjA1NC03LjAybDMuODItNi42MTRsLTMuODItNi42MTVsNC4wNTQtNy4wMmg4LjEwNGwzLjg0Myw2LjY1Nmg3LjcwMWw0LjA1Miw3LjAyTDUxLjE4Nyw3Ni4yMTR6Ij48L3BhdGg+PC9nPjwvZz48Zz48Zz48cGF0aCBkPSJNMzQuNDg5LDIyLjkzNGMwLDEuMTc1LTAuOTUzLDIuMTI4LTIuMTI4LDIuMTI4bDAsMGMtMS4xNzQsMC0yLjEyNy0wLjk1My0yLjEyNy0yLjEyOFYxMS43MjEgICAgYzAtMS4xNzUsMC45NTMtMi4xMjgsMi4xMjctMi4xMjhsMCwwYzEuMTc1LDAsMi4xMjgsMC45NTMsMi4xMjgsMi4xMjhWMjIuOTM0eiI+PC9wYXRoPjwvZz48Zz48cGF0aCBkPSJNNDAuMDU0LDI0LjU3MWMwLDEuMTc1LTAuOTUzLDIuMTI2LTIuMTI5LDIuMTI2bDAsMGMtMS4xNzUsMC0yLjEyNi0wLjk1MS0yLjEyNi0yLjEyNlYxMC4wODUgICAgYzAtMS4xNzUsMC45NTEtMi4xMjgsMi4xMjYtMi4xMjhsMCwwYzEuMTc2LDAsMi4xMjksMC45NTMsMi4xMjksMi4xMjhWMjQuNTcxeiI+PC9wYXRoPjwvZz48Zz48cGF0aCBkPSJNNDUuNjE4LDI2LjIwN2MwLDEuMTc0LTAuOTUyLDIuMTI4LTIuMTI4LDIuMTI4bDAsMGMtMS4xNzUsMC0yLjEyNi0wLjk1NC0yLjEyNi0yLjEyOFY4LjQ0OCAgICBjMC0xLjE3NSwwLjk1MS0yLjEyOCwyLjEyNi0yLjEyOGwwLDBjMS4xNzYsMCwyLjEyOCwwLjk1MywyLjEyOCwyLjEyOFYyNi4yMDd6Ij48L3BhdGg+PC9nPjxnPjxwYXRoIGQ9Ik01Ni43NDYsMjIuOTM0YzAsMS4xNzUtMC45NTEsMi4xMjgtMi4xMjYsMi4xMjhsMCwwYy0xLjE3NiwwLTIuMTI5LTAuOTUzLTIuMTI5LTIuMTI4VjExLjcyMSAgICBjMC0xLjE3NSwwLjk1My0yLjEyOCwyLjEyOS0yLjEyOGwwLDBjMS4xNzUsMCwyLjEyNiwwLjk1MywyLjEyNiwyLjEyOFYyMi45MzR6Ij48L3BhdGg+PC9nPjxnPjxwYXRoIGQ9Ik01MS4xODIsMjQuNTcxYzAsMS4xNzUtMC45NTEsMi4xMjYtMi4xMjcsMi4xMjZsMCwwYy0xLjE3NSwwLTIuMTI3LTAuOTUxLTIuMTI3LTIuMTI2VjEwLjA4NSAgICBjMC0xLjE3NSwwLjk1Mi0yLjEyOCwyLjEyNy0yLjEyOGwwLDBjMS4xNzYsMCwyLjEyNywwLjk1MywyLjEyNywyLjEyOFYyNC41NzF6Ij48L3BhdGg+PC9nPjxnPjxwYXRoIGQ9Ik01OC4wNTcsMTUuNUg4NC41N2MxLjAxLDAsMS44MjgsMC44MTgsMS44MjgsMS44MjhsMCwwYzAsMS4wMS0wLjgxOCwxLjgyNy0xLjgyOCwxLjgyN0g1OC4wNTdWMTUuNXoiPjwvcGF0aD48L2c+PC9nPjwvc3ZnPg==")}');
        GM_addStyle('.em-icon-rockmelon { background-image:url("data:image/svg+xml;base64,CjxzdmcgZmlsbD0iI0ZGRkZGRiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB4PSIwcHgiIHk9IjBweCIgdmlld0JveD0iMCAwIDEwMCAxMDAiIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDEwMCAxMDAiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxnPjxnPjxwYXRoIGZpbGw9IiNGRkZGRkYiIGQ9Ik04My44MTY0MSw1NS4xNTgyYy0wLjAzNDE4LTAuNjc4NzEtMC4wOTU3LTEuMzUxNTYtMC4xODM1OS0yICAgIGMtMS4xMjk4OC04LjM2MjMtNi4xODg0OC0xOS4xNzE4OC0xNi43MjU1OS0yMi4xMTYyMWMtMS40ODM0LTAuNDE1MDQtMi45OTQxNC0wLjYyNS00LjQ5MDIzLTAuNjI1Yy0wLjU1MjczLDAtMSwwLjQ0NzI3LTEsMSAgICBzMC40NDcyNywxLDEsMWMxLjMxNDQ1LDAsMi42NDM1NSwwLjE4NTU1LDMuOTUxMTcsMC41NTA3OGMzLjE0OTI5LDAuODc5ODgsNS43NTM5NywyLjU1NzEzLDcuODgyNzUsNC42NzYwMyAgICBjLTEuMDc1NzQsMC4yNDQ2My0yLjQ5NTI0LDAuNTc3NzYtMi45ODQzMSwwLjc0MDk3Yy0wLjUyMzQ0LDAuMTczODMtMC44MDY2NCwwLjc0MDIzLTAuNjMxODQsMS4yNjQ2NSAgICBjMC4xMzk2NSwwLjQxODk1LDAuNTI5MywwLjY4MzU5LDAuOTQ4MjQsMC42ODM1OWMwLjEwNDQ5LDAsMC4yMTA5NC0wLjAxNjYsMC4zMTY0MS0wLjA1MTc2ICAgIGMwLjEzNjc4LTAuMDQ1NjUsMC4zOTg3NC0wLjExNTg0LDAuNzI3NTQtMC4xOTg2MWMwLjAyMjI4LDAuNTcwOTIsMC4wMDQ4OCwxLjM2MTk0LTAuMDQxMDIsMi4wMTMwNiAgICBjLTAuMDQwMDQsMC41NTA3OCwwLjM3NSwxLjAyOTMsMC45MjU3OCwxLjA2ODM2YzAuMDI0NDEsMC4wMDE5NSwwLjA0ODgzLDAuMDAyOTMsMC4wNzIyNywwLjAwMjkzICAgIGMwLjUxOTUzLDAsMC45NTg5OC0wLjQwMjM0LDAuOTk2MDktMC45Mjg3MWMwLjAzMTk4LTAuNDQxODksMC4xMDQtMS42NjYwMiwwLjAxODk4LTIuNjIyOCAgICBjMC40MTc0Mi0wLjA5NTA5LDAuODIyMi0wLjE4NTc5LDEuMTg1MTItMC4yNjU4N2MxLjYxMzIyLDEuOTkyMzEsMi44ODg2MSw0LjI0MjU1LDMuODM4NjgsNi41NTY2NCAgICBjLTAuODgxNTMsMC40NTYzLTIuNzUwNzMsMS40NjMxMy0zLjM4OTQ3LDIuMTEwMzVjLTAuMzMyMDMsMC4xMjQwMi0xLjQzNDU3LDAuMTYwMTYtMi4zOTA2MiwwLjA3MDMxICAgIGMtMC41NDAwNC0wLjA1NDY5LTEuMDM3MTEsMC4zNTI1NC0xLjA4Nzg5LDAuOTAzMzJjLTAuMDUxNzYsMC41NDk4LDAuMzUyNTQsMS4wMzcxMSwwLjkwMTM3LDEuMDg4ODcgICAgYzAuNDkyMTksMC4wNDU5LDAuOTQzMzYsMC4wNjgzNiwxLjM1MjU0LDAuMDY4MzZjMC4xNDk0MSwwLDAuMjcyMjItMC4wMTQ2NSwwLjQxMDQ2LTAuMDIwNzUgICAgYzAuMDEyNjMsMi45ODY4MiwwLjA4MDMyLDMuMjAxMjksMC4xMzE1MywzLjM1NTcxYzAuMDc2MTcsMC4yMzA0NywwLjIzNDM4LDAuNDI0OCwwLjQ0MzM2LDAuNTQ3ODVsMi40MTY5OSwxLjQxNjAyICAgIGMwLjE1OTE4LDAuMDkyNzcsMC4zMzMwMSwwLjEzNjcyLDAuNTA0ODgsMC4xMzY3MmMwLjM0Mzc1LDAsMC42Nzc3My0wLjE3Njc2LDAuODY0MjYtMC40OTQxNCAgICBjMC4yNzgzMi0wLjQ3NjU2LDAuMTE5MTQtMS4wODk4NC0wLjM1NzQyLTEuMzY5MTRsLTEuOTY1ODItMS4xNTEzN2MtMC4wMjIwMy0wLjYyMjgtMC4wMzU4OS0xLjgwMTUxLTAuMDM5MjUtMi45NTkzNSAgICBjMC4wODk3OC0wLjA2NTQzLDAuMTg4NDgtMC4xMjYyMiwwLjI1NTA3LTAuMjAzNzRjMC4yNDIxMy0wLjI1OTE2LDEuNTA0MjctMS4wMDMwNSwyLjY0ODM4LTEuNjA3MTggICAgYzAuNjQyODgsMS45MTczNiwxLjA4NjYxLDMuODMzMDEsMS4zMjkxNiw1LjYyNzY5YzAuMDgwMDgsMC41OTM3NSwwLjEzNjcyLDEuMjA5OTYsMC4xNjc5NywxLjgzMjAzICAgIGMwLjA1NjQsMS4xMzU5OSwwLjAxMDYyLDIuMjY5NDEtMC4wOTg1MSwzLjM5MjMzYy0xLjMyMTM1LTAuMDIzNDQtMi43MjE0NCwwLjAyODA4LTMuNTI1NTEsMC4wNjU2NyAgICBjLTAuNTAyOTMtMC44NDA4Mi0xLjM4MTg0LTEuODQ5NjEtMS45NTg5OC0yLjQ3NTU5Yy0wLjM3MjA3LTAuNDA3MjMtMS4wMDc4MS0wLjQzMjYyLTEuNDEyMTEtMC4wNTg1OSAgICBjLTAuNDA3MjMsMC4zNzMwNS0wLjQzMjYyLDEuMDA1ODYtMC4wNTg1OSwxLjQxMjExYzAuODc2OTUsMC45NTQxLDEuNzQwMjMsMi4wNzIyNywxLjg0MTgsMi4zNzIwNyAgICBjMC4wMTA4LDAuMDQ4NTgsMC4wMzc2LDAuMDg4MjYsMC4wNTQ4NywwLjEzMzU0Yy0wLjA3MjUxLDAuNzkzMDktMC4xOTA1NSwxLjc0MDQ4LTAuMjU3MDIsMS45NDU1NiAgICBjLTAuMjA1MDgsMC41MTI3LDAuMDQzOTUsMS4wOTQ3MywwLjU1NjY0LDEuMzAwNzhjMC4xMjIwNywwLjA0ODgzLDAuMjQ4MDUsMC4wNzEyOSwwLjM3MjA3LDAuMDcxMjkgICAgYzAuMzk2NDgsMCwwLjc3MTQ4LTAuMjM3MywwLjkyODcxLTAuNjI3OTNjMC4xNTM2My0wLjM4NTEzLDAuMjc0MDUtMS4zMzAyLDAuMzUwOTUtMi4wODkxMSAgICBjMC43Mzk0NC0wLjAzMTM3LDEuODAyLTAuMDY0NDUsMi44MjY4NC0wLjA1Mzk2Yy0wLjM5NTYzLDIuMTM1MjUtMS4wNzExMSw0LjE5NDM0LTIuMDI2MTIsNi4wNzUzMmwtMS40NzE5OC0wLjkwNTg4ICAgIGMtMC40NzM2My0wLjI5MTAyLTEuMDg3ODktMC4xNDI1OC0xLjM3NTk4LDAuMzI3MTVjLTAuMjg5MDYsMC40NzA3LTAuMTQyNTgsMS4wODY5MSwwLjMyNzE1LDEuMzc1OThsMS41MjYxOCwwLjkzOTIxICAgIGMtMC4zMTMyMywwLjQ5MTctMC42NDE0MiwwLjk3MTU2LTAuOTkzOTYsMS40Mjg5NmMtMS41MDc5MywxLjk1NjU0LTMuNTE0NCwzLjU0NTktNi4wMjI0LDQuODEzOTYgICAgYzAuMDQ5ODctMS4wNjA3OSwwLjAxOTktMi4xMzgxOCwwLjAxMzYxLTIuMzE1OTJjLTAuMDE2Ni0wLjU1MjczLTAuNDk2MDktMS4wMjUzOS0xLjAzMTI1LTAuOTY2OCAgICBjLTAuNTUxNzYsMC4wMTc1OC0wLjk4NTM1LDAuNDc5NDktMC45NjY4LDEuMDMxMjVjMC4wMTk3MSwwLjYyNTk4LDAuMDMzMzksMi4zMDIyNS0wLjEwMzUyLDMuMTgxNjQgICAgYy0wLjk3MjksMC4zODI0NS0xLjk4OTc1LDAuNzM3OTItMy4wOTM5OSwxLjA0MTVjLTAuMjQxMDktMC40ODczLTAuNjAzMzMtMS4xNTU3Ni0wLjk2MTY3LTEuNTczNzMgICAgYy0wLjQzNzkzLTAuNTEwNS0xLjY5ODY3LTEuMDc0NzEtMi44MDQwMi0xLjQ5ODA1YzAuMzEyNTYtMC41NTUxOCwwLjU5NjEzLTEuMTE0NzUsMC44NDkzNy0xLjY3MjM2ICAgIGMwLjMzNzE2LDAuMDM0NDIsMS4wODk3OCwwLjEwMTA3LDEuOTAyODksMC4xMDEwN2MwLjU2ODM2LDAsMS4xNjIxMS0wLjAzMzIsMS42NTYyNS0wLjEzMTg0ICAgIGMwLjU0MTAyLTAuMTA4NCwwLjg5MjU4LTAuNjM0NzcsMC43ODQxOC0xLjE3Njc2Yy0wLjEwNzQyLTAuNTQxMDItMC42Mjk4OC0wLjg5ODQ0LTEuMTc2NzYtMC43ODQxOCAgICBjLTAuNjM5ODksMC4xMjY5NS0xLjY1ODI2LDAuMDk4NTEtMi4zOTU1NywwLjA0ODcxYzAuMTc2OTQtMC41MjkwNSwwLjMyMzQ5LTEuMDQ1MjksMC40Mzc1Ni0xLjUzOTkyICAgIGMwLjI2ODk4LTEuMTY2NSwwLjQxOTkyLTIuMzEyNzQsMC40ODc1NS0zLjQ0NThjMC4zNjQ1LDAuNTkzMjYsMC43MzI2NywxLjM3NzA4LDAuOTM3MjYsMi4zNjk2MyAgICBjMC4wOTc2NiwwLjQ3MjY2LDAuNTEzNjcsMC43OTc4NSwwLjk3ODUyLDAuNzk3ODVjMC4wNjY0MSwwLDAuMTM0NzctMC4wMDY4NCwwLjIwMzEyLTAuMDIwNTEgICAgYzAuNTQxMDItMC4xMTEzMywwLjg4ODY3LTAuNjQwNjIsMC43NzczNC0xLjE4MTY0Yy0wLjY0ODQ0LTMuMTQ3NDYtMi42MDE1Ni00Ljc1NzgxLTIuNjg0NTctNC44MjUyICAgIGMtMC4wNjY1OS0wLjA1Mzk2LTAuMTQ0MDQtMC4wODAwOC0wLjIxODU3LTAuMTE0MjZjLTAuMDI5OTctMC41MDU2Mi0wLjA3Mzk3LTEuMDA5NjQtMC4xMjc3NS0xLjUxMjU3ICAgIGMwLjEwNTgzLDAuMDAxMSwwLjIxOTEyLDAuMDAxODMsMC4zMzk0OCwwLjAwMTgzYzAuODcxMDksMCwyLjA2NDQ1LTAuMDM3MTEsMi43MjQ2MS0wLjIxNjggICAgYzAuNTMzMi0wLjE0NTUxLDAuODQ3NjYtMC42OTUzMSwwLjcwMjE1LTEuMjI3NTRjLTAuMTQ1NTEtMC41MzQxOC0wLjcwMDItMC44NDc2Ni0xLjIyNzU0LTAuNzAyMTUgICAgYy0wLjQ3NzI5LDAuMTMwNzQtMS44MjI5NCwwLjE1Njk4LTIuODAxNywwLjEzOTg5Yy0wLjE1Njg2LTEuMDEwMDEtMC4zNDE2Ny0yLjAxOTA0LTAuNTM4MTUtMy4wMzE0OSAgICBjLTAuMTA1NDctMC41NDE5OS0wLjYzMDg2LTAuODk3NDYtMS4xNzE4OC0wLjc5MTAyYy0wLjU0MTk5LDAuMTA0NDktMC44OTY0OCwwLjYyOTg4LTAuNzkxMDIsMS4xNzE4OCAgICBjMC43ODUxNiw0LjA0Nzg1LDEuNDExMTMsOC4wMjI0NiwwLjQ2MTkxLDEyLjEzODY3Yy0wLjg0ODYzLDMuNjgyNjItMy42NTMzMiw4LjQ1NzAzLTcuMzcwMTIsMTAuNDU2MDUgICAgYy0xMC40NzU1OSw1LjYzMzc5LTI2LjQ5MDIzLDUuMTU1MjctMzQuMDk3NjYtNS40NDIzOGMtMS4zMDM3MS0xLjgxNzM4LTIuMzMwMDgtMy45MTYwMi0zLjA0MTk5LTYuMjE1ODIgICAgYy0wLjAyMjQ2LTAuMDgzMDEtMC4wNzQyMi0wLjMzMDA4LTAuMTM5NjUtMC42NDA2MmMtMC4wNDY4OC0wLjIxODc1LTAuMDg5ODQtMC40MjA5LTAuMTI5ODgtMC42MDY0NSAgICBjNC4xNzgyOCwwLjgyNzY0LDE0Ljc4NDYxLDIuODE1OTIsMTguNjMyODcsMi4zOTExMWMwLjEyOTA5LDAuMDc1OTMsMC4yNzExMiwwLjEzMTg0LDAuNDMwNiwwLjE0MzA3ICAgIGMwLjE1NDMsMC4wMTA3NCwxLjg1MjU0LDAuMTI0MDIsNC4xNDE2LDAuMTI0MDJjMi45MDQzLDAsNi43NTg3OS0wLjE4MzU5LDkuNjE2MjEtMC45OTMxNiAgICBjNS4zODM3OS0xLjUyNTM5LDkuODU4NC04LjA4OTg0LDEwLjg1MDU5LTExLjMzNjkxYzAuMTYyMTEtMC41MjgzMi0wLjEzNTc0LTEuMDg2OTEtMC42NjQwNi0xLjI0ODA1ICAgIGMtMC41MjUzOS0wLjE2NTA0LTEuMDg2OTEsMC4xMzU3NC0xLjI0ODA1LDAuNjY0MDZjLTAuODUzNTIsMi43OTI5Ny00Ljg2MzI4LDguNjg3NS05LjQ4MzQsOS45OTcwNyAgICBjLTIuMTc1ODQsMC42MTY3LTUuMDYzNTQsMC44MzU5NC03LjU3NDU4LDAuODkzNTVjNS4zMDU0Mi0yLjA3OTEsMTIuMzMyMjgtNS45ODU3MiwxNi4xODAwNS0xMS44NjgxNmwzLjExNDI2LTEuMjE0ODQgICAgYzAuNTE0NjUtMC4yMDExNywwLjc2OTUzLTAuNzgwMjcsMC41NjgzNi0xLjI5NDkyYy0wLjIwMTE3LTAuNTE1NjItMC43ODQxOC0wLjc2OTUzLTEuMjk0OTItMC41NjgzNmwtMy40MTY5OSwxLjMzMzAxICAgIGMtMC4xOTkyMiwwLjA3ODEyLTAuMzY5MTQsMC4yMTc3Ny0wLjQ4MjQyLDAuMzk4NDRjLTEuMTkyODcsMS44OTM0My0yLjc1MTgzLDMuNTYyOTktNC40NzcxNyw1LjAzMzA4bC0xLjc5MzMzLTEuMTk2MTcgICAgYzAuNDEzMDktMS44NDM3NSwwLjQ3MjY2LTMuMDc2MTcsMC4xNzY3Ni0zLjY2ODk1Yy0wLjE0ODQ0LTAuMjk2ODgtMC41NDM5NS0xLjA4NDk2LTQuNTgzOTgtMi4wMjUzOSAgICBjLTAuNTM1MTYtMC4xMzI4MS0xLjA3NTIsMC4yMDgwMS0xLjIwMDIsMC43NDcwN2MtMC4xMjU5OCwwLjUzNzExLDAuMjA4OTgsMS4wNzUyLDAuNzQ3MDcsMS4yMDAyICAgIGMxLjM0MTgsMC4zMTM0OCwyLjc0NzA3LDAuNzcwNTEsMy4yMzE0NSwxLjA0Mjk3YzAuMDEyNywwLjUwNTg2LTAuMTg5NDUsMS43NjQ2NS0wLjQ3NDYxLDIuOTA4MiAgICBjLTAuMTAyNTQsMC40MTAxNiwwLjA2MzQ4LDAuODM5ODQsMC40MTUwNCwxLjA3NDIybDEuODM5NiwxLjIyNjU2Yy00LjAwMjI2LDIuOTU2MDUtOC41NzMzNiw0LjkwOTc5LTExLjc1OTQ2LDUuOTA2MDEgICAgYy0wLjAxMDE5LTAuMDM0MDYtMC4wMDY1My0wLjA2ODg1LTAuMDIwNTctMC4xMDIyOWMtMS43OTEwOC00LjI2NTg3LTIuNTUxMjEtOS4xMjE3LTIuMTI2ODMtMTMuMjYxMjMgICAgYzAuNDk1MTIsMC4wMTYyNCwxLjA5NjA3LDAuMDM5MDYsMS40NTA5MywwLjA1MzFjMC41MzUwMywxLjExNDc1LDEuMDU2MzQsMi4zNTMxNSwxLjA4ODAxLDIuNjc4ODMgICAgYzAsMC4wMDY5NiwwLjAwNDAzLDAuMDEzMDYsMC4wMDQxNSwwLjAyMDAyYy0wLjEyMjA3LDAuMTA5NjItMC4yMjc0MiwwLjIzOTE0LTAuMjg0NDIsMC40MDU3NiAgICBjLTEuMDUzNzEsMy4wNzQyMi0xLjA1MzcxLDMuMzE1NDMtMS4wNTM3MSwzLjQ5MTIxYzAsMC41NTI3MywwLjQ0NzI3LDEsMSwxYzAuNTE1NjIsMCwwLjk0MDQzLTAuMzkwNjIsMC45OTQxNC0wLjg5MTYgICAgYzAuMDY0MzktMC4yODYxMywwLjQ2NTAzLTEuNTE4OCwwLjg0NzA1LTIuNjQyNThjMC42MjM2NiwwLjEzNzgyLDEuNTk0MjQsMC4yNDEzMywzLjEzNTM4LDAuMjIxNjggICAgYzAuMTQ5NDEsMC43OTc4NSwwLjI1NTg2LDIuMTU1MjctMC4zNjQyNiwzLjM1MjU0Yy0wLjI1MzkxLDAuNDkwMjMtMC4wNjI1LDEuMDkzNzUsMC40Mjc3MywxLjM0NzY2ICAgIEM0NC41MTk1Myw2MC45NjM4Nyw0NC42NzY3Niw2MSw0NC44MzIwMyw2MWMwLjM2MTMzLDAsMC43MTA5NC0wLjE5NjI5LDAuODg4NjctMC41NDAwNCAgICBjMS4zNTE1Ni0yLjYwNTQ3LDAuMzQ3NjYtNS41MDQ4OCwwLjMwNDY5LTUuNjI3OTNjLTAuMTQ1NTEtMC40MTIxMS0wLjUzNTE2LTAuNjg5NDUtMC45Nzk0OS0wLjY2NDA2ICAgIGMtMS4zNzUsMC4wNTE3Ni0yLjgzNjkxLTAuMDE2Ni0zLjQ2Mjg5LTAuMTQ3NDZjLTAuMjI2NzUtMC45MjEzOS0wLjg1ODQtMi4yODc2LTEuMzIyMzMtMy4yMjkxM2wxLjA0OTg3LTEuMzk5NzhsMS42ODc1LDEuNTE4NTUgICAgYzAuNDEyMTEsMC4zNzAxMiwxLjA0Mjk3LDAuMzM3ODksMS40MTIxMS0wLjA3NDIyYzAuMzY5MTQtMC40MTAxNiwwLjMzNTk0LTEuMDQyOTctMC4wNzQyMi0xLjQxMjExbC0yLjUtMi4yNSAgICBjLTAuMjA4OTgtMC4xODg0OC0wLjQ4OTI2LTAuMjc2MzctMC43NjU2Mi0wLjI1MTk1Yy0wLjI4MDI3LDAuMDI3MzQtMC41MzUxNiwwLjE3MDktMC43MDMxMiwwLjM5NTUxbC0xLjkzNTU1LDIuNTgwMDggICAgYy0wLjI4NDE4LTAuMDEwOTktMC42NDUwMi0wLjAyNDQxLTAuOTg3NDktMC4wMzYzOGMwLjQwNTY0LTEuOTk3NTYsMS4wNDg0Ni0zLjg2NzE5LDEuOTA0MTEtNS41NzY0MiAgICBjMC4wNTkzMywwLjAxNDY1LDAuMTEyODUsMC4wNDI3MiwwLjE3NjE1LDAuMDQ2MzljMC4xOTE0MSwwLjAxMTcyLDEuMzQ2NjgsMC4wNzcxNSwyLjQ3ODUyLDAuMDc3MTUgICAgYzAuNDMwMTEsMCwwLjg1MjExLTAuMDEwOTksMS4yMjEwNy0wLjAzNjYybDAuMTA5OTksMi4wOTgxNGMwLjAyODMyLDAuNTMzMiwwLjQ2OTczLDAuOTQ3MjcsMC45OTgwNSwwLjk0NzI3ICAgIGMwLjAxNzU4LDAsMC4wMzUxNiwwLDAuMDUzNzEtMC4wMDA5OGMwLjU1MDc4LTAuMDI5MywwLjk3NDYxLTAuNSwwLjk0NjI5LTEuMDUxNzZsLTAuMTU2MjUtMi45NzU1OSAgICBjMC4yNzczNC0wLjg0NjY4LDAuNzMwNDctMi41MjYzNywwLjMzNTk0LTMuNTA5NzdjLTAuMjY2ODUtMC42Njc0OC0wLjk2NTI3LTEuMzY2MjEtMS41MzY2Mi0xLjg1OTg2ICAgIGMxLjI5OTA3LTEuMjQyMzEsMi43MTg1MS0yLjI5MTI2LDQuMTk0NjQtMy4xNTU4OGwwLjIwMzI1LDEuOTY0MzZsLTEuNDcxNjIsMC4yNzIwOSAgICBjLTAuNTQyOTcsMC4xMDA1OS0wLjkwMjM0LDAuNjIyMDctMC44MDE3NiwxLjE2NTA0YzAuMDg4ODcsMC40ODE0NSwwLjUwOTc3LDAuODE4MzYsMC45ODI0MiwwLjgxODM2ICAgIGMwLjA2MDU1LDAsMC4xMjEwOS0wLjAwNDg4LDAuMTgyNjItMC4wMTY2bDEuNTk5MDYtMC4yOTU2NWMwLjA2Nzk5LDAuMDU2MTUsMC4xNDM1NSwwLjEwNDI1LDAuMjI2MTQsMC4xNDEzNiAgICBjMC41OTY2OCwwLjI2ODU1LDEuMzAxNzYsMC42MTkxNCwxLjgwMzcxLDAuODk5NDFjLTAuNDE2OTksMC42MzQ3Ny0wLjk5NDE0LDEuNzA0MS0xLjgwNzYyLDMuNTMyMjMgICAgYy0wLjIyMzYzLDAuNTA0ODgsMC4wMDI5MywxLjA5NTcsMC41MDc4MSwxLjMyMDMxYzAuMTMxODQsMC4wNTg1OSwwLjI2OTUzLDAuMDg1OTQsMC40MDUyNywwLjA4NTk0ICAgIGMwLjM4Mzc5LDAsMC43NDkwMi0wLjIyMDcsMC45MTUwNC0wLjU5Mzc1YzAuNjM4NjctMS40MzU1NSwxLjUyMTQ4LTMuMTY2MDIsMS44NjUyMy0zLjU1NTY2ICAgIGMwLjMzMzAxLTAuMTk2MjksMC41MzYxMy0wLjUzODA5LDAuNTM5MDYtMC45MjM4M2MwLjAwMzkxLTAuNDg4MjgsMC4wMDg3OS0wLjk5MzE2LTIuODgyODEtMi4zNDc2NmwtMC4zNTgwOS0zLjQ2NzI5ICAgIGMyLjU2NzA4LTEuMTcyNDksNS4yMjktMS43NDA0OCw3LjcyNTI4LTEuNjQ0MjljMC4wMDA5OCwwLjI2MzQzLDAuMDEzMDYsMC40OTk3NiwwLjA0Mjk3LDAuNjg4NzIgICAgYzAuMDc3MTUsMC40OTIxOSwwLjUwMjkzLDAuODQzNzUsMC45ODYzMywwLjg0Mzc1YzAuMDUxNzYsMCwwLjEwNDQ5LTAuMDAzOTEsMC4xNTcyMy0wLjAxMjcgICAgYzAuNTQ0OTItMC4wODU5NCwwLjkxNzk3LTAuNTk3NjYsMC44MzEwNS0xLjE0MzU1Yy0wLjE0NTMyLTAuOTIyMzYsMC4zNTU4My00LjEwMTMyLDAuNzc2NjEtNi4yOTc4NSAgICBjMy4zNDg4OC0wLjI0MzE2LDYuMjY3MDMtMS4yNjQxNiw5LjAyNDE3LTIuMzY3MTljMC41MTI3LTAuMjA1MDgsMC43NjI3LTAuNzg3MTEsMC41NTc2Mi0xLjI5OTggICAgYy0wLjIwNTA4LTAuNTEzNjctMC43OTE5OS0wLjc2MTcyLTEuMjk5OC0wLjU1NzYyYy00Ljc1MTk1LDEuOTAxMzctOS41ODEwNSwzLjQxNzk3LTE2LjM5NTUxLDEuMTQ3NDYgICAgYy0wLjUyOTMtMC4xNzQ4LTEuMDg5ODQsMC4xMDg0LTEuMjY0NjUsMC42MzE4NGMtMC4xNzQ4LDAuNTI0NDEsMC4xMDg0LDEuMDkwODIsMC42MzE4NCwxLjI2NDY1ICAgIGMyLjQzNzUsMC44MTI3NCw0LjY0ODE5LDEuMTYxMDEsNi43MDMzNywxLjIxNDExYy0wLjE5MjU3LDEuMDI5NzktMC40NDk4MywyLjUxNjM2LTAuNjA4NzYsMy44NzIwNyAgICBjLTMuMzI4NjctMC4xNjUwNC02LjUwNzc1LDAuNjE5ODctOS4zODA4NiwyLjA3NDcxYy0wLjAyMjk1LDAuMDExMjMtMC4wNDYyLDAuMDE5NjUtMC4wNjgwNSwwLjAzMjU5ICAgIGMtNi44ODI4MSwzLjUxNTYyLTExLjk5ODE3LDEwLjg0NzA1LTEzLjE5MTU5LDE3Ljk4ODE2Yy0xLjExOTc1LDYuNzAyMDMsMS4wMDkzNCwxMi45MzQ1NywyLjA0Njg4LDE1LjQ0NDgyICAgIGMtMC4zNDMzOCwwLjA3OTM1LTAuNjYwNTgsMC4xNDUyNi0wLjkyNjc2LDAuMTg3OTljLTMuMTEzMjgsMC41MDQ4OC0xNC4yOTI5Ny0xLjUxNTYyLTE5Ljc5Mjk3LTIuNjU2MjUgICAgYy0wLjAwMzkxLTAuMDAwOTgtMC4wMDc4MS0wLjAwMTk1LTAuMDExNzItMC4wMDI5M2MtMC4wMDE5NSwwLTAuMDA0ODgtMC4wMDA5OC0wLjAwNjg0LTAuMDAwOTggICAgYy0wLjU0MDA0LTAuMTExMzMtMS4wNjczOCwwLjI0MTIxLTEuMTc1NzgsMC43ODEyNWMtMC4wMjc1OSwwLjEzNTEzLTAuMDIwMjYsMC4yNjcwOSwwLjAwNTI1LDAuMzk0MTcgICAgYy0wLjAxMzA2LDAuMDU3NzQtMC4wMzksMC4xMTAyMy0wLjA0MjM2LDAuMTcxMjZjLTAuMTIxMDksMi4xODU1NS0wLjIxNzc3LDQuNjk4MjQsMC4xNjc5Nyw2Ljg3ODkxICAgIGMwLjcwNjA1LDQuMDAzOTEsNC4wNzMyNCwxMi43OTE5OSwxOS45NzA3LDEyLjc5MTAyYzEuMjI4NTItMC4wMDA5OCwyLjUzNDE4LTAuMDUyNzMsMy45MTYwMi0wLjE2NDA2ICAgIGMwLjE1NDI0LTAuMDEyNTcsMC4yOTI1NC0wLjA2NTU1LDAuNDE3ODUtMC4xMzg1NWMwLjI1MzY2LDAuMDA1NzQsMC41MDcwOCwwLjAxNzQ2LDAuNzYwODYsMC4wMTc0NiAgICBjNS40ODkyNiwwLDEwLjk4NTM1LTEuMzU1NDcsMTUuNTA2ODQtMy43ODcxMWMwLjE1MTYxLTAuMDgxNTQsMC4yOTc0Mi0wLjE3NDkzLDAuNDQ1NjgtMC4yNjMzMSAgICBjMC4wNDMyNywwLjAxMTM1LDAuMDc5OTYsMC4wMzYwMSwwLjEyNTYxLDAuMDQxNjNjMC42NDk0MSwwLjA4MDA4LDEuMjQ0MTQsMC4xMTQyNiwxLjgwNjY0LDAuMTE0MjYgICAgYzEuNjY3OTcsMCwzLjA0Mzk1LTAuMzA2NjQsNC42NzY3Ni0wLjY3MDljMC4zNzQwMi0wLjA4Mzk4LDAuNzYzNjctMC4xNzA5LDEuMTc1NzgtMC4yNTc4MSAgICBjNi43NzA1MS0xLjQzNDU3LDExLjU1ODU5LTQuMDc0MjIsMTQuNjM3Ny04LjA3MDMxQzgyLjM1MTU2LDY2Ljc3MDUxLDg0LjEwNDQ5LDYwLjk1NzAzLDgzLjgxNjQxLDU1LjE1ODJ6IE00My42NTEzNyw0MC42MTMyOCAgICBjMC4wNzE0MSwwLjIzNjA4LTAuMDQ1MSwwLjk3OTk4LTAuMjUzMTcsMS43MzM3NmMtMC42Njk4NiwwLjA4ODM4LTIuMDE1MzgsMC4wNjIzOC0yLjk2ODM4LDAuMDI1MjcgICAgYzAuNjUyNTktMS4wMzY3NCwxLjM3MzI5LTIuMDEwMjUsMi4xNTktMi45MDUwM0M0My4wODU5NCwzOS44OTIzMyw0My41NTUwNSw0MC4zNzIxOSw0My42NTEzNyw0MC42MTMyOHogTTE3LjUzNzExLDcxLjE0NzQ2ICAgIGMtMC4wMTc4Mi0wLjEwMTA3LTAuMDIyMzQtMC4yMTM2Mi0wLjAzNzktMC4zMTY2NWMwLjU3MjQ1LDEuMTg4NzIsMS4yMjgxNSwyLjMwOTIsMS45NzE1LDMuMzQ0OTcgICAgYzIuMzg3OTQsMy4zMjU5Myw1LjUzMTkyLDUuNzMwODMsOS4wNjEyOCw3LjMzMjY0QzIyLjM1Mzg4LDgwLjAzODgyLDE4LjQ4MDQ3LDc2LjQ4Nzc5LDE3LjUzNzExLDcxLjE0NzQ2eiBNNjIuNzU5NzcsNzcuNDgzNCAgICBjLTEuMzcwNzksMC4zMDU1NC0yLjQ5MzQxLDAuNTUwMjktMy43NDEyMSwwLjYwNTcxYzAuODcyNjgtMC44MzA5MywxLjY1NzIzLTEuNzY3ODIsMi4zNDg0NS0yLjc1NzgxICAgIGMxLjEyODM2LDAuNDE4MDksMi4xNzA0MSwwLjg4NjIzLDIuMzc0MjEsMS4wNzAwN2MwLjE0MDk5LDAuMTY0MDYsMC4zMTQxNSwwLjQ1MTY2LDAuNDc4NTgsMC43NTU2MiAgICBjLTAuMDkwMTUsMC4wMTk3OC0wLjE3MTgxLDAuMDQ0NDMtMC4yNjI3NiwwLjA2MzcyQzYzLjUzNjEzLDc3LjMxMDU1LDYzLjEzOTY1LDc3LjM5ODQ0LDYyLjc1OTc3LDc3LjQ4MzR6Ij48L3BhdGg+PHBhdGggZmlsbD0iI0Y1RDMyNyIgZD0iTTU0LjcxMDk0LDQ2LjcyNDYxYy0wLjE1MTM3LTAuNTMxMjUtMC43MDk5Ni0wLjgzNjkxLTEuMjM2MzMtMC42ODU1NSAgICBjLTAuNDgwNDcsMC4xMzY3Mi0xLjk4NjMzLDAuNzc2MzctMi44NDI3NywxLjE0NjQ4Yy0wLjU0MDA0LTAuNDEwMTYtMS40ODkyNi0xLjE0MDYyLTIuMzUyNTQtMS44MDk1NyAgICBjLTAuNDM3NS0wLjMzNTk0LTEuMDY0NDUtMC4yNTc4MS0xLjQwMzMyLDAuMTc4NzFjLTAuMzM3ODksMC40MzY1Mi0wLjI1NzgxLDEuMDY0NDUsMC4xNzg3MSwxLjQwMzMyICAgIGMwLjUwNzE0LDAuMzkyMzMsMS45NjY1NSwxLjUyMDUxLDIuNjA1NTksMS45OTgyOWwwLjgxNDMzLDIuMjk0NjhjMC4xMjk4OCwwLjM2NzE5LDAuNDYxOTEsMC42MjU5OCwwLjg0OTYxLDAuNjYyMTEgICAgYzEuMzU3NDIsMC4xMjU5OCwzLjAyNjM3LDAuMzUyNTQsMy40NTIxNSwwLjUwMDk4YzAuMTY3OTcsMC4xMTIzLDAuMzYyMywwLjE2ODk1LDAuNTU2NjQsMC4xNjg5NSAgICBjMC4yNTU4NiwwLDAuNTExNzItMC4wOTc2NiwwLjcwNzAzLTAuMjkyOTdjMC4zOTA2Mi0wLjM5MDYyLDAuMzkwNjItMS4wMjM0NCwwLTEuNDE0MDYgICAgYy0wLjIwNzAzLTAuMjA4MDEtMC41NDY4OC0wLjU0Njg4LTMuODkzNTUtMC44OTI1OGwtMC4zOTE1NC0xLjEwMzUyYzAuOTU4NS0wLjQwOTkxLDEuOTk3OC0wLjg0MDk0LDIuMjcwNDUtMC45MTg5NSAgICBDNTQuNTU2NjQsNDcuODA5NTcsNTQuODYzMjgsNDcuMjU1ODYsNTQuNzEwOTQsNDYuNzI0NjF6Ij48L3BhdGg+PHBhdGggZmlsbD0iI0ZGRkZGRiIgZD0iTTU3Ljk5NjA5LDQxLjUxNzU4bDEuMzgwODYsMi40Njk3M2MwLjE4MzU5LDAuMzI4MTIsMC41MjM0NCwwLjUxMjcsMC44NzQwMiwwLjUxMjcgICAgYzAuMTY1MDQsMCwwLjMzMjAzLTAuMDQxMDIsMC40ODYzMy0wLjEyNjk1YzAuNDgyNDItMC4yNjk1MywwLjY1NTI3LTAuODc4OTEsMC4zODU3NC0xLjM2MDM1bC0xLjU4MzAxLTIuODMzMDEgICAgYy0wLjEyOTg4LTAuMjMyNDItMC4zNDY2OC0wLjQwMzMyLTAuNjAyNTQtMC40NzU1OWwtMS41ODMwMS0wLjQ0NTMxYzAuNTczMjQtMS42MTYyMSwwLjQzNzUtMi42NDc0Ni0wLjQwODItMy4wNzAzMSAgICBjLTAuMzQxOC0wLjE3MDktMS40NTYwNS0xLjA1NjY0LTIuMjkyOTctMS43NzgzMmMtMC40MTYwMi0wLjM1OTM4LTEuMDQ5OC0wLjMxNTQzLTEuNDEwMTYsMC4xMDM1MiAgICBjLTAuMzYxMzMsMC40MTc5Ny0wLjMxNDQ1LDEuMDQ4ODMsMC4xMDM1MiwxLjQxMDE2YzAuMjc2MzcsMC4yMzgyOCwxLjUyNjM3LDEuMzA4NTksMi4zNDI3NywxLjgzOTg0ICAgIGMtMC4wNjU0MywwLjM5MzU1LTAuMzEyNSwxLjEyMTA5LTAuNTk1NywxLjczMDQ3Yy0wLjAwNjY1LDAuMDE0MjgtMC4wMDQwOSwwLjAzMDUyLTAuMDEwMDEsMC4wNDQ5MiAgICBjLTAuMDA2NDEsMC4wMTU2Mi0wLjAxOTQ3LDAuMDI2LTAuMDI1MTUsMC4wNDE5OWwtMC44MzMwMSwyLjMzMzAxYy0wLjE4NjUyLDAuNTE5NTMsMC4wODQ5NiwxLjA5MTgsMC42MDU0NywxLjI3NzM0ICAgIGMwLjExMDM1LDAuMDQwMDQsMC4yMjQ2MSwwLjA1ODU5LDAuMzM1OTQsMC4wNTg1OWMwLjQxMTEzLDAsMC43OTU5LTAuMjU0ODgsMC45NDE0MS0wLjY2NDA2bDAuNTE4OTgtMS40NTMzN0w1Ny45OTYwOSw0MS41MTc1OHoiPjwvcGF0aD48cGF0aCBmaWxsPSIjRkZGRkZGIiBkPSJNNjQuMzg0NzcsMzUuMjAxMTdjLTAuMjU2ODQtMC40ODkyNi0wLjg2MzI4LTAuNjc2NzYtMS4zNTA1OS0wLjQxODk1ICAgIGMtMS40MTMwOSwwLjc0MzE2LTIuNjIyMDcsMC45ODI0Mi0yLjYzNzcsMC45ODUzNWMtMC41NDEwMiwwLjEwMjU0LTAuODk4NDQsMC42MjUtMC43OTU5LDEuMTY2OTkgICAgYzAuMDg5ODQsMC40ODA0NywwLjUwOTc3LDAuODE1NDMsMC45ODE0NSwwLjgxNTQzYzAuMDYwNTUsMCwwLjEyMzA1LTAuMDA1ODYsMC4xODU1NS0wLjAxNzU4ICAgIGMwLjAzMzE0LTAuMDA1ODYsMC40ODgwNC0wLjA5NjQ0LDEuMTYzODItMC4zMTkwOWwyLjA5NjkyLDIuODQ2NDRjMC4xOTUzMSwwLjI2NjYsMC40OTgwNSwwLjQwNzIzLDAuODA1NjYsMC40MDcyMyAgICBjMC4yMDYwNSwwLDAuNDE0MDYtMC4wNjM0OCwwLjU5MTgtMC4xOTUzMWMwLjQ0NTMxLTAuMzI3MTUsMC41NDAwNC0wLjk1MzEyLDAuMjExOTEtMS4zOTc0NmwtMC4wMjM2OC0wLjAzMjIzICAgIGMxLjIyMDM0LTAuMzI0NDYsMi45Nzk1NS0wLjkyMjQ5LDMuNzMyNjctMS44MTM0OGMwLjM1NjQ1LTAuNDIxODgsMC4zMDM3MS0xLjA1MjczLTAuMTE4MTYtMS40MDkxOCAgICBjLTAuNDIyODUtMC4zNTg0LTEuMDU0NjktMC4zMDM3MS0xLjQwOTE4LDAuMTE4MTZjLTAuMzk4OTMsMC40NzI0MS0yLjA2NTYxLDEuMDQ4NTgtMy40OTMzNSwxLjM1NjJsLTAuNDk2ODMtMC42NzQ1NiAgICBjMC4wNDYyLTAuMDIzNjgsMC4wOTAwMy0wLjA0Mjg1LDAuMTM2NjYtMC4wNjczOEM2NC40NTQxLDM2LjI5NDkyLDY0LjY0MjU4LDM1LjY5MDQzLDY0LjM4NDc3LDM1LjIwMTE3eiI+PC9wYXRoPjxwYXRoIGZpbGw9IiNGRkZGRkYiIGQ9Ik02NC43MjY1Niw0My41ODc4OWMtMC40NTgwMS0wLjMwNzYyLTEuMDgwMDgtMC4xODc1LTEuMzg4NjcsMC4yNjk1M2wtMi4wNjU0MywzLjA1OTU3SDU4ICAgIGMtMC41NTI3MywwLTEsMC40NDcyNy0xLDFzMC40NDcyNywxLDEsMWgzLjQ2NDM2bDEuMTAzMDMsMS43NzczNGMwLjE4OTQ1LDAuMzA0NjksMC41MTU2MiwwLjQ3MjY2LDAuODUwNTksMC40NzI2NiAgICBjMC4xNzk2OSwwLDAuMzYyMy0wLjA0ODgzLDAuNTI2MzctMC4xNTAzOWMwLjQ2ODc1LTAuMjkxMDIsMC42MTMyOC0wLjkwNzIzLDAuMzIyMjctMS4zNzY5NWwtMS4xNTgyLTEuODY3MTlsMS44ODc3LTIuNzk1OSAgICBDNjUuMzA0NjksNDQuNTE4NTUsNjUuMTg0NTcsNDMuODk3NDYsNjQuNzI2NTYsNDMuNTg3ODl6Ij48L3BhdGg+PHBhdGggZmlsbD0iI0ZGRkZGRiIgZD0iTTc0LjI5MDA0LDQ2LjEyNDAyYzAuMzkwNjItMC4zOTA2MiwwLjQxOTkyLTEuMDQ5OCwwLjAyOTMtMS40NDA0MyAgICBjLTAuMzkxNi0wLjM4OTY1LTAuOTk0MTQtMC40MTY5OS0xLjM4NTc0LTAuMDI1MzljLTAuMjAzMzcsMC4xNTM1Ni0xLjMzODg3LDAuNzk1NDEtMi41MDg3OSwxLjQzNTE4ICAgIGMtMC40ODUxMS0xLjc0MzUzLTEuNDU0ODMtNC4wMzQ5MS0xLjUwNDg4LTQuMTUxOThjLTAuMjE1ODItMC41MDc4MS0wLjgwNDY5LTAuNzQ0MTQtMS4zMTE1Mi0wLjUyODMyICAgIGMtMC41MDc4MSwwLjIxNTgyLTAuNzQ1MTIsMC44MDI3My0wLjUyODMyLDEuMzExNTJjMC4zNzk4OCwwLjg5NTUxLDEuNDEwMTYsMy40ODI0MiwxLjU5OTYxLDQuNjgxNjQgICAgYzAuMTM2NzIsMC44NzEwOS0xLjA5NzY2LDEuNjQ0NTMtMS4xMDU0NywxLjY0OTQxYy0wLjA0MDcxLDAuMDI0MTctMC4wNzQyMiwwLjA1NjE1LTAuMTEwNTMsMC4wODUzMyAgICBjLTAuMDEwNSwwLjAwODQyLTAuMDIzNzQsMC4wMTAzOC0wLjAzNCwwLjAxOTE3Yy0wLjAwNTg2LDAuMDA1MTMtMC4wMDc5MywwLjAxMjQ1LTAuMDEzNjcsMC4wMTc1OCAgICBjLTAuMDg2MywwLjA3ODEyLTAuMTU2MTksMC4xNjk1Ni0wLjIxMDM5LDAuMjcxMjRjLTAuMDExODQsMC4wMjIyMi0wLjAyMDY5LDAuMDQ0MTktMC4wMzA3NiwwLjA2NzE0ICAgIGMtMC4wNDM3NiwwLjA5OTEyLTAuMDc1NjIsMC4yMDMzNy0wLjA4NTQ1LDAuMzEzODRjLTAuMDAwNTUsMC4wMDU5OC0wLjAwMjg3LDAuMDExMzUtMC4wMDMzLDAuMDE3MzMgICAgYy0wLjAwMDEyLDAuMDAyMDgtMC4wMDEwNCwwLjAwNDAzLTAuMDAxMTYsMC4wMDYyM2wtMC4zMzMwMSw1LjI1Yy0wLjAzNTE2LDAuNTUxNzYsMC4zODM3OSwxLjAyNjM3LDAuOTM0NTcsMS4wNjE1MiAgICBjMC4wMjE0OCwwLjAwMDk4LDAuMDQyOTcsMC4wMDE5NSwwLjA2NDQ1LDAuMDAxOTVjMC41MjM0NCwwLDAuOTYzODctMC40MDcyMywwLjk5NzA3LTAuOTM2NTJsMC4xOTEyMi0zLjAxMDc0ICAgIGMxLjAzMjY1LDAuODk2NDgsMS42MjA2MSwxLjAzNTE2LDEuOTI0MDEsMS4wMzUxNmMwLjA2NzM4LDAsMC4xMjEwOS0wLjAwNTg2LDAuMTY0MDYtMC4wMTA3NCAgICBjMC41NDg4My0wLjA2MDU1LDAuOTQ0MzQtMC41NTU2NiwwLjg4Mzc5LTEuMTA0NDljLTAuMDU0NjktMC40OTUxMi0wLjQ2Mzg3LTAuODY2MjEtMC45NDcyNy0wLjg4ODY3ICAgIGMtMC4yNjQ0Ny0wLjEyNDI3LTAuODMzMDEtMC42MjE0Ni0xLjQyMzY1LTEuMjI3MDVjMC40NTIyNy0wLjQ1NTA4LDAuODY0MTQtMS4wNDY4OCwxLjA0NjM5LTEuNzQyMTkgICAgQzczLjkzNjQ2LDQ2LjQ3NjgxLDc0LjE4NDg4LDQ2LjIyOTI1LDc0LjI5MDA0LDQ2LjEyNDAyeiI+PC9wYXRoPjxwYXRoIGZpbGw9IiNGRkZGRkYiIGQ9Ik03MS45OTEyMSw1NS44MzIwM2MtMC4yMjk0OS0wLjUwMDk4LTAuODIxMjktMC43MjI2Ni0xLjMyNjE3LTAuNDkwMjMgICAgYy0wLjUwMDk4LDAuMjMwNDctMC43MjE2OCwwLjgyNDIyLTAuNDkwMjMsMS4zMjYxN2MwLjQ2Nzc3LDEuMDE4NTUsMC45OTEyMSwyLjIxMDk0LDEuMjU0ODgsMi44NzEwOWwtMS44NjAzNSwxLjcyODUyICAgIGMtMC40MDQzLDAuMzc1OTgtMC40Mjc3MywxLjAwODc5LTAuMDUxNzYsMS40MTMwOUM2OS43MTM4Nyw2Mi44OTI1OCw2OS45ODE0NSw2Myw3MC4yNSw2MyAgICBjMC4yNDQxNCwwLDAuNDg4MjgtMC4wODg4NywwLjY4MDY2LTAuMjY3NThsMi4zMzMwMS0yLjE2Njk5YzAuMjQ2MDktMC4yMjg1MiwwLjM2MDM1LTAuNTY1NDMsMC4zMDU2Ni0wLjg5NjQ4ICAgIEM3My40ODI0Miw1OS4xNDY0OCw3Mi42NjQwNiw1Ny4yOTM5NSw3MS45OTEyMSw1NS44MzIwM3oiPjwvcGF0aD48cGF0aCBmaWxsPSIjRkZGRkZGIiBkPSJNNzQuODA5NTcsNjMuNzk5OGMwLjExOTE0LTAuNTM5MDYtMC4yMjA3LTEuMDczMjQtMC43NTk3Ny0xLjE5MzM2ICAgIGMtMC41MzQxOC0wLjExMjMtMS4wNzMyNCwwLjIyMDctMS4xOTMzNiwwLjc1OTc3Yy0wLjA0MTAyLDAuMTg2NTItMC4zMzg4NywxLjUzMTI1LTAuNTAzOTEsMi40MjY3NiAgICBDNzEuNTk5NjEsNjYuMDg5ODQsNzAuMzUwNTksNjYuNSw2OS40MTY5OSw2Ni41Yy0wLjU1MjczLDAtMSwwLjQ0NzI3LTEsMXMwLjQ0NzI3LDEsMSwxICAgIGMxLjA4NDY2LDAsMi4zMDI0My0wLjM1MzUyLDMuMTU5NzktMC42NTg2OWMwLjAyNzQ3LDAuMDE4MDcsMC4wNDYwMiwwLjA0NTQxLDAuMDc1NTYsMC4wNjEwNCAgICBjMC4wNjkzNCwwLjAzNjEzLDAuNjcxODgsMC4zOTQ1MywwLjUyMTQ4LDEuNjQ1NTFjLTAuMDY1NDMsMC41NDg4MywwLjMyNjE3LDEuMDQ1OSwwLjg3NDAyLDEuMTEyMyAgICBjMC4wNDAwNCwwLjAwNDg4LDAuMDgxMDUsMC4wMDY4NCwwLjEyMDEyLDAuMDA2ODRjMC40OTkwMiwwLDAuOTMwNjYtMC4zNzMwNSwwLjk5MjE5LTAuODgwODYgICAgYzAuMTg1LTEuNTQ1NjUtMC4zMzU1Ny0yLjU2MDc5LTAuOTIwNTMtMy4xNTMyYzAuMDAwNDktMC4wMDM0MiwwLjAwMjE0LTAuMDA2NDcsMC4wMDI1Ni0wLjAwOTg5ICAgIEM3NC4zMDU2Niw2Ni4xMTUyMyw3NC42NzI4NSw2NC40MTMwOSw3NC44MDk1Nyw2My43OTk4eiI+PC9wYXRoPjwvZz48L2c+PC9zdmc+")}');
        GM_addStyle('.em-icon-lemon { background-image:url("data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjRkZGRkZGIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgMTAwIDEwMCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMTAwIDEwMCIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PGc+PHBhdGggZmlsbD0iI0ZGRkZGRiIgZD0iTTIxLjYxOSw5NC4yNzFjLTEuNzQ1LDAtMy4zNDctMC41MzUtNC42MzctMS41NTFjLTIuOTU4LTIuMzI2LTMuNjc4LTYuNjY0LTEuODc3LTEwLjc4NyAgIGMtNy41NjUtMTEuODM2LTUuMzYtMjkuNDk4LDUuNTE0LTQzLjMyMmM4LjM3Ni0xMC42NTEsMjAuMjY5LTE3LjAwOSwzMS44MDktMTcuMDA5YzMuMDk4LDAsNi4wNjUsMC40Nyw4LjgzMSwxLjM5OCAgIGMzLjU1LTMuMDQ4LDguNDY0LTMuNjAyLDExLjUxNy0xLjIwOGMzLjE1MiwyLjQ4MSwzLjc0Myw3LjE5MiwxLjU0NCwxMS40NzhjNy40NDgsMTEuODM1LDUuMjEyLDI5LjQyNy01LjYwNSw0My4xNzcgICBDNjAuMzM1LDg3LjEsNDguNDQ0LDkzLjQ1OSwzNi45MDUsOTMuNDU5Yy0wLjAwMywwLTAuMDAzLDAtMC4wMDMsMGMtMy4xNTgsMC02LjE4LTAuNDktOC45OTEtMS40NTEgICBDMjUuOTc5LDkzLjQ3MywyMy43NzcsOTQuMjcxLDIxLjYxOSw5NC4yNzF6IE01Mi40MjgsMjQuNjg4Yy0xMC42MDMsMC0yMS41ODgsNS45MTgtMjkuMzg2LDE1LjgzMSAgIGMtMTAuMjc4LDEzLjA2OS0xMi4yOTMsMjkuNjg4LTQuODk2LDQwLjQxOWMwLjMyNSwwLjQ2OSwwLjM2MiwxLjA4NiwwLjA5MywxLjU5MmMtMS41NjMsMi45NzUtMS4yODksNi4yNCwwLjY1MSw3Ljc2NiAgIGMxLjkxLDEuNTA2LDUuMjQzLDAuOTY5LDcuNzA0LTEuMTk1YzAuNDMxLTAuMzc5LDEuMDQyLTAuNDg4LDEuNTctMC4yODFjMi42OTcsMS4wMzEsNS42MzgsMS41NTUsOC43MzgsMS41NTUgICBjMTAuNjAzLDAsMjEuNTg4LTUuOTE4LDI5LjM4OS0xNS44MzRjMTAuMjM5LTEzLjAxOCwxMi4yNzItMjkuNjA1LDQuOTQ4LTQwLjMzNmMtMC4zNDEtMC41LTAuMzU4LTEuMTU3LTAuMDQyLTEuNjc0ICAgYzEuODk2LTMuMDk5LDEuNzU0LTYuNjcyLTAuMzMxLTguMzEyYy0yLjA0OC0xLjYxNS01LjY0OS0wLjg2OS04LjE0OCwxLjYzOWMtMC40MjgsMC40My0xLjA3MywwLjU2Ni0xLjYzOSwwLjM1NCAgIEM1OC40MDIsMjUuMiw1NS40OTIsMjQuNjg4LDUyLjQyOCwyNC42ODh6Ij48L3BhdGg+PC9nPjxnPjxwYXRoIGZpbGw9IiNGRkZGRkYiIGQ9Ik03MS44MiwyNC41NDdjLTAuMzg2LDAtMC43NzEtMC4xNDQtMS4wNy0wLjQzM2MtMC42MS0wLjU5MS0wLjYyOS0xLjU2Ny0wLjAzOC0yLjE4MSAgIGMwLjA1OC0wLjA2Miw1Ljk2OC02LjMwNiw2LjA4Mi0xNC45NDFjMC4wMTMtMC44NDUsMC42OTktMS41MjMsMS41NDQtMS41MjNjMC4wMDYsMCwwLjAxMiwwLDAuMDIxLDAgICBjMC44NSwwLjAxMiwxLjUzMywwLjcxMSwxLjUyMSwxLjU2M2MtMC4xMjksOS44OTQtNi42NzMsMTYuNzYtNi45NTEsMTcuMDQ2QzcyLjYyNSwyNC4zOTEsNzIuMjI1LDI0LjU0Nyw3MS44MiwyNC41NDd6Ij48L3BhdGg+PC9nPjxnPjxwYXRoIGZpbGw9IiNGRkZGRkYiIGQ9Ik04My42MDQsMjYuMjgzTDgzLjYwNCwyNi4yODNjLTIuNDQ0LDAtNC43ODUtMS4wNjItNi40MjEtMi45MTZjLTAuNDM5LTAuNDk4LTAuNTA5LTEuMjIxLTAuMTc4LTEuNzk2ICAgYzEuMzg2LTIuMzg0LDMuODQxLTMuOTY5LDYuNTYzLTQuMjM5YzIuNzcxLTAuMjc1LDUuNDM4LDAuODA2LDcuMjcxLDIuODY3YzAuNDQyLDAuNDk5LDAuNTE1LDEuMjI1LDAuMTc3LDEuOCAgIGMtMS4zODksMi4zODgtMy44NDEsMy45NzMtNi41NjUsNC4yNDFDODQuMTY4LDI2LjI3LDgzLjg4NCwyNi4yODMsODMuNjA0LDI2LjI4M3ogTTgwLjM5NiwyMi4xNDUgICBjMS4wNzQsMC43ODMsMi4zODYsMS4xNjMsMy43NTQsMS4wMjVjMS4zNTUtMC4xMzMsMi41NzYtMC43NTEsMy40OC0xLjc0Yy0xLjA4LTAuNzgzLTIuMzg3LTEuMTcyLTMuNzU4LTEuMDI3ICAgQzgyLjUzOCwyMC41MzYsODEuMzAyLDIxLjE2Nyw4MC4zOTYsMjIuMTQ1eiI+PC9wYXRoPjwvZz48Zz48cGF0aCBmaWxsPSIjRkZGRkZGIiBkPSJNNDQuNjYzLDg1LjA0MWMtMC41NTQsMC0xLjA4Ny0wLjI5OS0xLjM2NC0wLjgyMmMtMC4zOTgtMC43NTQtMC4xMDktMS42ODksMC42NDctMi4wODYgICBjMS42MzktMC44NjMsMy4yMDYtMS43NzcsNC42NTgtMi43MTdjMC43MDgtMC40NjMsMS42NjktMC4yNiwyLjEzMywwLjQ1NWMwLjQ2MiwwLjcxNSwwLjI2LDEuNjctMC40NTcsMi4xMzMgICBjLTEuNTI4LDAuOTkyLTMuMTc2LDEuOTU1LTQuOSwyLjg1OUM0NS4xNTEsODQuOTg0LDQ0LjkwOCw4NS4wNDEsNDQuNjYzLDg1LjA0MXoiPjwvcGF0aD48L2c+PGc+PHBhdGggZmlsbD0iI0ZGRkZGRiIgZD0iTTU0LjU2NCw3OC40ODhjLTAuNDM5LDAtMC44NzctMC4xODktMS4xODUtMC41NTNjLTAuNTQ1LTAuNjUyLTAuNDYxLTEuNjI1LDAuMTkzLTIuMTc0ICAgYzE3LjYzOS0xNC43NywxMi42NjctMzIuOTIsMTIuNDQ3LTMzLjY4NWMtMC4yMzUtMC44MTksMC4yMzQtMS42NzIsMS4wNTUtMS45MTFjMC43OTgtMC4yMjUsMS42NjksMC4yMjksMS45MDgsMS4wNDggICBjMC4wNiwwLjIwNyw1Ljc5NiwyMC44MTMtMTMuNDI4LDM2LjkxNUM1NS4yNjcsNzguMzcxLDU0LjkxNCw3OC40ODgsNTQuNTY0LDc4LjQ4OHoiPjwvcGF0aD48L2c+PC9zdmc+")}');
        GM_addStyle('.em-energy-text-hidden { display:none; }');
        GM_addStyle('.em-energy-text { display:initial;text-align:center;display:inline-block;width:100%;font-size:1.42em; }');

        jQ(jQ("#navbarSupportedContent").find("form").find("div").get(0)).prepend(
            "<button type=\"button\" class=\"mr-2 btn btn-sm btn-success em-button\" id=\"em-energy-lemonade\" onclick=\"javascript:ET_EnergyMinderMod.EatFood('lemonade');\"><span id=\"em-energy-lemonade-text\" class=\"cooldown-text em-energy-text-hidden\">0</span><i class=\"em-icon em-icon-lemonade\" id=\"em-energy-lemonade-icon\"></i></button>" +
            "<button type=\"button\" class=\"mr-2 btn btn-sm btn-success em-button\" id=\"em-energy-lemon-honey\" onclick=\"javascript:ET_EnergyMinderMod.EatFood('lemon honey');\"><span id=\"em-energy-lemon-honey-text\" class=\"cooldown-text em-energy-text-hidden\">0</span><i class=\"em-icon em-icon-lemon-honey\" id=\"em-energy-lemon-honey-icon\"></i></button>" +
            "<button type=\"button\" class=\"mr-2 btn btn-sm btn-success em-button\" id=\"em-energy-rockmelon\" onclick=\"javascript:ET_EnergyMinderMod.EatFood('rockmelon');\"><span id=\"em-energy-rockmelon-text\" class=\"cooldown-text em-energy-text-hidden\">0</span><i class=\"em-icon em-icon-rockmelon\" id=\"em-energy-rockmelon-icon\"></i></button>" +
            "<button type=\"button\" class=\"mr-2 btn btn-sm btn-success em-button\" id=\"em-energy-lemon\" onclick=\"javascript:ET_EnergyMinderMod.EatFood('lemon');\"><span id=\"em-energy-lemon-text\" class=\"cooldown-text em-energy-text-hidden\">0</span><i class=\"em-icon em-icon-lemon\" id=\"em-energy-lemon-icon\"></i></button>" +
            "<span>&nbsp;&nbsp;&nbsp;</span>" +
            "<span class=\"mr-2\" id=\"em-energy\"><img src=\"/icons/energy.svg\" class=\"extra-small-icon\"> <span id=\"em-energy-val\">-</span></span>"
        );
    },
};


////////////////////////////////////////////////////////////////
/////////////// ** common.js -- DO NOT MODIFY ** ///////////////
time_val = function()
{
    return CDbl(Math.floor(Date.now() / 1000));
};

IsValid = function(oObject)
{
    if (oObject === undefined) return false;
    if (oObject === null) return false;
    return true;
};

Random = function(iMin, iMax)
{
    return parseInt(iMin + Math.floor(Math.random() * iMax));
};

ShiftClick = function(oEl)
{
    jQ(oEl).trigger(ShiftClickEvent());
};

ShiftClickEvent = function(target)
{
	let shiftclickOrig = jQ.Event("click");
  shiftclickOrig.which = 1; // 1 = left, 2 = middle, 3 = right
  //shiftclickOrig.type = "click"; // "mousedown" ?
	shiftclickOrig.shiftKey = true;
  shiftclickOrig.currentTarget = target;

	let shiftclick = jQ.Event("click");
  shiftclick.which = 1; // 1 = left, 2 = middle, 3 = right
  //shiftclick.type = "click"; // "mousedown" ?
	shiftclick.shiftKey = true;
  shiftclick.currentTarget = target;

	shiftclick.originalEvent = shiftclickOrig;

  //document.ET_Util_Log(shiftclick);

	return shiftclick;
};

if (!String.prototype.replaceAll)
    String.prototype.replaceAll = function(search, replace) { return ((replace === undefined) ? this.toString() : this.replace(new RegExp('[' + search + ']', 'g'), replace)); };

if (!String.prototype.startsWith)
    String.prototype.startsWith = function(search, pos) { return this.substr(((!pos) || (pos < 0)) ? 0 : +pos, search.length) === search; };

CInt = function(v)
{
	try
	{
		if (!isNaN(v)) return Math.floor(v);
		if (typeof v === 'undefined') return parseInt(0);
		if (v === null) return parseInt(0);
		let t = parseInt(v);
		if (isNaN(t)) return parseInt(0);
		return Math.floor(t);
	}
	catch (err) { }

	return parseInt(0);
};

CDbl = function(v)
{
	try
	{
		if (!isNaN(v)) return parseFloat(v);
		if (typeof v === 'undefined') return parseFloat(0.0);
		if (v === null) return parseFloat(0.0);
		let t = parseFloat(v);
		if (isNaN(t)) return parseFloat(0.0);
		return t;
	}
	catch (err) { }

	return parseFloat(0.0);
};

// dup of String.prototype.startsWith, but uses indexOf() instead of substr()
startsWith = function (haystack, needle) { return (needle === "") || (haystack.indexOf(needle) === 0); };
endsWith   = function (haystack, needle) { return (needle === "") || (haystack.substring(haystack.length - needle.length) === needle); };

Chopper = function(sText, sSearch, sEnd)
{
	let sIntermediate = "";

	if (sSearch === "")
		sIntermediate = sText.substring(0, sText.length);
	else
	{
		let iIndexStart = sText.indexOf(sSearch);
		if (iIndexStart === -1)
			return sText;

		sIntermediate = sText.substring(iIndexStart + sSearch.length);
	}

	if (sEnd === "")
		return sIntermediate;

	let iIndexEnd = sIntermediate.indexOf(sEnd);

	return (iIndexEnd === -1) ? sIntermediate : sIntermediate.substring(0, iIndexEnd);
};

ChopperBlank = function(sText, sSearch, sEnd)
{
	let sIntermediate = "";

	if (sSearch === "")
		sIntermediate = sText.substring(0, sText.length);
	else
	{
		let iIndexStart = sText.indexOf(sSearch);
		if (iIndexStart === -1)
			return "";

		sIntermediate = sText.substring(iIndexStart + sSearch.length);
	}

	if (sEnd === "")
		return sIntermediate;

	let iIndexEnd = sIntermediate.indexOf(sEnd);

	return (iIndexEnd === -1) ? "" : sIntermediate.substring(0, iIndexEnd);
};

CondenseSpacing = function(text)
{
	while (text.indexOf("  ") !== -1)
		text = text.replace("  ", " ");
	return text;
};

// pad available both ways as pad(string, width, [char]) or string.pad(width, [char])
pad = function(sText, iWidth, sChar)
{
    sChar = ((sChar !== undefined) ? sChar : ('0'));
    sText = sText.toString();
    return ((sText.length >= iWidth) ? (sText) : (new Array(iWidth - sText.length + 1).join(sChar) + sText));
};

if (!String.prototype.pad) {
  String.prototype.pad = function(iWidth, sChar) {
    sChar = ((sChar !== undefined) ? sChar : ('0'));
    return ((this.length >= iWidth) ? (this) : (new Array(iWidth - this.length + 1).join(sChar) + this));
  };
}

String.prototype.toHHMMSS = function () {
    let sec_num = parseInt(this, 10);
    let hours   = Math.floor(sec_num / 3600);
    let minutes = Math.floor((sec_num - (hours * 3600)) / 60);
    let seconds = sec_num - (hours * 3600) - (minutes * 60);

    if (hours   < 10) {hours   = "0"+hours;}
    if (minutes < 10) {minutes = "0"+minutes;}
    if (seconds < 10) {seconds = "0"+seconds;}
    return hours+':'+minutes+':'+seconds;
};

String.prototype.toFriendlyTime = function () {
    let sec_num = parseInt(this, 10);
    let hours   = Math.floor(sec_num / 3600);
    let minutes = Math.floor((sec_num - (hours * 3600)) / 60);
    let seconds = sec_num - (hours * 3600) - (minutes * 60);

    let out = '';

    if (hours > 0) out = `${out}${hours}h`;
    if (minutes > 0) out = `${out}${minutes}m`;
    if (seconds > 0) out = `${out}${seconds}s`;
    return out;
};

Number.prototype.toPercent = function () {
    try
    {
        let pct_val = parseFloat(this);
        if (pct_val >= 15.0) return pct_val.toFixed(0);
        return pct_val.toFixed(1).replace(".0", "");
    }
    catch (err) { }
    return 'NaN';
};

is_visible = (function () {
    let x = window.pageXOffset ? window.pageXOffset + window.innerWidth - 1 : 0,
        y = window.pageYOffset ? window.pageYOffset + window.innerHeight - 1 : 0,
        relative = !!((!x && !y) || !document.elementFromPoint(x, y));
    function inside(child, parent) {
        while(child){
            if (child === parent) return true;
            child = child.parentNode;
        }
        return false;
    }
    return function (elem) {
        if (
            hidden ||
            elem.offsetWidth==0 ||
            elem.offsetHeight==0 ||
            elem.style.visibility=='hidden' ||
            elem.style.display=='none' ||
            elem.style.opacity===0
        ) return false;
        let rect = elem.getBoundingClientRect();
        if (relative) {
            if (!inside(document.elementFromPoint(rect.left + elem.offsetWidth/2, rect.top + elem.offsetHeight/2),elem)) return false;
        } else if (
            !inside(document.elementFromPoint(rect.left + elem.offsetWidth/2 + window.pageXOffset, rect.top + elem.offsetHeight/2 + window.pageYOffset), elem) ||
            (
                rect.top + elem.offsetHeight/2 < 0 ||
                rect.left + elem.offsetWidth/2 < 0 ||
                rect.bottom - elem.offsetHeight/2 > (window.innerHeight || document.documentElement.clientHeight) ||
                rect.right - elem.offsetWidth/2 > (window.innerWidth || document.documentElement.clientWidth)
            )
        ) return false;
        if (window.getComputedStyle || elem.currentStyle) {
            let el = elem,
                comp = null;
            while (el) {
                if (el === document) {break;} else if(!el.parentNode) return false;
                comp = window.getComputedStyle ? window.getComputedStyle(el, null) : el.currentStyle;
                if (comp && (comp.visibility=='hidden' || comp.display == 'none' || (typeof comp.opacity !=='undefined' && comp.opacity != 1))) return false;
                el = el.parentNode;
            }
        }
        return true;
    };
})();

function sumObjectsByKey(...objs) {
	return objs.reduce((a, b) => {
		for (let k in b) {
			if (b.hasOwnProperty(k))
				a[k] = (a[k] || 0) + b[k];
		}
		return a;
	}, {});
}
////////////////////////////////////////////////////////////////


////////////////////////////////////////////////////////////////
////////////// ** common_ET.js -- DO NOT MODIFY ** /////////////
if (window.ET === undefined) window.ET = { };
if ((window.ET.MCMF === undefined) || (CDbl(window.ET.MCMF.version) < 1.08)) // MeanCloud mod framework
{
    window.ET.MCMF =
    {
        version: 1.08,

        TryingToLoad: false,
        WantDebug: false,
        WantFasterAbilityCDs: false,

        InBattle: false,
        FinishedLoading: false,
        Initialized: false,
        AbilitiesReady: false,
        InitialAbilityCheck: true,
        TimeLeftOnCD: 9999,
        TimeLastFight: 0,

        ToastMessageSuccess: function(msg)
        {
            toastr.success(msg);
        },

        ToastMessageWarning: function(msg)
        {
            toastr.warning(msg);
        },

        EventSubscribe: function(sEventName, fnCallback, sNote)
        {
            if (window.ET.MCMF.EventSubscribe_events === undefined)
                window.ET.MCMF.EventSubscribe_events = [];

            let newEvtData = {};
                newEvtData.name = ((!sEventName.startsWith("ET:")) ? (`ET:${sEventName}`) : (sEventName));
                newEvtData.callback = fnCallback;
                newEvtData.note = sNote;

            window.ET.MCMF.EventSubscribe_events.push(newEvtData);

            if (window.ET.MCMF.WantDebug) window.ET.MCMF.Log(`Added event subscription '${sEventName}'!` + ((sNote === undefined) ? "" : ` (${sNote})`));
        },

        EventTrigger: function(sEventName)
        {
            if (window.ET.MCMF.EventSubscribe_events === undefined) return;

            window.ET.MCMF.EventSubscribe_events.forEach(function(oThisEvent)
            {
                if (sEventName === oThisEvent.name)
                {
                    if (window.ET.MCMF.WantDebug) window.ET.MCMF.Log(`FIRING '${oThisEvent.name}'!` + ((oThisEvent.note === undefined) ? "" : ` (${oThisEvent.note})`));
                    try { oThisEvent.callback(); } catch (err) { if (window.ET.MCMF.WantDebug) window.ET.MCMF.Log("Exception:"); console.log(err); }
                }
            });
        },

        Log: function(msg)
        {
            try
            {
                let now = new Date();
                let timestamp_date = `${(now.getMonth()+1)}/${now.getDate()}`;
                let timestamp_time = `${((now.getHours()===0)?12:((now.getHours()>12)?(now.getHours()-12):(now.getHours())))}:${now.getMinutes().toString().padStart(2,"0")}:${now.getSeconds().toString().padStart(2,"0")}${((now.getHours()< 2)?"a":"p")}`;
                console.log(`%c${timestamp_date} ${timestamp_time}%c  ${msg}`, "color: #555;", "font-weight: bold;");
            }
            catch (err) { }
        },

        Time: function() // returns time in milliseconds (not seconds!)
        {
            return CInt((new Date()).getTime());
        },

        SubscribeToGameChannel: function(channel_name)
        {
            let oChannel;

            try
            {
                channel_name = channel_name.toString().trim();

                let bAlreadySubscribed = false;

                jQuery.makeArray(Object.keys(Meteor.connection._subscriptions).map(key => Meteor.connection._subscriptions[key])).forEach(function(oThisConnection)
                {
                    try
                    {
                        if (oThisConnection.name === channel_name)
                            bAlreadySubscribed = true;
                    }
                    catch (err) { }
                });

                if (!bAlreadySubscribed)
                {
                    Meteor.subscribe(channel_name);
                    if (window.ET.MCMF.WantDebug) window.ET.MCMF.Log(`Meteor::Subscribed to channel '${channel_name}'`);
                }
            }
            catch (err)
            {
                if (window.ET.MCMF.WantDebug) window.ET.MCMF.Log(`Meteor::Exception in SubscribeToGameChannel("${channel_name}"):`);
                if (window.ET.MCMF.WantDebug) console.log(err);
            }

            return oChannel;
        },

        CraftingBuff: function()
        {
            let oDate, iTimeLeft;

            try
            {
                oDate = new Date(Meteor.connection._stores.state._getCollection().find({ name: "buffCrafting" }).fetch()[0].value.activeTo);
                iTimeLeft = ((oDate) > (new Date())) ? CInt(Math.floor(Math.abs(oDate - (new Date())) / 1000.0)) : 0;

                return { active: (iTimeLeft > 0), remaining: iTimeLeft, expires: oDate };
            }
            catch (err) { }

            return { active: false, remaining: 0, expires: oDate };
        },

        CombatBuff: function()
        {
            let oDate, iTimeLeft;

            try
            {
                oDate = new Date(Meteor.connection._stores.state._getCollection().find({ name: "buffCombat" }).fetch()[0].value.activeTo);
                iTimeLeft = ((oDate) > (new Date())) ? CInt(Math.floor(Math.abs(oDate - (new Date())) / 1000.0)) : 0;

                return { active: (iTimeLeft > 0), remaining: iTimeLeft, expires: oDate };
            }
            catch (err) { }

            return { active: false, remaining: 0, expires: oDate };
        },

        GatheringBuff: function()
        {
            let oDate, iTimeLeft;

            try
            {
                oDate = new Date(Meteor.connection._stores.state._getCollection().find({ name: "buffGathering" }).fetch()[0].value.activeTo);
                iTimeLeft = ((oDate) > (new Date())) ? CInt(Math.floor(Math.abs(oDate - (new Date())) / 1000.0)) : 0;

                return { active: (iTimeLeft > 0), remaining: iTimeLeft, expires: oDate };
            }
            catch (err) { }

            return { active: false, remaining: 0, expires: oDate };
        },

        PersonalCraftingBuff: function()
        {
            let oDate, iTimeLeft;

            try
            {
                oDate = new Date(Meteor.connection._stores.users._getCollection().find().fetch()[0].craftingUpgradeTo);
                iTimeLeft = ((oDate) > (new Date())) ? CInt(Math.floor(Math.abs(oDate - (new Date())) / 1000.0)) : 0;

                return { active: (iTimeLeft > 0), remaining: iTimeLeft, expires: oDate };
            }
            catch (err) { }

            return { active: false, remaining: 0, expires: oDate };
        },

        PersonalWoodcuttingBuff: function()
        {
            let oDate, iTimeLeft;

            try
            {
                oDate = new Date(Meteor.connection._stores.users._getCollection().find().fetch()[0].woodcuttingUpgradeTo);
                iTimeLeft = ((oDate) > (new Date())) ? CInt(Math.floor(Math.abs(oDate - (new Date())) / 1000.0)) : 0;

                return { active: (iTimeLeft > 0), remaining: iTimeLeft, expires: oDate };
            }
            catch (err) { }

            return { active: false, remaining: 0, expires: oDate };
        },

        // pretty much always true now since the routes changed (/combat and /newCombat are both the same page)
        IsNewCombatTab: function() {
          try {
            const routeName = Router._currentRoute.getName();
            const windowUrl = window.location.href;

            if ((routeName === 'battle') || (routeName === 'combat') || (routeName === 'newCombat') || (routeName === 'fight')) {
              return true;
            }

            if ((windowUrl.indexOf('/battle') !== -1) || (windowUrl.indexOf('/combat') !== -1) || (windowUrl.indexOf('/newCombat') !== -1) || (windowUrl.indexOf('/fight') !== -1)) {
              return true;
            }
          } catch (err) {
          }

          return false;
        },

        GetActiveTab: function()
        {
          let active_tab = "";
          let current_route = Router._currentRoute.getName();

          if ((current_route === "overview") || (current_route === "gameHome")) active_tab = "home";
          if ((current_route === "mine") || (current_route === "mining") || (current_route === "minePit")) active_tab = "mining";
          if ((current_route === "items") || (current_route === "inventory") || (current_route === "craft") || (current_route === "crafting")) active_tab = "crafting";
          if ((current_route === "battle") || (current_route === "combat") || (current_route === "newCombat") || (current_route === "fight")) active_tab = "combat";
          if ((current_route === "woodcut") || (current_route === "woodcutting") || (current_route === "lumber") || (current_route === "lumbering")) active_tab = "woodcutting";
          if ((current_route === "farm") || (current_route === "farming")) active_tab = "farming";
          if ((current_route === "inscribe") || (current_route === "inscribing") || (current_route === "inscription") || (current_route === "enchantments") || (current_route === "alchemy")) active_tab = "inscription";
          if ((current_route === "magic") || (current_route === "astro") || (current_route === "astrology") || (current_route === "astronomy") || (current_route === "spells") || (current_route === "spellBook")) active_tab = "magic";
          if ((current_route === "faq") || (current_route === "help")) active_tab = "faq";
          if (current_route === "chat") active_tab = "chat";
          if ((current_route === "skills") || (current_route === "leaderboard") || (current_route === "ranking") || (current_route === "ranks")) active_tab = "skills";
          if (current_route === "achievements") active_tab = "achievements";
          if ((current_route === "updates") || (current_route === "patchNotes") || (current_route === "changelog") || (current_route === "changes") || (current_route === "news")) active_tab = "updates";

          if (active_tab === "") {
            if (window.location.href.indexOf("/gameHome") !== -1) active_tab = "home";
            if (window.location.href.indexOf("/overview") !== -1) active_tab = "home";
            if (window.location.href.indexOf("/mine") !== -1) active_tab = "mining";
            if (window.location.href.indexOf("/mining") !== -1) active_tab = "mining";
            if (window.location.href.indexOf("/minePit") !== -1) active_tab = "mining";
            if (window.location.href.indexOf("/items") !== -1) active_tab = "crafting";
            if (window.location.href.indexOf("/inventory") !== -1) active_tab = "crafting";
            if (window.location.href.indexOf("/craft") !== -1) active_tab = "crafting";
            if (window.location.href.indexOf("/crafting") !== -1) active_tab = "crafting";
            if (window.location.href.indexOf("/battle") !== -1) active_tab = "combat";
            if (window.location.href.indexOf("/combat") !== -1) active_tab = "combat";
            if (window.location.href.indexOf("/newCombat") !== -1) active_tab = "combat";
            if (window.location.href.indexOf("/fight") !== -1) active_tab = "combat";
            if (window.location.href.indexOf("/woodcut") !== -1) active_tab = "woodcutting";
            if (window.location.href.indexOf("/woodcutting") !== -1) active_tab = "woodcutting";
            if (window.location.href.indexOf("/lumber") !== -1) active_tab = "woodcutting";
            if (window.location.href.indexOf("/lumbering") !== -1) active_tab = "woodcutting";
            if (window.location.href.indexOf("/farm") !== -1) active_tab = "farming";
            if (window.location.href.indexOf("/farming") !== -1) active_tab = "farming";
            if (window.location.href.indexOf("/inscribe") !== -1) active_tab = "inscription";
            if (window.location.href.indexOf("/inscribing") !== -1) active_tab = "inscription";
            if (window.location.href.indexOf("/inscription") !== -1) active_tab = "inscription";
            if (window.location.href.indexOf("/enchantments") !== -1) active_tab = "inscription";
            if (window.location.href.indexOf("/alchemy") !== -1) active_tab = "inscription";
            if (window.location.href.indexOf("/magic") !== -1) active_tab = "magic";
            if (window.location.href.indexOf("/astro") !== -1) active_tab = "magic";
            if (window.location.href.indexOf("/astrology") !== -1) active_tab = "magic";
            if (window.location.href.indexOf("/astronomy") !== -1) active_tab = "magic";
            if (window.location.href.indexOf("/spells") !== -1) active_tab = "magic";
            if (window.location.href.indexOf("/spellBook") !== -1) active_tab = "magic";
            if (window.location.href.indexOf("/faq") !== -1) active_tab = "faq";
            if (window.location.href.indexOf("/help") !== -1) active_tab = "faq";
            if (window.location.href.indexOf("/chat") !== -1) active_tab = "chat";
            if (window.location.href.indexOf("/skills") !== -1) active_tab = "skills";
            if (window.location.href.indexOf("/leaderboard") !== -1) active_tab = "skills";
            if (window.location.href.indexOf("/ranking") !== -1) active_tab = "skills";
            if (window.location.href.indexOf("/ranks") !== -1) active_tab = "skills";
            if (window.location.href.indexOf("/achievements") !== -1) active_tab = "achievements";
            if (window.location.href.indexOf("/updates") !== -1) active_tab = "updates";
            if (window.location.href.indexOf("/patchNotes") !== -1) active_tab = "updates";
            if (window.location.href.indexOf("/changelog") !== -1) active_tab = "updates";
            if (window.location.href.indexOf("/changes") !== -1) active_tab = "updates";
            if (window.location.href.indexOf("/news") !== -1) active_tab = "updates";
          }

            return active_tab;
        },

        GetActiveTabSection: function()
        {
            let active_tab_section = "";

            try
            {
                let active_tab = window.ET.MCMF.GetActiveTab();

                if (active_tab === "mining") active_tab_section = Meteor.connection._stores.users._getCollection().find().fetch()[0].uiState.miningTab;
                if (active_tab === "crafting") active_tab_section = Meteor.connection._stores.users._getCollection().find().fetch()[0].uiState.craftingFilter;
                if (active_tab === "combat")
                {
                    if (window.ET.MCMF.IsNewCombatTab())
                        active_tab_section = Meteor.connection._stores.users._getCollection().find().fetch()[0].uiState.newCombatType;
                    else
                        active_tab_section = Meteor.connection._stores.users._getCollection().find().fetch()[0].uiState.combatTab;
                }
                if (active_tab === "farming") active_tab_section = Meteor.connection._stores.users._getCollection().find().fetch()[0].uiState.farmingTab;
                if (active_tab === "inscription") active_tab_section = Meteor.connection._stores.users._getCollection().find().fetch()[0].uiState.inscriptionFilter;
                if (active_tab === "achievements") active_tab_section = Meteor.connection._stores.users._getCollection().find().fetch()[0].uiState.achievementTab;
                if (active_tab === "magic") active_tab_section = Meteor.connection._stores.users._getCollection().find().fetch()[0].uiState.magicTab;

                active_tab_section = active_tab_section.trim().toLowerCase();

                if (active_tab_section === "minepit") active_tab_section = "mine pit";
                if (active_tab_section === "personalquest") active_tab_section = "personal quest";
                if (active_tab_section === "tower") active_tab_section = "the tower";
                if (active_tab_section === "battlelog") active_tab_section = "battle log";
                if (active_tab_section === "pigment") active_tab_section = "pigments";
                if (active_tab_section === "book") active_tab_section = "books";
                if (active_tab_section === "magic_book") active_tab_section = "magic books";
                if (active_tab_section === "spellbook") active_tab_section = "spell book";

                if (active_tab_section.length === 0)
                    throw "Invalid active tab section";
            }
            catch (err)
            {
                try
                {
                    active_tab_section = jQuery(jQuery("a.active").get(1)).text().trim().toLowerCase();

                    if (active_tab_section.length === 0)
                        throw "Invalid active tab section";
                }
                catch (err) { }
            }

            return active_tab_section;
        },

        BattleSocket_UseAbility: function(abil, targ)
        {
            try
            {
                let sMsg = '';

                if (targ === undefined)
                {
                    sMsg = '["action",{"abilityId":"' + abil + '","targets":[],"caster":"' + window.ET.MCMF.UserID + '"}]';
                    if (window.ET.MCMF.WantDebug) window.ET.MCMF.Log(`Battle socket emitting: '${sMsg}'`);

                    battleSocket.emit
                    (
                        "action",
                        {
                            abilityId: abil,
                            targets: [],
                            caster: window.ET.MCMF.UserID
                        }
                    );
                }
                else
                {
                    sMsg = '["action",{"abilityId":"' + abil + '","targets":["' + targ + '"],"caster":"' + window.ET.MCMF.UserID + '"}]';
                    if (window.ET.MCMF.WantDebug) window.ET.MCMF.Log(`Battle socket emitting: '${sMsg}'`);

                    battleSocket.emit
                    (
                        "action",
                        {
                            abilityId: abil,
                            targets: [targ],
                            caster: window.ET.MCMF.UserID
                        }
                    );
                }
            }
            catch (err) { }
        },

        CallGameCmd: function()
        {
            try
            {
                if (arguments.length > 0)
                {
                    let cmd = arguments[0];
                    let fnc = function() { };

                    if (arguments.length === 1)
                    {
                        if (window.ET.MCMF.WantDebug) window.ET.MCMF.Log(`Calling: '${cmd}' with no data`);
                        Package.meteor.Meteor.call(cmd, fnc);
                    }
                    else
                    {
                        let data1, data2, data3, data4;

                        if (typeof arguments[arguments.length - 1] === "function")
                        {
                            fnc = arguments[arguments.length - 1];
                            if (arguments.length >= 3) data1 = arguments[1];
                            if (arguments.length >= 4) data2 = arguments[2];
                            if (arguments.length >= 5) data3 = arguments[3];
                            if (arguments.length >= 6) data4 = arguments[4];
                        }
                        else
                        {
                            if (arguments.length >= 2) data1 = arguments[1];
                            if (arguments.length >= 3) data2 = arguments[2];
                            if (arguments.length >= 4) data3 = arguments[3];
                            if (arguments.length >= 5) data4 = arguments[4];
                        }

                        if (data1 === undefined)
                        {
                        if (window.ET.MCMF.WantDebug) window.ET.MCMF.Log(`Calling: '${cmd}' with no data`);
                            Package.meteor.Meteor.call(cmd, fnc);
                        }
                        else if (data2 === undefined)
                        {
                            if (window.ET.MCMF.WantDebug) window.ET.MCMF.Log(`Calling: '${cmd}' with { ${JSON.stringify(data1)} }`);
                            Package.meteor.Meteor.call(cmd, data1, fnc);
                        }
                        else if (data3 === undefined)
                        {
                            if (window.ET.MCMF.WantDebug) window.ET.MCMF.Log(`Calling: '${cmd}' with { ${JSON.stringify(data1)}, ${JSON.stringify(data2)} }`);
                            Package.meteor.Meteor.call(cmd, data1, data2, fnc);
                        }
                        else if (data4 === undefined)
                        {
                            if (window.ET.MCMF.WantDebug) window.ET.MCMF.Log(`Calling: '${cmd}' with { ${JSON.stringify(data1)}, ${JSON.stringify(data2)}, ${JSON.stringify(data3)} }`);
                            Package.meteor.Meteor.call(cmd, data1, data2, data3, fnc);
                        }
                        else
                        {
                            if (window.ET.MCMF.WantDebug) window.ET.MCMF.Log(`Calling: '${cmd}' with { ${JSON.stringify(data1)}, ${JSON.stringify(data2)}, ${JSON.stringify(data3)}, ${JSON.stringify(data4)} }`);
                            Package.meteor.Meteor.call(cmd, data1, data2, data3, data4, fnc);
                        }
                    }
                }
                else if (window.ET.MCMF.WantDebug)
                    window.ET.MCMF.Log("Meteor::Warning, CallGameCmd() with no arguments!");
            }
            catch (err)
            {
                if (window.ET.MCMF.WantDebug) window.ET.MCMF.Log("Meteor::Exception in CallGameCmd():");
                if (window.ET.MCMF.WantDebug) console.log(err);
            }
        },

        SendGameCmd: function(cmd)
        {
            try
            {
                Meteor.connection._send(cmd);
            if (window.ET.MCMF.WantDebug) window.ET.MCMF.Log(`Meteor::Sending: ${JSON.stringify(cmd)}`);
            }
            catch (err)
            {
                if (window.ET.MCMF.WantDebug) window.ET.MCMF.Log(`Meteor::Exception in SendGameCmd(${JSON.stringify(cmd)}):`);
                if (window.ET.MCMF.WantDebug) console.log(err);
            }
        },

        FasterAbilityUpdates: function()
        {
            try
            {
                window.ET.MCMF.SubscribeToGameChannel("abilities");

                if ((window.ET.MCMF.WantFasterAbilityCDs) && (window.ET.MCMF.FinishedLoading) && (!window.ET.MCMF.InBattle) && (!window.ET.MCMF.AbilitiesReady))
                    window.ET.MCMF.CallGameCmd("abilities.gameUpdate");
            }
            catch (err) { }

            setTimeout(window.ET.MCMF.FasterAbilityUpdates, 2000);
        },

        PlayerInCombat: function()
        {
            return ((window.ET.MCMF.InBattle) || ((window.ET.MCMF.Time() - window.ET.MCMF.TimeLastFight) < 3));
        },

        AbilityCDTrigger: function()
        {
            try
            {
                if ((window.ET.MCMF.FinishedLoading) && (!window.ET.MCMF.PlayerInCombat()))
                {
                    iTotalCD = 0;
                    iTotalCDTest = 0;
                    iHighestCD = 0;

                    window.ET.MCMF.GetAbilities().forEach(function(oThisAbility)
                    {
                        if (oThisAbility.equipped)
                        {
                            if (parseInt(oThisAbility.currentCooldown) > 0)
                            {
                                iTotalCD += parseInt(oThisAbility.currentCooldown);
                                if (iHighestCD < parseInt(oThisAbility.currentCooldown))
                                    iHighestCD = parseInt(oThisAbility.currentCooldown);
                            }
                        }

                        iTotalCDTest += parseInt(oThisAbility.cooldown);
                    });

                    if ((iTotalCDTest > 0) && (iTotalCD === 0))
                    {
                        if (!window.ET.MCMF.AbilitiesReady)
                        {
                            if (!window.ET.MCMF.InitialAbilityCheck)
                            {
                                if (window.ET.MCMF.WantDebug) window.ET.MCMF.Log("<-- triggering ET:abilitiesReady -->");
                                window.ET.MCMF.EventTrigger("ET:abilitiesReady");
                            }
                        }

                        window.ET.MCMF.AbilitiesReady = true;
                        window.ET.MCMF.TimeLeftOnCD = 0;
                    }
                    else
                    {
                        window.ET.MCMF.AbilitiesReady = false;
                        window.ET.MCMF.TimeLeftOnCD = iHighestCD;
                    }

                    window.ET.MCMF.InitialAbilityCheck = false;
                }
                else
                {
                    window.ET.MCMF.AbilitiesReady = false;
                    window.ET.MCMF.TimeLeftOnCD = 9999;
                }
            }
            catch (err) { }

            setTimeout(window.ET.MCMF.AbilityCDTrigger, 500);
        },

        BattleFloorRoom: "0.0",
        BattleFirstFrame: undefined,
        BattleUnitList: [],
        BattleUITemplate: undefined,

        LiveBattleData: function()
        {
            try
            {
                if (window.ET.MCMF.BattleUITemplate !== undefined)
                    return window.ET.MCMF.BattleUITemplate.state.get("currentBattle");
            }
            catch (err) { }

            return undefined;
        },

        LastUnitIDList: '',
        InternalBattleTickMonitor: undefined,

		CombatStarted: function(forced)
		{
			if (!window.ET.MCMF.FinishedLoading || !battleSocket)
			{
				setTimeout(window.ET.MCMF.CombatStarted, 100);
				return;
			}

			if (forced || (window.ET.MCMF.InternalBattleTickMonitor === undefined) || (window.ET.MCMF.BattleFirstFrame === undefined))
			{
                window.ET.MCMF.InternalBattleTickMonitor = true;

				battleSocket.on('tick', function(oAllData)
				{
					let battleData = window.ET.MCMF.LiveBattleData();

					if (battleData !== undefined)
					{
						/* if (battleData.floor !== undefined)
						{
							let currentFloorRoom = CInt(battleData.floor).toFixed(0) + "." + CInt(battleData.room).toFixed(0);

							if (window.ET.MCMF.BattleFloorRoom !== currentFloorRoom)
							{
								window.ET.MCMF.BattleFloorRoom = currentFloorRoom;
								window.ET.MCMF.BattleFirstFrame = undefined;
							}
						} */

                        let CurrentUnitIDList = '';
                        jQ.makeArray(battleData.enemies).forEach(function(oEnemyUnit)
                        {
                            CurrentUnitIDList += `${oEnemyUnit.id}|`;
                        });

                        let bNewBattleFrameReset = false;
                        jQ.makeArray(battleData.enemies).forEach(function(oEnemyUnit)
                        {
                            if (window.ET.MCMF.LastUnitIDList.indexOf(`${oEnemyUnit.id}|`) === -1)
                                bNewBattleFrameReset = true;
                        });

                        if (bNewBattleFrameReset)
                            window.ET.MCMF.BattleFirstFrame = undefined;

                        window.ET.MCMF.LastUnitIDList = CurrentUnitIDList;

						if (window.ET.MCMF.BattleFirstFrame === undefined)
						{
							window.ET.MCMF.BattleFirstFrame = battleData;

							if (window.ET.MCMF.WantDebug) window.ET.MCMF.Log("<-- triggering ET:firstBattleFrame -->");
							window.ET.MCMF.EventTrigger("ET:firstBattleFrame");

                            //window.ET.MCMF.Log("new BattleFirstFrame data:");
                            //console.log(window.ET.MCMF.BattleFirstFrame);
						}

						if (window.ET.MCMF.WantDebug) window.ET.MCMF.Log("<-- triggering ET:combatTick -->");
						window.ET.MCMF.EventTrigger("ET:combatTick");
					}
				});
			}
		},

        InitGameTriggers: function()
        {
            if ((Package.meteor.Meteor === undefined) || (Package.meteor.Meteor.connection === undefined) || (Package.meteor.Meteor.connection._stream === undefined) || (Template.currentBattleUi === undefined))
            {
                setTimeout(window.ET.MCMF.InitGameTriggers, 100);
                return;
            }

			window.ET.MCMF.EventSubscribe("ET:navigation", function()
			{
                window.ET.MCMF.InternalBattleTickMonitor = undefined;

                // re-trigger combat-start events when the battle socket is reconnected
				if (window.ET.MCMF.InBattle && window.ET.MCMF.IsNewCombatTab())
					window.ET.MCMF.CombatStarted(true);
			});

			Router.onRun(function()
			{
				if (window.ET.MCMF.WantDebug) window.ET.MCMF.Log("<-- triggering ET:navigation -->");
				window.ET.MCMF.EventTrigger("ET:navigation");

                try
                {
                    let sCurrentRoute = Router._currentRoute.getName();

                    if (window.ET.MCMF.WantDebug) window.ET.MCMF.Log(`<-- triggering ET:navigation:${sCurrentRoute} -->`);
                    window.ET.MCMF.EventTrigger(`ET:navigation:${sCurrentRoute}`);
                }
                catch (err) { }

				this.next();
			});

            // note: not a trustworthy method to get new battle unit data, since the templates will reuse and not trigger render from room to room
            Blaze._getTemplate("battleUnit").onRendered(function()
            {
                if ((this.data !== undefined) && (this.data.unit !== undefined))
                    window.ET.MCMF.BattleUnitList.push(this);
            });

            Template.currentBattleUi.onCreated(function()
            {
                window.ET.MCMF.BattleUITemplate = this;
            });

            Template.currentBattleUi.onDestroyed(function()
            {
                window.ET.MCMF.BattleUITemplate = undefined;
                window.ET.MCMF.BattleUnitList = [];
            });

            Package.meteor.Meteor.connection._stream.on('message', function(sMeteorRawData)
            {
                //if (window.ET.MCMF.CombatID === undefined)
                //    window.ET.MCMF.GetPlayerCombatData();

                try
                {
                    oMeteorData = JSON.parse(sMeteorRawData);

                    /////////////////////////////////////////////////////////////////////////////////////////////////////////
                    //
                    //  BACKUP TO RETRIEVE USER AND COMBAT IDS
                    //
                    /*
                    if (oMeteorData.collection === "users")
                        if ((window.ET.MCMF.UserID === undefined) || (window.ET.MCMF.UserID.length !== 17))
                            window.ET.MCMF.UserID = oMeteorData.id;

                    if (oMeteorData.collection === "combat")
                        if ((window.ET.MCMF.CombatID === undefined) || (window.ET.MCMF.CombatID.length !== 17))
                            if (oMeteorData.fields.owner === window.ET.MCMF.UserID)
                                window.ET.MCMF.CombatID = oMeteorData.id;
                    */
                    //
                    /////////////////////////////////////////////////////////////////////////////////////////////////////////

                    if (oMeteorData.collection === "battlesList")
                    {
                        window.ET.MCMF.AbilitiesReady = false;

                        if ((oMeteorData.msg === "added") || (oMeteorData.msg === "removed"))
                        {
                            window.ET.MCMF.InternalBattleTickMonitor = undefined;
                            window.ET.MCMF.BattleFirstFrame = undefined;
                            window.ET.MCMF.BattleUnitList = [];
                            window.ET.MCMF.InBattle = (oMeteorData.msg === "added");
                            if (window.ET.MCMF.WantDebug) window.ET.MCMF.Log("<-- triggering ET:combat" + (((oMeteorData.msg === "added")) ? ("Start") : ("End")) + " -->");
                            window.ET.MCMF.EventTrigger("ET:combat" + (((oMeteorData.msg === "added")) ? ("Start") : ("End")));

                            if (window.ET.MCMF.InBattle)
                                window.ET.MCMF.CombatStarted();
                            else
                                window.ET.MCMF.BattleFloorRoom = "0.0";
                        }
                    }

                    if ((oMeteorData.collection === "battles") && (oMeteorData.msg === "added"))
                    {
                        if (oMeteorData.fields.finished)
                        {
                            window.ET.MCMF.WonLast = oMeteorData.fields.win;
                            window.ET.MCMF.TimeLastFight = window.ET.MCMF.Time();

							if (window.ET.MCMF.FinishedLoading)
							{
								if (window.ET.MCMF.WantDebug) window.ET.MCMF.Log("<-- triggering ET:combat" + ((oMeteorData.fields.win) ? ("Won") : ("Lost")) + " -->");
								window.ET.MCMF.EventTrigger("ET:combat" + ((oMeteorData.fields.win) ? ("Won") : ("Lost")));
							}
                        }
						else
							window.ET.MCMF.CombatStarted();
                    }
                }
                catch (err) { }
            });
        },

        PlayerHP: function()
        {
            return window.ET.MCMF.GetPlayerCombatData().stats.health;
        },

        PlayerHPMax: function()
        {
            return window.ET.MCMF.GetPlayerCombatData().stats.healthMax;
        },

        PlayerEnergy: function()
        {
            return window.ET.MCMF.GetPlayerCombatData().stats.energy;
        },

        AbilityCDCalc: function()
        {
            iTotalCD = 0;
            iTotalCDTest = 0;
            iHighestCD = 0;

            window.ET.MCMF.GetAbilities().forEach(function(oThisAbility)
            {
                if (oThisAbility.equipped)
                {
                    if (parseInt(oThisAbility.currentCooldown) > 0)
                    {
                        iTotalCD += parseInt(oThisAbility.currentCooldown);
                        if (iHighestCD < parseInt(oThisAbility.currentCooldown))
                            iHighestCD = parseInt(oThisAbility.currentCooldown);
                    }
                }

                iTotalCDTest += parseInt(oThisAbility.cooldown);
            });

            if ((iTotalCDTest > 0) && (iTotalCD === 0))
            {
                if (!window.ET.MCMF.AbilitiesReady)
                {
                    if (!window.ET.MCMF.InitialAbilityCheck)
                    {
                        if (window.ET.MCMF.WantDebug) window.ET.MCMF.Log("<-- triggering ET:abilitiesReady -->");
                        window.ET.MCMF.EventTrigger("ET:abilitiesReady");
                    }
                }

                window.ET.MCMF.AbilitiesReady = true;
                window.ET.MCMF.TimeLeftOnCD = 0;
            }
            else
            {
                window.ET.MCMF.AbilitiesReady = false;
                window.ET.MCMF.TimeLeftOnCD = iHighestCD;
            }

            window.ET.MCMF.InitialAbilityCheck = false;
        },

        GetUnitCombatData: function(sUnitID)
        {
            let oCombatPlayerData;

            try
            {
                // get recent combat data from stored 'state' data in 'BattleUITemplate' template (comes from 'battleSocket')
                if (window.ET.MCMF.LiveBattleData() !== undefined)
                {

                    jQ.makeArray(window.ET.MCMF.LiveBattleData().units).forEach(function(oCurrentUnit)
                    {
                        if (oCurrentUnit.id === sUnitID)
                            oCombatPlayerData = oCurrentUnit;
                    });
                }
            }
            catch (err) { }

            return oCombatPlayerData;
        },

        GetEnemyCombatData: function(sUnitID)
        {
            let oCombatEnemyData;

            try
            {
                // get recent combat data from stored 'state' data in 'BattleUITemplate' template (comes from 'battleSocket')
                if (window.ET.MCMF.LiveBattleData() !== undefined)
                {
                    jQ.makeArray(window.ET.MCMF.LiveBattleData().enemies).forEach(function(oCurrentUnit)
                    {
                        if (oCurrentUnit.id === sUnitID)
                            oCombatEnemyData = oCurrentUnit;
                    });
                }
            }
            catch (err) { }

            return oCombatEnemyData;
        },

        GetPlayerCombatData: function()
        {
            try
            {
                Meteor.connection._stores.combat._getCollection().find().fetch().forEach(function(oThisCombatUnit)
                {
                    if (oThisCombatUnit.owner === window.ET.MCMF.UserID)
                        window.ET.MCMF.PlayerUnitData = oThisCombatUnit;
                });

                // new: get updated combat data from stored 'state' data in 'BattleUITemplate' template (comes from 'battleSocket')
                if (window.ET.MCMF.LiveBattleData() !== undefined)
                {
                    jQ.makeArray(window.ET.MCMF.LiveBattleData().units).forEach(function(oCurrentUnit)
                    {
                        if (oCurrentUnit.id === window.ET.MCMF.UserID)
                            window.ET.MCMF.PlayerUnitData = oCurrentUnit;
                    });
                }
            }
            catch (err) { }

            return window.ET.MCMF.PlayerUnitData;
        },

        GetAbilities: function()
        {
            return Meteor.connection._stores.abilities._getCollection().find().fetch()[0].learntAbilities;
        },

        GetAdventures: function()
        {
            let oAdventureDetails = { AllAdventures: [], ShortAdventures: [], LongAdventures: [], EpicAdventures: [], PhysicalAdventures: [], MagicalAdventures: [], ActiveAdventures: [], CurrentAdventure: undefined };

            // oThisAdventure
            //    .duration     {duration in seconds} (integer)
            //    .endDate      {end date/time} (Date()) (property only exists if the adventure is ongoing)
            //    .floor        {corresponding Tower Floor} (integer)
            //    .icon         "{imageofbattle.ext}" (string)
            //    .id           "{guid}" (13-digit alphanumeric string)
            //    .length       "short" / "long" / "epic" (string)
            //    .level        {general level} (integer)
            //    .name         "{Name of Battle}" (string)
            //    .room         {corresponding Tower Room in Tower Floor} (integer)
            //    .type         "physical" / "magic" (string)
            //    .startDate    {start date/time} (Date()) (property only exists if the adventure is ongoing)
            window.ET.MCMF.GetAdventures_raw().forEach(function(oThisAdventure)
            {
                try
                {
                    oAdventureDetails.AllAdventures.push(oThisAdventure);
                    if (oThisAdventure.length  === "short")    oAdventureDetails.ShortAdventures   .push(oThisAdventure);
                    if (oThisAdventure.length  === "long")     oAdventureDetails.LongAdventures    .push(oThisAdventure);
                    if (oThisAdventure.length  === "epic")     oAdventureDetails.EpicAdventures    .push(oThisAdventure);
                    if (oThisAdventure.type    === "physical") oAdventureDetails.PhysicalAdventures.push(oThisAdventure);
                    if (oThisAdventure.type    === "magic")    oAdventureDetails.MagicalAdventures .push(oThisAdventure);
                    if (oThisAdventure.endDate !== undefined)  oAdventureDetails.ActiveAdventures  .push(oThisAdventure);
                }
                catch (err) { }
            });

            oAdventureDetails.AllAdventures.sort(function(advA, advB)
            {
                if ((advA.startDate === undefined) && (advB.startDate !== undefined)) return 1;
                if ((advA.startDate !== undefined) && (advB.startDate === undefined)) return -1;
                if ((advA.startDate !== undefined) && (advB.startDate !== undefined))
                {
                    if (advA.startDate > advB.startDate) return 1;
                    if (advA.startDate < advB.startDate) return -1;
                }
                if (advA.duration > advB.duration) return 1;
                if (advA.duration < advB.duration) return -1;
                return 0;
            });

            oAdventureDetails.ActiveAdventures.sort(function(advA, advB)
            {
                if (advA.startDate > advB.startDate) return 1;
                if (advA.startDate < advB.startDate) return -1;
                return 0;
            });

            oAdventureDetails.PhysicalAdventures.sort(function(advA, advB)
            {
                if (advA.duration > advB.duration) return 1;
                if (advA.duration < advB.duration) return -1;
                return 0;
            });

            oAdventureDetails.MagicalAdventures.sort(function(advA, advB)
            {
                if (advA.duration > advB.duration) return 1;
                if (advA.duration < advB.duration) return -1;
                return 0;
            });

            if (oAdventureDetails.ActiveAdventures.length > 0)
                oAdventureDetails.CurrentAdventure = oAdventureDetails.ActiveAdventures[0];

            return oAdventureDetails;
        },

        GetAdventures_raw: function()
        {
            try
            {
                return Meteor.connection._stores.adventures._getCollection().find().fetch()[0].adventures;
            }
            catch (err) { }

            return [];
        },

        GetChats: function()
        {
            return Meteor.connection._stores.simpleChats._getCollection().find().fetch();
        },

        GetItem: function(in__id)
        {
            let oItems = window.ET.MCMF.GetItems({_id: in__id});

            if (oItems.length > 0)
                return oItems[0];

            return {};
        },

        GetItems: function()
        {
            let oItems;

            if (arguments.length === 0)
                oItems = jQ.makeArray(Meteor.connection._stores.items._getCollection().find().fetch());
            else
                oItems = jQ.makeArray(Meteor.connection._stores.items._getCollection().find(arguments[0]).fetch());

            for (let i = 0; i < oItems.length; i++)
                oItems[i] = window.ET.MCMF.AddItemConsts(oItems[i]);

            return oItems;
        },

        AddItemConsts: function(oItem)
        {
            let oItemNew;
            let consts;

            try
            {
                consts = (IsValid(window) && IsValid(window.gameConstants)) ? window.gameConstants : (IsValid(unsafeWindow) && IsValid(unsafeWindow.gameConstants)) ? unsafeWindow.gameConstants : { };

                oItemNew = { ...(oItem) };
                oItemNew = { ...(oItemNew), ...(consts.ITEMS[oItemNew.itemId]) };

                if (IsValid(oItemNew.produces) && IsValid(consts.FARMING) && IsValid(consts.FARMING.plants))
                {
                    oItemNew.plantingDetails = consts.FARMING.plants[oItemNew.produces];

                    if (IsValid(oItemNew.plantingDetails))
                        oItemNew.required = oItemNew.plantingDetails.required;
                }
            }
            catch (err) { }

            try
            {
                oItemNew = { ...(oItemNew), ...(oItem) };
                oItemNew.stats = sumObjectsByKey(oItem.extraStats, consts.ITEMS[oItem.itemId].stats);
            }
            catch (err) { }

            try
            {
                if (typeof oItemNew['description'] === 'function')
                    oItemNew.description = oItemNew.description();
            }
            catch (err) { }

            return oItemNew;
        },

        GetItemConsts: function(sItemID)
        {
            let oItemNew;
            let consts;

            try
            {
                consts = (IsValid(window) && IsValid(window.gameConstants)) ? window.gameConstants : (IsValid(unsafeWindow) && IsValid(unsafeWindow.gameConstants)) ? unsafeWindow.gameConstants : { };

                oItemNew = consts.ITEMS[sItemID];

                if (IsValid(oItemNew.produces) && IsValid(consts.FARMING) && IsValid(consts.FARMING.plants))
                {
                    oItemNew.plantingDetails = consts.FARMING.plants[oItemNew.produces];

                    if (IsValid(oItemNew.plantingDetails))
                        oItemNew.required = oItemNew.plantingDetails.required;
                }
            }
            catch (err) { }

            try
            {
                if (typeof oItemNew['description'] === 'function')
                    oItemNew.description = oItemNew.description();
            }
            catch (err) { }

            return oItemNew;
        },

        GetSkills: function()
        {
            return Meteor.connection._stores.skills._getCollection().find().fetch();
        },

        Setup: function()
        {
            if ((!window.ET.MCMF.TryingToLoad) && (!window.ET.MCMF.FinishedLoading))
            {
                // use whatever version of jQuery available to us
                $("body").append("<div id=\"ET_meancloud_bootstrap\" style=\"visibility: hidden; display: none;\"></div>");
                window.ET.MCMF.TryingToLoad = true;
                window.ET.MCMF.Setup_Initializer();
            }
        },

        Setup_Initializer: function()
        {
            // wait for Meteor availability
            if ((Package === undefined) || (Package.meteor === undefined) || (Package.meteor.Meteor === undefined) || (Package.meteor.Meteor.connection === undefined) || (Package.meteor.Meteor.connection._stream === undefined))
            {
                setTimeout(window.ET.MCMF.Setup_Initializer, 10);
                return;
            }

            if (!window.ET.MCMF.Initialized)
            {
                window.ET.MCMF.Initialized = true;
                window.ET.MCMF.Setup_SendDelayedInitializer();
                window.ET.MCMF.InitGameTriggers();
                window.ET.MCMF.Setup_remaining();
            }
        },

        Setup_SendDelayedInitializer: function()
        {
            try
            {
                jQ("div#ET_meancloud_bootstrap").trigger("ET:initialized");
                window.ET.MCMF.EventTrigger("ET:initialized");
            }
            catch (err)
            {
                setTimeout(window.ET.MCMF.Setup_SendDelayedInitializer, 100);
            }
        },

        Setup_remaining: function()
        {
            try
            {
                if (Meteor === undefined) throw "[MCMF Setup] Not loaded yet: Meteor not initialized";
                if (Meteor.connection === undefined) throw "[MCMF Setup] Not loaded yet: Meteor not initialized";
                if (Meteor.connection._userId === undefined) throw "[MCMF Setup] Not loaded yet: Meteor not initialized";

                window.ET.MCMF.UserID = Meteor.connection._userId;
                window.ET.MCMF.UserName = Meteor.connection._stores.users._getCollection()._collection._docs._map[window.ET.MCMF.UserID].username;
                window.ET.MCMF.GetPlayerCombatData();

                if (window.ET.MCMF.GetAbilities().length < 0) throw "[MCMF Setup] Not loaded yet: no abilities";
                if (window.ET.MCMF.GetItems().length < 0) throw "[MCMF Setup] Not loaded yet: no items";
                if (window.ET.MCMF.GetChats().length < 0) throw "[MCMF Setup] Not loaded yet: no chats";
                if (window.ET.MCMF.GetSkills().length < 0) throw "[MCMF Setup] Not loaded yet: no skills";

                // if the above is all good, then this should be no problem:

                window.ET.MCMF.AbilityCDTrigger();     // set up ability CD trigger
                window.ET.MCMF.AbilityCDCalc();
                window.ET.MCMF.FasterAbilityUpdates(); // set up faster ability updates (do not disable, this is controlled via configurable setting)

                // trigger finished-loading event
                if (!window.ET.MCMF.FinishedLoading)
                {
                    if (window.ET.MCMF.WantDebug) window.ET.MCMF.Log("<-- triggering ET:loaded -->");
                    window.ET.MCMF.EventTrigger("ET:loaded");
                    window.ET.MCMF.FinishedLoading = true;
                }
            }
            catch (err) // any errors and we retry setup
            {
                if (err.toString().indexOf("[MCMF Setup]") !== -1)
                {
                    window.ET.MCMF.Log("ET MCMF setup exception:");
                    console.log(err);
                }

                setTimeout(window.ET.MCMF.Setup_remaining, 500);
            }
        },

        // Ready means the mod framework has been initialized, but Meteor is not yet available
        Ready: function(fnCallback, sNote)
        {
            if (!window.ET.MCMF.Initialized)
                window.ET.MCMF.EventSubscribe("initialized", fnCallback, sNote);
            else
                fnCallback();
        },

        // Loaded means the mod framework and Meteor are fully loaded and available
        Loaded: function(fnCallback, sNote)
        {
            if (!window.ET.MCMF.FinishedLoading)
                window.ET.MCMF.EventSubscribe("loaded", fnCallback, sNote);
            else
                fnCallback();
        },
    };

    window.ET.MCMF.Setup();
}
////////////////////////////////////////////////////////////////


////////////////////////////////////////////////////////////////
////////// ** CORE SCRIPT STARTUP -- DO NOT MODIFY ** //////////
function LoadJQ(callback) {
    if (window.jQ === undefined) { var script=document.createElement("script");script.setAttribute("src","//ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js");script.addEventListener('load',function() {
        var subscript=document.createElement("script");subscript.textContent="window.jQ=jQuery.noConflict(true);("+callback.toString()+")();";document.body.appendChild(subscript); },
    !1);document.body.appendChild(script); } else callback(); } LoadJQ(startup);
////////////////////////////////////////////////////////////////
