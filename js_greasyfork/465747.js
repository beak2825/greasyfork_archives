// ==UserScript==
// @name         Bouton STICKERS FAVORIS
// @namespace    http://tampermonkey.net/
// @version      0.2
// @description  Bouton STICKERS pour ses favoris
// @author       Porn
// @license      MIT
// @match        https://onche.org/*
// @icon         https://www.google.com/s2/favicons?sz=64&domain=onche.org
// @grant        none
// @downloadURL https://update.greasyfork.org/scripts/465747/Bouton%20STICKERS%20FAVORIS.user.js
// @updateURL https://update.greasyfork.org/scripts/465747/Bouton%20STICKERS%20FAVORIS.meta.js
// ==/UserScript==
$(document).ready(function() {
    $('<script>', {src: 'https://code.jquery.com/jquery-3.6.0.min.js'}).appendTo('head');

    var TooltipVisible=false
    let Collections = $([
        '<div class="images"><div class="title">Favoris</div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/ee49fe09-853a-462c-bcea-da9c52b8bfd5!A3A781ITcN/64" title=":ah1:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/61fd670e-cb2b-4098-9922-8b7c9c37a3f5!y6Z1FiET3J/64" title=":ahi5:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/7540fcc2-b6c3-4285-8cbd-f291391979ad!dlict93YGs/64" title=":ahi6:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/56797ddc-6605-4f9f-8672-4d8ff90888c6!IDeVnTzKkP/64" title=":ahi9:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/ddfc42aa-ebf0-4b42-8938-58f35e747ac4!uE4ILAibUb/64" title=":ahi10:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/efd3b138-2bbc-4d14-9cf2-8d4b93b6a625!2oIpFWUAdf/64" title=":ahi11:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/c2afbb2e-877f-4768-bdc2-66c2aa892f39!EGT8rWnvgN/64" title=":ahi12:"><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/fc757e71-cc42-40c7-b716-ee06479a00df!11V7VUKCtM/64" title=":cat_sad:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/da7c76d7-8220-4efb-8cc5-eb1d8ee2acf2!8HbmkKXzzA/64" title=":ris1:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/5255ae97-0a94-4584-a24c-68b5ef366a33!QatgG70B8E/64" title=":ris2:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/248f783c-3c5d-4a45-b570-b3539caecabc!gVUPhIg6B2/64" title=":risitas_1:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/72f58dbd-5533-4386-9dc2-22c08e88d4eb!7n65FAmI0E/64" title=":risi1:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/c0a92974-1b5a-4115-b3fe-cbdb96ee84c8!UBjPE7hpRy/64" title=":risi2:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/1fed0317-58cb-48f0-909c-e1acd779eecd!VMWpt62riT/64" title=":risi12:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/e6d0fa49-a5ce-4414-9704-c60e4ce19e5f!EyryGo1a5z/64" title=":risi15:"></div></div>',
        '<div class="images"><div class="title">Menhera</div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/ce13f70c-6249-4f23-a7f6-d0a4eea04e0c!fmFFfOyN4Q/64" title=":Menhera_1:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/bfd0e31e-78e2-4ec1-b017-05a6467f60f3!gqwrCIUGTa/64" title=":Menhera_2:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/f564bd5c-cda1-4120-a650-febfd37b4f16!vpnxVPqqTi/64" title=":Menhera_3:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/5cf2c191-7420-462c-baf3-d5a635983d99!t8lBt13xKF/64" title=":Menhera_5:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/7888ecda-0263-40a0-bf3a-6f3d3f07ac5a!1fJpydge8O/64" title=":Menhera_6:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/ddb077ca-80c9-493f-93aa-40be86b0912c!SZv32tbcJl/64" title=":Menhera_8:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/91391edf-c2f2-44a3-8a93-5cd955d1e1e9!ZhjQFgDmag/64" title=":Menhera_9:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/9bb93966-638f-42f7-bfe5-b23451533e56!Iy5TYIrhEL/64" title=":Menhera_11:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/2916fff4-8866-4306-8710-e0de39c2e294!o4CjuasHep/64" title=":Menhera_12:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/ba307a42-35b9-4a66-933e-f839c28bb7cd!6JfgxdruzX/64" title=":Menhera_13:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/3ba432de-2b79-41e5-bb6a-cc59fa08c61d!frpkZCaVbW/64" title=":Menhera_14:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/47a50c27-fd29-4388-8180-ceb5ce7a193c!hO9rhMryQC/64" title=":Menhera_15:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/e01489ee-1445-432f-b4ac-a3eb2cfdc152!3pdYtwkkPk/64" title=":Menhera_16:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/576e1ff2-fa06-43d7-8bdc-5662bf558586!KzKoGpbxmf/64" title=":Menhera_18:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/7a04100c-e46b-4ee1-844d-fd1394e4e3a8!2LtyMwOxkb/64" title=":Menhera_20:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/aa8958a4-02ab-4b6e-8700-052068a08d14!pHqRwGE2vP/64" title=":Menhera_22:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/7ca6ef2b-8d09-4eca-a3c7-5583cf946d67!BngoMPjvDu/64" title=":Menhera_23:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/092ffc19-cc92-4ccc-ab60-4e6eb4bf412b!9IT7lvWI54/64" title=":Menhera_25:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/a84f1632-4cd9-450e-9c63-7683da9a8c49!wAoP4AsdRJ/64" title=":Menhera_26:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/8d7f6f28-ff44-4a45-8d30-8be39c199e14!YmGx0KjRlE/64" title=":Menhera_28:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/a9be4031-1fb5-4307-8bae-6fef2e9a1e0a!P7ETwwScrk/64" title=":Menhera_30:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/2babb3af-4fdb-4e06-9dc7-ff88895c254a!o0BkGMd5Fw/64" title=":Menhera_31:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/abb9d205-44e0-4211-acb1-eca5ef834f47!5LQDGNKMR4/64" title=":Menhera_32:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/05f0a97d-c312-4763-aaa9-c5ccf6c4c7fe!dDVSfFqxil/64" title=":Menhera_33:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/99775450-4b79-440f-b1a8-0ccffd3329a4!TZzR1t4peO/64" title=":Menhera_34:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/eba33f0c-4b54-4877-ba65-2df46c1dc9a8!sxvSYkb7iE/64" title=":Menhera_36:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/a7fc6f81-fe3f-4dd0-a112-b3a7d837392b!JiHowj8UWu/64" title=":Menhera_37:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/702ff802-7166-41ca-9b3f-00375e4c0718!CuKgoaNuS8/64" title=":Menhera_38:"></div></div>',
        '<div class="images"><div class="title">Kanna</div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/ee49fe09-853a-462c-bcea-da9c52b8bfd5!A3A781ITcN/64" title=":ahi1:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/61fd670e-cb2b-4098-9922-8b7c9c37a3f5!y6Z1FiET3J/64" title=":ahi5:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/7540fcc2-b6c3-4285-8cbd-f291391979ad!dlict93YGs/64" title=":ahi6:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/a680ad57-634c-4b8a-b88a-0d987b29309a!50yV3b3m6r/64" title=":ahi7:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/56797ddc-6605-4f9f-8672-4d8ff90888c6!IDeVnTzKkP/64" title=":ahi9:"></div></div>',
        '<div class="images"><div class="title">Chats</div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/ddfc42aa-ebf0-4b42-8938-58f35e747ac4!uE4ILAibUb/64" title=":ahi10:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/efd3b138-2bbc-4d14-9cf2-8d4b93b6a625!2oIpFWUAdf/64" title=":ahi11:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/c2afbb2e-877f-4768-bdc2-66c2aa892f39!EGT8rWnvgN/64" title=":ahi12:"></div>',
        '<div class="images"><div class="title">Gifs</div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/da7c76d7-8220-4efb-8cc5-eb1d8ee2acf2!8HbmkKXzzA/64" title=":Ris1:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/5255ae97-0a94-4584-a24c-68b5ef366a33!QatgG70B8E/64" title=":Ris2:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/b93340df-1269-410f-9c54-280a9d0f534b!AJSGdG6dxH/64" title=":Ris3:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/46df0073-4657-4854-83d9-adda5cefad7b!iNOaknEEhV/64" title=":Ris4:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/3bec1a98-1dbf-420d-9bda-c5adbb1a04c2!b65I9Tcz7d/64" title=":Ris5:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/e4ddc247-930b-4787-99a1-fc788a82d9c7!1JjupqQh2W/64" title=":Ris6:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/fdb95b96-a173-4e73-917e-8e9db4e02ab5!jDTW84Dh7M/64" title=":Ris7:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/65a2f519-b2a3-4423-bb54-57818391ed1e!mY5PxIFWge/64" title=":Ris8:"></div><div class="image sticker clickable"><img class="image-sticker-clickable" src="https://cloud.onche.org/2d8ebc19-8892-4d9a-9edd-c8c9ddcadc59!VP87TbG4MK/64" title=":Ris9:"></div></div>',
    ]);

    let tooltip; // define tooltip variable in a higher scope

    $('.item.onche').clone().removeAttr('data-show-smileys').css('filter', 'hue-rotate(200deg)').insertAfter('.item.onche').on('click', function() {
        if (TooltipVisible==false){
            TooltipVisible=true
            tooltip = $('<div id="tooltip" class="with-margin tooltip" style="display: flex; width: 500px; height: 260px;" data-position="top"><div class="tabs"><div class="tab active">Favoris</div><div class="tab">Menhera</div><div class="tab">Kanna</div><div class="tab">Chats</div><div class="tab">Gifs</div></div><div class="content"><div class="images"><div class="title">Placeholder</div><div class="image sticker clickable"><img src="" alt=""></div>').offset({top: $(this).offset().top - 265,left: $(this).offset().left - 100}).appendTo('body');
            function updateTooltip(index) {
                let collection = $(Collections[index]);
                tooltip.find('.title').text(collection.find('.title').text());
                tooltip.find('.content').empty().append(collection.find('.image.sticker.clickable img').clone()).prepend($('<div class="title"></div>').text(collection.find('.title').text()));
            }

            updateTooltip(0);
            tooltip.find('.tab').on('click', function() {
                tooltip.find('.tab.active').removeClass("active");
                $(this).addClass("active");
                updateTooltip($(this).index());});

            $(document).on('click', function(event) {
                if (!$(event.target).closest(tooltip.add('.item.onche')).length) {TooltipVisible=false;tooltip.remove();}
            })
        }})

    $(document).on('click', '.image-sticker-clickable', function(event) {
        $("textarea[name='message']").val($("textarea[name='message']").val().substring(0, $("textarea[name='message']").prop("selectionStart")) + " " + $(this).attr("title") + $("textarea[name='message']").val().substring($("textarea[name='message']").prop("selectionEnd")));        TooltipVisible=false;
        tooltip.remove();
    });
});

