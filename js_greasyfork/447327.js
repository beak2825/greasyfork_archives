// ==UserScript==
// @name        Twitch Auto Loot Mutation
// @namespace   Violentmonkey Scripts
// @match       https://www.twitch.tv/*
// @grant       none
// @version     1.4
// @icon        data:image/jpeg;base64,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
// @author      DanielLambert
// @description This script checks for the loot button after every document change and clicks it if it's detected.
// @license MIT
// @downloadURL https://update.greasyfork.org/scripts/447327/Twitch%20Auto%20Loot%20Mutation.user.js
// @updateURL https://update.greasyfork.org/scripts/447327/Twitch%20Auto%20Loot%20Mutation.meta.js
// ==/UserScript==

function getElementByXpath(path) {
  return document.evaluate(path, document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;
}

function callback(mutationList, observer) {
  const button = getElementByXpath(
      "/html/body/div[1]/div/div[2]/div/div[2]/div/div[1]/aside/div/div/div/div/div/section/div/div[6]/div[2]/div[2]/div[1]/div/div/div/div[2]/div/div/div/button"
  );
  if (button) {
    button.click();
    console.log("%cChange detected: clicked button", "color: green; font-size: 15px");
  }
}

let observer = new MutationObserver(callback);
observer.observe(document.body, {childList: true, subtree: true});



