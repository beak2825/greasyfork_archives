// ==UserScript==
// @name         Neopets - use shop wizard during faerie quests
// @namespace    neoshopwizfaeriewhatever
// @version      0.1
// @description  Lets you use the shop wizard while on faerie quests
// @author       You
// @match        *.neopets.com/market.phtml?type=wizard
// @grant        none
// @require      https://ajax.googleapis.com/ajax/libs/jquery/2.2.3/jquery.min.js
// @downloadURL https://update.greasyfork.org/scripts/35258/Neopets%20-%20use%20shop%20wizard%20during%20faerie%20quests.user.js
// @updateURL https://update.greasyfork.org/scripts/35258/Neopets%20-%20use%20shop%20wizard%20during%20faerie%20quests.meta.js
// ==/UserScript==

$(document).ready(function(){
  if ($('#content .content').first().text().includes("faerie") === true) {
    var faerieText = '<br><hr><center>You\'re on a <a href="http://www.neopets.com/quests.phtml">faerie quest</a>!</center><hr>';
    $('#content .content').first().html('<div style=\"position: relative; float: right; width: 160px; height: 630px; margin-left: 5px;\"><div id=\"ad-160x600DivWrapper\" class=\"rubiconAdWrapper ad_wrapper\" data-dorefresh=\"\" true\"\"=\"\"><p>ADVERTISEMENT</p><iframe class=\"rubicon tower\" scrolling=\"no\" src=\"/ads/rubiconFrame.phtml?rpAccount=11488&amp;rpSite=33442&amp;rpZoneSize=137412-9&amp;rpAdType=js\" style=\"display: none !important;\" hidden=\"\" frameborder=\"0\"></iframe></div></div><div style=\"width: 635px;\"><style type=\"text/css\">.bgYellow {background-color: #FFCC00;}.blistHeader {background-color: #FFCC00;font-weight: bold;font-size: 11px;color: #000000;}.blistTopic {font-size: 12px;}.blistSmall {font-weight: normal;font-size: 11px;}.topicSmall {font-weight: normal;font-size: 10px;}.topic {background-color: #FFFFFF;font-weight: normal;font-size: 12px;color: #000000;border-bottom: 1px solid #000000;}.topicPosted {background-color: #F6F6F6;font-weight: normal;font-size: 10px;color: #000000;border-bottom: 1px solid #000000;}.topicAuthor {background-color: #F6F6F6;font-weight: normal;border-right: 1px solid #000000;border-bottom: 1px solid #000000;}.blockquote {margin: 10px;}.quote {background-color: #F6F6F6;font-size: 11px;font-style: italic;border: 1px solid #000000;padding: 5px;}</style><div class=\"medText\" align=\"center\"><a href=\"/objects.phtml\"><b>Neopia Central</b></a>&nbsp;|<a href=\"/market_bazaar.phtml\"><b>Bazaar</b></a>&nbsp;|<a href=\"/market_plaza.phtml\"><b>Plaza</b></a>&nbsp;|<a href=\"/market_map.phtml\"><b>Marketplace</b></a>&nbsp;|<a href=\"/market.phtml?type=wizard\"><b>Shop Wizard</b></a>&nbsp;|<a href=\"/auctions.phtml\"><b>Auctions</b></a>&nbsp;|<a href=\"/island/tradingpost.phtml\"><b>Trading Post</b></a><br><a href=\"/objects.phtml?type=inventory\"><b>Inventory</b></a>&nbsp;|<a href=\"/closet.phtml\"><b>Closet</b></a>&nbsp;|<a href=\"/safetydeposit.phtml\"><b>Safety Deposit Box</b></a>&nbsp;|<a href=\"/bank.phtml\"><b>Bank</b></a>&nbsp;|<a href=\"/market.phtml?type=your\"><b>Your Shop</b></a><br><a href=\"/battledome/battledome.phtml\"><b>Battledome</b></a>&nbsp;|<a href=\"/guilds/index.phtml\"><b>Guild Headquarters</b></a>&nbsp;|<a href=\"/noticeboard.phtml\"><b>Notice Board</b></a>&nbsp;|<a href=\"/neohome/\"><b>Neohomes</b></a>&nbsp;|<a href=\"/neohome/shed\"><b>Storage Shed</b></a></div>' + faerieText + '<br><b>Shop Wizard</b><br><br>Alakazam!!! It\'s the Shop Wizard!  The Shop Wizard is your friendly guide to online comparison shopping.  Type in what you want to buy and he will search through all the shops in the market to find you the best prices. (He searches a different section of the market each time to get more results!)<br><br><div class=\"contentModule\" style=\"height: 100%\"><table class=\"contentModuleTable\" cellspacing=\"0\" cellpadding=\"3\" border=\"0\"><tbody><tr><td class=\"contentModuleHeaderAlt\"> What are you looking for?</td></tr><tr><td class=\"contentModuleContent\" valign=\"top\" align=\"left\"><div align=\"center\"><table cellspacing=\"0\" cellpadding=\"4\" border=\"0\"><tbody><tr><td valign=\"top\" align=\"center\"><img src=\"http://images.neopets.com/shopkeepers/shopwizard.gif\" width=\"150\" height=\"150\" border=\"0\" align=\"left\"></td><td valign=\"middle\" align=\"left\"><form action=\"market.phtml\" method=\"post\"><input name=\"type\" value=\"process_wizard\" type=\"hidden\"><input name=\"feedset\" id=\"feedset\" value=\"0\" type=\"hidden\"><table cellspacing=\"1\" cellpadding=\"4\" border=\"0\" align=\"center\"><tbody><tr><td style=\"background-color: #EFEFEF;\" valign=\"middle\"><b>Search Text</b></td><td valign=\"top\"><input name=\"shopwizard\" value=\"\" size=\"50\" maxlength=\"60\" style=\"width: 300px\" type=\"text\"></td></tr><tr><td style=\"background-color: #EFEFEF;\" valign=\"top\"><b>Area</b></td><td valign=\"top\"><input name=\"table\" value=\"shop\" checked=\"\" type=\"radio\"> Shop<br><input name=\"table\" value=\"gallery\" type=\"radio\">Gallery</td></tr><tr><td style=\"background-color: #EFEFEF;\" valign=\"middle\"><b>Search Items</b></td><td valign=\"top\"><select name=\"criteria\"><option selected=\"\" value=\"containing\">containing my phrase</option><option value=\"exact\">identical to my phrase</option></select></td></tr><tr><td style=\"background-color: #EFEFEF;\" <b=\"\" valign=\"middle\">Min Price</td><td valign=\"top\"><input name=\"min_price\" size=\"5\" maxlength=\"5\" value=\"0\" type=\"text\"> <b>NP</b></td></tr><tr><td style=\"background-color: #EFEFEF;\" valign=\"middle\"><b>Max Price</b></td><td valign=\"top\"><input name=\"max_price\" size=\"5\" maxlength=\"5\" value=\"99999\" type=\"text\"> <b>NP</b></td></tr></tbody></table></form></td></tr></tbody></table><div style=\"background-color: #EFEFEF; padding: 4px;\" align=\"center\"><input value=\"Search\" type=\"submit\" id=\"wiz-search\"></div></div></td></tr></tbody></table></div><div style=\"width: 400px; text-align: center; margin-top: 20px; margin-left: auto; margin-right: auto; margin-bottom: 10px;\"><div id=\"ad-400x400Div-btfWrapper\" class=\"rubiconAdWrapper ad_wrapper_fixed\" data-dorefresh=\"\" true\"\"=\"\"><p>ADVERTISEMENT</p><iframe class=\"rubicon mrecwide\" scrolling=\"no\" src=\"/ads/rubiconFrame.phtml?rpAccount=11488&amp;rpSite=107662&amp;rpZoneSize=503678-216&amp;rpAdType=js\" style=\"display: none !important;\" hidden=\"\" frameborder=\"0\"></iframe></div></div><br clear=\"all\"></div>');
    $('#wiz-search').click(function(){$('form[action="market.phtml"]').submit();});
  }
});