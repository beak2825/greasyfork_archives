// ==UserScript==
// @name         red list fixed
// @version      0.2.11
// @description  世界是由各种各样的人组成的，当你拉黑某个沙雕，你也屏蔽了世界的一部分信息，世界也就变得不再完整。怎么办？拉红他！拉红之后，他依然会出现在你的视线里，但是会被标记，以提示这是你认为的一个沙雕。
// @author       taxayd, rrkeleek, curx95
// @match        *://*.v2ex.com/*
// @grant GM_setValue
// @grant GM_getValue
// @grant GM_deleteValue
// @namespace https://greasyfork.org/en/scripts/394722
// @downloadURL https://update.greasyfork.org/scripts/394722/red%20list%20fixed.user.js
// @updateURL https://update.greasyfork.org/scripts/394722/red%20list%20fixed.meta.js
// ==/UserScript==

(function() {
    'use strict';
    const SHADIAO_BG_CSS = "background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAwIAAABECAYAAAAyVYJUAAAVKUlEQVR4Xu2dr7c9tRXFzxWIVoAoAkQFCCpaQQWIChCtwPDX1iBAfBGIIkCAAEEFAgQIKkBU3K79XuY1Ny+ZZGaSTGbuZ9Z664mbOTnZJzOTnZwfl6vZ1bhAAARAAARAAARAAARAAATuCoELROCu7M1gQQAEQAAEQAAEQAAEQOABAYgAEwEEQAAEQAAEQAAEQAAE7hABiMAdGp0hgwAIgAAIgAAIgAAIgMAzInAxuwALCIAACIAACIAACIAACIDAuRAIQwIgAueyL6MBARAAARAAARAAARAAgSgCEAEmBgiAAAiAAAiAAAiAAAjcIQIQgTs0OkMGARAAARAAARAAARAAAYgAcwAEQAAEQAAEQAAEQAAE7hABiMDJjX41e8nMXrqY/XryoTI8EAABEAABEAABEACBBQhABBaAdaSmV7Pfm9kfzewNp/cnF7P/HmkM6AoCIAACILA/AtfHb4n+puv7i9n3+2uGBlsQcOuE1y5m322Rw73HRgAisLP93Av2z2b25cXsxxrqOJlvB7K+u5h9XUM+MkAABM6FwNVM7wttHvjXrxezL881UkazBoGr2d/M7A/evfpeQQTWgDnIPVez1+zxuZfXAPYcxC57qAER2AN1M3NMXA/h9HLVbv1nF7P/bFXJyf57RM6LGvK36sf96xCIfIzXCdp+l+bpz9vFIGEEBBIbB1Lt24vZNyPoiA77IeDcSz8INPiIE+b9bLK156vZn8zsrUBOcn0QORHaqsLi+y9mny2+iRuKEIAIFMFUv9HV7B17ZOT+JRKgRdZmF57Eg/4zD1N9W/aSCBHohfT99OMWedo00K5geP3nYvbiftA410ivZjppfqXCqDQ3Xg7k1NwIwM2ogpGWiHBz483gHq07oi7EifXEki43t72Y/XOzEAREEYAI7DQx3K79e5EPsF6Km4/j3Qf+fTP7XTDEz2u5IO0E3d12CxG4W9M3G3hiQ8Lvj1OBZui3FTzQ+yI3UOZYDqEGv1/NtD4ICV6U/EMEGhhgIJEQgR2N4Xz0dDIQXlUW6wn5v13MPt5x2HS9EoGBPuy4Bq204Ui3Xc20I6hd49yFS2EOoQF/H+h9kUMHIpBDqMHvSzYjcQ1qYICBREIEdjZGYkdOR3Sf1kj5GXwMJPff+P3ubPSV3Uc+7M1dva6PMSwKFPQviMBKG45y2/VxJ1A7giXXb2YmMrDZZbGkM9rUQcDZOObytaQD+ZL7QcKaC18sEVDQVptTpLcuAKp2k5nNSIKHa4M9sDyIwM7GmfHRfVrkuTbhEV6p5q+6oCD5dCpF2OqPOQGipZC3aQcRaIPrvUmdcRvUu0FuibFTyh8vZp/fG1ZnGa8j9EuHIxIRzgV9Q6pktzMzuaGs/h4tHQzt4wjMxAtUSV4C7uMjABEYwEaJXVdp9nBkOvN7V+0J1ukK97POIAL74n+W3hO+wRreg0tiYmGg30lBfNBJcDX7cEDVOVkcxCiJd0LyJLBiIHoKgV9Id95vckAE+mE929PMx1dZO7QzE7pndNccItAd8psOI0RAL+rWubwVbO4XEpJOfMD3nQqre3f1AkJ7St5NkoIZsoDLwGr097sRIrAf9kfoecZVMHoS2CH+pLnb6xHs0ktHiEAvpDP9zLgI6RhWx7EQgUFstZcaHV6+pUODCJQiNVC7GRLwLG2xWxjonRPzMYcMDGTXElXcu6OkqdqosFyYbU4uPJtr3AQKfEVdm1KTtG+XSB4QjVfs8C2CCLQ3+VMPEIGOYOe6igTuiATIZ1fxARCBHIAn/73Dy7cUQYhAKVKDtJshAcnEBDOBhBoVZGAQ29ZUI0EAqxW7rKkrsuojEHxjFFeo5/xZIHfMTdW2FZlUQLoflA4RqG/epESIQEewS7pyWYT0QCg+QCcBzS+XRkxpBOUDXLNQTHPd76kDiMA9WbveWDMkYDYgMJNiFDJQz0xVJS08AfD71qZTeAokF8QeWX04Iag6C5YL81KKzq4/It+iTSlgI3UKIALLzbf6DojAauja3OhchF7qmU4teAh1/CtC0Nr3vA2AJ5ZKjMCJjdtoaDMkoHhXPyPj614bFo0gOqXYQWMCclhz0phDaJDfIQKDGKKSGhCBSkAeVcxMbAJFhAYzKlmDBjPIwOq451ruhKm0w4t28zNkQJsGIgSkghxkTkAEBjHESdWACJzLsBCBg9rTVfqTC9GmD7CT83YAA8dyA84LiMCARhlQJefn/W4k4HPSdhEJmG7KkAGdJH5B8OcYE6KgboDcf1QsLEYUZcuvFo5EVapfC+55KGBpZj8VyqKuQCFQezdLnE5vcR8LA9RZg3Q0MkSgI9i1ugoW73ppK//3qofwavaPyIJh1UKh1viQE0cAIsDMyCHg3g2K90lVlN30bGfIgBZ+3WKbcljwe/I9IgLwRmKOrK4V4eJJ3orIVdzZN8SfnWdGdohXgwh0nC4Qgb5gi/XGcniHWvya8tFPFBdbldUhEqAjPVTu/eOOsNBVIQIdXr6FmlBHoBSoXu2cK5AWYdqZTV2bSMAkdKbmydRECz8CP3sZv6AfNz/07dH8CFOD+nbbmiwiVndkkj/VPVHNilUbVwVDpckMAm798GoBSD/NEbcO3yKIQIGRajWBCNRCskDOggrByYegVn7vmdgAArYKbLlHkw4v39JhMUdKkerQzr0T/joTD6CNAp0aRhd5iffS7Ic44VIYjpbYgQ72n+vCZYHR7r9IQOqUaA8tdZItlyEVrNpKPvbQ/5B9Jjb/YmOZzQJE+tBDmj+pNESgoz1rEAGpm/nw31QITQ0vccQPC+84H5Z2BRFYitj52xd82LUL+6853/01RMB7D6WKjk3gT37icjkhmLjTlHRETT77od9+Jw0WdzMRA/3Xd4gTg8UQ5m8oeF9MQnJEQO6Hr3g9at2xOtOgm6++t8QvF7Ov8yOiRQ0EIAI1UCyUUYsIuI+wdndSWUGeVQr1VZzRg0xBhbbcoxlEYA/Ux+zTPcM6BUi5eUhx7bTqJGB2Ab6WCHjvoXeCYkAp0LRQECGoXaF2TCPtoJXb4NHif273X+TQnzeaJy125bWwm5ufKYQ0Z1VMk6syArWIQGW1ELczAhCBjgZwO/l/iXS5OmJ+JngvuhPoXILej7ygVweJdYTwrrsiWPiuzf8weOfqoViAXKxR8fO8hQhMFskUHrsx3MXsn1iyDQKuIGXqFOAhaNf17Feq31QMKjWSyPvqEzdv5whC8bxtg+C5pc7ECOid4l/P5sSC+ILaIBJTUhvRQB5EoDHAJeK3VtWbYfnaCVSA4NPuSoI4iDToNICj+xKD7dTGBWn6x7HNj08T5JVA0B3mQCY+aNLo2TOfU7UGEXAkRako52IV1KzJojM3xnv5PbHRc5O1J2LvVpWDb6oU+wTQzWURgte9TSmlD31xL7YaaZyRuhMxIqBsUyFh6DEMYtIaowwRaAxwifitRMB9hPVSDesBTN0/VP+cCfDjQSsxFG1AYGcEMu5hRa5A4RBqEYFJ7kwaSTKSdZg/18e4AH0LtAGkBd2Nv/0CF9Wq2qZOghwpUCYbZarBbawq6mXCIAJlOJ21FURgAMvWIAKODKjAmPx1Y/6h+ijEjow5ih1gDniLKBE6uYod8rr83/XgkPqPrrRzDXoveMY35e+vTQTcu0jvIAUU+i5M+H4PMMFGIwIDQHL3KqwkAnrv5IjbzamQ0pNbPhBc6xj/YqOy8QyFCDQGuER8LSLgPsB68HKZPCa1OIotMVDHNgMFBK8aNf7fq2BbdFPgjy+CrxO/1VlWWhABj9jqoy6XAruYfbZooDRugkDE3griXp3xZUZJxcM9VS7m3dDEnFWEriQC2SyDke9Z1jUwogtEoIqV00IgAo0BLhFfkwh4u3GpjEKTSmLzn25ZQJSMjTbLEIAILMPrXlu7oFAF0W3OrtKSCNyrfUYeN0RgZOvsoxtEYB/cR+kVIjCAJWoTAY8MzKX1yzLzAaC5OxUgAndn8t0HDBHY3QRdFcA1qCvch+gMInAIMzVTEiLQDNpywY2IQImLEGSg3ExdWrqA7hYxAsrnHaacrJ4/nBiBLtOkaicQgapwDi8MIjC8iborCBHoDvlQHUIEBjBHbSLgXvSpoOFwxPINlY8xqUMHmAslKriAUS3qfyjNspH4+EMESwA/eRuIwMkNHAzPSwnsB3KWBH4uAWp1bZwlndC2DgIriUCdzvNSiBHIY7SpBURgE3x1bq5JBJYU9vG0n61EXGeUSKmFQJAGVlkYfsqROYhALfTPJwcicD6blowocEPMBn6WyJzahN80AoWXoNe/LUSgP+Yj9QgRGMAaNYiAKySj3NGpqpJfu7RdahNLLxqtRDwAPKjwfEdPpz2hnT+aO9WBCDCNUghABM45N5xd5wbnZ/XRZtBXGSSUZe7h5LhAtk4sfVfE2YxRFzO5KXLthABEYCfgB+kWIjCAIbYSAa+ATGyBrxGquvBDerhMdVK95JXrm5fyAPMipoIjfB8Ev/14Mft8TmWIwKAGHUAtiMAARmigQmRxt7WXJxeN2rI5Mdhqmm33ryQCJeTxJoWsS1ObS1WrjIf+hWvQNvNm74YIZCFq32AtEXC+4irakzoFiC7sHRl41yvtHg7yiTi0Hz09LEEgUR06a6+GAYJVXQqWYEHbOghABOrgOJqU2ot1M4MIjGbkSvqsJALZdz91BCoZqLEYiEBjgEvELyUCblf4TTN7I+Hmo27F1rW7Hy005GTM1RpQjvIvS/SnTT8Ermb/CAjcfy9mH+U0gAjkELrf3yEC57R9sLiLVXTNBQvrhPmpINgMEYjJfhYsHKB88zsnAvvOQYjAvvjv3TtEYG8LPLrrqPLmW54qUaZdSAAk5ruLmWICZq8CMqBiRdptJqNQDswOvycWbKW2VoXX8Mi1htbZXaEanSCjHQIQgXbY7ik5WNw9yxCWCxaOzIvUiUBM9s03LVzoE0y858x43jdEYCx79NYGItAb8Uh/OSLgpYucOwGQZO3MfLHUx/9qpgDiMMf8pCkZhQaYI1IhUWxMJO2THFnjRGAQIw6oBkRgQKNUUAkiUAHEOxGxkghovZHz99e6QjVspqukdo2/Kar7iBFoPA8hAo0BLhF/NZOfv1x9nh6Wi9lDlgXnz/9+gZxv3UnAqt37DBmQi5FOB7h2QiARG/BE1i5mL+ZUI1h4J8MdoFuIwAGMtEJFXINWgHant6wkAr3Qggg0Rhoi0BjgnPjEAk9p2p4WdplFuhboKggWjQXI9e//HjmZ0M/ECiwBsUFb58L195l4kKydIAINDHMSkRCBkxgyGAbBwue0a+1RJTYbs+5etfWYkQcRaAw2RKAxwJldWh2byS0ndj0twBO+/Dpi+2apG1BuuAExgQTkAOvw+9UsVjdAJz9hutikGxdEoIOhDtoFROCghsuoDRE4p11rjsp97+WRkP2WRDYKa1ejnoameDb/ggjUNHpEFkSgMcAp8RlXj+k2nwwoe4NchOSTpwBRLfqaXE63l0sCjpsogNAnBBKVouWbKdex9yIvcL2cdUJ047sJEWBSzbyLYoHkBIEffMoEREDvg9CfO1dQTGmpXzezH+zRNdQvKPahB09Mdq6g2Ksu653EULtmh7lWsAa52VjKxTLWGkKEwEIEaoGbkAMRaAxwTHzBA+jfpkWfdv5zQTk7jIQuWyIwM08eYjYyxeEe5o0+4Aokhgi0tNSxZXMicGz7zRA8P0uYNpXCzQH9Pu2+3hC/IE3xbxezj/1+XOICf8MqlJ3MGhTZ3HjmhnJOi4wzqoy7sa+oNpaUOVDfm5Dc/dJiszCYW9Llq5Ybn+NYZT9NIAKdsZ95AMW+v5txFdLCTjszaqd4gKfdmRZDcO5Ifg7pqZum/bYYyxFlzpCAm3ShbhEn16FUVWkNX25kmjNhZqjNH2CX0crPCqG6Bs1Oq45oy9F1hgiMbqE2+s2lD418p7JFCwOiMEcE9K7yY5602Py0RpxbG6TOJTWzBpEtQtccATCtTx42ls6FCKOBCHScA5HsQE+La5ciSzu3c3EDa7SNFXuRnLBYTKnsFyz0SqFa125mDtwEkU/SCypFr1Nk3V3Pdg/XieGuXghABHoh3a+fmY0cKSG3HF1+asdpo+kV91v4fYg+1+7dE9uECHePldXOL2D2rODYlCmvH0r311MiBfW00H/IVOjqzcQ2Af31yi8uXXkKRP2eIwyaN9N8yxlDm02aM7q0GUYWwxxiC36HCCwAa2vTBBN/FuDZgAxsVX26n0VeLSQjctzHW4FbsZoOs/UCvGJzYQ7mhhpHRSs+QSdbXAdBACJwEEMVqNkgQNjvVZXmdbLYojCh+iFNdYGNtzQpWYO4b4mSmChGZMRLdXM2Z0kccWB76QQR6Ii8c6PQkeh0aXGnQJhnrhSurR7G2DFdR61vuiqqYruXckfvN5EdSMNKzpNwzF7xubCQSy94eEn3QrpSPxCBSkAOIGZmx7eGdg8bQQ3Jhk4ldOKc20muMZa7lLFwDaJvSCyj0J7YyTXp8z0VOGPfEIHOVg0YedbNxj24qiis49y547oeI8nq20OJs/aRWJAVk4AIKdB80bzRsep0BOsfz9eGkpd0bUQ7yIMIdAC5UxeJWjCx3kOX0VgqyCmuyN+M0qmAFoglG1Ta4AoX9YpX8i/J8WVtjlvqBPVhu1myBnGnAzoZUMHTvdcfwpwMQg1mHkSgAahzIj1Gvij4apLpPtp+F1rgzQWKVhvh5TELDVdDBIIPuT6kOi7nGLQh5vcuGiJwnhngnQhqUL6f9qog/uuje4iSEUyXfLPl+jfFGfzk/bY4kURsh/pi9tF5LDLeSNauQby4k3DN4fvvtxyw5jCnAQ0Qhgg0ADUnUg8ii7scSvf7uzven9K2cUx+v1Ohy8hdwKdyyvtXk9SAXQZEJ1URuJp94DKPyTU03NHf3Je3Q60UpIox4p23GdV5AaxBGgN8MPEQgYMZDHVBAARAAARA4CwIuJ3ml9gcO4tFGcfREIAIHM1i6AsCIAACIAACIAACIAACFRCACFQAEREgAAIgAAIgAAIgAAIgcDQEIAJHsxj6ggAIgAAIgAAIgAAIgEAFBCACFUBEBAiAAAiAAAiAAAiAAAgcDYEsETjagNAXBEAABEAABEAABEAABEBgOQKXkBksF8EdIAACIAACIAACIAACIAACR0MAInA0i6EvCIAACIAACIAACIAACFRAACJQAUREgAAIgAAIgAAIgAAIgMDREPgfj3b7FwqReX8AAAAASUVORK5CYII=');";
    let username_in_infopage;
    let listName = 'red-list';
    let strlist = GM_getValue(listName, "");
    let redlist = strlist.split(';');
    let url = document.URL;
    let path = location.pathname
    let buttonName = 'redbutton';

    // delete all
    //GM_deleteValue('red-list');console.log('list:' + GM_getValue('red-list', 'empty'));return;

    function redthis() {
        let strlist = GM_getValue(listName, "");
        let redlist = strlist.split(';');
        // console.log('redlist:' + redlist, 'username_in_infopage:' + username_in_infopage, 'strlist:' + strlist);
        if (redlist.indexOf(username_in_infopage) >= 0) {
            GM_setValue(listName, strlist.replace(';' + username_in_infopage, ''));
        } else {
            GM_setValue(listName, strlist + ';' + username_in_infopage);
        }
        document.getElementById(buttonName).value = GM_getValue(listName, '').split(';').indexOf(username_in_infopage)>=0 ? 'Unred' : 'Red';
        // console.log('strlist:' + GM_getValue(listName, ""));
    }

    if (path == '/' || path.startsWith('/go/') || path.startsWith('/tag/') || path.startsWith('/recent'))
    {
        // 首页及类首页
        let home_list = document.getElementsByClassName('topic_info');
        let len = home_list.length;
        for(let i=0; i<len; i++) {
            let username = path === '/' || path.startsWith('/tag/') || path.startsWith('/recent') ? home_list[i].children[2] : home_list[i].children[0];
            if (redlist.indexOf(username.innerText) >= 0) {
                // console.log('in red list: ' + username.innerText);
                home_list[i].parentElement.parentElement.parentElement.parentElement.parentElement.style = "background-image:url('data:image/png;base64,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');background-size:100% 100%;";
            }
        }
    } else if (path.startsWith('/t/')) {
        // 帖子详情页
        let comments = document.getElementsByClassName('cell');
        let len = comments.length;
        for(let i=0; i<len; i++) {
            let cell = comments[i];
            // 处理帖子的楼主发言
            if (cell.children && cell.children[0].classList.contains("topic_content")) {
                let username = cell.parentElement.querySelector(".header small>a");
                if (redlist.indexOf(username.innerText) >= 0) {
                    cell.style = SHADIAO_BG_CSS + "background-size:100% 100%;";
                }

            } else if (cell.id.substr(0, 2) != 'r_') {
                // console.log(comments);
                continue;
            } else {
                let username = cell.getElementsByTagName('strong')[0];
                if (redlist.indexOf(username.innerText) >= 0) {
                    // console.log('in red list: ' + username.innerText);
                    cell.style = SHADIAO_BG_CSS + "background-size:100% 100%;";
                }

            }
        }
    } else if (path.startsWith('/member/')) {
        // 个人主页
        username_in_infopage = document.getElementsByTagName('h1')[0].innerText;
        // let button = document.getElementsByClassName('fr')[0];
        let button_container = document.getElementsByTagName('input')[1].parentElement;
        let red = document.createElement('input');
        red.setAttribute('type', 'button');
        red.setAttribute('id', buttonName);
        red.setAttribute('value', redlist.indexOf(username_in_infopage)>=0 ? 'Unred' : 'Red');
        red.setAttribute('class', 'super normal button');
        button_container.appendChild(red);
        document.getElementById(buttonName).onclick = redthis;
    }
})();