// ==UserScript==
// @name         Cartel Empire - Enabled Attack Buttons
// @namespace    baccy
// @version      0.1.2
// @description  Replaces each of the three attack buttons so you don't need to refresh once the player leaves hospital/jail
// @author       Baccy
// @match        https://cartelempire.online/user/*
// @match        https://cartelempire.online/User/*
// @icon         https://cartelempire.online/images/icon-white.png
// @grant        none
// @license      MIT
// @downloadURL https://update.greasyfork.org/scripts/522930/Cartel%20Empire%20-%20Enabled%20Attack%20Buttons.user.js
// @updateURL https://update.greasyfork.org/scripts/522930/Cartel%20Empire%20-%20Enabled%20Attack%20Buttons.meta.js
// ==/UserScript==

// Change these to false if you don't want a button to be replaced.
// This option is just to prevent accidentally clicking the wrong button.
const leave = true;
const mug = true;
const hosp = true;

(function() {
    'use strict';

    let playerName = '';
    let playerId = '';

    function playerInfo() {
        const profileImg = document.querySelector('#profileImg');
        if (!profileImg) { // Just used in cases where connection speeds are slow and the script fires prematurely to ensure elements have loaded
            setTimeout(playerInfo, 500);
            return;
        }
        const nameElement = document.querySelector('.profileNameTitle');
        const idElement = document.querySelector('.table.align-items-center.table-flush tbody tr:first-child td');
        if (nameElement) playerName = nameElement.textContent.trim();
        if (idElement) playerId = idElement.textContent.trim();
        replaceButtons();
    }

    function replaceButtons() {
        const disabledButtons = document.querySelectorAll('.btn.btn-block.btn-outline-dark.attackBtn.disabled.actionButton');
        if (disabledButtons) {
            const leaveButton = `<button class="btn-block btn btn-danger attackBtn actionButton" href="#" data-bs-toggle="modal" data-bs-target="#attackConfirmModal" data-bs-player-target-id="${playerId}" data-bs-attack-type="Attack" data-bs-player-name="${playerName}" title="Attack and Leave"><div class="visually-hidden">Attack player</div><div class="descriptionText d-none">Attack Player</div><svg xmlns="http://www.w3.org/2000/svg" width="28" height="24" fill="currentColor" viewBox="0 0 52 52"><path d="M47.9818192,11.6695557h-3.0493774c0.0388794-0.1068115,0.0683594-0.218811,0.0683594-0.3391113v-2   c0-0.5522461-0.4472656-1-1-1s-1,0.4477539-1,1v2c0,0.1203003,0.029541,0.2322998,0.0684204,0.3391113H11.9324408   c0.0388794-0.1068115,0.0683594-0.218811,0.0683594-0.3391113v-2c0-0.5522461-0.4472656-1-1-1s-1,0.4477539-1,1v2   c0,0.1203003,0.029541,0.2322998,0.0684204,0.3391113h-1.517395c-1.9100337,0-3.6400142,1.0700073-4.4199824,2.7299805   l-1.6600344,3.5599976c-0.4899902,1.0300293-0.5299683,2.1900024-0.1199951,3.2600098   c0.4199829,1.1199951,1.2800293,2,2.4000247,2.4799805l0.2399902,0.1100464   c0.7099609,0.2999878,1.0800171,1.0199585,0.8800049,1.6999512L2.1618111,38.3595581   c-0.3599854,1.2199707-0.1199951,2.5200195,0.6600342,3.5499878c0.8199463,1.0999756,2.1499636,1.7600098,3.5599978,1.7600098   h5.269958c1.960022,0,3.6900024-1.2700195,4.210022-3.0700073l2.8727427-9.9317017h2.1968994   c4.4492188,0,8.0693359-3.6201172,8.0693359-8.0698242v-0.1884766h16.6409912c2.4000244,0,4.3600464-1.8699951,4.3600464-4.1699829   v-4.6099854C50.0018387,12.5495605,49.0918045,11.6695557,47.9818192,11.6695557z M20.9314651,28.6678467h-1.6184082   l1.3387451-4.6282959c0.0857544-0.2940674,0.2401733-0.5561523,0.4358521-0.7848511l2.163147,2.163147   c0.1953125,0.1953125,0.4511719,0.2929688,0.7070313,0.2929688s0.5117188-0.0976563,0.7070313-0.2929688   c0.390625-0.390625,0.390625-1.0234375,0-1.4140625l-1.3359375-1.3359375h3.671875   C26.9627151,25.9827881,24.2547073,28.6678467,20.9314651,28.6678467z">                                   </path></svg></button>`;
            const mugButton = `<button class="btn-block btn btn-danger attackBtn actionButton" href="#" data-bs-toggle="modal" data-bs-target="#attackConfirmModal" data-bs-player-target-id="${playerId}" data-bs-attack-type="Mug" data-bs-player-name="${playerName}" title="Mug"><div class="visually-hidden">Mug player</div><div class="descriptionText d-none">Attempt to Mug</div><svg xmlns="http://www.w3.org/2000/svg" width="28" height="24" fill="currentColor" viewBox="0 0 20 20"><path d="M 12.964844 0.095703125 C 12.805889 0.093483625 12.654204 0.10575226 12.503906 0.12890625 C 11.902715 0.22152215 11.399294 0.43880053 10.416016 0.60742188 C 9.5128577 0.76230303 8.9000581 0.53804687 8.1347656 0.34375 C 7.3694731 0.14945313 6.4403485 0.025497315 5.2929688 0.54492188 C 5.0125471 0.67254789 4.9131349 1.0209548 5.0839844 1.2773438 L 6.8574219 3.9355469 C 6.4799034 4.2948616 5.386098 5.3589005 4.0996094 7.0742188 C 2.5695621 9.1142816 1 11.799685 1 14.5 C 1 17.150236 2.3087845 18.664286 4.0703125 19.341797 C 5.8318405 20.019308 8 20 10 20 C 12 20 14.168159 20.01931 15.929688 19.341797 C 17.691216 18.664286 19 17.150236 19 14.5 C 19 11.799685 17.430438 9.1142814 15.900391 7.0742188 C 14.613901 5.3589005 13.520096 4.2948616 13.142578 3.9355469 L 14.916016 1.2773438 C 15.088927 1.0174273 14.984039 0.66436817 14.697266 0.54101562 C 13.978672 0.23310127 13.441708 0.10236154 12.964844 0.095703125 z M 12.65625 1.1171875 C 12.922777 1.0761275 13.330981 1.236312 13.679688 1.3300781 L 12.232422 3.5 L 7.7675781 3.5 L 6.3046875 1.3046875 C 6.8796693 1.1670037 7.3639663 1.1812379 7.8886719 1.3144531 C 8.5922201 1.493074 9.4404156 1.7898596 10.583984 1.59375 C 11.647433 1.4113805 12.227503 1.1832377 12.65625 1.1171875 z M 7.7070312 4.5 L 12.292969 4.5 C 12.480348 4.6748327 13.734431 5.8555423 15.099609 7.6757812 C 16.569562 9.6357185 18 12.200315 18 14.5 C 18 16.849764 17.058785 17.835714 15.570312 18.408203 C 14.081843 18.980692 12 19 10 19 C 8 19 5.9181595 18.980692 4.4296875 18.408203 C 2.9412155 17.835714 2 16.849764 2 14.5 C 2 12.200315 3.4304379 9.6357186 4.9003906 7.6757812 C 6.2655702 5.855542 7.5196519 4.6748327 7.7070312 4.5 z M 10.416016 9.0039062 L 10.21875 9.0175781 L 10.023438 9.0488281 L 9.8320312 9.09375 L 9.6445312 9.1542969 L 9.4609375 9.2285156 L 9.2851562 9.3183594 L 9.1152344 9.421875 L 8.9570312 9.5371094 L 8.8066406 9.6640625 L 8.6660156 9.8046875 L 8.5390625 9.9550781 L 8.421875 10.113281 L 8.3183594 10.283203 L 8.2304688 10.458984 L 8.1542969 10.640625 L 8.09375 10.830078 L 8.0488281 11.021484 L 8.0175781 11.216797 L 8.0039062 11.414062 L 8.0039062 11.611328 L 8.0195312 11.806641 L 8.0527344 12.001953 L 8.0507812 12.001953 L 7 12.001953 L 7 13.001953 L 8.203125 13.001953 L 8.1992188 13.238281 L 8.1796875 13.472656 L 8.1445312 13.705078 L 8.0917969 13.935547 L 8.0253906 14.162109 L 7.9433594 14.382812 L 7.8476562 14.597656 L 7.7363281 14.804688 L 7.6113281 15.003906 L 7.4726562 15.195312 L 8.1074219 15.941406 L 8.3164062 15.835938 L 8.5332031 15.744141 L 8.7539062 15.667969 L 8.9785156 15.605469 L 9.2089844 15.560547 L 9.4394531 15.529297 L 9.671875 15.513672 L 9.90625 15.513672 L 10.140625 15.529297 L 10.371094 15.560547 L 10.601562 15.607422 L 10.826172 15.669922 L 11.046875 15.746094 L 11.261719 15.837891 L 11.416016 15.900391 L 11.574219 15.949219 L 11.736328 15.982422 L 11.902344 15.998047 L 12.068359 16 L 12.234375 15.986328 L 12.396484 15.955078 L 12.556641 15.910156 L 12.710938 15.849609 L 12.859375 15.775391 L 13 15.6875 L 12.427734 14.867188 L 12.34375 14.916016 L 12.253906 14.957031 L 12.160156 14.984375 L 12.064453 14.998047 L 11.966797 15 L 11.869141 14.990234 L 11.775391 14.966797 L 11.683594 14.931641 L 11.449219 14.830078 L 11.208984 14.742188 L 10.962891 14.667969 L 10.712891 14.607422 L 10.460938 14.5625 L 10.207031 14.53125 L 9.953125 14.513672 L 9.6953125 14.511719 L 9.4394531 14.525391 L 9.1855469 14.552734 L 8.9335938 14.59375 L 9.0078125 14.373047 L 9.0683594 14.150391 L 9.1191406 13.923828 L 9.1582031 13.695312 L 9.1855469 13.464844 L 9.2011719 13.234375 L 9.2050781 13.001953 L 10.5 13.001953 L 10.5 12.001953 L 9.0800781 12.001953 L 9.0527344 11.890625 L 9.0195312 11.740234 L 9.0039062 11.589844 L 9.0019531 11.4375 L 9.0175781 11.287109 L 9.046875 11.138672 L 9.0898438 10.992188 L 9.1484375 10.851562 L 9.2207031 10.71875 L 9.3066406 10.59375 L 9.4042969 10.476562 L 9.5136719 10.371094 L 9.6347656 10.277344 L 9.7617188 10.195312 L 9.8984375 10.128906 L 10.041016 10.074219 L 10.1875 10.035156 L 10.335938 10.009766 L 10.488281 10.001953 L 10.640625 10.007812 L 10.791016 10.029297 L 10.9375 10.066406 L 11.082031 10.119141 L 11.21875 10.183594 L 11.347656 10.263672 L 11.46875 10.355469 L 11.580078 10.458984 L 11.679688 10.574219 L 11.767578 10.697266 L 11.841797 10.830078 L 11.902344 10.96875 L 11.949219 11.113281 L 12.916016 10.855469 L 12.857422 10.666016 L 12.783203 10.482422 L 12.695312 10.304688 L 12.59375 10.136719 L 12.480469 9.9746094 L 12.353516 9.8242188 L 12.216797 9.6835938 L 12.066406 9.5527344 L 11.908203 9.4355469 L 11.740234 9.3300781 L 11.566406 9.2402344 L 11.384766 9.1621094 L 11.195312 9.1015625 L 11.003906 9.0527344 L 10.810547 9.0214844 L 10.613281 9.0039062 L 10.416016 9.0039062 z "></path></svg></button>`;
            const hospButton = `<button class="btn-block btn btn-danger attackBtn actionButton" href="#" data-bs-toggle="modal" data-bs-target="#attackConfirmModal" data-bs-player-target-id="${playerId}" data-bs-attack-type="Hospitalise" data-bs-player-name="${playerName}" title="Attack and Hospitalise"><div class="visually-hidden">Hospitalise player</div><div class="descriptionText d-none">Attempt to Hospitalise</div><svg xmlns="http://www.w3.org/2000/svg" width="28" height="24" fill="currentColor" viewBox="0 0 16 16"><path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"></path><path d="M9.146 5.146a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708.708l-.647.646.647.646a.5.5 0 0 1-.708.708l-.646-.647-.646.647a.5.5 0 1 1-.708-.708l.647-.646-.647-.646a.5.5 0 0 1 0-.708zm-5 0a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 1 1 .708.708l-.647.646.647.646a.5.5 0 1 1-.708.708L5.5 7.207l-.646.647a.5.5 0 1 1-.708-.708l.647-.646-.647-.646a.5.5 0 0 1 0-.708zM10 11a2 2 0 1 1-4 0 2 2 0 0 1 4 0z"></path></svg></button>`;
            if (leave) disabledButtons[0].outerHTML = leaveButton;
            if (mug) disabledButtons[1].outerHTML = mugButton;
            if (hosp) disabledButtons[2].outerHTML = hospButton;
        }
    }

    playerInfo();
})();