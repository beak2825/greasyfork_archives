// ==UserScript==
// @name better than Premium-Dark 3D Cockpit
// @namespace https://greasyfork.org/de/scripts/472451-better-than-premium-dark-3d-cockpit
// @version 4.0.2
// @description Leitstellenspiel Design-All devices-Inclusive LSSM,AAO Optimization4Mobile-Free use for members of the "Stark in Schleswig-Holsteinüö®" association
// @license MIT
// @author TorBEngel
// @run-at document-body
// @match https://www.leitstellenspiel.de/*
// @grant        GM_addStyle
// @downloadURL https://update.greasyfork.org/scripts/472451/better%20than%20Premium-Dark%203D%20Cockpit.user.js
// @updateURL https://update.greasyfork.org/scripts/472451/better%20than%20Premium-Dark%203D%20Cockpit.meta.js
// ==/UserScript==
function sMod(){$("#MyDesignID").modal("show")}function DeDunkel(){$.ajax({url:"/design/1",cache:!1,success:function(){window.location.reload()}})}function DeStan(){$.ajax({url:"/design/0",cache:!1,success:function(){window.location.reload()}})}function check(){46664!==alliance_id&&"5"!==localStorage.tsdesign&&localStorage.setItem("tsdesign","6")}!function(){"use strict";if("1"!==localStorage.tsdesign){if("2"!==localStorage.tsdesign)return"6"===localStorage.tsdesign?(alert("Diese Stylez / Designs stehen nur Mitglieder des 'Schleswig-Holstein Aktiv' Verbandes vorbehaltlos zur Verf√ºgung. Weitere Infos folgen auf 'Okay'"),localStorage.setItem("tsdesign","5"),void window.open("https://www.leitstellenspiel.de/alliances/46664")):void 0;document.getElementsByTagName("head")[0].insertAdjacentHTML("beforeend",'<link rel="stylesheet" href="https://static.staticsave.com/mydesigns/simplebright.css" />')}else document.getElementsByTagName("head")[0].insertAdjacentHTML("beforeend",'<link rel="stylesheet" href="https://static.staticsave.com/mydesigns/dark3dcockpit.css" />')}();var lastUserActionTime=Date.now();function trackUserAction(){lastUserActionTime=Date.now()}function simulateUserAction(){let e=localStorage.getItem("tsdesign");Date.now()-lastUserActionTime>=2e4&&(window.top===window.self&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",check):check()),1!=e||$("body").hasClass("dark")?1!=e&&5!=e&&$("body").hasClass("dark")&&(alert("hell"),DeStan()):(alert("dunkel"),DeDunkel()))}if(setInterval(simulateUserAction,2e4),document.addEventListener("click",(function(){trackUserAction()})),window.top===window.self){function reload(){var e=0;document.addEventListener("visibilitychange",(function(){"visible"===document.visibilityState?(Date.now()-e>=3e5&&window.location.reload(),e=0):e=Date.now()}))}function togMod(){$("#MyDesignID").modal("toggle")}function MyDesignBox(){GM_addStyle(".modal{z-index:6050!important}#designInfo hr {padding: unset;border: 0;border-top: 1px solid #eee;}#designInfo{padding-top: 5px;}#imageContainer img{max-width: 65%;float: left;padding-right: 5px;}#modal-body{min-height: fit-content;max-height: clamp(300px, 70vh, 1200px);overflow-y:auto;padding:10px}#decontent a{color:#5cb85c}.modal-footer p{font-style: italic;}"),$("body").append('<div class="modal fade" id="MyDesignID" tabindex="-1" role="dialog" aria-hidden="true">\n  <div class="modal-dialog" role="document">\n    <div class="modal-content" id="tsmod-content">\n    </div>\n  </div>\n</div>'),$("ul .dropdown-menu[aria-labelledby='menu_profile'] >> a[id='navbar_profile_link']").parent().after('<li role="presentation"><a data-toggle="modal" data-target="#MyDesignID" id="show.bs.modal" style="cursor:pointer"><span style="margin-right: 8px" class="glyphicon glyphicon-exclamation-sign"></span>   Design-Einstellungenüî•</a></li>'),$(document).on("show.bs.modal","#MyDesignID",(function(){!function modfu(){var e='\n <div id="decontent"><div class="modal-header">\n <h5 class="modal-title" id="exampleModalLabel">Hallo '+username+`</h5><button type="button" class="close btn btn-primary copy-btn" data-dismiss="modal" aria-label="Close">\n <span aria-hidden="true">&times;</span>\n </button>\n </div>\n <div id="modal-body">\n<form>\n<fieldset>\n<legend><h3>Welches Design m√∂chtest du aktivieren?</h3></legend>\n<div id="designid">\n<input type="radio" class="dclass" name="dclass" value="1">\n<label for="dark">Dark3DCockpitüî•</label>\n<input type="radio" class="dclass" name="dclass" value="2">\n<label for="bright">SimpleBrightüåû</label>\n<input type="radio" class="dclass" name="dclass" value="5">\n<label for="off">offüì¥</label>\n</div>\n</fieldset>\n</form>\n<div id="imageContainer">\n  \x3c!-- Hier werden die Bilder angezeigt --\x3e\n</div>\n\n<div id="designInfo">\n  \x3c!-- Hier k√∂nnen Informationen zum ausgew√§hlten Design angezeigt werden --\x3e\n</div>\n </div>\n      <div class="modal-footer">\n       <div class="pull-left">v: ${GM_info.script.version}</div>\n       <button type="button" id="feedback" class="btn btn-success">‚ö†Ô∏èFeedback&Infos‚ö†Ô∏è</button>\n       <button type="button" id="desave" class="btn btn-primary">speichern‚úÖ</button>\n      </div></div>\n `,n='\n<h3>Dein Feedback</h3>\n<p>Dein Feedback ist ein erfreuliches Zeichen der Wertsch√§tzung. Auch hift es bei der Weiterentwicklung der Styles/Designs und der Spiel-Erweiterung. Desweiteren kann Feedback den Mitspielern behilflich sein, auch in den Genuss zu kommen, das Spiel bestm√∂glich spielen zu k√∂nnen.</br>\n<a href="/alliance_threads/96762" class="lightbox-open">>>Feedback InGame<<</a></br>\n<a href="https://greasyfork.org/de/scripts/472451-better-than-premium-dark-3d-cockpit" target="_blank">Meine Seite beim Hoster</a></p>\n</p>\n<h3>Einstellungen</h3>\n<p>Dieses Fenster findest du jederzeit in der Navigation unter ‚û°Ô∏èProfil‚û°Ô∏èDesign Einstellungenüî•</p>\n<p>Dieses Skript speichert deine Auswahl als Zahlenwert. Solltest du mal s√§mtliche Browserdaten l√∂schen, erscheint dieses Fenster automatisch nochmal, sodass du dein Design wieder aktivieren kannst.<p><h2>‚ö†Ô∏è Wichtige Empfehlung</h2><p> Unter dem nachfolgenden Link erf√§hrst du mit welchem Klick der Browser immer frisch und schnell bleibt, ohne das alles gel√∂scht wird:</br>\n      <a href="/alliance_threads/98669" class="lightbox-open">>>>empfohlene Browser Einstellung<<<</a></p>\n       <h3>Nutzungsberechtigung</h3>\n<p>Die Nutzung ist nur f√ºr Mitglieder des Verbandes Schleswig-Holstein Aktiv vorbehaltlos vorgesehen. Wir freuen uns auf neue Mitglieder</br><a href="/profile/1079412" class="lightbox-open">>>Fragen bitte per PM<<</a> </p>\n      ';$("#tsmod-content").html(e),$("#radio").buttonset();var t,i={1:["https://abload.de/img/dark3dcockpitmobileei1ncy9.png","https://abload.de/img/dark3dcockpitmobileeiivcpg.png","https://abload.de/img/dark3dcockpitmobileeibdf38.png","https://abload.de/img/dark3dcockpitdesktopeoliwj.png"],2:["https://abload.de/img/simplebrighteinsatzmobjfnw.png","https://abload.de/img/simplebrighteinsatzmoaxe6y.png","https://abload.de/img/simplebrighteinsatzmon0evc.png","https://abload.de/img/simplebrighteinsatzdez9i7h.png"],5:["","","",""]},a=0;function updateSlideshow(e){if(i&&i[e]){var n=i[e];a=0;var s=$("#imageContainer");s.empty();var d=$("<img>").attr("src",n[a]);s.append(d),t&&clearInterval(t),"5"!==e&&(t=setInterval((function(){a=(a+1)%n.length,d.fadeOut(500,(function(){d.attr("src",n[a]),d.fadeIn(500)}))}),5e3));var l=$("#designInfo");"1"===e?l.html("<div>sehr schicker 3D Cockpit Effekt<hr>angenehmes eher dunkel gehaltenes Farbkonzept (basiert auf ehemals Premium Design nur sehr viel besser)<hr>\n      viele Designfehler wie z.b. √úberlappungen, chaotische oder sinnlose Anordnungen vom Spiel(auch AAO) und LSS-MANAGER v3 und v4 behoben</div>"):"2"===e?l.html("<div>hell und einfach gehalten<hr>auf Effizienz getrimmt<hr>\n      viele Designfehler wie z.b. √úberlappungen, chaotische oder sinnlose Anordnungen vom Spiel(auch AAO) und LSS-MANAGER v3 und v4 behoben</div>"):"5"===e&&l.html("‚¨ÜÔ∏èEs ist kein better than Premium Design aktiviert.‚¨ÜÔ∏è </br> Bitte treffe deine Auswahl")}else console.log("Ung√ºltiges ausgew√§hltes Design oder designImages ist nicht definiert.")}function radioElem(){$(".dclass").change((function(){updateSlideshow($("input[name='dclass']:checked").val())}));var e=localStorage.getItem("tsdesign");if(null!=e)for(var n=document.querySelectorAll('input[name="dclass"]'),t=0;t<n.length;t++)if(n[t].value===e){n[t].checked=!0,updateSlideshow(e);break}}let s;radioElem(),$("#tsmod-content").on("click","#feedback",(function(){2===s?($("#tsmod-content").html(e),radioElem(),$(this).text("Feedback&Infos"),$("#desave").css("display","inline-block"),s=1):($("#modal-body").html(n),$(this).text("zur√ºck"),$("#desave").css("display","none"),s=2)})),$("#tsmod-content").on("click","#desave",(function(){var e=$("#designid .dclass:checked").val();localStorage.setItem("tsdesign",e),togMod(),"1"===e?(DeDunkel(),alert("Das Dark3DCockpitüî• Design wurde aktiviert"),window.location.reload()):"2"===e?(DeStan(),alert("Das SimpleBrightüåû Design wurde aktiviert"),window.location.reload()):"5"===e&&(DeStan(),alert("Okay"+username+",\rdas 'better than Premium Design' wurde Deaktiviert und das Standard Design des Spiels wieder hergestellt"),window.location.reload())}))}()})),$(document).on("hide.bs.modal","#MyDesignID",(function(){var e=document.getElementById("decontent");e&&e.remove()})),null==localStorage.tsdesign&&$("#MyDesignID").modal("show")}window.addEventListener("load",(function(){reload(),MyDesignBox()}))}