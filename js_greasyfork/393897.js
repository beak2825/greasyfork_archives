// ==UserScript==
// @name         Smoothix Toaster
// @namespace    http://tampermonkey.net/
// @version      0.3
// @description  try to take over the world!
// @author       Alexandre Hanot
// @match        *://*/*
// @grant        none
// @downloadURL https://update.greasyfork.org/scripts/393897/Smoothix%20Toaster.user.js
// @updateURL https://update.greasyfork.org/scripts/393897/Smoothix%20Toaster.meta.js
// ==/UserScript==

(function() {
    'use strict';
var parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"x3gy":[function(require,module,exports) {
"use strict";function n(n){return void 0===n}function e(n){return null===n}function t(n){return n===Object(n)}function i(n){return Array.isArray(n)}function r(n){return n instanceof Date}function u(n){return n&&"number"==typeof n.size&&"string"==typeof n.type&&"function"==typeof n.slice}function o(n){return u(n)&&("object"==typeof n.lastModifiedDate||"number"==typeof n.lastModified)&&"string"==typeof n.name}function f(n){return n instanceof FormData}function s(c,l,a,p){if(f(l)&&(p=a,a=l,l=null),(l=l||{}).indices=!n(l.indices)&&l.indices,l.nulls=!!n(l.nulls)||l.nulls,a=a||new FormData,n(c))return a;if(e(c))l.nulls&&a.append(p,"");else if(i(c))if(c.length)c.forEach(function(n,e){var t=p+"["+(l.indices?e:"")+"]";s(n,l,a,t)});else{var d=p+"[]";a.append(d,"")}else r(c)?a.append(p,c.toISOString()):!t(c)||o(c)||u(c)?a.append(p,c):Object.keys(c).forEach(function(n){var e=c[n];if(i(e))for(;n.length>2&&n.lastIndexOf("[]")===n.length-2;)n=n.substring(0,n.length-2);s(e,l,a,p?p+"["+n+"]":n)});return a}module.exports=s;
},{}],"cjA7":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e={set:function(e,t,n,r){var i="",o="";if(n){var s=new Date;s.setTime(s.getTime()+60*n*1e3),i="; expires="+s.toGMTString()}r&&(o="; domain="+r),document.cookie=e+"="+escape(t)+i+o+"; path=/"},get:function(e){var t,n,r=e+"=",i=document.cookie.split(";");for(t=0;t<i.length;t++){for(n=i[t];" "===n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(r))return unescape(n.substring(r.length,n.length))}return null}};exports.default=e;
},{}],"oody":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=n(require("object-to-formdata")),e=n(require("./cookies"));function n(t){return t&&t.__esModule?t:{default:t}}var i={urlPrefix:"",visitsUrl:"/ahoy/visits",eventsUrl:"/ahoy/events",page:null,platform:"Web",useBeacon:!0,startOnReady:!0,trackVisits:!0,cookies:!0,cookieDomain:null,headers:{},visitParams:{},withCredentials:!1},r=window.ahoy||window.Ahoy||{};r.configure=function(t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])},r.configure(r);var o,a,s,c=window.jQuery||window.Zepto||window.$,u=240,f=1051200,d=!1,l=[],v="undefined"!=typeof JSON&&void 0!==JSON.stringify,h=[];function g(){return i.urlPrefix+i.visitsUrl}function k(){return i.urlPrefix+i.eventsUrl}function y(t){return 0===Object.keys(t).length}function m(){return(i.useBeacon||i.trackNow)&&y(i.headers)&&v&&void 0!==window.navigator.sendBeacon&&!i.withCredentials}function p(t,n,r){e.default.set(t,n,r,i.cookieDomain||i.domain)}function w(t){return e.default.get(t)}function x(t){e.default.set(t,"",-1)}function _(t){w("ahoy_debug")&&window.console.log(t)}function S(){for(var t;t=l.shift();)t();d=!0}function b(t){d?t():l.push(t)}function O(t,e){var n=t.matches||t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector;return n?n.apply(t,[e]):(_("Unable to match"),!1)}function C(t,e,n){document.addEventListener(t,function(t){O(t.target,e),n(t)})}function P(t){"interactive"===document.readyState||"complete"===document.readyState?t():document.addEventListener("DOMContentLoaded",t)}function V(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)})}function j(){i.cookies&&v&&p("ahoy_events",JSON.stringify(h),1)}function T(){var t=document.querySelector("meta[name=csrf-token]");return t&&t.content}function N(){var t=document.querySelector("meta[name=csrf-param]");return t&&t.content}function M(t){var e=T();e&&t.setRequestHeader("X-CSRF-Token",e)}function q(t,e,n){if(v)if(c&&c.ajax)c.ajax({type:"POST",url:t,data:JSON.stringify(e),contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:M,success:n,headers:i.headers,xhrFields:{withCredentials:i.withCredentials}});else{var r=new XMLHttpRequest;for(var o in r.open("POST",t,!0),r.withCredentials=i.withCredentials,r.setRequestHeader("Content-Type","application/json"),i.headers)i.headers.hasOwnProperty(o)&&r.setRequestHeader(o,i.headers[o]);r.onload=function(){200===r.status&&n()},M(r),r.send(JSON.stringify(e))}}function I(t){var e={events:[t]};return i.cookies&&(e.visit_token=t.visit_token,e.visitor_token=t.visitor_token),delete t.visit_token,delete t.visitor_token,e}function J(t){b(function(){q(k(),I(t),function(){for(var e=0;e<h.length;e++)if(h[e].id==t.id){h.splice(e,1);break}j()})})}function R(e){b(function(){var n=I(e),i=N(),r=T();i&&r&&(n[i]=r),n.events_json=JSON.stringify(n.events),delete n.events,window.navigator.sendBeacon(k(),(0,t.default)(n))})}function L(){return i.page||window.location.pathname}function A(t){return t&&t.length>0?t:null}function H(t){for(var e in t)t.hasOwnProperty(e)&&null===t[e]&&delete t[e];return t}function U(t){var e=t.target;return H({tag:e.tagName.toLowerCase(),id:A(e.id),class:A(e.className),page:L(),section:$(e)})}function $(t){for(;t&&t!==document;t=t.parentNode)if(t.hasAttribute("data-section"))return t.getAttribute("data-section");return null}function B(){if(d=!1,o=r.getVisitId(),a=r.getVisitorId(),s=w("ahoy_track"),!1===i.cookies||!1===i.trackVisits)_("Visit tracking disabled"),S();else if(o&&a&&!s)_("Active visit"),S();else if(o||p("ahoy_visit",o=V(),u),w("ahoy_visit")){_("Visit started"),a||p("ahoy_visitor",a=V(),f);var t={visit_token:o,visitor_token:a,platform:i.platform,landing_page:window.location.href,screen_width:window.screen.width,screen_height:window.screen.height,js:!0};for(var e in document.referrer.length>0&&(t.referrer=document.referrer),i.visitParams)i.visitParams.hasOwnProperty(e)&&(t[e]=i.visitParams[e]);_(t),q(g(),t,function(){x("ahoy_track"),S()})}else _("Cookies disabled"),S()}r.getVisitId=r.getVisitToken=function(){return w("ahoy_visit")},r.getVisitorId=r.getVisitorToken=function(){return w("ahoy_visitor")},r.reset=function(){return x("ahoy_visit"),x("ahoy_visitor"),x("ahoy_events"),x("ahoy_track"),!0},r.debug=function(t){return!1===t?x("ahoy_debug"):p("ahoy_debug","t",525600),!0},r.track=function(t,e){var n={name:t,properties:e||{},time:(new Date).getTime()/1e3,id:V(),js:!0};return b(function(){i.cookies&&!r.getVisitId()&&B(),b(function(){_(n),n.visit_token=r.getVisitId(),n.visitor_token=r.getVisitorId(),m()?R(n):(h.push(n),j(),setTimeout(function(){J(n)},1e3))})}),!0},r.trackView=function(t){var e={url:window.location.href,title:document.title,page:L()};if(t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.track("$view",e)},r.trackClicks=function(){C("click","a, button, input[type=submit]",function(t){var e=t.target,n=U(t);n.text="input"==n.tag?e.value:(e.textContent||e.innerText||e.innerHTML).replace(/[\s\r\n]+/g," ").trim(),n.href=e.href,r.track("$click",n)})},r.trackSubmits=function(){C("submit","form",function(t){var e=U(t);r.track("$submit",e)})},r.trackChanges=function(){C("change","input, textarea, select",function(t){var e=U(t);r.track("$change",e)})},r.trackAll=function(){r.trackView(),r.trackClicks(),r.trackSubmits(),r.trackChanges()};try{h=JSON.parse(w("ahoy_events")||"[]")}catch(F){}for(var D=0;D<h.length;D++)J(h[D]);r.start=function(){B(),r.start=function(){}},P(function(){i.startOnReady&&r.start()});var E=r;exports.default=E;
},{"object-to-formdata":"x3gy","./cookies":"cjA7"}],"frMb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n=e(require("./ahoy"));function e(n){return n&&n.__esModule?n:{default:n}}var t=["rejection","engagement","happiness","boredom","frustration","interest"],o=function(n){return"string"!=typeof n?"":n.charAt(0).toUpperCase()+n.slice(1)},i=function(){document.getElementById("smoothix-toggle").style.display="none",document.getElementById("smoothix-toaster").style.display="inline-block"},s=function(){document.getElementById("smoothix-toggle").style.display="none",document.getElementById("smoothix-toaster").style.display="none"};setTimeout(function(){"none"==document.getElementById("smoothix-toaster").style.display&&i()},1e4);var a=function(){var e=t.map(function(n){return'\n    <label style="display:block; margin: 3px 0;" class="smoothix-label">\n      <input type="checkbox" name="'.concat(n,'" class="smoothix-feedback" /> ').concat(o(n),"\n    </label>\n  ")}).join(""),a='\n    <button\n      id="smoothix-toggle"\n      style="\n        position: fixed;\n        bottom: 20px;\n        right: 20px;\n        display:inline-block;\n        background-color: #3f51b5;\n        color: white;\n        border: none;\n        border-radius: 8px;\n        padding: 10px;\n        text-align: center;\n    ">\n      Feedback\n    </button>\n    <form\n      id="smoothix-toaster"\n      style="\n        background-color:white;\n        box-shadow: 0 4px 6px rgba(50,50,93,.11), 0 1px 3px rgba(0,0,0,.08);\n        color: black;\n        font-family: sans-serif;\n        padding: 20px;\n        display:none;\n        position: fixed;\n        bottom: 20px;\n        right: 20px;\n        font-size: 14px;\n      "\n    >\n      <strong id="smoothix-header">Feedback about this session</strong>\n      '.concat(e,'\n      <button\n        id="smoothix-button"\n        style="\n          display:block;\n          background-color: #3f51b5;\n          color: white;\n          border: none;\n          border-radius: 8px;\n          padding: 10px;\n          text-align: center;\n          width: 100%;\n      ">\n        Submit\n      </button>\n  </form>\n  ');document.body.insertAdjacentHTML("beforeend",a),document.getElementById("smoothix-button").addEventListener("click",function(e){e.preventDefault(),e.stopPropagation();var t=document.getElementsByClassName("smoothix-feedback"),o={};Array.from(t).forEach(function(n){o[n.name]=n.checked?1:0}),setTimeout(function(){console.log("feedback"),n.default.track("$feedback",o)},100),s()}),document.getElementById("smoothix-toggle").addEventListener("click",function(n){n.preventDefault(),n.stopPropagation(),i()})};exports.default=a;
},{"./ahoy":"oody"}],"wnHN":[function(require,module,exports) {
"use strict";var t=i(require("./ahoy")),e=i(require("./toaster"));function i(t){return t&&t.__esModule?t:{default:t}}t.default.init=function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"https://us-central1-smoothix-3f485.cloudfunctions.net";this.configure({eventsUrl:"/events?apiKey=".concat(t),urlPrefix:i,visitsUrl:"/events?apiKey=".concat(t)}),this.trackAll(),(0,e.default)()},window.smoothix=t.default;
},{"./ahoy":"oody","./toaster":"frMb"}]},{},["wnHN"], null)
//# sourceMappingURL=/tracker.js.map

    smoothix.init("a0d223a9-1c07-413d-9c77-0bc869579541", "https://barista.smoothix.io");
    smoothix.debug();
})();