// ==UserScript==
// @name         UGATU SDO ANSWERS SCRIPT
// @namespace    https://t.me/+AzlTc2COncJmYzAy
// @version      1.1.2
// @description  Показ верных ответов на сайте СДО УГАТУ!
// @author       GuFFy_OwO
// @match        https://online.mospolytech.ru
// @icon         https://sdo.ugatu.su/pluginfile.php/1/theme_opentechnology/settings_setugatu_header_logoimage/1664187092/Z3_222.png
// @grant        none
// @run-at       document-start
// @license      MIT
// @downloadURL https://update.greasyfork.org/scripts/455163/UGATU%20SDO%20ANSWERS%20SCRIPT.user.js
// @updateURL https://update.greasyfork.org/scripts/455163/UGATU%20SDO%20ANSWERS%20SCRIPT.meta.js
// ==/UserScript==
 
(function () {
	let dataModelPatch = false;
	console.log("[UGATU SDO ANSWERS SCRIPT] loaded");
 
	const oldSplit = window.String.prototype.split;
	window.String.prototype.split = function () {
		try {
			if (!dataModelPatch && M.scorm_api.init) {
				const latency_rand = { min: 60, max: 300 }; //Значения минимального и максимального времени решения вопроса.
				const session_time_rand = { min: 2700, max: 5400 }; //Значения минимального и максимального времени просмотра лекции.
 
				function getRandomInt(min, max) {
					min = Math.ceil(min);
					max = Math.floor(max);
					return Math.floor(Math.random() * (max - min) + min);
				}
 
				function secondsToTime(seconds) {
					return new Date(seconds * 1000).toISOString().slice(11, 19);
				}
 
				function timeToSeconds(time) {
					const timeSplit = time.split(":");
					return +timeSplit[0] * 60 * 60 + +timeSplit[1] * 60 + +timeSplit[2];
				}
 
				let interactionsNum = 0;
				let lastInteractionTime = 0;
				const session_time = getRandomInt(session_time_rand.min, session_time_rand.max);
 
				function SCORMapi1_2(def,cmiobj,cmiint,cmistring256,cmistring4096,scormdebugging,scormauto,scormid,cfgwwwroot,sesskey,scoid,attempt,viewmode,cmid,currentorg,autocommit,masteryoverride,hidetoc){var prerequrl=cfgwwwroot+"/mod/scorm/prereqs.php?a="+scormid+"&scoid="+scoid+"&attempt="+attempt+"&mode="+viewmode+"&currentorg="+currentorg+"&sesskey="+sesskey,datamodelurl=cfgwwwroot+"/mod/scorm/datamodel.php",datamodelurlparams="id="+cmid+"&a="+scormid+"&sesskey="+sesskey+"&attempt="+attempt+"&scoid="+scoid;CMIString256=cmistring256,CMIString4096=cmistring4096,CMITime="^([0-2]{1}[0-9]{1}):([0-5]{1}[0-9]{1}):([0-5]{1}[0-9]{1})(.[0-9]{1,2})?$",CMITimespan="^([0-9]{2,4}):([0-9]{2}):([0-9]{2})(.[0-9]{1,2})?$",CMIInteger="^\\d+$",CMISInteger="^-?([0-9]+)$",CMIDecimal="^-?([0-9]{0,3})(.[0-9]*)?$",CMIIdentifier="^[\\u0021-\\u007E]{0,255}$",CMIFeedback=CMIString256,CMIIndex="[._](\\d+).",CMIStatus="^passed$|^completed$|^failed$|^incomplete$|^browsed$",CMIStatus2="^passed$|^completed$|^failed$|^incomplete$|^browsed$|^not attempted$",CMIExit="^time-out$|^suspend$|^logout$|^$",CMIType="^true-false$|^choice$|^fill-in$|^matching$|^performance$|^sequencing$|^likert$|^numeric$",CMIResult="^correct$|^wrong$|^unanticipated$|^neutral$|^([0-9]{0,3})?(.[0-9]*)?$",NAVEvent="^previous$|^continue$",cmi_children="core,suspend_data,launch_data,comments,objectives,student_data,student_preference,interactions",core_children="student_id,student_name,lesson_location,credit,lesson_status,entry,score,total_time,lesson_mode,exit,session_time",score_children="raw,min,max",comments_children="content,location,time",objectives_children="id,score,status",correct_responses_children="pattern",student_data_children="mastery_score,max_time_allowed,time_limit_action",student_preference_children="audio,language,speed,text",interactions_children="id,objectives,time,type,correct_responses,weighting,student_response,result,latency",score_range="0#100",audio_range="-1#100",speed_range="-100#100",weighting_range="-100#100",text_range="-1#1";var datamodel={},cmi,nav;for(scoid in def)datamodel[scoid]={"cmi._children":{defaultvalue:cmi_children,mod:"r",writeerror:"402"},"cmi._version":{defaultvalue:"3.4",mod:"r",writeerror:"402"},"cmi.core._children":{defaultvalue:core_children,mod:"r",writeerror:"402"},"cmi.core.student_id":{defaultvalue:def[scoid]["cmi.core.student_id"],mod:"r",writeerror:"403"},"cmi.core.student_name":{defaultvalue:def[scoid]["cmi.core.student_name"],mod:"r",writeerror:"403"},"cmi.core.lesson_location":{defaultvalue:def[scoid]["cmi.core.lesson_location"],format:CMIString256,mod:"rw",writeerror:"405"},"cmi.core.credit":{defaultvalue:def[scoid]["cmi.core.credit"],mod:"r",writeerror:"403"},"cmi.core.lesson_status":{defaultvalue:def[scoid]["cmi.core.lesson_status"],format:CMIStatus,mod:"rw",writeerror:"405"},"cmi.core.entry":{defaultvalue:def[scoid]["cmi.core.entry"],mod:"r",writeerror:"403"},"cmi.core.score._children":{defaultvalue:score_children,mod:"r",writeerror:"402"},"cmi.core.score.raw":{defaultvalue:def[scoid]["cmi.core.score.raw"],format:CMIDecimal,range:score_range,mod:"rw",writeerror:"405"},"cmi.core.score.max":{defaultvalue:def[scoid]["cmi.core.score.max"],format:CMIDecimal,range:score_range,mod:"rw",writeerror:"405"},"cmi.core.score.min":{defaultvalue:def[scoid]["cmi.core.score.min"],format:CMIDecimal,range:score_range,mod:"rw",writeerror:"405"},"cmi.core.total_time":{defaultvalue:def[scoid]["cmi.core.total_time"],mod:"r",writeerror:"403"},"cmi.core.lesson_mode":{defaultvalue:def[scoid]["cmi.core.lesson_mode"],mod:"r",writeerror:"403"},"cmi.core.exit":{defaultvalue:def[scoid]["cmi.core.exit"],format:CMIExit,mod:"w",readerror:"404",writeerror:"405"},"cmi.core.session_time":{format:CMITimespan,mod:"w",defaultvalue:"00:00:00",readerror:"404",writeerror:"405"},"cmi.suspend_data":{defaultvalue:def[scoid]["cmi.suspend_data"],format:CMIString4096,mod:"rw",writeerror:"405"},"cmi.launch_data":{defaultvalue:def[scoid]["cmi.launch_data"],mod:"r",writeerror:"403"},"cmi.comments":{defaultvalue:def[scoid]["cmi.comments"],format:CMIString4096,mod:"rw",writeerror:"405"},"cmi.evaluation.comments._count":{defaultvalue:"0",mod:"r",writeerror:"402"},"cmi.evaluation.comments._children":{defaultvalue:comments_children,mod:"r",writeerror:"402"},"cmi.evaluation.comments.n.content":{defaultvalue:"",pattern:CMIIndex,format:CMIString256,mod:"rw",writeerror:"405"},"cmi.evaluation.comments.n.location":{defaultvalue:"",pattern:CMIIndex,format:CMIString256,mod:"rw",writeerror:"405"},"cmi.evaluation.comments.n.time":{defaultvalue:"",pattern:CMIIndex,format:CMITime,mod:"rw",writeerror:"405"},"cmi.comments_from_lms":{mod:"r",writeerror:"403"},"cmi.objectives._children":{defaultvalue:objectives_children,mod:"r",writeerror:"402"},"cmi.objectives._count":{mod:"r",defaultvalue:"0",writeerror:"402"},"cmi.objectives.n.id":{pattern:CMIIndex,format:CMIIdentifier,mod:"rw",writeerror:"405"},"cmi.objectives.n.score._children":{pattern:CMIIndex,mod:"r",writeerror:"402"},"cmi.objectives.n.score.raw":{defaultvalue:"",pattern:CMIIndex,format:CMIDecimal,range:score_range,mod:"rw",writeerror:"405"},"cmi.objectives.n.score.min":{defaultvalue:"",pattern:CMIIndex,format:CMIDecimal,range:score_range,mod:"rw",writeerror:"405"},"cmi.objectives.n.score.max":{defaultvalue:"",pattern:CMIIndex,format:CMIDecimal,range:score_range,mod:"rw",writeerror:"405"},"cmi.objectives.n.status":{pattern:CMIIndex,format:CMIStatus2,mod:"rw",writeerror:"405"},"cmi.student_data._children":{defaultvalue:student_data_children,mod:"r",writeerror:"402"},"cmi.student_data.mastery_score":{defaultvalue:def[scoid]["cmi.student_data.mastery_score"],mod:"r",writeerror:"403"},"cmi.student_data.max_time_allowed":{defaultvalue:def[scoid]["cmi.student_data.max_time_allowed"],mod:"r",writeerror:"403"},"cmi.student_data.time_limit_action":{defaultvalue:def[scoid]["cmi.student_data.time_limit_action"],mod:"r",writeerror:"403"},"cmi.student_preference._children":{defaultvalue:student_preference_children,mod:"r",writeerror:"402"},"cmi.student_preference.audio":{defaultvalue:def[scoid]["cmi.student_preference.audio"],format:CMISInteger,range:audio_range,mod:"rw",writeerror:"405"},"cmi.student_preference.language":{defaultvalue:def[scoid]["cmi.student_preference.language"],format:CMIString256,mod:"rw",writeerror:"405"},"cmi.student_preference.speed":{defaultvalue:def[scoid]["cmi.student_preference.speed"],format:CMISInteger,range:speed_range,mod:"rw",writeerror:"405"},"cmi.student_preference.text":{defaultvalue:def[scoid]["cmi.student_preference.text"],format:CMISInteger,range:text_range,mod:"rw",writeerror:"405"},"cmi.interactions._children":{defaultvalue:interactions_children,mod:"r",writeerror:"402"},"cmi.interactions._count":{mod:"r",defaultvalue:"0",writeerror:"402"},"cmi.interactions.n.id":{pattern:CMIIndex,format:CMIIdentifier,mod:"w",readerror:"404",writeerror:"405"},"cmi.interactions.n.objectives._count":{pattern:CMIIndex,mod:"r",defaultvalue:"0",writeerror:"402"},"cmi.interactions.n.objectives.n.id":{pattern:CMIIndex,format:CMIIdentifier,mod:"w",readerror:"404",writeerror:"405"},"cmi.interactions.n.time":{pattern:CMIIndex,format:CMITime,mod:"w",readerror:"404",writeerror:"405"},"cmi.interactions.n.type":{pattern:CMIIndex,format:CMIType,mod:"w",readerror:"404",writeerror:"405"},"cmi.interactions.n.correct_responses._count":{pattern:CMIIndex,mod:"r",defaultvalue:"0",writeerror:"402"},"cmi.interactions.n.correct_responses.n.pattern":{pattern:CMIIndex,format:CMIFeedback,mod:"w",readerror:"404",writeerror:"405"},"cmi.interactions.n.weighting":{pattern:CMIIndex,format:CMIDecimal,range:weighting_range,mod:"w",readerror:"404",writeerror:"405"},"cmi.interactions.n.student_response":{pattern:CMIIndex,format:CMIFeedback,mod:"w",readerror:"404",writeerror:"405"},"cmi.interactions.n.result":{pattern:CMIIndex,format:CMIResult,mod:"w",readerror:"404",writeerror:"405"},"cmi.interactions.n.latency":{pattern:CMIIndex,format:CMITimespan,mod:"w",readerror:"404",writeerror:"405"},"nav.event":{defaultvalue:"",format:NAVEvent,mod:"w",readerror:"404",writeerror:"405"}};function initdatamodel(scoid){for(element in prerequrl=cfgwwwroot+"/mod/scorm/prereqs.php?a="+scormid+"&scoid="+scoid+"&attempt="+attempt+"&mode="+viewmode+"&currentorg="+currentorg+"&sesskey="+sesskey,datamodelurlparams="id="+cmid+"&a="+scormid+"&sesskey="+sesskey+"&attempt="+attempt+"&scoid="+scoid,cmi=new Object,cmi.core=new Object,cmi.core.score=new Object,cmi.objectives=new Object,cmi.student_data=new Object,cmi.student_preference=new Object,cmi.interactions=new Object,cmi.evaluation=new Object,cmi.evaluation.comments=new Object,nav=new Object,datamodel[scoid])null==element.match(/\.n\./)&&(void 0!==datamodel[scoid][element].defaultvalue?eval(element+' = datamodel["'+scoid+'"]["'+element+'"].defaultvalue;'):eval(element+' = "";'));eval(cmiobj[scoid]),eval(cmiint[scoid]),""==cmi.core.lesson_status&&(cmi.core.lesson_status="not attempted")}var Initialized=!1;function LMSInitialize(e){if(initdatamodel(scoid=scorm_current_node&&scorm_current_node.scoid?scorm_current_node.scoid:scoid),errorCode="0",""==e){if(!Initialized)return Initialized=!0,errorCode="0",scormdebugging&&LogAPICall("LMSInitialize",e,"",errorCode),"true";errorCode="101"}else errorCode="201";return scormdebugging&&LogAPICall("LMSInitialize",e,"",errorCode),"false"}function LMSFinish(e){if(errorCode="0",""==e){if(Initialized){Initialized=!1,result=StoreData(cmi,!0),""!=nav.event?"continue"==nav.event?setTimeout("mod_scorm_launch_next_sco();",500):setTimeout("mod_scorm_launch_prev_sco();",500):1==scormauto&&setTimeout("mod_scorm_launch_next_sco();",500),scormdebugging&&LogAPICall("LMSFinish","AJAXResult",result,0),result="true"==result?"true":"false",errorCode="true"==result?"0":"101",scormdebugging&&(LogAPICall("LMSFinish","result",result,0),LogAPICall("LMSFinish",e,"",0));var r=M.mod_scorm.connectPrereqCallback;return YUI().use("io-base",(function(e){e.on("io:complete",r.success,e),e.io(prerequrl)})),result}errorCode="301"}else errorCode="201";return scormdebugging&&LogAPICall("LMSFinish",e,"",errorCode),"false"}function LMSGetValue(element){if(errorCode="0",Initialized)if(""!=element)if(expression=new RegExp(CMIIndex,"g"),elementmodel=String(element).replace(expression,".n."),void 0!==datamodel[scoid][elementmodel])if("w"!=datamodel[scoid][elementmodel].mod){for(element=String(element).replace(expression,"_$1."),elementIndexes=element.split("."),subelement="cmi",i=1;i<elementIndexes.length&&void 0!==eval(subelement);)subelement+="."+elementIndexes[i++];if(subelement==element)return errorCode="0",scormdebugging&&LogAPICall("LMSGetValue",element,eval(element),0),eval(element);errorCode="0"}else errorCode=datamodel[scoid][elementmodel].readerror;else childrenstr="._children",countstr="._count",elementmodel.substr(elementmodel.length-childrenstr.length,elementmodel.length)==childrenstr?(parentmodel=elementmodel.substr(0,elementmodel.length-childrenstr.length),void 0!==datamodel[scoid][parentmodel]?errorCode="202":errorCode="201"):elementmodel.substr(elementmodel.length-countstr.length,elementmodel.length)==countstr?(parentmodel=elementmodel.substr(0,elementmodel.length-countstr.length),void 0!==datamodel[scoid][parentmodel]?errorCode="203":errorCode="201"):errorCode="201";else errorCode="201";else errorCode="301";return scormdebugging&&LogAPICall("LMSGetValue",element,"",errorCode),""}function LMSSetValue(element,value){if(errorCode="0",Initialized)if(""!=element)if(expression=new RegExp(CMIIndex,"g"),elementmodel=String(element).replace(expression,".n."),void 0!==datamodel[scoid][elementmodel])if("r"!=datamodel[scoid][elementmodel].mod)if(expression=new RegExp(datamodel[scoid][elementmodel].format),value+="",matches=value.match(expression),null!=matches){if(element!=elementmodel){for(elementIndexes=element.split("."),subelement="cmi",i=1;i<elementIndexes.length-1;i++)elementIndex=elementIndexes[i],elementIndexes[i+1].match(/^\d+$/)?(void 0===eval(subelement+"."+elementIndex)&&(eval(subelement+"."+elementIndex+" = new Object();"),eval(subelement+"."+elementIndex+"._count = 0;")),elementIndexes[i+1]==eval(subelement+"."+elementIndex+"._count")&&eval(subelement+"."+elementIndex+"._count++;"),elementIndexes[i+1]>eval(subelement+"."+elementIndex+"._count")&&(errorCode="201"),subelement=subelement.concat("."+elementIndex+"_"+elementIndexes[i+1]),i++):subelement=subelement.concat("."+elementIndex),void 0===eval(subelement)&&(eval(subelement+" = new Object();"),"cmi.objectives"==subelement.substr(0,14)&&(eval(subelement+".score = new Object();"),eval(subelement+".score._children = score_children;"),eval(subelement+'.score.raw = "";'),eval(subelement+'.score.min = "";'),eval(subelement+'.score.max = "";')),"cmi.interactions"==subelement.substr(0,16)&&(eval(subelement+".objectives = new Object();"),eval(subelement+".objectives._count = 0;"),eval(subelement+".correct_responses = new Object();"),eval(subelement+".correct_responses._count = 0;")));element=subelement.concat("."+elementIndexes[elementIndexes.length-1])}if("0"==errorCode){if(autocommit&&!SCORMapi1_2.timeout&&(SCORMapi1_2.timeout=Y.later(6e4,API,"LMSCommit",[""],!1)),void 0===datamodel[scoid][elementmodel].range)return"cmi.comments"==element?cmi.comments=cmi.comments+value:eval(element+"=value;"),errorCode="0",scormdebugging&&LogAPICall("LMSSetValue",element,value,errorCode),"true";if(range=datamodel[scoid][elementmodel].range,ranges=range.split("#"),value*=1,value>=ranges[0]&&value<=ranges[1])return eval(element+"=value;"),errorCode="0",scormdebugging&&LogAPICall("LMSSetValue",element,value,errorCode),"true";errorCode=datamodel[scoid][elementmodel].writeerror}}else errorCode=datamodel[scoid][elementmodel].writeerror;else errorCode=datamodel[scoid][elementmodel].writeerror;else errorCode="201";else errorCode="201";else errorCode="301";return scormdebugging&&LogAPICall("LMSSetValue",element,value,errorCode),"false"}function LMSCommit(e){if(SCORMapi1_2.timeout&&(SCORMapi1_2.timeout.cancel(),SCORMapi1_2.timeout=null),errorCode="0",""==e){if(Initialized){if(result=StoreData(cmi,!1),"3"!==hidetoc){Y.log("Refreshing toc");var r=M.mod_scorm.connectPrereqCallback;YUI().use("io-base",(function(e){e.on("io:complete",r.success,e),e.io(prerequrl)}))}return scormdebugging&&LogAPICall("Commit",e,"",0),scormdebugging&&LogAPICall("LMSCommit","AJAXResult",result,0),result="true"==result?"true":"false",errorCode="true"==result?"0":"101",scormdebugging&&(LogAPICall("LMSCommit","result",result,0),LogAPICall("LMSCommit","errorCode",errorCode,0)),result}errorCode="301"}else errorCode="201";return scormdebugging&&LogAPICall("LMSCommit",e,"",0),"false"}function LMSGetLastError(){return scormdebugging&&LogAPICall("LMSGetLastError","","",errorCode),errorCode}function LMSGetErrorString(e){if(""!=e){var r=new Array;return r[0]="No error",r[101]="General exception",r[201]="Invalid argument error",r[202]="Element cannot have children",r[203]="Element not an array - cannot have count",r[301]="Not initialized",r[401]="Not implemented error",r[402]="Invalid set value, element is a keyword",r[403]="Element is read only",r[404]="Element is write only",r[405]="Incorrect data type",scormdebugging&&LogAPICall("LMSGetErrorString",e,r[e],0),r[e]}return scormdebugging&&LogAPICall("LMSGetErrorString",e,"No error string found!",0),""}function LMSGetDiagnostic(e){return""==e&&(e=errorCode),scormdebugging&&LogAPICall("LMSGetDiagnostic",e,e,0),e}function AddTime(e,r){var t=e.split(":"),o=r.split(":"),n=t[2].split("."),i=o[2].split("."),a=0;FirstCents=0,n.length>1&&(FirstCents=parseInt(n[1],10)),SecondCents=0,i.length>1&&(SecondCents=parseInt(i[1],10));var m=FirstCents+SecondCents;m-=100*(a=Math.floor(m/100)),Math.floor(m)<10&&(m="0"+m.toString());var d=parseInt(n[0],10)+parseInt(i[0],10)+a;return d-=60*(a=Math.floor(d/60)),Math.floor(d)<10&&(d="0"+d.toString()),mins=parseInt(t[1],10)+parseInt(o[1],10)+a,a=Math.floor(mins/60),mins-=60*a,mins<10&&(mins="0"+mins.toString()),hours=parseInt(t[0],10)+parseInt(o[0],10)+a,hours<10&&(hours="0"+hours.toString()),"0"!=m?hours+":"+mins+":"+d+"."+m:hours+":"+mins+":"+d}function TotalTime(){return total_time=AddTime(cmi.core.total_time,cmi.core.session_time),"&"+underscore("cmi.core.total_time")+"="+encodeURIComponent(total_time)}function CollectData(e,r){var t="";for(property in e)"object"==typeof e[property]?t+=CollectData(e[property],r+"."+property):(element=r+"."+property,expression=new RegExp(CMIIndex,"g"),elementmodel=String(element).replace(expression,".n."),"cmi.core.session_time"!=element&&(void 0===datamodel[scoid][element]&&void 0!==datamodel[scoid][elementmodel]&&(datamodel[scoid][element]=CloneObj(datamodel[scoid][elementmodel])),void 0!==datamodel[scoid][element]&&"r"!=datamodel[scoid][element].mod&&(elementstring="&"+underscore(element)+"="+encodeURIComponent(e[property]),void 0!==datamodel[scoid][element].defaultvalue&&datamodel[scoid][element].defaultvalue==e[property]&&typeof datamodel[scoid][element].defaultvalue==typeof e[property]||(t+=elementstring,datamodel[scoid][element].defaultvalue=e[property]))));return t}function CloneObj(e){if(null==e||"object"!=typeof e)return e;var r=new e.constructor;for(var t in e)r[t]=CloneObj(e[t]);return r}function StoreData(e,r){var t="";if(r)"not attempted"==cmi.core.lesson_status&&(cmi.core.lesson_status="completed"),"normal"==cmi.core.lesson_mode&&"credit"==cmi.core.credit&&masteryoverride&&""!==cmi.student_data.mastery_score&&""!==cmi.core.score.raw&&(parseFloat(cmi.core.score.raw)>=parseFloat(cmi.student_data.mastery_score)?cmi.core.lesson_status="passed":cmi.core.lesson_status="failed"),"browse"==cmi.core.lesson_mode&&""==datamodel[scoid]["cmi.core.lesson_status"].defaultvalue&&"not attempted"==cmi.core.lesson_status&&(cmi.core.lesson_status="browsed"),t=CollectData(e,"cmi"),t+=TotalTime();else{let r=0;for(0===interactionsNum&&(lastInteractionTime=timeToSeconds(e.interactions_0.time));e[`interactions_${interactionsNum}`];){const t=e[`interactions_${interactionsNum}`];let o=getRandomInt(latency_rand.min,latency_rand.max);t.latency=secondsToTime(o),t.time=secondsToTime(lastInteractionTime),lastInteractionTime+=o,r+=o,interactionsNum++}e.core.session_time=secondsToTime(r+session_time),t=CollectData(e,"cmi")}var o=NewHttpReq(),n=DoRequest(o,datamodelurl,datamodelurlparams+t);return!1!==n&&(results=String(n).split("\n"),errorCode=results[1],results[0])}this.LMSInitialize=LMSInitialize,this.LMSFinish=LMSFinish,this.LMSGetValue=LMSGetValue,this.LMSSetValue=LMSSetValue,this.LMSCommit=LMSCommit,this.LMSGetLastError=LMSGetLastError,this.LMSGetErrorString=LMSGetErrorString,this.LMSGetDiagnostic=LMSGetDiagnostic}
				M.scorm_api.init=function(e,r,t,o,n,i,a,d,m,l,s,c,u,f,g,_,p,I,C){window.API=new SCORMapi1_2(r,t,o,n,i,a,d,m,l,s,c,u,f,g,_,p,I,C)};
 
				dataModelPatch = true;
				console.log("[UGATU SDO ANSWERS SCRIPT] Datamodel patched =>", M.scorm_api.init);
			}
		} catch (e) {}
 
		if (!arguments.callee.caller) {
			return oldSplit.apply(this, arguments);
		}
		let caller = arguments.callee.caller.caller;
 
		if (typeof caller == "function" && caller.toString().includes("reviewWithCorrectAnswers")) {
			window.String.prototype.split = oldSplit;
 
			console.log("[UGATU SDO ANSWERS SCRIPT] Player caller founded =>", caller);
			alert(
				"[UGATU SDO ANSWERS SCRIPT]\nОбновления тут: https://t.me/+AzlTc2COncJmYzAy\nTelegram бот с ответами: https://t.me/usatu_answers_bot\nПоддержать меня: https://qiwi.com/n/AYYNITRROSELLER"
			);
 
			caller = caller
				.toString()
				.replace(
					/function\(\){/,
					`function(){let questionsObject,reviewAnswersType="reviewWithCorrectAnswers";const questionUpdateMethodKeys=[],showAnswersButtonContainer=document.createElement("div"),showAnswersButtonContainerStyle={position:"fixed",left:"50%",bottom:"20px",transform:"translate(-50%, -50%)",margin:"0 auto"};for(const e of Object.keys(showAnswersButtonContainerStyle))showAnswersButtonContainer.style[e]=showAnswersButtonContainerStyle[e];const showAnswersButton=document.createElement("button");showAnswersButton.innerHTML="СКРЫТЬ ОТВЕТЫ";const showAnswersButtonStyle={"align-items":"center",appearance:"button","background-color":"rgba(82,139,223,1)","border-radius":"8px","border-style":"none","box-shadow":"rgba(255, 255, 255, 0.26) 0 1px 2px inset","box-sizing":"border-box",color:"#fff",cursor:"pointer",display:"flex","flex-direction":"row","flex-shrink":"0","font-family":'"RM Neue",sans-serif',"font-size":"100%","line-height":"1.15",margin:"0",padding:"10px 21px","text-align":"center","text-transform":"none",transition:"color .13s ease-in-out,background .13s ease-in-out,opacity .13s ease-in-out,box-shadow .13s ease-in-out","user-select":"none","-webkit-user-select":"none","touch-action":"manipulation"};for(const e of Object.keys(showAnswersButtonStyle))showAnswersButton.style[e]=showAnswersButtonStyle[e];showAnswersButton.onclick=function(){return questionsObject?2!==questionUpdateMethodKeys.length?console.error("[UGATU SDO ANSWERS SCRIPT] questionUpdateMethodKeys is not loaded"):("reviewWithCorrectAnswers"===reviewAnswersType?(reviewAnswersType="normal",showAnswersButton.innerHTML="ПОКАЗАТЬ ОТВЕТЫ",showAnswersButton.style.backgroundColor="rgb(223,82,82, 1)"):(reviewAnswersType="reviewWithCorrectAnswers",showAnswersButton.innerHTML="СКРЫТЬ ОТВЕТЫ",showAnswersButton.style.backgroundColor="rgba(82,139,223,1)"),console.log("[UGATU SDO ANSWERS SCRIPT] reviewAnswersType updated:",reviewAnswersType),void questionsObject[questionUpdateMethodKeys[0]](questionsObject[questionUpdateMethodKeys[1]])):console.error("[UGATU SDO ANSWERS SCRIPT] questionsObject is not loaded")},showAnswersButtonContainer.appendChild(showAnswersButton),window.document.body.appendChild(showAnswersButtonContainer),console.log("[UGATU SDO ANSWERS SCRIPT] showAnswersButtonContainer was created");`
				);
			caller = caller.replace(
				'return"reviewing"==a?b?"reviewWithCorrectAnswers":"reviewWithoutCorrectAnswers":"normal"',
				"return reviewAnswersType"
			);
 
			const questionUpdaterFunction = caller
				.match(/if\("completed"!=\w+\(a\)\|\|!\w+\){.+}/)[0]
				.match(/a\.\w+\(a\.\w+\)/)[0];
			caller = caller.replace(
				/if\("completed"!=\w+\(a\)\|\|!\w+\){/,
				`questionsObject=a;questionUpdateMethodKeys[0]="${
					questionUpdaterFunction.split(".")[1].split("(")[0]
				}";questionUpdateMethodKeys[1]="${questionUpdaterFunction.split(".")[2].split(")")[0]}";$&`
			);
 
			const newCaller = new Function(caller.substring(caller.indexOf("{") + 1, caller.lastIndexOf("}")));
			newCaller();
 
			return console.log("[UGATU SDO ANSWERS SCRIPT] Player caller patched =>", newCaller);
		}
 
		return oldSplit.apply(this, arguments);
	};
})();