// ==UserScript==
// @name         일번가 전적 한글화
// @namespace    http://tampermonkey.net/
// @version      1.0
// @description  한글화
// @icon         https://www.mahjong-jp.com/img/logo_jp.0b20f74e.png
// @author       you
// @match        https://www.mahjong-jp.com/loglibrary/search
// @match        https://www.mahjong-jp.com/loglibrary/detail/*
// @grant        none
// @run-at       document-idle
// @downloadURL https://update.greasyfork.org/scripts/563880/%EC%9D%BC%EB%B2%88%EA%B0%80%20%EC%A0%84%EC%A0%81%20%ED%95%9C%EA%B8%80%ED%99%94.user.js
// @updateURL https://update.greasyfork.org/scripts/563880/%EC%9D%BC%EB%B2%88%EA%B0%80%20%EC%A0%84%EC%A0%81%20%ED%95%9C%EA%B8%80%ED%99%94.meta.js
// ==/UserScript==

(function () {
    'use strict';

    const transData = {

          // 설명
        "説明":"설명",
        "牌譜屋では、炎陽・銀河段位戦の牌譜およびデータのみを記録しています。": "패보 사이트에서는 염양·은하 단위전의 패보 및 데이터만을 기록하고 있습니다.",
        "プレイヤー検索機能は、炎陽・銀河段位戦に参加したプレイヤーのみ検索可能です。":"플레이어 검색 기능은 염양·은하 단위전에 참가한 플레이어만 검색할 수 있습니다.",
        "ご不明な点がございましたら、サポートまでお問い合わせください。":"궁금한 점이 있으시면 서포트로 문의해 주시기 바랍니다.",
        "対局履歴の対象は、2025年6月18日 05:00以降の牌譜データです。":"대국 이력의 대상은 2025년 6월 18일 05:00 이후의 패보 데이터입니다.",
       "局中データの対象は、プレイヤーが炎陽・銀河段位戦で行った全対局のデータです。":"국중 데이터의 대상은 플레이어가 염양·은하 단위전에서 진행한 모든 대국의 데이터입니다.",

        //검색
        "これ以上データがありません":"더 이상 데이터가 없습니다.",

        "局中データ": "국중 데이터",
        "対局牌譜":"대국 패보",

        "プレイヤー詳細":"플레이어 상세",
        "牌譜IDをコピー":"패보 ID 복사",
        "コピーしました":"복사 했습니다",

        "プレイヤー検索":"플레이어 검색",
        "対局履歴閲覧":"대국 이력 열람",

          // 메인 데이터 설명 문구
        "プレイヤーのメインデータを表示します。":"플레이어의 메인 데이터를 표시합니다.",
        "対局のトータル回数" : "전체 대국(반장전/동풍전)을 플레이한 총 횟수",
        "x位回数":"x위 횟수",
        "x位率":"x위율",
        "x位を取った回数":"x위를 차지한 횟수",
        "総対局数のうちx位を取った比率":"전체 대국 수 중 x위를 차지한 비율",
        "総局数のうち立直した局の比率": "전체 국 수 중 리치를 선언한 국의 비율",
        "総局数のうち副露（チー、ポン、明槓）した局の比率": "전체 국 수 중 후로(치, 퐁, 명깡)를 실행한 국의 비율",
        "総局数のうち和了した局の比率": "전체 국 수 중 승리(화료)하여 점수를 획득한 국의 비율",
        "平均打点":"평균타점",
        "平均放銃点":"평균방총점",
        "和了点数の平均値": "화료했을 때 얻은 점수의 평균값",
        "総局数中放銃した局の比率": "전체 국 수 중 상대에게 론을 허용하여 점수를 잃은 국의 비율",
        "放銃した点数の平均値": "방총했을 때 잃은 점수의 평균값",
        "対局の順位の平均値": "치러진 대국 순위의 평균값",
        "総対局数中1位か2位の対局数の比率": "전체 대국 수 중 1위 또는 2위를 기록한 대국 수의 비율",
        "総対局数のうち、点数が0点未満になった数の比率": "전체 대국 수 중 점수가 0점 미만이 되어 게임이 강제 종료된 비율",

        // 세부 데이터 설명 문구
        "プレイヤーのデータを表示します。":"플레이어의 데이터를 표시합니다.",
        "親番の連荘回数の最大値":"친(오야)일 때 본장이 이어진 최대 횟수",
        "和了の平均巡目": "화료에 성공했을 때의 평균적인 순목",
        "総局数のうち立直で和了した局の比率":"전체 국 수 중 리치 상태에서 화료에 성공한 국의 비율",
        "総局数のうち門前で和了した局の比率":"전체 국 수 중 멘젠 상태에서 화료에 성공한 국의 비율",
        "総局数のうち鳴きで和了した局の比率":"전체 국 수 중 후로(울기) 상태에서 화료에 성공한 국의 비율",
        "総局数のうち立直でロンアガリの比率":"전체 국 수 중 리치 상태에서 론으로 화료한 국의 비율",
        "総局数のうち門前でロンアガリの比率":"전체 국 수 중 멘젠 상태에서 론으로 화료한 국의 비율",
        "総局数のうち鳴きでロンアガリの比率":"전체 국 수 중 후로 상태에서 론으로 화료한 국의 비율",
        "総局数のうち立直でツモアガリの比率":"전체 국 수 중 리치 상태에서 쯔모로 화료한 국의 비율",
        "総局数のうち門前でツモアガリの比率":"전체 국 수 중 멘젠 상태에서 쯔모로 화료한 국의 비율",
        "総局数のうち鳴きでツモアガリの比率":"전체 국 수 중 후로 상태에서 쯔모로 화료한 국의 비율",
        "立直した局のうち和了した局の比率" : "리치를 선언한 국 중에서 실제로 화료까지 이어진 국의 비율",
        "立直和了した局のうち一発で和了した局の比率" : "리치 화료 중 리치 후 한 바퀴 이내에(일발) 화료한 국의 비율",
        "総局数のうち流局した局の比率" : "전체 국 수 중 아무도 화료하지 못하고 국이 종료된 비율",
        "和了した局のうち黙聴で和了した局の比率" : "전체 화료 중 리치를 걸지 않은 텐파이(다마텐) 상태에서 화료한 비율",
        "放銃点数の最大値" : "한 번의 방총으로 실점한 점수의 최대치",
         "ロンアガリの比率" : "전체 화료 중 론으로 승리한 비율",
         "ツモアガリの比率" : "전체 화료 중 쯔모로 승리한 비율",
        "和了巡目": "평균순목",

        // 섹션
        "メインデータ": "메인 데이터",
        "データ": "세부 데이터",

        // 세부 데이터
        "立直成功率": "리치 성공률",
        "最大連荘": "최대 연장",
        "和了巡数": "화료 순",
        "立直和了率": "리치 화료율",
        "門前和了率": "멘젠 화료율",
        "鳴き和了率": "후로 화료율",

      
        "立直ロン率": "리치 론율",
        "門前ロン率": "멘젠 론율",
        "鳴きロン率": "후로 론율",
     
        "立直ツモ率": "리치 쯔모율",
        "門前ツモ率": "멘젠 쯔모율",
        "鳴きツモ率": "후로 쯔모율",

        "一発率": "일발율",
        "流局率": "유국율",
        "黙聴率": "다마율",

       "最大放銃点": "최대 방총점",
       "総対局数":"전체 대국 수",
        "炎陽":"염양",
        "銀河":"은하",
        "東風":"동풍전",
        "半荘":"반장전",

         "ロン率": "론율",
         "ツモ率": "쯔모율",

        // 기본 통계 데이터
        "総対局数": "총 대국 수",
        "平均順位": "평균 순위",

        "1位回数": "1위 횟수",
        "1位率": "1위율",
        "2位回数": "2위 횟수",
        "2位率": "2위율",
        "3位回数": "3위 횟수",
        "3位率": "3위율",
        "4位回数": "4위 횟수",
        "4位率": "4위율",

        "立直率": "리치율",
        "副露率": "후로율",
        "和了率": "화료율",
        "平均和了": "평균 화료점",
        "放銃率": "방총률",
        "平均放銃": "평균 방총점",

        "連対率": "연대율",
        "飛び率": "토비율",

    };

    function replaceText(root = document.body) {
        const walker = document.createTreeWalker(root, NodeFilter.SHOW_TEXT, null);
        let node;
        while ((node = walker.nextNode())) {
            for (const key in transData) {
                if (node.nodeValue.includes(key)) {
                    node.nodeValue = node.nodeValue.replaceAll(key, transData[key]);
                }
            }
        }
    }

    const observer = new MutationObserver(mutations => {
        for (const m of mutations) {
            if (m.type === "childList" || m.type === "characterData") {
                replaceText(m.target);
            }
        }
    });

    function start() {
        replaceText();
        observer.observe(document.body, {
            childList: true,
            subtree: true,
            characterData: true
        });
    }

    if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", start);
    } else {
        start();
    }
})();
