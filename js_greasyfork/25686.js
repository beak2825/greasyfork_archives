// ==UserScript==
// @name         hukd
// @namespace    hotukdeals.com
// @version      0.1
// @description  try to take over the world!
// @author       You
// @match        http://hotukdeals.com
// @grant        none
// @downloadURL https://update.greasyfork.org/scripts/25686/hukd.user.js
// @updateURL https://update.greasyfork.org/scripts/25686/hukd.meta.js
// ==/UserScript==

(function() {
    'use strict';

    // function catchFlamedeer(a){var b=$(".flame-modal-contents");b.toggleClass("seal--spin"),$.ajax("/flamedeer?flamedeerCatchKey="+a,{type:"POST",dataType:"text",success:function(a,c,d){var e=JSON.parse(a);b.replaceWith(e.data.content)}})}function setFixed(a){a.css({"-webkit-transition":"0","-moz-transition":"0","-ie-transition":"0","-o-transition":"0",transition:"0"}),a.css({top:"auto",position:"fixed",bottom:0}),$(window).unbind("scroll")}function parseResponse(a){var b={};return b.status=getTagFromResponse("response_status",a),b.content=getTagFromResponse("response_content",a),b.messages=getTagFromResponse("response_messages",a),b.value=getTagFromResponse("response_value",a),b}function getTagFromResponse(a,b){return tagVal=null,b=b.split("<"+a+">"),b.length>1&&(b=b[1].split("</"+a+">"),b.length>1&&(tagVal=trim(b[0]))),tagVal}function trim(a){return a.replace(/^\s+|\s+$/g,"")}function openModal(a){a.content="<div class='flamedeer-contest'>"+a.content+"</div>",$("body").append(a.content);var b=$(".s-modal-flamedeer");b.modal({overlay:{color:"#000",opacity:"0.6"},close:{className:"call-close"},isCentered:"false",onClose:function(){}});var c=b.data("modal");setTimeout(function(){var a=$(window).scrollTop()+$(window).height()-b.height()+"px",d=$(".s-content");d.offset()||(d=$(".layout-mainContent-body"));var e=0,f=220;e=d.width()<600?(d.width()-f)/2:d.width()+d.offset().left-486;var g=$(document).scrollTop()+$(window).height()+300;setTimeout(function(){b.css({left:e+"px",top:g+"px"}),c.open(),$("#modal-no-click-bg").unbind("click"),setTimeout(function(){b.css({"-webkit-transition":"top 1s ease","-moz-transition":"top 1s ease","-ie-transition":"top 1s ease","-o-transition":"top 1s ease",transition:"top 1s ease"}),b.css({display:"block",top:a}),$(window).scroll(function(){setFixed(b)}),setTimeout(function(){setFixed(b)},1e3)},100)},100)},500)}$(document).ready(function(){var a=Math.round((new Date).getTime()/1e3);if(void 0==campaignUrl){if(1==$(".hukdHeader").data("fd")){var b=10,c=60,d=1e3*Math.floor(Math.random()*(c-b+1)+b);setTimeout(function(){$.ajax("/flamedeer",{type:"POST",data:{findFlamedeer:!0,timestamp:a},dataType:"text",success:function(a,b,c){a=parseResponse(a),"success"==a.status&&openModal(a)}})},d)}}else isNaN(campaignUrl)||$.ajax("/flamedeer",{type:"POST",data:{getCampaignFlamedeer:campaignUrl,path:path,timestamp:a},dataType:"text",success:function(a,b,c){a=parseResponse(a),"success"!=a.status&&"failure"!=a.status||openModal(a)}})}),function(a){var b=function(b,c){b=a(b);var d=this,e=a.extend(!0,{overlay:{id:"modal-no-click-bg",color:"#000",opacity:"0.4",zindex:1e5},close:{className:"close"},isCentered:"true",onOpen:function(){},onClose:function(){}},c||{});this.init=function(){};var f=function(){"true"==e.isCentered&&d.center()};this.create_overlay=function(){a("#"+e.overlay.id).length<1&&(a("body").prepend('<div id="'+e.overlay.id+'">&nbsp;</div>'),a("#"+e.overlay.id).hide(),a("#"+e.overlay.id).css({position:"fixed","background-color":e.overlay.color,width:"100%",height:"100%",top:"0px",left:"0px",zIndex:e.overlay.zindex,filter:"alpha(Opacity = "+100*e.overlay.opacity+")",opacity:e.overlay.opacity,"-moz-opacity":e.overlay.opacity})),a(window).bind("scroll resize",f),a("."+e.close.className,b).click(function(a){a.preventDefault(),d.close()}),a("#"+e.overlay.id).click(function(a){a.preventDefault(),d.close()})},this.remove_overlay=function(){a(window).unbind("scroll resize",f),a("#"+e.overlay.id).remove()},this.toggle=function(){b.is(":hidden")?this.open():this.close()},this.open=function(){this.create_overlay(),a("#"+e.overlay.id).show(),b.show(),"true"==e.isCentered&&d.center(),e.onOpen()},this.close=function(){this.remove_overlay(),a("#"+e.overlay.id).hide(),b.hide(),"true"==e.isCentered&&d.center(),e.onClose()},this.center=function(){if("block"==a("#"+e.overlay.id).css("display")){var c=b.height(),d=b.outerHeight(),f=c+(d-c),g=a(window).height(),i=(a(document).scrollTop(),g/2-f/2),j=b.width(),k=b.outerWidth(),l=j+(k-j);b.css({"margin-left":"-"+l/2+"px",left:"50%","margin-top":"0px",top:i+"px",position:"fixed","z-index":e.overlay.zindex+1})}}};a.fn.modal=function(c){this.each(function(){var d=a(this);if(!d.data("modal")){var e=new b(this,c);e.init(),d.data("modal",e)}})}}(jQuery);
})();