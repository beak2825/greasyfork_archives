// ==UserScript==
// @name         Gartic.io sınırsız Oto Kick profil
// @namespace    http://tampermonkey.net/
// @version      1.0
// @description  bleeh
// @author       Mark
// @match        https://gartic.io/*
// @grant        none
// @downloadURL https://update.greasyfork.org/scripts/543200/Garticio%20s%C4%B1n%C4%B1rs%C4%B1z%20Oto%20Kick%20profil.user.js
// @updateURL https://update.greasyfork.org/scripts/543200/Garticio%20s%C4%B1n%C4%B1rs%C4%B1z%20Oto%20Kick%20profil.meta.js
// ==/UserScript==
let satoru=[];let sonoylananid=null;let oylananoyuncu=[];let kickbutonu=null;let withdrawButton=null;let orjbuton=null;let kapaaat=null;let disconnectMessage=null;const debounce=(func,delay)=>{let timeout;return function(...args){const context=this;clearTimeout(timeout);timeout=setTimeout(()=>func.apply(context,args),delay)}};const strongest=(nick,id)=>{satoru.some(p=>p.id===id)||satoru.push({nick:nick,id:id})};const sorcerer=(id)=>{satoru=satoru.filter(p=>p.id!==id);const index=oylananoyuncu.indexOf(id);if(index>-1){oylananoyuncu.splice(index,1);console.log(` Ayrılan oyuncu (${id}) oy verilenler listesinden çıkarıldı.`)}};const eklehg=(id)=>{if(!oylananoyuncu.includes(id)){oylananoyuncu.push(id);console.log(` ${id} ID'li oyuncuya oy verildi, listeye eklendi.`)}};const silsg=(id)=>{const index=oylananoyuncu.indexOf(id);if(index>-1){oylananoyuncu.splice(index,1);console.log(` ${id} ID'li oyuncunun oyu geri çekildi, listeden çıkarıldı.`)}};const showDisconnectMessage=()=>{if(!disconnectMessage){disconnectMessage=document.createElement('div');disconnectMessage.textContent='Bağlantın Koptu!/odadan çıktın';disconnectMessage.style.cssText=`
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background-color: red;
                color: white;
                text-align: center;
                padding: 10px 15px;
                font-size: 14px;
                font-weight: bold;
                border-radius: 5px;
                z-index: 9999;
                box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            `;document.body.appendChild(disconnectMessage);console.log(" 'Bağlantın Koptu!' mesajı ekrana eklendi.")}
disconnectMessage.style.display='block'};const hideDisconnectMessage=()=>{if(disconnectMessage){disconnectMessage.style.display='none';console.log(" 'Bağlantın Koptu!' mesajı ekrandan gizlendi.")}};let hollowpurple=WebSocket.prototype.send;window.wsObj={};WebSocket.prototype.send=function(data){hollowpurple.apply(this,arguments);if(Object.keys(window.wsObj).length===0){window.wsObj=this;window.eventAdd()}};window.eventAdd=()=>{window.wsObj.addEventListener('message',e=>{if(typeof e.data==="string"&&e.data.startsWith('42')){try{const data=JSON.parse(e.data.slice(2));if(data[0]==="5"){window.wsObj.id=data[2];data[5].forEach(x=>{strongest(x.nick,x.id)});hideDisconnectMessage()}
if(data[0]==="23"&&data[1]){strongest(data[1].nick,data[1].id)}else if(data[0]==="24"&&data[1]){sorcerer(data[1])}else if(data[0]==="6"){console.log("Sunucudan '6' mesajı alındı, bağlantı koptu olarak algılandı.");showDisconnectMessage()}}catch(error){console.error("dingdong",error)}}});const temizlebutonlarisgggg=()=>{if(kickbutonu&&kickbutonu.parentNode){kickbutonu.parentNode.removeChild(kickbutonu)}
if(withdrawButton&&withdrawButton.parentNode){withdrawButton.parentNode.removeChild(withdrawButton)}
kickbutonu=null;withdrawButton=null;console.log(" Tüm özel butonlar temizlendi.")};const addkapaaatListener=()=>{kapaaat=document.querySelector("#popUp > div:nth-child(1) > div > button");if(kapaaat&&!kapaaat.dataset.listenerAdded){kapaaat.addEventListener('click',()=>{console.log(" Orijinal kapatma butonuna tıklandı.");temizlebutonlarisgggg()});kapaaat.dataset.listenerAdded='true';console.log(" Orijinal kapatma butonuna listener eklendi.")}};const butonlariguncelleeeeeeee=()=>{const popUpSpan=document.querySelector("#popUp > div > div > div.contentPopup > span");orjbuton=document.querySelector("#popUp > div > div > div.buttons > button.btYellowBig.ic-votekick");const buttonsDiv=document.querySelector("#popUp > div > div > div.buttons");if(orjbuton){orjbuton.style.display='none'}
if(popUpSpan&&popUpSpan.textContent&&buttonsDiv){const kickedNick=popUpSpan.textContent.trim();const playerToKick=satoru.find(p=>p.nick===kickedNick);if(playerToKick){sonoylananid=playerToKick.id;const isVoted=oylananoyuncu.includes(sonoylananid);console.log(` Pop-up'ta tespit edilen oyuncu: ${playerToKick.nick} (ID: ${playerToKick.id}). Oy verildi mi: ${isVoted}`);if(!kickbutonu&&!withdrawButton){if(isVoted){withdrawButton=document.createElement('button');withdrawButton.id='customGarticWithdrawButton';withdrawButton.textContent='Oyu Geri Çek';withdrawButton.classList.add('btYellowBig','ic-votekick');withdrawButton.style.marginLeft='10px';buttonsDiv.appendChild(withdrawButton);console.log(" 'Oyu Geri Çek' butonu oluşturuldu ve eklendi.");withdrawButton.onclick=()=>{if(sonoylananid){console.log(` 'Oyu Geri Çek' butonuna tıklandı! ID ${sonoylananid} için oy geri çekme mesajı gönderiliyor.`);window.wsObj.send(`42[45,"${window.wsObj.id}",[${sonoylananid},false]]`);window.wsObj.send(`42[45,"${window.wsObj.id}",["${sonoylananid}",false]]`);silsg(sonoylananid);temizlebutonlarisgggg();document.querySelector("#popUp > div:nth-child(1) > div > button").click()}}}else{kickbutonu=document.createElement('button');kickbutonu.id='customGartickickbutonu';kickbutonu.textContent='Oyla/At';kickbutonu.classList.add('btYellowBig','ic-votekick');kickbutonu.style.marginLeft='10px';buttonsDiv.appendChild(kickbutonu);console.log(" 'Oyla/At' butonu oluşturuldu ve eklendi.");kickbutonu.onclick=()=>{if(sonoylananid){console.log(` 'Oyla/At' butonuna tıklandı! ID ${sonoylananid} için kick mesajı gönderiliyor.`);window.wsObj.send(`42[45,"${window.wsObj.id}",[${sonoylananid},true]]`);window.wsObj.send(`42[45,"${window.wsObj.id}",["${sonoylananid}",true]]`);eklehg(sonoylananid);temizlebutonlarisgggg();document.querySelector("#popUp > div:nth-child(1) > div > button").click()}}}}else if(isVoted&&!withdrawButton){temizlebutonlarisgggg();withdrawButton=document.createElement('button');withdrawButton.id='customGarticWithdrawButton';withdrawButton.textContent='Oyu Geri Çek';withdrawButton.classList.add('btYellowBig','ic-votekick');withdrawButton.style.marginLeft='10px';buttonsDiv.appendChild(withdrawButton);console.log(" 'Oyu Geri Çek' butonu yeniden oluşturuldu ve eklendi.");withdrawButton.onclick=()=>{if(sonoylananid){console.log(` 'Oyu Geri Çek' butonuna tıklandı! ID ${sonoylananid} için oy geri çekme mesajı gönderiliyor.`);window.wsObj.send(`42[45,"${window.wsObj.id}",[${sonoylananid},false]]`);window.wsObj.send(`42[45,"${window.wsObj.id}",["${sonoylananid}",false]]`);silsg(sonoylananid);temizlebutonlarisgggg();document.querySelector("#popUp > div:nth-child(1) > div > button").click()}}}else if(!isVoted&&!kickbutonu){temizlebutonlarisgggg();kickbutonu=document.createElement('button');kickbutonu.id='customGartickickbutonu';kickbutonu.textContent='Oyla/At';kickbutonu.classList.add('btYellowBig','ic-votekick');kickbutonu.style.marginLeft='10px';buttonsDiv.appendChild(kickbutonu);console.log(" 'Oyla/At' butonu yeniden oluşturuldu ve eklendi.");kickbutonu.onclick=()=>{if(sonoylananid){console.log(` 'Oyla/At' butonuna tıklandı! ID ${sonoylananid} için kick mesajı gönderiliyor.`);window.wsObj.send(`42[45,"${window.wsObj.id}",[${sonoylananid},true]]`);window.wsObj.send(`42[45,"${window.wsObj.id}",["${sonoylananid}",true]]`);eklehg(sonoylananid);temizlebutonlarisgggg();document.querySelector("#popUp > div:nth-child(1) > div > button").click()}}}
addkapaaatListener()}else{temizlebutonlarisgggg();if(orjbuton)orjbuton.style.display='';sonoylananid=null;addkapaaatListener()}}else{sonoylananid=null;if(kapaaat&&kapaaat.dataset.listenerAdded){kapaaat.removeEventListener('click',()=>{temizlebutonlarisgggg()});kapaaat.dataset.listenerAdded=''}}};const debouncedbutonlariguncelleeeeeeee=debounce(butonlariguncelleeeeeeee,150);const popUpObserver=new MutationObserver((mutations)=>{debouncedbutonlariguncelleeeeeeee()});const popUpContainer=document.querySelector("#popUp");if(popUpContainer){popUpObserver.observe(popUpContainer,{childList:!0,subtree:!0,attributes:!0,attributeFilter:['style','class']});console.log(" #popUp elementi gözlemleniyor.");debouncedbutonlariguncelleeeeeeee()}else{console.warn(" #popUp elementi bulunamadı. Özel buton otomasyonu çalışmayabilir.")}}
let lM;let lastSentMessage='';setInterval(()=>{const userElement=document.querySelector(".user.you");if(!userElement)return;let nickin=userElement.querySelector(".nick").innerText;let l=document.querySelectorAll(".msg.sending.you");if(l.length>0){lM=l[l.length-1].innerText}
let llMsg=document.querySelectorAll(".msg");if(llMsg.length===0)return;let llastMsg=llMsg[llMsg.length-1].innerText;let msgAlert=document.querySelectorAll(".msg.alert");if(msgAlert.length===0)return;let lastMsgAlert=msgAlert[msgAlert.length-1].innerText;if((lastMsgAlert==llastMsg&&lastMsgAlert.includes("Saldırgan"))||(lastMsgAlert==llastMsg&&lastMsgAlert.includes("Offensive"))){if(lastSentMessage===lM)return;let replacedMessage=lM.replace(nickin,"").split("").join("឵");for(let i=0;i<replacedMessage.length;i+=100){setTimeout(()=>{window.wsObj.send(`42[11,"${window.wsObj.id}","${replacedMessage.slice(i, i + 100)}"]`)},i/100*1000)}
lastSentMessage=lM}},1)