// ==UserScript==
// @name                this is a test 08-b - 29 aug 2017 - a
// @author              test001
// @version             1.1
// @description         test
// @include             https://www.mturk.com/mturk/searchbar*


// @namespace           jhakjfh
// @downloadURL https://update.greasyfork.org/scripts/32690/this%20is%20a%20test%2008-b%20-%2029%20aug%202017%20-%20a.user.js
// @updateURL https://update.greasyfork.org/scripts/32690/this%20is%20a%20test%2008-b%20-%2029%20aug%202017%20-%20a.meta.js
// ==/UserScript==

var previewLinkEls = document.querySelectorAll('span.capsulelink a');

for (var i = 0; i < previewLinkEls.length; i++) {
    var previewLink = previewLinkEls[i].getAttribute('href');

    if (previewLink && previewLink.split('?')) {
        var previewLinkArray = previewLink.split('?');
        if (previewLinkArray[0] == '/mturk/preview') {
            var previewAndAcceptLink = previewLinkArray[0] + 'andaccept?' + previewLinkArray[1] + '&autoAcceptEnabled=true';

            var previewAndAcceptEl = document.createElement('a');
            previewAndAcceptEl.setAttribute('href', previewAndAcceptLink);
            previewAndAcceptEl.setAttribute('target', 'mturkhits');
            previewAndAcceptEl.setAttribute('style', 'margin-right: 20px;');
            //previewAndAcceptEl.innerHTML = 'Preview & Accept HITs';
            previewAndAcceptEl.innerHTML = previewLink;

            var parentSpan = previewLinkEls[i].parentNode;
            parentSpan.insertBefore(previewAndAcceptEl, parentSpan.firstChild);
            
         
         var test1 = ["3WAI7IWAXVD09QTSTQBZO8YYDN1KCB", "3Q9ARQ9ZBQG37YYTRLUUSV0BEP8M3H", "3V7AFCJQHC1E4HIWJGN5B2E4BB54AQ", "37672WDDC2JQREP5GIAU7DW7RSIMN1", "3GC8IVJ11FGR77RNNR737HNOT79N9H", "3IE1FJZRADLUWCN6NIIO4VBTPCMK9Q", "367GCHJ564RPM0N98UV4J83XEGPM93", "3P6UG6V268PU7C2X30EDFFHHXELN48", "3NXBKB55A9G5GI5O8IUPJVO8ECSL9V", "3HYDIS22DXAC3V6XH5XNK7NVXAGN5D", "30E2X49V6109PGJT3M9U5APBJFGN3G", "30E2X49V6109PGJT3M9U5APBJENN3L", "30X7H91F8M6L64C69F5G6OIBY0T7UO", "3U5LDTO7DUTDFD5EGIVBHHAELUBN1V", "3WY138MAADSXPESC1LR3DBD9HAUYI7", "3SFJXQ9EF4MAFDVVND7FTPMKJ83DXY", "3WY138MAADSEX596D7DI23D7QDPYIF", "3SFJXQ9EF4MRHYMG4B4Q30QNNYOXDS", "3HCACVK2ZBCTLICS1399ZHDBVUV648", "3SJ1BZ9YN0ORQZKG5YCKIR1ROG9N7Q", "3N6I2GM9S1MOCANI8XKN122QA4X5BC", "33QM7VBL68IZCJPAUZRC1T8O7523Q0", "3T063PBWYV4RPO7DYLD6XVCQNKG6HY", "3KFTENQ26GW7DLI80AU5S99IL6IWNH", "3OJGK8O6LQSV08YHSM8P1Q044IA5L6", "37Z5ZKVZFV5J1GG8R9TFSILMEJNL3H", "3244QHISK2RNKOHB8MBWQKNFB8WL0H", "3QOZH73NKQUB3EQL8S441BRB0ZKQAT", "3Z44DFV2WUT12ZHVTLW55ZX2JL7L7K", "351HA2MLHMEQUUDVZE6T9CIDY15OVJ", "3YR6VNT5240OURMJY95RD51U3VI7B8", "3O3GBVZQKNGU977FRQJ8E41I1Z42U7", "36DWM50OFILR6G8XMFWV9M5X3KCEKO", "3MK14RC5OTSW4W143WUDYFXW8F26T6", "3J06FGISMVKBVPLUKS57SF6R3G4K50", "3PR0UJAGZPICKHEDYLRGXK5LCF5HJ7", "3ED2P6N3JY8CXTQEHX221QK0WMO6FG", "3VF0G6A7K0CYLNMMUZD0XVYCGPPEYP", "3S82SNMR20FAFLJL2REM4MUOFVYFA8", "3XIFEF0YTSS643CB9BDCNO6MOTLTWL", "3KSJQJJC8X808Q1HBRMW1I9RHY7GKT", "33X7UBO5WU4NGR01B0VCSXGVDZNU01", "3SHL2XNU6YAWNCTGS9G92MBL42Q0P4", "3D3X1L1OAHQN0VAJC99H2O1OWYXV1P", "3BJ81NIZBG27ETL8PBFCKLKRZAMK6L", "36KIZ77D4Q9EMG2ANLGP9LVJ8ABM27", "3W718UE9EUHUI74WIQCA4ZGI55CK87", "3WRXIMH6F2U4JCZCRNYY2NDSSJJL42", "3J06FGISMVKBVPLUKS57SF6R3F6K50", "31QOF9ABMOYNRD2T45FW4P6PG03L1L", "3NAD71TD8VYUGYKPN9FA98GU85NL26", "3LE9INWSGX27Q6ZW8YCBQX24BCRM0N", "3IE1FJZRADLUWCN6NIIO4VBTPCLK9P", "3F12ASV6BX5OPUHXRZZD20SHSO7M43", "3IE1FJZRADLUWCN6NIIO4VBTPBTK9V", "3RKALKFQF0TY82SS7TI1XJ86UR8791", "3WYS9MM12T74FGCYQUZCX6KW7PU0GI", "36DWM50OGJA9MCR4HWCHG66JUNJKEW", "38IOEK81UIXF42ENOJD9R58AZGK69X", "3VXAY8PXA6QYE0D8F1KKGAMF0V6UBZ", "3OQEO5BIM1SPR61Y6VCPUB7TXKRU9H", "3YVRJW0BX3KR0VFVP5CCGOH23ZQZ4B", "3LFL2M9PP9NV2E4P31L4BOKBAYOKKT", "3DASWRA7V4B8M251VRW6K7R8B3B9P2", "3MK14RC5NSGQBLKQK714NGS1MFP6TG", "3I6C7P7ISCDXWXJDX4HBNDDX4SF6ZE", "3O73QR1UZ9MRVWHFHND6RYDCKX0949", "3BW6RX62FE5JGV4FN13JXR36CJ8LE1", "305NBF6GKRHPRNLSWQPVDLUKIYXRD3", "3FIV35QXDMXT9LOSGPR9N0JU5Y96AJ", "34YKDDZP4VBUVJNXOI8XYXSC304HWW", "3QPQKLUN2SX2FPUCOKGTMX8Y55GS6C", "3ZSDUF3VWNHT0BARJMVHSBS39AB23R", "3MXFP9RGE54MJXRAAWPVV6U7XSM2BV", "3VXAY8PXA6RAO4CSGX9OQMCYRIUUBE", "3D8O2NKTBHY9N3BJHGY1EP5KCKN139", "3LUKZ8GFZ31J7P98RJG39LOSQ63WGQ", "3FZVIEL19TSFY8QSPR66MMBJCWWRRQ", "3DECMKXKS7HIY96Y7G6FKNXSJR2BMD", "3DXFGU9SKNWWKGQCB031XSRIPWFEXZ", "330XZFCZ7RBMOFXKHW2JRFQBTVJTXP", "3FIV35QXDMXT9LOSGPR9N0JU5Y46AE", "3JGLGV9D7LS7QYSTD4O8GJ9KJWDD5F", "3PCJO2UJYJRQTL4R83V2Y92XT8IU5H", "3R7DCNC1NOULXYJKN9DLWLQP3VKUD2", "39UNKKTVEG7SWHS0PQH1EDVKRP6YGU", "3MQJWSYXOHGDXJ3GAF96UH2MB215O3", "3SFRD5IA5Z46FCDVEM418FVEH0BFB9", "3YA4TL3MRJGJYLNOR9E0O7X2LHTMYA", "306OACM7G0CGDZ7G94O77EFLBSZA87", "3Z44DFV2WUT12ZHVTLW55ZX2JJ9L7I", "3XB7PZ5TYKR1XOX1J9B6TA9JOSK7O6", "3CP9VRCFS73WHMB13FAH2V7RS00EUH", "3F12ASV6BX5OPUHXRZZD20SHSM8M40", "33CCZ2QQZLSJHH72U1W73T0NGDD9EO", "3S1POB7GV9SOY8IOC8KQ1A3NQMKQUJ", "3TSPVXK7YO9K9TNCI86HQ0LVGRWLFQ", "3T6HLR4BXWC28GXBHYA7BJ415AG98Q", "3T9YKFMCGXZ4KJNOYAQCD50KV109CV", "38GRQLZZQQ3CPIU4RJPLM78LPSM0C4", "3VKZWROWWHLHNQKJV4GH30QO9NB8GG", "3IJ5583D9EWRMGEINAVGCV8OA4Z0EX", "3Z44DFV2WUT12ZHVTLW55ZX2JJ8L7H", "3LE9INWSGX27Q6ZW8YCBQX24BAUM0M", "3UEL82N5TO6CD3JR2HD8Q3QU695NTZ", "3YA4TL3MRJEAQIH8AZ349C63A4RMY9", "33U5EW3SWR7I90EVH9GHF9OQUF78ZP", "3GCOF3W23JYNZ0XRS6GGEW2DFKR52W", "33XMDKLTER8L5S1K7GJZ7577941CZU", "3QNALI7B3RMDAPXJGOG1I1NKYWG5ZL", "3DHOXWJRRBM57QA883EV1HEPKVGT3J", "3LIIZRDE850C4BDQO5X0IDLI7MLYTC", "32SOQFN7SOS08WKMAUMGMA0NF9HIPG", "3DBSZOC6MK7FTX9NMK1BVECZO22C3C", "37672WDDD32J59EHOME9GCF639FNM0", "3E9JM64F34APQCBUG261XG918ERNPX", "3N9FD9XF595EZRR0NSHQ1JGH5DCVEN"];
         
         var test2 = previewLink.replace("/mturk/preview?groupId=", "");
          
          var test3 = test1.indexOf(test2);
          if(test3 === -1){
          var winOpen =  window.open(previewAndAcceptEl, width=100, height=100);
            break;
            
          }
        }
    }
}

var myt4 = setTimeout( function() {
            location.reload( true );
      // }, 500 );  
        }, 1000 ); 
        

if (test3 === -1){
   clearTimeout(myt4); 
}