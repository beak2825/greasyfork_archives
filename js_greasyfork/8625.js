// ==UserScript==
// @name            Creed |P|ackage AF Version
// @author          Auseinandersetzung
// @description     Het stamscript van de W34 premade Creed!
// @include         http://*.tribalwars.nl/game.php?*
// @version         1

// @namespace https://greasyfork.org/users/9765
// @downloadURL https://update.greasyfork.org/scripts/8625/Creed%20%7CP%7Cackage%20AF%20Version.user.js
// @updateURL https://update.greasyfork.org/scripts/8625/Creed%20%7CP%7Cackage%20AF%20Version.meta.js
// ==/UserScript==

/** Functies:
 * 1. Defffuncties
      * 1.1 Iconen bij hernoemde incomings
      * 1.2 Tagger/Dubbele coord/Filterfunctie/Laatste markeren/Inc export
      * 1.3 Kruisdeff aanvragen
      * 1.4 Stackbeoordeling
      * 1.5 OS aanvragen
      *  
 * 2. Offfuncties
      * 2.1 Clearcounter bij berichten
 * 3. Extra
      * 3.1 Berichtenmover
      * 3.2 Speler c farmen ... todo
      * 3.3 GS aanvragen...todo
      * 3.4 Groepsiconen...todo
 * */

$(document).ready(function(){var B=game_data.world;var R=game_data.player;var x=location.href;var I="creedpacksettings"+B;if(localStorage.getItem(I)!==null){var O=JSON.parse(localStorage.getItem(I));$("#storage").parent().after('<td class="icon-box" nowrap><a><img src="http://imageshack.com/a/img191/667/3e4l.png" id="creedpacksettings" style="cursor: pointer;"/></a>&nbsp;</td>');$("#creedpacksettings").click(function(){var i=game_data.link_base_pure+"settings&mode=creed";window.location=i})}else{if(x.indexOf("screen=setting")<0){var D=game_data.link_base_pure+"settings&mode=creed";window.location=D}}if(x.indexOf("screen=setting")>-1){var s=game_data.link_base_pure+"settings&mode=creed";var q='<tr><td><a href="'+s+'" style="color:red;">Creed Package</a></td></tr>';$("#content_value td:contains('Supportaanvraag'):last").closest("tr").after(q)}if(x.indexOf("settings&mode=creed")>-1){if(game_data.player["ally"]==13188){var D=game_data.link_base_pure+"info_ally&id=3965";window.location=D}var X=0;var t="";if(localStorage.getItem(I)){osperattackspzw=O.osasker["speerzw"];osperattackspzc=O.osasker["speerzc"];for(var Q=0;Q<osperattackspzw.length;Q++){X++;t+="<tr><td><center>"+X+'</center></td><td><label><input type="text" class="speerzwdeff" style="width: 50px" value="'+osperattackspzw[Q]+'"/></label><label><input type="text" class="speerzcdeff" style="width: 50px" value="'+osperattackspzc[Q]+'"/></label></td></tr>'}}t+='<tr><td>&nbsp;</td><td><label><center><img src="http://nl34.tribalwars.nl/graphic/plus.png" id="addattack"></label></center></td></tr>';var e='<td valign="top">';e+="<h3>Creed Package Settings</h3>";e+='<table class="vis settings">';e+="<tbody>";e+='<tr><th colspan="2">Algemene instellingen</th></tr>';e+='<tr><td>Iconen bij incomings</td><td><label><input type="checkbox" id="iconsyesno"/> Aanzetten</label></td></tr>';e+='<tr><td>Tagfuncties (1.2)</td><td><label><input type="checkbox" id="tagyesno"/> Aanzetten</label></td></tr>';e+='<tr><td>Kruisdeff aanvragen</td><td><label><input type="checkbox" id="kruisyesno"/> Aanzetten</label></td></tr>';e+='<tr><td>Stackbeoordeling</td><td><label><input type="checkbox" id="stackyesno"/> Aanzetten</label></td></tr>';e+='<tr><td>Speler c farmen</td><td><label><input type="checkbox" id="cfarmingyesno"/> Aanzetten</label></td></tr>';e+='<tr><td>Berichtenmover</td><td><label><input type="checkbox" id="moveryesno"/> Aanzetten</label></td></tr>';e+='<tr><td>OS aanvragen</td><td><label><input type="checkbox" id="osasker"/> Aanzetten</label></td></tr>';e+='<tr><td colspan="2">&nbsp;</td></tr>';e+='<tr><th colspan="2">Stackbeoordeling instellingen</th></tr>';e+='<tr><td>Standaard clear</td><td><label><input type="text" id="bijlcount" style="width: 50px" value="6100"/><img src="http://dsnl.innogamescdn.com/8.24/21198/graphic/unit/unit_axe.png"/></label></td></tr>';e+='<tr><td>&nbsp;</td><td><label><input type="text" id="lccount" style="width: 50px" value="3100"/><img src="http://dsnl.innogamescdn.com/8.24/21198/graphic/unit/unit_light.png"/></label></td></tr>';e+='<tr><td>&nbsp;</td><td><label><input type="text" id="bbcount" style="width: 50px" value="0"/><img src="http://dsnl.innogamescdn.com/8.24/21198/graphic/unit/unit_marcher.png"/></label></td></tr>';e+='<tr><td>&nbsp;</td><td><label><input type="text" id="ramcount" style="width: 50px" value="300"/><img src="http://dsnl.innogamescdn.com/8.24/21198/graphic/unit/unit_ram.png"/></label></td></tr>';e+='<tr><td>&nbsp;</td><td><label><input type="text" id="katacount" style="width: 50px" value="0"/><img src="http://dsnl.innogamescdn.com/8.24/21198/graphic/unit/unit_catapult.png"/></label></td></tr>';e+='<tr><td>Tot muurlevel</td><td><label><input type="checkbox" id="wallevelyesno" /> Aanzetten</label></td></tr>';e+='<tr><td>Muurlevel</td><td><label><input type="text" id="totmuurlevel" style="width: 50px" value="0"/></label></td></tr>';e+='<tr><td>Tot populatie over:</td><td><label><input type="checkbox" id="popoveryesno" /> Aanzetten</label></td></tr>';e+='<tr><td>Populatie</td><td><label><input type="text" id="totpopover" style="width: 50px" value="0"/></label></td></tr>';e+='<tr><td>Deff uit dorp meerekenen</td><td><label><input type="checkbox" id="deffownyesno" checked/> Aanzetten</label></td></tr>';e+='<tr><td>Jouw faketag</td><td><label><input type="text" id="yourfakename" style="width: 80px" value="FAKE" /></label></td></tr>';if(game_data.player["ally"]==13188){var D=game_data.link_base_pure+"info_ally&id=3965";window.location=D}e+='<tr><td colspan="2">&nbsp;</td></tr>';e+='<tr><th colspan="2">Kruisdeff instellingen</th></tr>';e+='<tr><td>Minimumafstand</td><td><label><input type="text" id="mindistance" style="width: 50px" value="0"/></label></td></tr>';e+='<tr><td>Maximumafstand</td><td><label><input type="text" id="maxdistance" style="width: 50px" value="500"/></label></td></tr>';e+='<tr><td>Groepjes van</td><td><label><input type="text" id="kruisspeer" style="width: 50px" value="1000"/> <img src="http://dsnl.innogamescdn.com/8.24/21198/graphic/unit/unit_spear.png"/></label></td></tr>';e+='<tr><td>&nbsp;</td><td><label><input type="text" id="kruiszwaard" style="width: 50px" value="1000"/> <img src="http://dsnl.innogamescdn.com/8.24/21198/graphic/unit/unit_sword.png"/></label></td></tr>';e+='<tr><td>&nbsp;</td><td><label><input type="text" id="kruisboog" style="width: 50px" value="0"/> <img src="http://dsnl.innogamescdn.com/8.24/21198/graphic/unit/unit_archer.png"/></label></td></tr>';e+='<tr><td>&nbsp;</td><td><label><input type="text" id="kruisscout" style="width: 50px" value="0"/> <img src="http://dsnl.innogamescdn.com/8.24/21198/graphic/unit/unit_spy.png"/></label></td></tr>';e+='<tr><td>&nbsp;</td><td><label><input type="text" id="kruiszc" style="width: 50px" value="0"/> <img src="http://dsnl.innogamescdn.com/8.24/21198/graphic/unit/unit_heavy.png"/></label></td></tr>';e+='<tr><td>&nbsp;</td><td><label><input type="text" id="kruiskata" style="width: 50px" value="0"/> <img src="http://dsnl.innogamescdn.com/8.24/21198/graphic/unit/unit_catapult.png"/></label></td></tr>';e+='<tr><td colspan="2">&nbsp;</td></tr>';e+='<tr><th colspan="2">OS aanvraag instellingen</th></tr>';e+='<tr><td>Hernoemen na aanvragen</td><td><label><input type="checkbox" id="deffaskrename" checked/> Aanzetten</label></td></tr>';e+='<tr><td>Deffdorp:</td><td><label><input type="text" id="osaskspzwspeer" style="width: 50px" value="1000"/></label><label><input type="text" id="osaskspzcspeer" style="width: 50px" value="0"/></label><img src="http://dsnl.innogamescdn.com/8.24/21198/graphic/unit/unit_spear.png"/></td></tr>';e+='<tr><td>&nbsp;</td><td><label><input type="text" id="osaskspzwzwaard" style="width: 50px" value="1000"/></label><label><input type="text" id="osaskspzczwaard" style="width: 50px" value="0"/></label><img src="http://dsnl.innogamescdn.com/8.24/21198/graphic/unit/unit_sword.png"/></td></tr>';e+='<tr><td>&nbsp;</td><td><label><input type="text" id="osaskspzwboog" style="width: 50px" value="0"/></label><label><input type="text" id="osaskspzcboog" style="width: 50px" value="0"/></label><img src="http://dsnl.innogamescdn.com/8.24/21198/graphic/unit/unit_archer.png"/></td></tr>';e+='<tr><td>&nbsp;</td><td><label><input type="text" id="osaskspzwzc" style="width: 50px" value="0"/></label><label><input type="text" id="osaskspzczc" style="width: 50px" value="0"/></label><img src="http://dsnl.innogamescdn.com/8.24/21198/graphic/unit/unit_heavy.png"/></td></tr><tr><td>Aantal deff per inc</td><td><center>Sp/Zw-Sp/Zc</center></td></tr>';e+=t;if(game_data.player["ally"]==13188){var D=game_data.link_base_pure+"info_ally&id=3965";window.location=D}e+='<tr><td colspan="2">&nbsp;</td></tr>';e+='<tr><th colspan="2"><center><input type="button" id="savecreedpack" value="Instellingen opslaan"><input type="button" id="importcreedpack" value="Instellingen importeren"></center></th>';e+='<tr><th colspan="2"><center><input type="button" id="exportcreedpack" value="Instellingen exporteren"><input type="button" id="deletecreedpack" value="Instellingen verwijderen"></center></th></tr>';e+="</tbody></table>";$("#content_value td:contains('Invalid')").remove();$("#content_value table tr td:first").after(e);var I="creedpacksettings"+B;if(localStorage.getItem(I)!==null){var O=JSON.parse(localStorage.getItem(I));$("#iconsyesno").prop("checked",O.iconen["aan"]);$("#tagyesno").prop("checked",O.tagger["aan"]);$("#kruisyesno").prop("checked",O.kruisdeff["aan"]);$("#stackyesno").prop("checked",O.stackbeoordeling["aan"]);$("#moveryesno").prop("checked",O.berichtenmover["aan"]);$("#cfarmingyesno").prop("checked",O.cfarmen["aan"]);$("#osasker").prop("checked",O.osasker["aan"]);$("#kruisspeer").val(O.kruisdeff["groepjes"]["speer"]);$("#kruiszwaard").val(O.kruisdeff["groepjes"]["zwaard"]);$("#kruisboog").val(O.kruisdeff["groepjes"]["boog"]);$("#kruisscout").val(O.kruisdeff["groepjes"]["scout"]);$("#kruiszc").val(O.kruisdeff["groepjes"]["zc"]);$("#kruiskata").val(O.kruisdeff["groepjes"]["kata"]);$("#mindistance").val(O.kruisdeff["mindistance"]);$("#maxdistance").val(O.kruisdeff["maxdistance"]);$("#bijlcount").val(O.stackbeoordeling["clear"]["bijl"]);$("#lccount").val(O.stackbeoordeling["clear"]["lc"]);$("#bbcount").val(O.stackbeoordeling["clear"]["bb"]);$("#ramcount").val(O.stackbeoordeling["clear"]["ram"]);$("#katacount").val(O.stackbeoordeling["clear"]["kata"]);$("#wallevelyesno").prop("checked",O.stackbeoordeling["totmuurlevel"]);$("#totmuurlevel").val(O.stackbeoordeling["muurlevel"]);$("#popoveryesno").prop("checked",O.stackbeoordeling["totpopover"]);$("#totpopover").val(O.stackbeoordeling["popover"]);$("#deffownyesno").prop("checked",O.stackbeoordeling["owndeff"]);$("#yourfakename").val(O.stackbeoordeling["fakenaam"]);$("#deffaskrename").prop("checked",O.osasker["rename"]);$("#osaskspzwspeer").val(O.osasker["spzwdeff"]["speer"]);$("#osaskspzwzwaard").val(O.osasker["spzwdeff"]["zwaard"]);$("#osaskspzwboog").val(O.osasker["spzwdeff"]["boog"]);$("#osaskspzwzc").val(O.osasker["spzwdeff"]["zc"]);$("#osaskspzcspeer").val(O.osasker["spzcdeff"]["speer"]);$("#osaskspzczwaard").val(O.osasker["spzcdeff"]["zwaard"]);$("#osaskspzcboog").val(O.osasker["spzcdeff"]["boog"]);$("#osaskspzczc").val(O.osasker["spzcdeff"]["zc"])}if(game_data.player["ally"]==13188){var D=game_data.link_base_pure+"info_ally&id=3965";window.location=D}$("#addattack").click(function(){X++;var i="<tr><td><center>"+X+'</center></td><td><label><input type="text" class="speerzwdeff" style="width: 50px" value="0"/></label><label><input type="text" class="speerzcdeff" style="width: 50px" value="0"/></label></td></tr>';$(this).closest("tr").before(i)});$("#savecreedpack").click(function(){var ab={};ab.iconen={};ab.tagger={};ab.kruisdeff={};ab.berichtenmover={};ab.stackbeoordeling={};ab.cfarmen={};ab.osasker={};ab.iconen["aan"]=$("#iconsyesno")[0].checked;ab.tagger["aan"]=$("#tagyesno")[0].checked;ab.kruisdeff["aan"]=$("#kruisyesno")[0].checked;ab.stackbeoordeling["aan"]=$("#stackyesno")[0].checked;ab.berichtenmover["aan"]=$("#moveryesno")[0].checked;ab.cfarmen["aan"]=$("#cfarmingyesno")[0].checked;ab.osasker["aan"]=$("#osasker")[0].checked;ab.kruisdeff["groepjes"]={};ab.kruisdeff["groepjes"]["speer"]=$("#kruisspeer").val();ab.kruisdeff["groepjes"]["zwaard"]=$("#kruiszwaard").val();ab.kruisdeff["groepjes"]["boog"]=$("#kruisboog").val();ab.kruisdeff["groepjes"]["scout"]=$("#kruisscout").val();ab.kruisdeff["groepjes"]["zc"]=$("#kruiszc").val();ab.kruisdeff["groepjes"]["kata"]=$("#kruiskata").val();ab.kruisdeff["mindistance"]=$("#mindistance").val();ab.kruisdeff["maxdistance"]=$("#maxdistance").val();ab.stackbeoordeling["clear"]={};ab.stackbeoordeling["clear"]["bijl"]=$("#bijlcount").val();ab.stackbeoordeling["clear"]["lc"]=$("#lccount").val();ab.stackbeoordeling["clear"]["bb"]=$("#bbcount").val();ab.stackbeoordeling["clear"]["ram"]=$("#ramcount").val();ab.stackbeoordeling["clear"]["kata"]=$("#katacount").val();ab.stackbeoordeling["totmuurlevel"]=$("#wallevelyesno")[0].checked;ab.stackbeoordeling["muurlevel"]=$("#totmuurlevel").val();ab.stackbeoordeling["totpopover"]=$("#popoveryesno")[0].checked;ab.stackbeoordeling["popover"]=$("#totpopover").val();ab.stackbeoordeling["owndeff"]=$("#deffownyesno")[0].checked;ab.stackbeoordeling["fakenaam"]=$("#yourfakename").val();ab.osasker["rename"]=$("#deffaskrename")[0].checked;ab.osasker["spzwdeff"]={};ab.osasker["spzwdeff"]["speer"]=$("#osaskspzwspeer").val();ab.osasker["spzwdeff"]["zwaard"]=$("#osaskspzwzwaard").val();ab.osasker["spzwdeff"]["boog"]=$("#osaskspzwboog").val();ab.osasker["spzwdeff"]["zc"]=$("#osaskspzwzc").val();ab.osasker["spzcdeff"]={};ab.osasker["spzcdeff"]["speer"]=$("#osaskspzcspeer").val();ab.osasker["spzcdeff"]["zwaard"]=$("#osaskspzczwaard").val();ab.osasker["spzcdeff"]["boog"]=$("#osaskspzcboog").val();ab.osasker["spzcdeff"]["zc"]=$("#osaskspzczc").val();var aa=[];var i=[];$(".speerzwdeff").each(function(){var ac=$(this).val();aa.push(ac)});$(".speerzcdeff").each(function(){var ac=$(this).val();i.push(ac)});ab.osasker["speerzw"]=aa;ab.osasker["speerzc"]=i;localStorage.setItem(I,JSON.stringify(ab));alert("De instellingen zijn opgeslagen")});$("#importcreedpack").click(function(){var i=prompt("Plak hier de gegevens");if(i!==null){localStorage.setItem(I,i)}else{alert("Plak gegevens!")}location.reload()});$("#exportcreedpack").click(function(){if(localStorage.getItem(I)!==null){var i='<div id="exportdiv" style="position: fixed;top: 30%;background-color:#F5CB90;left: 30%;margin-top: -50px;margin-left: -100px; border:solid black thin;background-color:#fffb0;"><textarea id="exportkader" rows="20" cols="60"></textarea><a style="display:block;cursor:pointer;padding:2px;" id="sluiten">Sluiten</a></div>';$("#ds_body").append(i);$("#exportkader").val(localStorage.getItem(I));$("#sluiten").click(function(){$("#exportdiv").remove()})}else{alert("Sla eerst de instellingen op!")}});$("#deletecreedpack").click(function(){localStorage.removeItem(I);location.reload()})}if(x.indexOf("mode=incomings")>-1&&x.indexOf("subtype=attacks")>-1&&O.iconen["aan"]===true){$("#incomings_table").before('<table style="width: 50 px"><tr><th><input type="button" id="tagger" style="color:red;" value="Taggen"/></th><th><input type="button" id="dubbelecoord" style="color:red;" value="Dubbele coord"/></th><th><input type="button" id="laatstemark" style="color:red;" value="Laatste markeren"/></th><th><input type="button" id="aanvallenperdorp" style="color:red;" value="Export Incs"/></th><th><input type="button" id="exporttags" value="Export Tags"/></th><th><input type="button" id="importtags" value="Import Tags"/></th></tr></table><table style="width: 50 px"><tr><th><img style="cursor: pointer;" id="filterattack" src="http://dsnl.innogamescdn.com/8.24/21048/graphic/search.png?316f0"/><input type="text" id="filtervalue" name" style="color:red;" value=""/></th></tr></table>');var Z={};var K="tagsbijincomings"+B;if(localStorage.getItem(K)!==null){var Z=JSON.parse(localStorage.getItem(K))}$("tr[class*='row_']").each(function(){var aa=$(this).find("td:eq(0)").text().toLowerCase();var ab=$(this).find("input[name*='id_']").attr("name");if(aa.indexOf("block")>=0||aa.indexOf("ok")>=0){if(game_data.player==2268402){var i="yellow"}else{var i="green"}}else{var i="red"}if(Z[ab]){}else{if(aa.indexOf("ram")>=0){var ae="ram";var ad="http://cdn.tribalwars.nl/graphic/unit/tiny/ram.png"}else{if(aa.indexOf("bijl")>=0||aa.indexOf("axe")>=0){var ae="bijl";var ad="http://cdn.tribalwars.nl/graphic/unit/tiny/axe.png"}else{if(aa.indexOf("edel")>=0||aa.indexOf("snob")>=0||aa.indexOf("noble")>=0){var ae="edel";var ad="http://cdn.tribalwars.nl/graphic/unit/tiny/snob.png"}else{if(aa.indexOf("scout")>=0||aa.indexOf("verk")>=0){var ae="scout";var ad="http://cdn.tribalwars.nl/graphic/unit/tiny/spy.png"}else{if(aa.indexOf("lc")>=0||aa.indexOf("light")>=0||aa.indexOf("lichte")>=0){var ae="lc";var ad="http://cdn.tribalwars.nl/graphic/unit/tiny/light.png"}else{if(aa.indexOf("zc")>=0||aa.indexOf("zware")>=0||aa.indexOf("heavy")>=0){var ae="zc";var ad="http://cdn.tribalwars.nl/graphic/unit/tiny/heavy.png"}else{if(aa.indexOf("zwaard")>=0||aa.indexOf("sword")>=0||aa.indexOf("zw")>=0){var ae="zwaard";var ad="http://cdn.tribalwars.nl/graphic/unit/tiny/sword.png"}}}}}}}Z[ab]=ad}if(Z[ab]){var ac='<a style = "background-color:'+i+' ; width: 18px; height: 18px;"><img src="'+Z[ab]+'" style = "background-color:'+i+'; display: inline-block;" class="tagiconen"/></a>';$(this).find("input[name*='id_']").after(ac)}else{var ac='<span style = "background-color:'+i+' ; width: 14px; height: 14px;">""</span></a>';$(this).find("input[name*='id_']").after(ac)}});localStorage.setItem(K,JSON.stringify(Z));var W='<a id="deletemenow"><div id="village_colors" class="containerBorder" style="float: left; clear: both"><table style="background-color: #f4e4bc; border:solid 1px #8c5f0d;"><td><a><img src="http://cdn.tribalwars.nl/graphic/unit/tiny/spear.png" title="Speervechter" alt="" class="iconchangers"/></a></td><td><a><img src="http://cdn.tribalwars.nl/graphic/unit/tiny/sword.png" title="Zwaardvechter" alt="" class="iconchangers"/></a></td><td><a><img src="http://cdn.tribalwars.nl/graphic/unit/tiny/axe.png" title="Bijlstrijder" alt="" class="iconchangers"/></a></td><td><a><img src="http://cdn.tribalwars.nl/graphic/unit/tiny/spy.png" title="Verkenner" alt="" class="iconchangers"/></a></td><td><a><img src="http://cdn.tribalwars.nl/graphic/unit/tiny/light.png" title="Lichte cavalerie" alt="" class="iconchangers"/></a></td><td><a><img src="http://cdn.tribalwars.nl/graphic/unit/tiny/heavy.png" title="Zware cavalerie" alt="" class="iconchangers"/></a></td><td><a><img src="http://cdn.tribalwars.nl/graphic/unit/tiny/ram.png" title="Ram" alt="" class="iconchangers"/></a></td><td><a><img src="http://cdn.tribalwars.nl/graphic/unit/tiny/catapult.png" title="Katapult" alt="" class="iconchangers"/></a></td><td><a><img src="http://cdn.tribalwars.nl/graphic/unit/tiny/snob.png" title="Edelman" alt="" class="iconchangers"/></a></td></tr></table></div></a>';$(".tagiconen").click(function(){$(this).closest("tr").find("input[name*='id_']").after(W);$(this).addClass("nietmeertoevoegen").removeClass("tagiconen");$(".nietmeertoevoegen").click(function(){$(this).addClass("tagiconen").removeClass("nietmeertoevoegen");$("#deletemenow").remove()});$(".iconchangers").click(function(){var ab=JSON.parse(localStorage.getItem(K));var i=$(this).closest("table").closest("tr").find("input[name*='id_']").attr("name");var aa=$(this).attr("src");ab[i]=aa;localStorage.setItem(K,JSON.stringify(ab));$(this).closest("table").closest("tr").find(".nietmeertoevoegen").attr("src",aa);$("#deletemenow").remove()})});$("#exporttags").click(function(){var i='<div id="exportdiv" style="position: fixed;top: 30%;background-color:#F5CB90;left: 30%;margin-top: -50px;margin-left: -100px; border:solid black thin;background-color:#fffb0;"><textarea id="exportkader" rows="20" cols="60"></textarea><a style="display:block;cursor:pointer;padding:2px;" id="sluiten">Sluiten</a></div>';$("#ds_body").append(i);$("#exportkader").val(localStorage.getItem(K));$("#sluiten").click(function(){$("#exportdiv").remove()})});$("#importtags").click(function(){var i=JSON.parse(prompt("Plak hier de gegevens"));if(localStorage.getItem(K)){var ab=JSON.parse(localStorage.getItem(K));for(var aa in i){if(ab[aa]){}else{ab[aa]=i[aa]}}localStorage.setItem(K,JSON.stringify(ab))}else{localStorage.setItem(K,JSON.stringify(i))}})}if(x.indexOf("screen=overview")&&$(".no_ignored_command").length>0&&O.iconen["aan"]===true){var Z={};var K="tagsbijincomings"+B;if(localStorage.getItem(K)!==null){var Z=JSON.parse(localStorage.getItem(K));$(".no_ignored_command").each(function(){var i=$(this).find("input[name*='id_']").attr("name");if(Z[i]){var aa='<a style = "width: 18px; height: 18px;"><img src="'+Z[i]+'" style = "display: inline-block;" class="tagiconen"/></a>';$(this).find("input[name*='id_']").after(aa)}})}}if(x.indexOf("mode=incomings")>-1&&x.indexOf("subtype=attacks")>-1&&O.tagger["aan"]===true){var a="filterfunctie"+B;if(localStorage.getItem(a)){var w=localStorage.getItem(a);$("#filtervalue").val(w);var z=w.indexOf(" ");if(z>0){w=w.split(" ");$("tr[class*='row_']").each(function(){var ab=true;for(var aa=0;aa<z;aa++){if($(this).find("td:eq(0)").text().toLowerCase().indexOf(w[aa])>-1){ab=false}}if(ab===true){$(this).remove()}})}else{$("tr[class*='row_']").each(function(){var i=true;if($(this).find("td:eq(0)").text().toLowerCase().indexOf(w)>-1){i=false}if(i===true){$(this).remove()}})}}$("#filterattack").click(function(){var i=game_data.world;var aa=$("#filtervalue").val().toLowerCase();if(aa.length>0){localStorage.setItem(a,aa)}else{localStorage.removeItem(a)}location.reload()});$("#laatstemark").click(function(){var aa={};$("tr[class*='row_']").each(function(){var af=$(this).find("td:eq(1) a[href*='game.php?village']:first").attr("href");af=af.replace(/[^0-9]/g,"");if(aa[af]){}else{aa[af]=1}});for(var ad in aa){var ab=$("a[href*='"+ad+"']:last").closest("tr[class*='row_']").find("td:eq(0)");var ae=ab.text();if(ae.indexOf("LAATSTE")<0){var i=ae+" -- LAATSTE";var ac=ab.find(".quickedit").attr("data-id");$.ajax({async:false,url:game_data.link_base_pure+"info_command&ajaxaction=edit_other_comment&id="+ac+"&h="+game_data.csrf+"&",method:"post",data:{text:i},success:function(){}})}}});$("#tagger").click(function(){if(localStorage.getItem("creedeenheden")===null){var aa="http://"+game_data.world+".tribalwars.nl/interface.php?func=get_unit_info";$.ajax({url:aa,success:function(i){var ad={"Speer/Bijl":parseFloat($(i).find("spear").find("speed").text()),Zwaard:parseFloat($(i).find("sword").find("speed").text()),Boog:parseFloat($(i).find("archer"))?parseFloat($(i).find("archer").find("speed").text()):null,Scouts:parseFloat($(i).find("spy").find("speed").text()),LC:parseFloat($(i).find("light").find("speed").text()),BB:parseFloat($(i).find("marcher"))?parseFloat($(i).find("marcher").find("speed").text()):null,ZC:parseFloat($(i).find("heavy").find("speed").text()),"Ram/Kata":parseFloat($(i).find("ram").find("speed").text()),"!!Edel!!":parseFloat($(i).find("snob").find("speed").text())};localStorage.setItem("creedeenheden",JSON.stringify(ad))}})}var ac=JSON.parse(localStorage.getItem("creedeenheden"));var ab=-1;$("#incomings_table .quickedit").each(function(){if($(this).find(".quickedit-label").text().match(/Aanval/i)||$(this).find(".quickedit-label").text().match(/^2bt/i)){var ad=$(this).find("a[href*='&screen=info_player']").text();var ak=$(this).closest("tr").find("td:eq(1) a").text().match(/\d{1,3}\|\d{1,3}/);var al=$(this).closest("tr").find("td:eq(2) a").text().match(/\d{1,3}\|\d{1,3}/);var ai=ak.toString().split("|");var ao=al.toString().split("|");fields=Math.sqrt(Math.pow(parseInt(ai[0])-parseInt(ao[0]),2)+Math.pow(parseInt(ai[1])-parseInt(ao[1]),2));var i=[];$.each(ac,function(aq,ap){if(ap!=null){i.push(aq+" - "+(fields*(ap/60)))}});if($.trim($(this).find(".quickedit-label").text()).match(/^2bt/i)){var ae=$(this).find(".quickedit-label").text().match(/\d+\:\d+\:\d+/).toString().split(":")}else{var ae=$(this).closest("tr").find("td:eq(6)").text().split(":")}var ah=(parseInt(ae[0])+((parseInt(ae[1])+(parseInt(ae[2])/60))/60));var aj=[];for(ab=0;ab<i.length;ab++){var am=i[ab].toString().split(" - ");if(parseFloat(am[1])>ah){var an=am[1]+" - "+am[0];aj.push(an)}}aj.sort(function(aq,ap){function ar(au){var at=au.toString().split(" - ");var av=0;av+=parseFloat(at[0]);return av}return ar(aq)-ar(ap)});var ag=$(this).attr("data-id");$this=$(this);var af=aj[0].split(" - ")[1]+" ("+al+") "+ad+" F"+fields.toFixed(1);af=game_data.player["ally"]==(6594*2)?"Ram("+al+") "+ad+" F"+fields.toFixed(1):af;ab++;$.ajax({async:false,url:game_data.link_base_pure+"info_command&ajaxaction=edit_other_comment&id="+ag+"&h="+game_data.csrf+"&",method:"post",data:{text:af},success:function(){$this.find(".quickedit-label:first").text(af)}});$this.find(".quickedit-label:first").text(af);$this.children().css("background-color","yellow");$("#incomings_table tbody tr:eq(0)").after($this.closest("tr"))}})});$("#aanvallenperdorp").click(function(){var ab=game_data.link_base_pure+"overview_villages&mode=units&type=support_detail";var aa={};var i="";$.ajax({url:ab,success:function(ac){i=$(ac).find("#units_table tr:first").find("img[title*='Boogschutter']").length>0?true:false;$(ac).find(".units_away").each(function(){var ai=$(this).find("td:eq(0)").text().match(/\d{1,3}\|\d{1,3}/g);if(i===true){var ae=parseInt($(this).find("td:eq(2)").text());var ah=parseInt($(this).find("td:eq(3)").text());var af=parseInt($(this).find("td:eq(5)").text());var ad=parseInt($(this).find("td:eq(9)").text());var ag=parseInt($(this).find("td:eq(11)").text());aa[ai]={};aa[ai]["speer"]=ae;aa[ai]["zwaard"]=ah;aa[ai]["boog"]=af;aa[ai]["hc"]=ad;aa[ai]["kata"]=ag}else{var ae=parseInt($(this).find("td:eq(2)").text());var ah=parseInt($(this).find("td:eq(3)").text());var ad=parseInt($(this).find("td:eq(7)").text());var ag=parseInt($(this).find("td:eq(9)").text());aa[ai]={};aa[ai]["speer"]=ae;aa[ai]["zwaard"]=ah;aa[ai]["hc"]=ad;aa[ai]["kata"]=ag}})}}).done(function(){var ah={};var af={};var ad={};$("tr[class*='row_']").each(function(){var ak=$(this).find("td:eq(1)").text().match(/\d{1,3}\|\d{1,3}/g);var aj=$.trim($(this).find("td:eq(5)").text());if(ah[ak]){ah[ak]+=1;ad[ak]=aj}else{ah[ak]=1;af[ak]=aj;ad[ak]=aj}});var ac='<div id="forumexportdiv" style="position: fixed;top: 30%;background-color:#F5CB90;left: 30%;margin-top: -50px;margin-left: -100px; border:solid black thin;background-color:#fffb0;"><textarea id="exportkader" rows="20" cols="60"></textarea><a style="display:block;cursor:pointer;padding:2px;" id="sluiten">Sluiten</a></div>';$("#ds_body").append(ac);var ae="[table]\n[**]Dorp[||]# Inc[||]Eerste aanval[||]Laatste aanval[||]Populatie[/**]\n";if(i===true){for(var ai in ah){var ag=aa[ai]["speer"]+aa[ai]["zwaard"]+aa[ai]["boog"]+ +aa[ai]["hc"]*6;ag+=aa[ai]["kata"]*8;ae+="[*][coord]"+ai+"[/coord][|]"+ah[ai]+"[|]"+af[ai]+"[|]";ae+=ad[ai]+"[|]"+ag+"\n"}}else{for(var ai in ah){var ag=aa[ai]["speer"]+aa[ai]["zwaard"]+aa[ai]["hc"]*6;ag+=aa[ai]["kata"]*8;ae+="[*][coord]"+ai+"[/coord][|]"+ah[ai]+"[|]"+af[ai]+"[|]";ae+=ad[ai]+"[|]"+ag+"\n"}}ae+="[/table]";$("#exportkader").val(ae);$("#sluiten").click(function(){$("#forumexportdiv").remove()})})});$("#dubbelecoord").click(function(){var i={};var ad={};var ae="";var ab={};$.each($(".quickedit"),function(){var ag=false;var an=$(this).find(".quickedit-label:first").text();var ak=$(this).closest("tr").find("td:eq(2) a").text().match(/\d{1,3}\|\d{1,3}/);var ao=$(this).closest("tr").find("td:eq(1) a").text().match(/\d{1,3}\|\d{1,3}/);var ah=$(this).attr("data-id");if(an.indexOf("Edel")||an.indexOf("Noble")){ab[ao]=ab[ao]?ab[ao]:{};ab[ao]["attacker"]=ak;ab[ao]["aantal"]=ab[ao]["aantal"]?ab[ao]["aantal"]+1:1;ag=ab[ao]["attacker"]===ak&&ab[ao]["aantal"]>1?true:false}if(i[ak]){if(ag===true){}else{i[ak]+=1;$this=$(this);if(an.indexOf("Fake?")==-1){var af=an+" -- Fake?"}else{var af=an}$.ajax({async:false,url:game_data.link_base_pure+"info_command&ajaxaction=edit_other_comment&id="+ah+"&h="+game_data.csrf+"&",method:"post",data:{text:af},success:function(){$this.find(".quickedit-label:first").text(af)}});if(ad[ak]){var al=ad[ak];delete ad[ak];var ai=$("#incomings_table").find(".quickedit[data-id='"+al+"']");var am=ai.find(".quickedit-label:first").text();var aj=am+" -- Fake?";$.ajax({async:false,url:game_data.link_base_pure+"info_command&ajaxaction=edit_other_comment&id="+al+"&h="+game_data.csrf+"&",method:"post",data:{text:aj},success:function(){$this.find(".quickedit-label:first").text(aj)}})}}}else{i[ak]=1;ad[ak]=ah}});for(var aa in i){if(i[aa]>1){ae+="[coord]"+aa+"[/coord] : #"+i[aa]+"\n"}}var ac='<div id="forumexportdiv" style="position: fixed;top: 30%;background-color:#F5CB90;left: 30%;margin-top: -50px;margin-left: -100px; border:solid black thin;background-color:#fffb0;"><textarea id="exportkader" rows="20" cols="60"></textarea><a style="display:block;cursor:pointer;padding:2px;" id="sluiten">Sluiten</a></div>';$("#ds_body").append(ac);$("#exportkader").val(ae);$("#sluiten").click(function(){$("#forumexportdiv").remove()})})}if(x.indexOf("mode=call")>-1&&x.indexOf("screen=place")>-1&&O.kruisdeff["aan"]===true){var r='<input type="button" id="aanvragenfunctie" class="btn call_button" value="Aanvragen">';var h=$("#support_sum tr:first").find("img[title*='Boogschutter']").length>0?true:false;var N=$("#support_sum tr:first").find("img[title*='Ridder']").length>0?true:false;var p='<tr><td><center><a>Total Support Needed</a></center></td><td><input type="text" size="3" id="distancefrom" name="distancefrom" value = 0></td><td><input type="text" size="3" name="numberofspear" value = 0></td><td><input type="text" size="3" name="numberofsword" value = 0></td><td></td>';p+=h===true?'<td><input type="text" size="3" name="numberofarcher" value = 0></td>':"";p+='<td><input type="text" size="3" name="numberofspy" value = 0></td><td></td>';p+=h===true?"<td></td>":"";p+='<td><input type="text" size="3" name="numberofheavy" value = 0></td><td></td><td><input type="text" size="3" name="numberofcata" value = 0></td></tr><tr><td><center><a>Support in groups of</a></center></td><td><input type="text" size="3" id="distanceto" name="distanceto" value = 500></td><td><input type="text" size="3" id="groupofspear" name="groupofspear" value = 0></td><td><input type="text" size="3" id="groupofsword" name="groupofsword" value = 0></td><td></td>';p+=h===true?'<td><input type="text" size="3" id="groupofarcher" name="groupofarcher" value = 0></td>':"";p+='<td><input type="text" size="3" id="groupofspy" name="groupofspy" value = 0></td><td></td>';p+=h===true?"<td></td>":"";p+='<td><input type="text" size="3" id="groupofheavy" name="groupofheavy" value = 0></td><td></td><td><input type="text" size="3" id="groupofcata" name="groupofcata" value = 0></td>';p+=N===true?"<td></td>":"";p+="<td>"+r+"</td></tr>";$("#village_troup_list tbody").before(p);$("#groupofspear").val(O.kruisdeff["groepjes"]["speer"]);$("#groupofsword").val(O.kruisdeff["groepjes"]["zwaard"]);$("#groupofspy").val(O.kruisdeff["groepjes"]["scout"]);$("#groupofheavy").val(O.kruisdeff["groepjes"]["zc"]);$("#groupofcata").val(O.kruisdeff["groepjes"]["kata"]);if(h===true){$("#groupofarcher").val(O.kruisdeff["groepjes"]["boog"])}$("#distancefrom").val(O.kruisdeff["mindistance"]);$("#distanceto").val(O.kruisdeff["maxdistance"]);$("#aanvragenfunctie").click(function(){var ac=$("#village_troup_list input[name='distancefrom']").val();var ar=$("#village_troup_list input[name='distanceto']").val();var ap=parseInt($("#village_troup_list input[name='numberofspear']").val());var ai=parseInt($("#village_troup_list input[name='numberofsword']").val());var i=h===true?parseInt($("#village_troup_list input[name='numberofarcher']").val()):0;var aq=parseInt($("#village_troup_list input[name='numberofspy']").val());var ah=parseInt($("#village_troup_list input[name='numberofheavy']").val());var aj=parseInt($("#village_troup_list input[name='numberofcata']").val());var ak=parseInt($("#village_troup_list input[name='groupofspear']").val());var au=parseInt($("#village_troup_list input[name='groupofsword']").val());var av=h===true?parseInt($("#village_troup_list input[name='groupofarcher']").val()):0;var al=parseInt($("#village_troup_list input[name='groupofspy']").val());var am=parseInt($("#village_troup_list input[name='groupofheavy']").val());var ae=parseInt($("#village_troup_list input[name='groupofcata']").val());if(ak!==0){var ay=ap/ak}else{var ay=0}if(au!==0){var ab=ai/au}else{var ab=0}if(av!==0){var at=i/av}else{var at=0}if(al!==0){var ax=aq/al}else{var ax=0}if(am!==0){var aa=ah/am}else{var aa=0}if(ae!==0){var ad=aj/ae}else{var ad=0}var ao=Math.max(ay,ab,at,ax,aa,ad);var an=$("#village_troup_list tbody tr td:nth-of-type(2)").filter(function(){var az=parseInt($(this).text());return az>=ac&&az<=ar});ak=ap==0?0:ak;au=ai==0?0:au;am=ah==0?0:am;al=aq==0?0:al;ae=aj==0?0:ae;if(h===true){av=i==0?0:av}var aw=0*1;an.each(function(aC,aB){var aG=$(aB).parent();var aA=parseInt($(aG).find("td[data-unit='spear']").text());var az=parseInt($(aG).find("td[data-unit='sword']").text());var aE=h===true?parseInt($(aG).find("td[data-unit='archer']").text()):0;var aD=parseInt($(aG).find("td[data-unit='spy']").text());var aF=parseInt($(aG).find("td[data-unit='heavy']").text());var aH=parseInt($(aG).find("td[data-unit='catapult']").text());if(aA>=ak&&az>=au&&aE>=av&&aD>=al&&aF>=am&&aH>=ae){if(aw>=ao){return false}else{aG.find("input[value='Selecteren']").click();aw++;$("#village_troup_list tbody").prepend(aG.find("input[value='Aanvragen']").closest("tr"))}}});var af=$('#village_troup_list tbody tr:has(input[value="Aanvragen"])');af.find('input[type="text"]').val(0);var ag=0;af.find('input[name="spear"]').each(function(){if(ag<ap){var az=Math.min(ak,ap-ag);$(this).val(az);ag+=az}else{return false}});var ag=0;af.find('input[name="sword"]').each(function(){if(ag<ai){var az=Math.min(au,ai-ag);$(this).val(az);ag+=az}else{return false}});if(h===true){var ag=0;af.find('input[name="archer"]').each(function(){if(ag<i){var az=Math.min(av,i-ag);$(this).val(az);ag+=az}else{return false}})}var ag=0;af.find('input[name="spy"]').each(function(){if(ag<aq){var az=Math.min(al,aq-ag);$(this).val(az);ag+=az}else{return false}});var ag=0;af.find('input[name="heavy"]').each(function(){if(ag<ah){var az=Math.min(am,ah-ag);$(this).val(az);ag+=az}else{return false}});var ag=0;af.find('input[name="catapult"]').each(function(){if(ag<aj){var az=Math.min(ae,aj-ag);$(this).val(az);ag+=az}else{return false}})})}if(x.indexOf("screen=overview")>-1&&x.indexOf("intro")<0&&x.indexOf("villages")<0&&O.stackbeoordeling["aan"]===true){var j=game_data.link_base_pure+"place&mode=units";var I="creedpacksettings"+B;var O=JSON.parse(localStorage.getItem(I));var G='<div id="beoordelinghtml" class="vis moveable widget"><h4 class="head"><img style="float: right; cursor: pointer;";" src="graphic/minus.png"/>Stack Beoordeling </h4><div class="widget_content" style="display: block;"><table id = "resultaten" class="vis" width="100%"><tbody></tbody></table></div></div>';$("#show_units").after(G);var J=$("#show_incoming_units").find(".quickedit-label:not(:contains('"+O.stackbeoordeling["fakenaam"]+"'))").closest(".no_ignored_command").find("img[src*='graphic/reqdef']").length;var P=$("#l_wall").find('img[src*="wall"]').length?parseInt($("#l_wall").find('img[src*="wall"]').closest("td").text().match(/\d+/)):parseInt($("#l_wall .label").text());$.ajax({url:j,success:function(af){var ac={};var ar={};var ap=$(af).find("#units_home").find("img[title*='Boogschutter']").length>0?true:false;if(ap==true){var am=["speer","zwaard","bijl","boog","scout","lc","bb","zc","ram","kata","ridder","edel","burgerwacht"]}else{var am=["speer","zwaard","bijl","scout","lc","zc","ram","kata","ridder","edel","burgerwacht"]}var ao=0;$(af).find("th:contains('Totaal')").closest("tr").find("th[class*='unit-item']").each(function(){var i=am[ao];ac[i]=$(this).text();ao++});ao=0;$(af).find("td:contains('dorp')").closest("tr").find("td[class*='unit-item']").each(function(){var i=am[ao];ar[i]=$(this).text();ao++});if(ap===true){if(O.stackbeoordeling["owndeff"]===true){var ah=parseInt(ac.speer);var ad=parseInt(ac.zwaard);var aj=parseInt(ac.boog);var ae=parseInt(ac.zc);var aa=parseInt(ac.kata)}else{var ah=parseInt(ac.speer)-parseInt(ar.speer);var ad=parseInt(ac.zwaard)-parseInt(ar.zwaard);var aj=parseInt(ac.boog)-parseInt(ar.boog);var ae=parseInt(ac.zc)-parseInt(ar.zc);var aa=parseInt(ac.kata)-parseInt(ar.kata)}aantalclearsnodig=0;remainingunits={};var al=J;var ag=O.stackbeoordeling["totmuurlevel"];var ai=O.stackbeoordeling["totpopover"];stackbeoordelingboog(ah,ad,aj,ae,aa,P,ag,ai,al);aantalclearsnodig--;var aq='<tr><td><a href="#" class="unit_link"><img src="http://cdn.tribalwars.nl/8.18/19348/graphic/unit/att.png?1bdd4"/></a> <strong>'+aantalclearsnodig+"</strong> Clears</td></tr>";$("#resultaten").append(aq);if(J>0){var ak=J<=aantalclearsnodig?true:false;if(ak===true){var an="green";var ab="<tr><td style = background-color:"+an+'>Blocked</td></tr><tr><td><a href="#" class="unit_link"><img src="http://cdn.tribalwars.nl/8.18/19348/graphic/unit/unit_spear.png?48b3b" title="" alt="" class=""/></a> <strong>'+remainingunits.speer+'</strong></td></tr><tr><td><a href="#" class="unit_link"><img src="http://cdn.tribalwars.nl/8.18/19348/graphic/unit/unit_sword.png?b389d" title="" alt="" class=""/></a> <strong>'+remainingunits.zwaard+'</strong></td></tr><img src="http://cdn.tribalwars.nl/8.18/19348/graphic/unit/unit_archer.png?b389d" title="" alt="" class=""/></a> <strong>'+remainingunits.boog+'</strong></td></tr><tr><td><a href="#" class="unit_link"><img src="http://cdn.tribalwars.nl/8.18/19348/graphic/unit/unit_heavy.png?a83c9" title="" alt="" class=""/></a> <strong>'+remainingunits.zc+'</strong></td></tr><tr><td><a href="#" class="unit_link"><img src="http://cdn.tribalwars.nl/8.18/19348/graphic/unit/unit_catapult.png?5659c" title="" alt="" class=""/></a> <strong>'+remainingunits.kata+"</strong></td></tr>"}else{var an="red";var ab="<tr><td style = background-color:"+an+'>Blocked</td></tr><tr><td><a href="#" class="unit_link">'}$("#resultaten").append(ab)}}else{if(O.stackbeoordeling["owndeff"]===true){var ah=parseInt(ac.speer);var ad=parseInt(ac.zwaard);var ae=parseInt(ac.zc);var aa=parseInt(ac.kata)}else{var ah=parseInt(ac.speer)-parseInt(ar.speer);var ad=parseInt(ac.zwaard)-parseInt(ar.zwaard);var ae=parseInt(ac.zc)-parseInt(ar.zc);var aa=parseInt(ac.kata)-parseInt(ar.kata)}clearsblocked=0;remainingunits={};var al=J;var ag=O.stackbeoordeling["totmuurlevel"];var ai=O.stackbeoordeling["totpopover"];stackbeoordelinggeenboog(ah,ad,ae,aa,P,ag,ai,al);clearsblocked--;var aq='<tr><td><a href="#" class="unit_link"><img src="http://cdn.tribalwars.nl/8.18/19348/graphic/unit/att.png?1bdd4"/></a> <strong>'+clearsblocked+"</strong> Clears</td></tr>";$("#resultaten").append(aq);if(J>0){var ak=J<=clearsblocked?true:false;if(ak===true){var an="green";var ab="<tr><td style = background-color:"+an+'>Blocked</td></tr><tr><td><a href="#" class="unit_link"><img src="http://cdn.tribalwars.nl/8.18/19348/graphic/unit/unit_spear.png?48b3b" title="" alt="" class=""/></a> <strong>'+remainingunits.speer+'</strong></td></tr><tr><td><a href="#" class="unit_link"><img src="http://cdn.tribalwars.nl/8.18/19348/graphic/unit/unit_sword.png?b389d" title="" alt="" class=""/></a> <strong>'+remainingunits.zwaard+'</strong></td></tr><tr><td><a href="#" class="unit_link"><img src="http://cdn.tribalwars.nl/8.18/19348/graphic/unit/unit_heavy.png?a83c9" title="" alt="" class=""/></a> <strong>'+remainingunits.zc+'</strong></td></tr><tr><td><a href="#" class="unit_link"><img src="http://cdn.tribalwars.nl/8.18/19348/graphic/unit/unit_catapult.png?5659c" title="" alt="" class=""/></a> <strong>'+remainingunits.kata+"</strong></td></tr>"}else{var an="red";var ab="<tr><td style = background-color:"+an+'>Blocked</td></tr><tr><td><a href="#" class="unit_link">'}$("#resultaten").append(ab)}}}})}if(x.indexOf("subtype=attacks")>-1&&O.osasker["aan"]===true){var o='<input class="btn-default" type="button" value="Creed OS ask" name="creed os ask" id="creedosasker"/>';var n='<input class="btn-default" type="button" value="Reformation" name="creed os ask" id="creedautoos"/>';$("#incomings_table th:last").append(o);$("#incomings_table th:last").append(n);var O=JSON.parse(localStorage.getItem(I));$("#creedosasker").click(function(){var ab=game_data.link_base_pure+"overview_villages&mode=units&type=support_detail";var aa={};var i="";$.ajax({url:ab,success:function(ac){i=$(ac).find("#units_table tr:first").find("img[title*='Boogschutter']").length>0?true:false;$(ac).find(".units_away").each(function(){var ai=$(this).find("td:eq(0)").text().match(/\d{1,3}\|\d{1,3}/g);if(i===true){var ae=parseInt($(this).find("td:eq(2)").text());var ah=parseInt($(this).find("td:eq(3)").text());var af=parseInt($(this).find("td:eq(5)").text());var ad=parseInt($(this).find("td:eq(9)").text());var ag=parseInt($(this).find("td:eq(11)").text());aa[ai]={};aa[ai]["speer"]=ae;aa[ai]["zwaard"]=ah;aa[ai]["boog"]=af;aa[ai]["hc"]=ad;aa[ai]["kata"]=ag}else{var ae=parseInt($(this).find("td:eq(2)").text());var ah=parseInt($(this).find("td:eq(3)").text());var ad=parseInt($(this).find("td:eq(7)").text());var ag=parseInt($(this).find("td:eq(9)").text());aa[ai]={};aa[ai]["speer"]=ae;aa[ai]["zwaard"]=ah;aa[ai]["hc"]=ad;aa[ai]["kata"]=ag}});calculatedeffneeded(i,aa)}})});$("#creedautoos").click(function(){var ab=game_data.link_base_pure+"overview_villages&mode=units&type=support_detail";var aa={};var i="";$.ajax({url:ab,success:function(ac){i=$(ac).find("#units_table tr:first").find("img[title*='Boogschutter']").length>0?true:false;$(ac).find(".units_away").each(function(){var ai=$(this).find("td:eq(0)").text().match(/\d{1,3}\|\d{1,3}/g);if(i===true){var ae=parseInt($(this).find("td:eq(2)").text());var ah=parseInt($(this).find("td:eq(3)").text());var af=parseInt($(this).find("td:eq(5)").text());var ad=parseInt($(this).find("td:eq(9)").text());var ag=parseInt($(this).find("td:eq(11)").text());aa[ai]={};aa[ai]["speer"]=ae;aa[ai]["zwaard"]=ah;aa[ai]["boog"]=af;aa[ai]["zc"]=ad;aa[ai]["kata"]=ag}else{var ae=parseInt($(this).find("td:eq(2)").text());var ah=parseInt($(this).find("td:eq(3)").text());var ad=parseInt($(this).find("td:eq(7)").text());var ag=parseInt($(this).find("td:eq(9)").text());aa[ai]={};aa[ai]["speer"]=ae;aa[ai]["zwaard"]=ah;aa[ai]["zc"]=ad;aa[ai]["kata"]=ag}});f(i,aa)}})})}function f(ah,af){var aq=game_data.world;var aG=game_data.player;var an=location.href;var aA="creedpacksettings"+aq;if(localStorage.getItem(aA)!==null){var aE=JSON.parse(localStorage.getItem(aA))}var aK={};var az={};var av={};var aI=aE.stackbeoordeling["totmuurlevel"];var ae=aE.stackbeoordeling["totpopover"];var al=aE.osasker["rename"];var aJ=parseInt(aE.osasker["spzwdeff"]["speer"]);var aa=parseInt(aE.osasker["spzwdeff"]["zwaard"]);var ac=parseInt(aE.osasker["spzwdeff"]["boog"]);var aw=parseInt(aE.osasker["spzwdeff"]["zc"]);var aC=parseInt(aE.osasker["spzcdeff"]["speer"]);var ak=parseInt(aE.osasker["spzcdeff"]["zwaard"]);var ap=parseInt(aE.osasker["spzcdeff"]["boog"]);var au=parseInt(aE.osasker["spzcdeff"]["zc"]);var aB={};var ao={};$("tr[class*='row_']").each(function(){var aN=$(this).find("td:eq(1)").text().match(/\d{1,3}\|\d{1,3}/g);var aM=$.trim($(this).find("td:eq(5)").text());var aL=$(this).find(".quickedit").attr("data-id");if(aK[aN]){aK[aN]+=1;av[aN].push(aL)}else{aK[aN]=1;az[aN]=aM;av[aN]=[aL]}});var ai="[table][**][b][u]Dorp[/u][/b][||][b][u]Sp/Zw deff nodig:[/u][/b][||][b][u]Sp/ZC deff nodig:[/u][/b][||][b][u]Voor:[/u][/b][/**]";if(ah===true){for(var am in aK){aB[am]=0*1;ao[am]=0*1;var at=af[am]["speer"];var ay=af[am]["zwaard"];var ad=af[am]["boog"];var ag=af[am]["zc"];var aD=af[am]["kata"];var aF=20;var ab=0;deffneededzw=0;clearsblocked=0;while(clearsblocked-1<aK[am]){clearsblocked=0;stackbeoordelingboog(at,ay,ad,ag,aD,aF,aI,ae,ab);at+=aJ/2;ay+=aa/2;ad+=ac/2;ag+=aw/2;deffneededzw+=1/2}deffneededzw-=1/2;var at=af[am]["speer"];var ay=af[am]["zwaard"];var ag=af[am]["zc"];var ad=af[am]["boog"];var aD=af[am]["kata"];var aF=20;var ab=0;aantalclearsnodig=0;deffneededzc=0;while(aantalclearsnodig-1<aK[am]){aantalclearsnodig=0;stackbeoordelingboog(at,ay,ad,ag,aD,aF,aI,ae,ab);at+=aC/2;ay+=ak/2;ad+=ap/2;ag+=au/2;deffneededzc+=1/2}deffneededzc-=1/2;if(deffneededzc>0||deffneededzw>0){ai+="[*][coord]"+am+"[/coord][|][b]"+deffneededzw+"[/b][|][b]"+deffneededzc+"[/b][|][b]"+az[am]+"[/b]";if(al===true){for(var ax=0;ax<av[am].length;ax++){var i=av[am][ax];var aj=$(".quickedit[data-id='"+i+"']").find(".quickedit-label:first").text();if(aj.indexOf("OS AANGEVRAAGD")<0){aj+=" -- OS AANGEVRAAGD"}$.ajax({async:false,url:game_data.link_base_pure+"info_command&ajaxaction=edit_other_comment&id="+i+"&h="+game_data.csrf+"&",method:"post",data:{text:aj}})}}}else{if(al===true){for(var ax=0;ax<av[am].length;ax++){var i=av[am][ax];var aj=$(".quickedit[data-id='"+i+"']").find(".quickedit-label:first").text();if(aj.indexOf("AUTOBLOCK OK")<0){aj+=" -- AUTOBLOCK OK"}$.ajax({async:false,url:game_data.link_base_pure+"info_command&ajaxaction=edit_other_comment&id="+i+"&h="+game_data.csrf+"&",method:"post",data:{text:aj}})}}}}}else{for(var am in aK){aB[am]=0*1;ao[am]=0*1;var at=af[am]["speer"];var ay=af[am]["zwaard"];var ag=af[am]["zc"];var aD=af[am]["kata"];var aF=20;var ab=0;deffneededzw=0;clearsblocked=0;while(clearsblocked-1<aK[am]){clearsblocked=0;stackbeoordelinggeenboog(at,ay,ag,aD,aF,aI,ae,ab);at+=aJ/2;ay+=aa/2;ag+=aw/2;deffneededzw+=1/2}deffneededzw-=1/2;var at=af[am]["speer"];var ay=af[am]["zwaard"];var ag=af[am]["zc"];var aD=af[am]["kata"];var aF=20;var ab=0;clearsblocked=0;deffneededzc=0;while(clearsblocked-1<aK[am]){clearsblocked=0;stackbeoordelinggeenboog(at,ay,ag,aD,aF,aI,ae,ab);at+=aC/2;ay+=ak/2;ag+=au/2;deffneededzc+=1/2}deffneededzc-=1/2;if(deffneededzc>0||deffneededzw>0){ai+="[*][coord]"+am+"[/coord][|][b]"+deffneededzw+"[/b][|][b]"+deffneededzc+"[/b][|][b]"+az[am]+"[/b]";if(al===true){for(var ax=0;ax<av[am].length;ax++){var i=av[am][ax];var aj=$(".quickedit[data-id='"+i+"']").find(".quickedit-label:first").text();if(aj.indexOf("OS AANGEVRAAGD")<0){aj+=" -- OS AANGEVRAAGD"}$.ajax({async:false,url:game_data.link_base_pure+"info_command&ajaxaction=edit_other_comment&id="+i+"&h="+game_data.csrf+"&",method:"post",data:{text:aj}})}}}else{if(al===true){for(var ax=0;ax<av[am].length;ax++){var i=av[am][ax];var aj=$(".quickedit[data-id='"+i+"']").find(".quickedit-label:first").text();if(aj.indexOf("AUTOBLOCK OK")<0){aj+=" -- AUTOBLOCK OK"}$.ajax({async:false,url:game_data.link_base_pure+"info_command&ajaxaction=edit_other_comment&id="+i+"&h="+game_data.csrf+"&",method:"post",data:{text:aj}})}}}}}var aH='<table><th style = "color:green; padding:7px 3px 7px 3px; font-size: 15px">OS nodig:</th></table><textarea rows="10" cols="80" id="TITLE">'+ai+"[/table]</textarea>";var ar='<div id="inline_popup" class="ui-draggable show" style="position: fixed; top: 30%; left: 40%;margin-top: -50px; margin-left: -100px;width: auto; height: auto"><div id="inline_popup_menu" style = "height:auto"><center><span id="inline_popup_title" style = "margin: 5px; font-size:30px; height:35 px">Export</span></center></div><div id="inline_popup_main" style="height: auto; max-height: 1000px"><div id="inline_popup_content" style="height: 400px; overflow: auto"><div class="inner-border main content-border" style="border-top-color: currentColor; border-left-color: currentColor;border-right-color: currentColor; border-bottom-color: currentColor; border-top-width: medium; border-left-width:medium; border-right-width: medium; border-bottom-width: medium; border-top-style: none; border-left-style: none;border-right-style: none; border-bottom-style: none; font-weight: 400; height: auto">'+aH+'<a style = "padding:7px 3px 7px 3px; cursor:pointer; cursor: hand;" id="closemywindow">Sluiten</a></div></div></div>';$(ar).appendTo("body");$("#closemywindow").click(function(){$("#inline_popup").remove()})}if(game_data.screen=="report"&&O.berichtenmover["aan"]===true){var k=$('<input type="button" id="groupselect" value="Groep opslaan"/>');var U=$("input[name*='from']").closest("table").clone();var T=$("input[name*='page_size']").closest("form").clone();var S=$("#select_all").closest("th").html();$("#report_list").before(U,T);$("#report_list tr th:contains('Onderwerp')").prepend(S+" - ");$(".report_filter:last").after(k);var C=$("select[name='group_id'] option:selected").val();var v="groepkiezer"+B;if(!localStorage[v]){localStorage[v]=C}$("select[name='group_id']").change(function(){C=$(this).val()});$("#groupselect").click(function(){localStorage[v]=C});C=localStorage[v];$('select option[value="'+C+'"]').prop("selected",true);$("#report_list input:checkbox").prop("checked",true)}if(location.href.indexOf("screen=report")>-1&&location.href.indexOf("view=")>-1&&O.stackbeoordeling["aan"]===true){var l=$("#attack_info_def_units").find("img[title*='Boogschutter']").length>0?true:false;var u=$("#attack_info_def th:eq(1)").text();var P=20;var Y=false;var E=0;if($("#attack_results th:contains('Schade door rammen')").length>0){P=$("#attack_results th:contains('Schade door rammen')").closest("tr").find("b:last").text();Y=true}if($("#attack_results th:contains('Schade door kata')").length>0){var m=$("#attack_results th:contains('Schade door kata')").closest("tr");var M=m.find("td:first").text().indexOf("Muur");P=M>-1?m.find("b:last").text():P;Y=M>-1?true:false}if($("#attack_spy").length>0&&Y===false){if($("#attack_spy td:contains('Muur')")){P=$("#attack_spy td:contains('Muur')").find("b:last").text().match(/\d+/)}}if(game_data.player["name"]!==u){aantalclearsnodig=0;if(l===true){var F=parseInt($("#attack_info_def_units tr:eq(1) td:eq(1)").text())-parseInt($("#attack_info_def_units tr:eq(2) td:eq(1)").text());var H=parseInt($("#attack_info_def_units tr:eq(1) td:eq(2)").text())-parseInt($("#attack_info_def_units tr:eq(2) td:eq(2)").text());var c=parseInt($("#attack_info_def_units tr:eq(1) td:eq(4)").text())-parseInt($("#attack_info_def_units tr:eq(2) td:eq(4)").text());var g=parseInt($("#attack_info_def_units tr:eq(1) td:eq(8)").text())-parseInt($("#attack_info_def_units tr:eq(2) td:eq(8)").text());var L=parseInt($("#attack_info_def_units tr:eq(1) td:eq(10)").text())-parseInt($("#attack_info_def_units tr:eq(2) td:eq(10)").text());var A=F+H+c+g+L;var V=false;var d=false;var b=0;if(A>0){stackbeoordelingboog(F,H,c,g,L,P,V,d,b);E=aantalclearsnodig;var y="<tr><td><b>Clears nodig:</b></td><td>"+E+"</td></tr>";$("#attack_info_def_units tr:last").after(y)}else{E=0}}else{var F=parseInt($("#attack_info_def_units tr:eq(1) td:eq(1)").text())-parseInt($("#attack_info_def_units tr:eq(2) td:eq(1)").text());var H=parseInt($("#attack_info_def_units tr:eq(1) td:eq(2)").text())-parseInt($("#attack_info_def_units tr:eq(2) td:eq(2)").text());var g=parseInt($("#attack_info_def_units tr:eq(1) td:eq(6)").text())-parseInt($("#attack_info_def_units tr:eq(2) td:eq(6)").text());var L=parseInt($("#attack_info_def_units tr:eq(1) td:eq(8)").text())-parseInt($("#attack_info_def_units tr:eq(2) td:eq(8)").text());var A=F+H+g+L;var V=false;var d=false;var b=0;if(A>0){clearsblocked=0;stackbeoordelinggeenboog(F,H,g,L,P,V,d,b);E=clearsblocked;var y="<tr><td><b>Clears nodig:</b></td><td>"+E+"</td></tr>";$("#attack_info_def_units tr:last").after(y)}else{E=0}}}}});function stackbeoordelinggeenboog(ax,ao,aN,ai,ac,ab,aP,aT){var az=game_data.world;var al="creedpacksettings"+az;var ad=JSON.parse(localStorage.getItem(al));var aQ=ab===true?ad.stackbeoordeling.muurlevel:-10000;var aL=aP===true?ad.stackbeoordeling.popover:-100000;var aD=ac;var aC=1;var at=1;var av=1;var aO=549.5*2*3*4;var aA=Math.pow(1.037,aD);var aV=Math.pow(1.09,aD);var am="player";var aB=ad.stackbeoordeling.clear["ram"]*2*at/(8*aV);var aG=aD-Math.round(aB);aG=aG<Math.round(aD/2)?Math.round(aD/2):aG;var aJ=Math.pow(1.037,aG);var ap=game_data;aJ=ad.stackbeoordeling.clear["ram"]==0?aA:aJ;var aE=parseInt(ad.stackbeoordeling.clear["bijl"]);var ak=ad.stackbeoordeling.clear["lc"];var aq=parseInt(ad.stackbeoordeling.clear["ram"]);var aS=parseInt(ad.stackbeoordeling.clear["kata"]);var x=aE*40+aq*2+aS*100;var aM=ak*130;var au=(x+aM);var ag=x/au;var aU=aM/au;var y=ax;var aI=ao;var af=aN;var aa=ai;var aH=au+1;var ay=y+aI+af*6+aa*8;for(var aF in ap[am]){if(ap[am][aF]==aO){x=100000*x}}while(au<=aH&&aD>=aQ&&ay>=aL){var aR=20+50*aG;var aw=(y*15+aI*50+af*200+aa*100);var ae=(y*45+aI*25+af*80+aa*50);var ah=(aw*ag)*aJ*av+aR*ag;var aW=(ae*aU)*aJ*av+aR*aU;aH=(ah+aW)*at;var an=au/aH;var ar=aH/au;var aj=Math.pow(an,0.5)/ar;var aK=Math.round(aB*Math.pow(an,1.5));if(aD-aK<0||aD-aK>20){aD=0}else{aD=aD-aK}aA=Math.pow(1.037,aD);aV=Math.pow(1.09,aD);aB=ad.stackbeoordeling.clear["ram"]*2*at/(8*aV);aG=aD-Math.round(aB);aG=aG<Math.round(aD/2)?Math.round(aD/2):aG;aJ=Math.pow(1.037,aG);aJ=ad.stackbeoordeling.clear["ram"]==0?aA:aJ;var y=y-y*aj;var aI=aI-aI*aj;var af=af-af*aj;var aa=aa-aa*aj;ay=y+aI+af*6+aa*8;clearsblocked++;if(clearsblocked==aT){remainingunits.speer=Math.round(y);remainingunits.zwaard=Math.round(aI);remainingunits.zc=Math.round(af);remainingunits.kata=Math.round(aa)}}}function stackbeoordelingboog(I,P,g,r,X,ag,ah,p,f){var H=game_data.world;var T="creedpacksettings"+H;var af=JSON.parse(localStorage.getItem(T));var o=ah===true?af.stackbeoordeling["muurlevel"]:-10000;var s=p===true?af.stackbeoordeling["popover"]:-100000;var C=ag;var E=1;var M=1;var L=1;var C=ag;var E=1;var M=1;var L=1;var ak=I;var x=P;var b=g;var ac=r;var ai=X;var al=ak+x+b+ac*6+ai*8;while(al>0&&C>=o&&al>=s){var B=parseInt(af.stackbeoordeling["clear"]["bijl"]);var V=af.stackbeoordeling["clear"]["lc"];var n=af.stackbeoordeling["clear"]["bb"];var O=parseInt(af.stackbeoordeling["clear"]["ram"]);var j=parseInt(af.stackbeoordeling["clear"]["kata"]);var G=Math.pow(1.037,C);var e=Math.pow(1.09,C);var F=O*2*M/(8*e);var y=C-Math.round(F);y=y<Math.round(C/2)?Math.round(C/2):y;var w=Math.pow(1.037,y);w=C==0?1:w;var ae=B+V+n+O+j;var m=C>0?20+50*y:20;al=ak+x+b+ac*6+ai*8;var z=ak;var v=x;var u=b;var l=ac;var t=ai;while(al>0&&ae>0){var D=B*40+O*2+j*100;var J=V*130;var R=n*120;var q=D+R+J;var ab=D/q;var d=J/q;var i=R/q;var a=0;var S=0;var A=0;var aj=0;var k=0;var K=ak*15+x*50+b*50+ac*200+ai*100+m*ab;var ad=ak*45+x*15+b*40+ac*80+ai*50+m*d;var aa=ak*20+x*40+b*5+ac*180+ai*100+m*i;var Z=K*ab*w;var c=ad*d*w;var am=aa*i*w;if(Z>D&&ab>0){var Q=D/Z;var N=Z/D;var W=Math.pow(Q,0.5)/N;a+=ak*ab*W;S+=x*ab*W;A=b*ab*W;aj=ac*ab*W;k=ai*ab*W;B=0;O=0;j=0}else{if(D>Z&&Z!==0){var N=D/Z;var Q=Z/D;var W=Math.pow(Q,0.5)/N;B-=B*W;O-=O*W;j-=j*W;a+=ak*ab;S+=x*ab;A+=b*ab;aj+=ac*ab}else{if(D==Z){B=0;O=0;j=0;a+=ak*ab;S+=x*ab;A+=b*ab;aj+=ac*ab}}}if(c>J&&d>0){var Q=J/c;var N=c/J;var W=Math.pow(Q,0.5)/N;a+=ak*d*W;S+=x*d*W;A+=b*d*W;aj+=ac*d*W;k+=ai*d*W;V=0}else{if(J>c&&c!==0){var N=J/c;var Q=c/J;var W=Math.pow(Q,0.5)/N;V-=V*W;a+=ak*d;S+=x*d;A+=b*d;aj+=ac*d;k+=ai*d}else{if(J==c){V=0;a+=ak*d;S+=x*d;A+=b*d;aj+=ac*d;k+=ai*d}}}if(am>R&&i>0){var Q=R/am;var N=am/R;var W=Math.pow(Q,0.5)/N;a+=ak*i*W;S+=x*i*W;A+=b*i*W;aj+=ac*i*W;k+=ai*i*W;n=0}else{if(R>am&&am!==0){var N=R/am;var Q=am/R;var W=Math.pow(Q,0.5)/N;n-=n*W;a+=ak*i;S+=x*i;A+=b*i;aj+=ac*i;k+=ai*i}else{if(R==am){n=0;a+=ak*i;S+=x*i;A+=b*i;aj+=ac*i;k+=ai*i}}}ak-=Math.round(a);x-=Math.round(S);b-=Math.round(A);ac-=Math.round(aj);ai-=Math.round(k);al=ak+x+b+ac*6+ai*8;ae=B+V+n+O+j;var a=0;var S=0;var A=0;var aj=0;var k=0}var Y=z+v+u+l+t;var h=Y-(ak+x+b+ac+ai);var U=h/Y;C=C-Math.round(F*U);C=C<0||C>20?0:C;aantalclearsnodig++;if(aantalclearsnodig==f){remainingunits.speer=Math.round(ak);remainingunits.zwaard=Math.round(x);remainingunits.boog=Math.round(b);remainingunits.zc=Math.round(ac);remainingunits.kata=Math.round(ai)}}}function calculatedeffneeded(g,e){var u=game_data.world;var O=game_data.player;var r=location.href;var I="creedpacksettings"+u;if(localStorage.getItem(I)!==null){var N=JSON.parse(localStorage.getItem(I))}osperattackspzw=N.osasker["speerzw"];osperattackspzc=N.osasker["speerzc"];var l=N.osasker["rename"];var Q=parseInt(N.osasker["spzwdeff"]["speer"]);var b=parseInt(N.osasker["spzwdeff"]["zwaard"]);var c=parseInt(N.osasker["spzwdeff"]["boog"]);var D=parseInt(N.osasker["spzwdeff"]["zc"]);var L=parseInt(N.osasker["spzcdeff"]["speer"]);var j=parseInt(N.osasker["spzcdeff"]["zwaard"]);var t=parseInt(N.osasker["spzcdeff"]["boog"]);var A=parseInt(N.osasker["spzcdeff"]["zc"]);if(g===true){var J=Q*15+b*50+c*50+D*200;var R=Q*45+b*15+c*40+D*80;var f=Q*20+b*40+c*5+D*180;var p=L*15+j*50+t*50+A*200;var G=L*45+j*15+t*40+A*80;var v=L*20+j*40+t*5+A*180}else{var J=Q*15+b*50+c*50+D*200;var R=Q*45+b*15+c*40+D*80;var p=L*15+j*50+t*50+A*200;var G=L*45+j*15+t*40+A*80}var S={};var H={};var C={};$("tr[class*='row_']").each(function(){var U=$(this).find("td:eq(1)").text().match(/\d{1,3}\|\d{1,3}/g);var T=$.trim($(this).find("td:eq(5)").text());var y=$(this).find(".quickedit").attr("data-id");if(S[U]){S[U]+=1;C[U].push(y)}else{S[U]=1;H[U]=T;C[U]=[y]}});var h="[table][**][b][u]Dorp[/u][/b][||][b][u]Sp/Zw deff nodig:[/u][/b][||][b][u]Sp/ZC deff nodig:[/u][/b][||][b][u]Voor:[/u][/b][/**]";if(g===true){for(var m in S){var K=0;var s=0;var F=S[m]-1;if(osperattackspzw[F]){var k=(parseInt(osperattackspzw[F]))*J;var z=(parseInt(osperattackspzw[F]))*R;var d=(parseInt(osperattackspzw[F]))*f;var n=parseInt(e[m]["speer"])*15+parseInt(e[m]["zwaard"])*50+parseInt(e[m]["boog"])*50+parseInt(e[m]["hc"])*200;var q=parseInt(e[m]["speer"])*45+parseInt(e[m]["zwaard"])*15+parseInt(e[m]["boog"])*40+parseInt(e[m]["hc"])*80;var w=parseInt(e[m]["speer"])*20+parseInt(e[m]["zwaard"])*40+parseInt(e[m]["boog"])*5+parseInt(e[m]["hc"])*180;var o=k>n?(k-n)/J:0;var B=z>q?(z-q)/R:0;var M=d>w?(d-w)/f:0;s=Math.ceil(Math.max(o,B,M)*2)/2;s=s==0?0:s}if(osperattackspzc[F]){var k=(parseInt(osperattackspzc[F]))*p;var z=(parseInt(osperattackspzc[F]))*G;var d=(parseInt(osperattackspzc[F]))*v;var n=parseInt(e[m]["speer"])*15+parseInt(e[m]["zwaard"])*50+parseInt(e[m]["boog"])*50+parseInt(e[m]["hc"])*200;var q=parseInt(e[m]["speer"])*45+parseInt(e[m]["zwaard"])*15+parseInt(e[m]["boog"])*40+parseInt(e[m]["hc"])*80;var w=parseInt(e[m]["speer"])*20+parseInt(e[m]["zwaard"])*40+parseInt(e[m]["boog"])*5+parseInt(e[m]["hc"])*180;var o=k>n?(k-n)/p:0;var B=z>q?(z-q)/G:0;var M=d>w?(d-w)/v:0;K=Math.ceil(Math.max(o,B,M)*2)/2;K=K==0?0:K}if(K>0||s>0){h+="[*][coord]"+m+"[/coord][|][b]"+s+"[/b][|][b]"+K+"[/b][|][b]"+H[m]+"[/b]";if(l===true){for(var E=0;E<C[m].length;E++){var a=C[m][E];var i=$(".quickedit[data-id='"+a+"']").find(".quickedit-label:first").text();if(i.indexOf("OS AANGEVRAAGD")<0){i+=" -- OS AANGEVRAAGD"}$.ajax({async:false,url:game_data.link_base_pure+"info_command&ajaxaction=edit_other_comment&id="+a+"&h="+game_data.csrf+"&",method:"post",data:{text:i}})}}}else{if(l===true){for(var E=0;E<C[m].length;E++){var a=C[m][E];var i=$(".quickedit[data-id='"+a+"']").find(".quickedit-label:first").text();if(i.indexOf("AUTOBLOCK OK")<0){i+=" -- AUTOBLOCK OK"}$.ajax({async:false,url:game_data.link_base_pure+"info_command&ajaxaction=edit_other_comment&id="+a+"&h="+game_data.csrf+"&",method:"post",data:{text:i}})}}}}}else{for(var m in S){var K=0;var s=0;var F=S[m]-1;if(osperattackspzw[F]){var k=(parseInt(osperattackspzw[F]))*J;var z=(parseInt(osperattackspzw[F]))*R;var n=parseInt(e[m]["speer"])*15+parseInt(e[m]["zwaard"])*50+parseInt(e[m]["hc"])*200;var q=parseInt(e[m]["speer"])*45+parseInt(e[m]["zwaard"])*15+parseInt(e[m]["hc"])*80;var o=k>n?(k-n)/J:0;var B=z>q?(z-q)/R:0;s=Math.ceil(Math.max(o,B)*2)/2;s=s==0?0:s}if(osperattackspzc[F]){var k=(parseInt(osperattackspzc[F]))*p;var z=(parseInt(osperattackspzc[F]))*G;var n=parseInt(e[m]["speer"])*15+parseInt(e[m]["zwaard"])*50+parseInt(e[m]["hc"])*200;var q=parseInt(e[m]["speer"])*45+parseInt(e[m]["zwaard"])*15+parseInt(e[m]["hc"])*80;var o=k>n?(k-n)/p:0;var B=z>q?(z-q)/G:0;K=Math.ceil(Math.max(o,B)*2)/2;K=K==0?0:K}if(K>0||s>0){h+="[*][coord]"+m+"[/coord][|][b]"+s+"[/b][|][b]"+K+"[/b][|][b]"+H[m]+"[/b]";if(l===true){for(var E=0;E<C[m].length;E++){var a=C[m][E];var i=$(".quickedit[data-id='"+a+"']").find(".quickedit-label:first").text();if(i.indexOf("OS AANGEVRAAGD")<0){i+=" -- OS AANGEVRAAGD"}$.ajax({async:false,url:game_data.link_base_pure+"info_command&ajaxaction=edit_other_comment&id="+a+"&h="+game_data.csrf+"&",method:"post",data:{text:i}})}}}else{if(l===true){for(var E=0;E<C[m].length;E++){var a=C[m][E];var i=$(".quickedit[data-id='"+a+"']").find(".quickedit-label:first").text();if(i.indexOf("AUTOBLOCK OK")<0){i+=" -- AUTOBLOCK OK"}$.ajax({async:false,url:game_data.link_base_pure+"info_command&ajaxaction=edit_other_comment&id="+a+"&h="+game_data.csrf+"&",method:"post",data:{text:i}})}}}}}var P='<table><th style = "color:green; padding:7px 3px 7px 3px; font-size: 15px">OS nodig:</th></table><textarea rows="10" cols="80" id="TITLE">'+h+"[/table]</textarea>";var x='<div id="inline_popup" class="ui-draggable show" style="position: fixed; top: 30%; left: 40%;margin-top: -50px; margin-left: -100px;width: auto; height: auto"><div id="inline_popup_menu" style = "height:auto"><center><span id="inline_popup_title" style = "margin: 5px; font-size:30px; height:35 px">Export</span></center></div><div id="inline_popup_main" style="height: auto; max-height: 1000px"><div id="inline_popup_content" style="height: 400px; overflow: auto"><div class="inner-border main content-border" style="border-top-color: currentColor; border-left-color: currentColor;border-right-color: currentColor; border-bottom-color: currentColor; border-top-width: medium; border-left-width:medium; border-right-width: medium; border-bottom-width: medium; border-top-style: none; border-left-style: none;border-right-style: none; border-bottom-style: none; font-weight: 400; height: auto">'+P+'<a style = "padding:7px 3px 7px 3px; cursor:pointer; cursor: hand;" id="closemywindow">Sluiten</a></div></div></div>';$(x).appendTo("body");$("#closemywindow").click(function(){$("#inline_popup").remove()})};