// ==UserScript==
// @name         XDigma search comets
// @namespace    http://tampermonkey.net/
// @version      2.63
// @description  Search comets
// @author       valter0ff
// @match        https://xdigma.com/game.php?page=galaxy2*
// @match        https://xdigma.net/game.php?page=galaxy2*
// @icon         data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==
// @license      GPL3
// @grant        none
// @downloadURL https://update.greasyfork.org/scripts/530076/XDigma%20search%20comets.user.js
// @updateURL https://update.greasyfork.org/scripts/530076/XDigma%20search%20comets.meta.js
// ==/UserScript==

(function()  {
  "use strict";

  let array1 = [
  "1:1:2",
  "1:1:3",
  "1:1:4",
  "1:1:5",
  "1:2:1",
  "1:2:4",
  "1:2:9",
  "1:4:1",
  "1:4:2",
  "1:4:3",
  "1:4:4",
  "1:4:5",
  "1:4:6",
  "1:4:7",
  "1:4:8",
  "1:4:9",
  "1:9:6",
  "1:11:4",
  "1:14:4",
  "1:14:9",
  "1:15:7",
  "1:22:4",
  "1:22:9",
  "1:24:9",
  "1:25:1",
  "1:26:9",
  "1:28:3",
  "1:28:5",
  "1:28:6",
  "1:31:4",
  "1:32:4",
  "1:33:5",
  "1:34:9",
  "1:36:9",
  "1:40:5",
  "1:41:4",
  "1:42:4",
  "1:46:4",
  "1:46:6",
  "1:47:3",
  "1:47:4",
  "1:47:5",
  "1:47:6",
  "1:49:4",
  "1:52:4",
  "1:53:4",
  "1:54:1",
  "1:54:5",
  "1:55:1",
  "1:55:4",
  "1:55:8",
  "1:55:9",
  "1:56:1",
  "1:56:2",
  "1:56:3",
  "1:56:5",
  "1:56:6",
  "1:56:7",
  "1:56:8",
  "1:56:9",
  "1:57:2",
  "1:57:3",
  "1:57:4",
  "1:57:5",
  "1:57:7",
  "1:57:8",
  "1:57:9",
  "1:59:9",
  "1:60:1",
  "1:60:2",
  "1:61:9",
  "1:62:4",
  "1:64:4",
  "1:65:3",
  "1:65:4",
  "1:65:5",
  "1:65:6",
  "1:65:9",
  "1:67:4",
  "1:69:2",
  "1:69:4",
  "1:69:5",
  "1:70:5",
  "1:80:9",
  "1:81:4",
  "1:81:9",
  "1:83:4",
  "1:83:9",
  "1:85:1",
  "1:87:9",
  "1:89:4",
  "1:97:3",
  "1:97:5",
  "1:97:9",
  "1:108:4",
  "1:114:4",
  "1:115:4",
  "1:116:5",
  "1:116:6",
  "1:117:4",
  "1:119:8",
  "1:119:9",
  "1:120:4",
  "1:121:9",
  "1:122:1",
  "1:122:2",
  "1:122:3",
  "1:122:4",
  "1:122:5",
  "1:122:6",
  "1:122:7",
  "1:122:8",
  "1:123:4",
  "1:125:3",
  "1:128:4",
  "1:129:4",
  "1:130:4",
  "1:131:3",
  "1:131:4",
  "1:132:4",
  "1:133:3",
  "1:133:4",
  "1:135:3",
  "1:135:4",
  "1:136:5",
  "1:136:9",
  "1:137:4",
  "1:140:4",
  "1:141:4",
  "1:141:7",
  "1:142:4",
  "1:143:4",
  "1:144:4",
  "1:145:4",
  "1:146:1",
  "1:146:2",
  "1:146:3",
  "1:146:4",
  "1:146:5",
  "1:146:6",
  "1:146:7",
  "1:146:8",
  "1:146:9",
  "1:147:1",
  "1:147:6",
  "1:149:4",
  "1:149:5",
  "1:151:4",
  "1:153:3",
  "1:153:4",
  "1:154:4",
  "1:155:4",
  "1:160:5",
  "1:160:6",
  "1:161:4",
  "1:162:4",
  "1:163:1",
  "1:164:6",
  "1:166:2",
  "1:166:3",
  "1:166:4",
  "1:166:5",
  "1:166:6",
  "1:167:4",
  "1:167:8",
  "1:169:5",
  "1:170:4",
  "1:170:9",
  "1:171:4",
  "1:182:1",
  "1:182:9",
  "1:183:8",
  "1:183:9",
  "1:184:1",
  "1:186:6",
  "1:187:3",
  "1:187:4",
  "1:192:2",
  "1:192:4",
  "1:192:8",
  "1:196:2",
  "1:196:3",
  "1:196:4",
  "1:196:5",
  "1:196:6",
  "1:196:9",
  "1:197:3",
  "1:197:4",
  "1:197:5",
  "1:197:6",
  "1:198:9",
  "1:200:4",
  "1:203:8",
  "1:203:9",
  "1:204:8",
  "1:204:9",
  "1:205:8",
  "1:205:9",
  "1:206:8",
  "1:206:9",
  "1:207:2",
  "1:207:3",
  "1:207:4",
  "1:207:5",
  "1:207:6",
  "1:207:8",
  "1:207:9",
  "1:208:9",
  "1:210:4",
  "1:210:9",
  "1:211:1",
  "1:211:2",
  "1:211:3",
  "1:211:5",
  "1:211:6",
  "1:211:7",
  "1:211:8",
  "1:211:9",
  "1:213:1",
  "1:213:2",
  "1:213:3",
  "1:213:4",
  "1:213:5",
  "1:213:6",
  "1:213:7",
  "1:213:8",
  "1:213:9",
  "1:214:1",
  "1:214:2",
  "1:214:3",
  "1:214:4",
  "1:214:5",
  "1:214:6",
  "1:214:7",
  "1:214:8",
  "1:214:9",
  "1:215:1",
  "1:215:2",
  "1:215:3",
  "1:215:4",
  "1:215:5",
  "1:215:6",
  "1:215:7",
  "1:215:8",
  "1:215:9",
  "1:216:8",
  "1:217:9",
  "1:221:1",
  "1:221:2",
  "1:221:3",
  "1:221:5",
  "1:224:4",
  "1:227:5",
  "1:244:5",
  "1:248:5",
  "1:252:9",
  "1:253:3",
  "1:253:4",
  "1:254:4",
  "1:256:3",
  "1:256:4",
  "1:256:5",
  "1:256:6",
  "1:256:7",
  "1:258:2",
  "1:258:5",
  "1:258:6",
  "1:262:9",
  "1:268:1",
  "1:269:8",
  "1:269:9",
  "1:274:4",
  "1:275:3",
  "1:276:4",
  "1:277:1",
  "1:277:9",
  "1:278:2",
  "1:278:3",
  "1:278:4",
  "1:278:5",
  "1:278:6",
  "1:278:7",
  "1:278:8",
  "1:278:9",
  "1:279:2",
  "1:279:7",
  "1:279:8",
  "1:279:9",
  "1:280:1",
  "1:280:7",
  "1:280:8",
  "1:280:9",
  "1:281:4",
  "1:281:5",
  "1:281:6",
  "1:284:1",
  "1:285:4",
  "1:288:5",
  "1:289:4",
  "1:300:4",
  "1:306:4",
  "1:307:2",
  "1:307:4",
  "1:308:4",
  "1:308:5",
  "1:316:4",
  "1:318:9",
  "1:319:4",
  "1:319:9",
  "1:320:1",
  "1:320:2",
  "1:320:3",
  "1:320:4",
  "1:320:5",
  "1:320:6",
  "1:320:7",
  "1:320:9",
  "1:321:4",
  "1:321:9",
  "1:322:1",
  "1:322:2",
  "1:322:4",
  "1:322:7",
  "1:322:9",
  "1:323:9",
  "1:325:9",
  "1:326:4",
  "1:326:9",
  "1:327:1",
  "1:327:2",
  "1:327:3",
  "1:327:4",
  "1:327:5",
  "1:327:6",
  "1:327:7",
  "1:327:9",
  "1:328:1",
  "1:328:2",
  "1:328:4",
  "1:328:8",
  "1:328:9",
  "1:329:4",
  "1:330:3",
  "1:330:4",
  "1:330:9",
  "1:331:1",
  "1:331:2",
  "1:331:4",
  "1:331:6",
  "1:331:7",
  "1:331:9",
  "1:332:4",
  "1:332:9",
  "1:333:4",
  "1:333:5",
  "1:334:1",
  "1:334:4",
  "1:334:9",
  "1:335:1",
  "1:335:4",
  "1:335:8",
  "1:335:9",
  "1:336:4",
  "1:336:6",
  "1:336:9",
  "1:337:4",
  "1:338:4",
  "1:339:4",
  "1:340:1",
  "1:350:5",
  "1:356:9",
  "1:372:4",
  "1:374:1",
  "1:374:4",
  "1:377:7",
  "1:381:5",
  "1:385:1",
  "1:396:1",
  "1:396:2",
  "1:396:6",
  "1:398:6",
  "1:407:6",
  "1:423:3",
  "1:424:1",
  "1:425:2",
  "1:425:3",
  "1:425:4",
  "1:425:5",
  "1:425:6",
  "1:425:7",
  "1:425:8",
  "1:425:9",
  "1:426:5",
  "1:431:1",
  "1:431:2",
  "1:431:3",
  "1:431:4",
  "1:442:9",
  "1:443:1",
  "1:443:7",
  "1:443:8",
  "1:443:9",
  "1:444:3",
  "1:444:4",
  "1:444:6",
  "1:444:7",
  "1:444:8",
  "1:444:9",
  "1:445:9",
  "1:446:9",
  "1:450:3",
  "1:458:1",
  "1:499:9",
  "1:501:4",
  "1:514:4",
  "1:519:2",
  "1:519:4",
  "1:522:4",
  "1:524:1",
  "1:528:4",
  "1:534:4",
  "1:538:4",
  "1:560:2",
  "1:563:5",
  "1:564:5",
  "1:564:7",
  "1:565:5",
  "1:566:1",
  "1:566:2",
  "1:566:3",
  "1:566:4",
  "1:566:5",
  "1:566:6",
  "1:566:7",
  "1:566:8",
  "1:566:9",
  "1:567:4",
  "1:568:1",
  "1:568:4",
  "1:568:9",
  "1:572:4",
  "1:575:4",
  "1:580:4",
  "1:596:5",
  "1:600:1",
  "1:608:4",
  "1:610:1",
  "1:610:4",
  "1:610:5",
  "1:610:7",
  "1:611:4",
  "1:611:5",
  "1:625:5",
  "1:634:1",
  "1:634:2",
  "1:634:3",
  "1:634:4",
  "1:634:5",
  "1:634:6",
  "1:634:7",
  "1:634:8",
  "1:634:9",
  "1:647:9",
  "1:649:5",
  "1:649:6",
  "1:649:7",
  "1:650:5",
  "1:650:6",
  "1:668:2",
  "1:668:4",
  "1:678:4",
  "1:680:1",
  "1:687:4",
  "1:694:9",
  "1:712:4",
  "1:714:4",
  "1:715:4",
  "1:716:4",
  "1:719:4",
  "1:719:8",
  "1:724:4",
  "1:725:1",
  "1:729:5",
  "1:734:3",
  "1:734:4",
  "1:734:5",
  "1:734:6",
  "1:735:4",
  "1:737:4",
  "1:742:4",
  "1:743:1",
  "1:743:2",
  "1:743:5",
  "1:743:9",
  "1:744:1",
  "1:744:4",
  "1:745:1",
  "1:745:4",
  "1:746:1",
  "1:750:9",
  "1:759:3",
  "1:763:4",
  "1:767:1",
  "1:769:1",
  "1:770:2",
  "1:773:4",
  "1:776:1",
  "1:777:1",
  "1:781:4",
  "1:781:5",
  "1:781:6",
  "1:785:4",
  "1:787:1",
  "1:788:5",
  "1:789:4",
  "1:791:1",
  "1:791:2",
  "1:791:9",
  "1:792:1",
  "1:792:2",
  "1:792:3",
  "1:792:4",
  "1:792:5",
  "1:793:1",
  "1:793:2",
  "1:793:4",
  "1:794:9",
  "1:797:1",
  "1:798:5",
  "1:799:4",
  "1:824:4",
  "1:824:7",
  "1:827:1",
  "1:827:2",
  "1:827:3",
  "1:827:4",
  "1:827:6",
  "1:828:1",
  "1:828:2",
  "1:828:4",
  "1:828:5",
  "1:828:6",
  "1:828:7",
  "1:829:1",
  "1:829:2",
  "1:829:4",
  "1:829:5",
  "1:832:4",
  "1:834:4",
  "1:838:5",
  "1:848:7",
  "1:849:3",
  "1:852:1",
  "1:852:2",
  "1:852:3",
  "1:852:4",
  "1:852:5",
  "1:852:6",
  "1:852:7",
  "1:852:8",
  "1:852:9",
  "1:853:3",
  "1:853:4",
  "1:869:4",
  "1:869:5",
  "1:870:2",
  "1:870:4",
  "1:870:5",
  "1:870:6",
  "1:871:4",
  "1:883:4",
  "1:884:9",
  "1:892:4",
  "1:893:4",
  "1:897:4",
  "1:900:4"
]

  let array2 = [
  "2:7:9",
  "2:8:9",
  "2:10:9",
  "2:15:9",
  "2:20:4",
  "2:20:9",
  "2:21:9",
  "2:22:9",
  "2:23:1",
  "2:23:2",
  "2:23:3",
  "2:23:4",
  "2:23:5",
  "2:23:6",
  "2:23:7",
  "2:23:9",
  "2:24:9",
  "2:25:1",
  "2:25:4",
  "2:25:9",
  "2:26:9",
  "2:29:4",
  "2:35:5",
  "2:47:7",
  "2:55:4",
  "2:69:4",
  "2:70:4",
  "2:85:5",
  "2:103:9",
  "2:104:9",
  "2:105:9",
  "2:106:9",
  "2:107:9",
  "2:108:4",
  "2:108:5",
  "2:108:8",
  "2:108:9",
  "2:109:1",
  "2:109:2",
  "2:109:3",
  "2:109:4",
  "2:109:5",
  "2:109:6",
  "2:109:7",
  "2:109:8",
  "2:109:9",
  "2:110:1",
  "2:110:3",
  "2:110:8",
  "2:110:9",
  "2:111:9",
  "2:112:9",
  "2:113:9",
  "2:114:9",
  "2:115:2",
  "2:115:4",
  "2:115:9",
  "2:116:2",
  "2:116:4",
  "2:117:4",
  "2:119:4",
  "2:120:4",
  "2:124:4",
  "2:125:1",
  "2:127:9",
  "2:129:4",
  "2:130:4",
  "2:138:4",
  "2:141:4",
  "2:152:1",
  "2:163:4",
  "2:172:5",
  "2:181:3",
  "2:181:4",
  "2:181:5",
  "2:181:9",
  "2:186:4",
  "2:189:4",
  "2:192:4",
  "2:200:6",
  "2:200:9",
  "2:205:8",
  "2:205:9",
  "2:206:8",
  "2:206:9",
  "2:208:5",
  "2:210:5",
  "2:215:8",
  "2:216:9",
  "2:219:9",
  "2:221:1",
  "2:230:4",
  "2:230:5",
  "2:247:9",
  "2:263:4",
  "2:265:9",
  "2:270:9",
  "2:275:1",
  "2:275:9",
  "2:276:2",
  "2:276:9",
  "2:277:1",
  "2:277:4",
  "2:277:5",
  "2:278:9",
  "2:279:4",
  "2:279:6",
  "2:283:1",
  "2:296:1",
  "2:297:9",
  "2:298:1",
  "2:298:4",
  "2:298:9",
  "2:299:9",
  "2:300:5",
  "2:300:7",
  "2:300:8",
  "2:307:4",
  "2:307:5",
  "2:307:6",
  "2:330:5",
  "2:350:4",
  "2:363:4",
  "2:370:4",
  "2:376:4",
  "2:390:4",
  "2:391:4",
  "2:392:4",
  "2:397:4",
  "2:401:9",
  "2:405:4",
  "2:407:6",
  "2:425:4",
  "2:426:9",
  "2:446:5",
  "2:450:3",
  "2:452:1",
  "2:463:4",
  "2:470:1",
  "2:470:2",
  "2:470:3",
  "2:470:4",
  "2:470:5",
  "2:470:6",
  "2:470:7",
  "2:470:8",
  "2:470:9",
  "2:490:1",
  "2:492:8",
  "2:494:4",
  "2:500:6",
  "2:514:4",
  "2:517:1",
  "2:519:4",
  "2:525:4",
  "2:528:4",
  "2:563:4",
  "2:576:5",
  "2:590:1",
  "2:606:5",
  "2:625:5",
  "2:643:9",
  "2:644:9",
  "2:645:9",
  "2:647:7",
  "2:647:8",
  "2:647:9",
  "2:648:9",
  "2:649:9",
  "2:665:4",
  "2:679:4",
  "2:681:4",
  "2:682:4",
  "2:695:9",
  "2:717:5",
  "2:725:4",
  "2:725:5",
  "2:738:3",
  "2:744:4",
  "2:752:1",
  "2:765:4",
  "2:775:1",
  "2:797:1",
  "2:824:4",
  "2:824:5",
  "2:883:4",
  "2:885:4",
  "2:900:1"
]

  let array3 = [
  "3:1:1",
  "3:2:3",
  "3:3:2",
  "3:3:3",
  "3:3:4",
  "3:3:5",
  "3:3:7",
  "3:3:8",
  "3:9:3",
  "3:19:9",
  "3:26:9",
  "3:27:1",
  "3:29:5",
  "3:30:4",
  "3:40:9",
  "3:41:4",
  "3:44:4",
  "3:48:4",
  "3:49:4",
  "3:56:9",
  "3:57:4",
  "3:67:3",
  "3:67:4",
  "3:70:1",
  "3:70:8",
  "3:70:9",
  "3:71:9",
  "3:72:1",
  "3:72:6",
  "3:72:9",
  "3:73:4",
  "3:77:4",
  "3:83:5",
  "3:83:9",
  "3:84:4",
  "3:84:8",
  "3:85:8",
  "3:85:9",
  "3:86:1",
  "3:86:2",
  "3:86:3",
  "3:86:4",
  "3:86:5",
  "3:86:6",
  "3:86:7",
  "3:86:8",
  "3:86:9",
  "3:99:1",
  "3:100:1",
  "3:100:2",
  "3:100:3",
  "3:100:4",
  "3:100:5",
  "3:100:6",
  "3:100:7",
  "3:100:8",
  "3:101:1",
  "3:101:4",
  "3:101:5",
  "3:101:9",
  "3:103:4",
  "3:111:1",
  "3:112:1",
  "3:118:4",
  "3:119:4",
  "3:119:9",
  "3:120:1",
  "3:120:2",
  "3:120:3",
  "3:120:4",
  "3:120:5",
  "3:120:6",
  "3:120:7",
  "3:120:8",
  "3:120:9",
  "3:129:5",
  "3:131:4",
  "3:135:4",
  "3:135:9",
  "3:138:4",
  "3:140:3",
  "3:141:3",
  "3:141:4",
  "3:144:4",
  "3:145:9",
  "3:151:4",
  "3:152:4",
  "3:154:4",
  "3:156:2",
  "3:156:3",
  "3:156:4",
  "3:156:5",
  "3:167:4",
  "3:168:4",
  "3:181:1",
  "3:186:1",
  "3:186:2",
  "3:186:4",
  "3:187:4",
  "3:198:9",
  "3:205:8",
  "3:205:9",
  "3:206:8",
  "3:206:9",
  "3:207:3",
  "3:208:3",
  "3:208:5",
  "3:212:4",
  "3:216:9",
  "3:224:6",
  "3:225:9",
  "3:227:5",
  "3:228:9",
  "3:229:9",
  "3:234:3",
  "3:238:4",
  "3:247:1",
  "3:247:7",
  "3:247:8",
  "3:248:1",
  "3:248:2",
  "3:248:3",
  "3:248:4",
  "3:248:6",
  "3:248:7",
  "3:248:8",
  "3:248:9",
  "3:249:3",
  "3:249:8",
  "3:250:4",
  "3:250:9",
  "3:252:7",
  "3:253:4",
  "3:254:4",
  "3:256:4",
  "3:257:4",
  "3:259:9",
  "3:260:3",
  "3:260:5",
  "3:260:6",
  "3:260:8",
  "3:261:1",
  "3:261:2",
  "3:261:3",
  "3:261:5",
  "3:261:8",
  "3:261:9",
  "3:262:4",
  "3:262:8",
  "3:263:1",
  "3:263:3",
  "3:263:9",
  "3:264:9",
  "3:270:1",
  "3:272:4",
  "3:277:4",
  "3:279:4",
  "3:286:8",
  "3:287:9",
  "3:297:4",
  "3:298:9",
  "3:299:9",
  "3:302:1",
  "3:302:4",
  "3:303:4",
  "3:308:1",
  "3:327:9",
  "3:330:9",
  "3:334:3",
  "3:334:6",
  "3:352:4",
  "3:356:2",
  "3:363:5",
  "3:370:4",
  "3:378:4",
  "3:380:1",
  "3:380:4",
  "3:382:1",
  "3:383:5",
  "3:391:1",
  "3:391:9",
  "3:400:4",
  "3:401:9",
  "3:402:6",
  "3:407:3",
  "3:407:4",
  "3:425:2",
  "3:425:4",
  "3:449:2",
  "3:449:3",
  "3:449:5",
  "3:449:6",
  "3:450:9",
  "3:455:1",
  "3:455:2",
  "3:455:3",
  "3:455:4",
  "3:455:5",
  "3:455:6",
  "3:455:7",
  "3:455:9",
  "3:470:9",
  "3:475:1",
  "3:475:9",
  "3:476:4",
  "3:477:4",
  "3:477:5",
  "3:477:6",
  "3:477:7",
  "3:478:4",
  "3:478:9",
  "3:479:9",
  "3:492:1",
  "3:492:3",
  "3:492:9",
  "3:499:9",
  "3:501:1",
  "3:506:9",
  "3:507:1",
  "3:507:4",
  "3:508:4",
  "3:514:2",
  "3:514:4",
  "3:514:5",
  "3:514:7",
  "3:517:4",
  "3:523:4",
  "3:527:4",
  "3:535:5",
  "3:536:3",
  "3:537:2",
  "3:537:3",
  "3:537:4",
  "3:537:5",
  "3:537:6",
  "3:537:7",
  "3:537:8",
  "3:565:2",
  "3:579:6",
  "3:580:1",
  "3:582:7",
  "3:594:1",
  "3:594:4",
  "3:597:4",
  "3:612:5",
  "3:613:1",
  "3:613:2",
  "3:613:3",
  "3:613:6",
  "3:613:7",
  "3:613:8",
  "3:643:8",
  "3:657:4",
  "3:661:4",
  "3:661:6",
  "3:661:7",
  "3:665:9",
  "3:669:4",
  "3:670:1",
  "3:679:5",
  "3:684:1",
  "3:697:6",
  "3:698:6",
  "3:723:1",
  "3:726:1",
  "3:732:1",
  "3:739:2",
  "3:739:3",
  "3:739:4",
  "3:739:5",
  "3:739:6",
  "3:739:7",
  "3:744:4",
  "3:763:4",
  "3:766:1",
  "3:766:4",
  "3:766:5",
  "3:766:6",
  "3:767:4",
  "3:767:5",
  "3:767:9",
  "3:770:4",
  "3:779:5",
  "3:786:6",
  "3:787:4",
  "3:792:1",
  "3:813:2",
  "3:813:3",
  "3:813:4",
  "3:813:9",
  "3:824:5",
  "3:850:6",
  "3:872:9",
  "3:873:4",
  "3:874:9",
  "3:876:4",
  "3:885:9",
  "3:897:4"
]

function getFilteredCoordinates() {
  return $(".tooltip[data-tooltip-content^='Адрес [']")
    .map(function () { 
      var match = $(this).attr("data-tooltip-content").match(/\[(\d+:\d+:\d+)\]/);
      return match ? match[1] : null;
    })
    .get(); 
}
  
  function findComets({ initialArray = array1 } = {}) {
     const newElements = getFilteredCoordinates()
     const uniqueElements = [
     ...newElements.filter((x) => !initialArray.includes(x)),
     ...initialArray.filter((x) => !newElements.includes(x)),
    ];
    return uniqueElements;
  }
  
function showComets(coordinates) {
    coordinates.forEach((coord) => {
        const comet = $(`a[data-tooltip-content*="Адрес [${coord}]"]`)
        if (comet.length > 0) {
            comet.find('img').attr({
              src: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABHNCSVQICAgIfAhkiAAABR1JREFUOI0tlGtsU3UYxn/nnHZdb1Bs59hZtzUbbKOOse1silzNIAgEImoGmknEmIB+Q2eiwfjFEA2aoPJB2AwSA5EAGkCJF0hgXhCFdVvUba4MmGxz145uPTvt2tP+/bC9yZs8H57keZP3l0dibqSGhgb51i2n1bm1ztL13YeW8uxqJWr3yPn1K8WzT+2VLAUoJ95pkXpOHZagVwBp8MWhKAEhExCAJAEyPGKBLhfZdZ6yp3e67LUbXRMDE1m7GjdapxOIujVYS4Eb7YgzpzsTnW2/Y9e7jXjbxQnQJ6DSgNY0gASP2+HGQxTWLMYZLCgobVS3HNjs2VaOo34BNico8+nK3FXoLSazoU4ilw6fuxsZ6u+fnekbI3Q9Dl0mgAqOapbs3i5vaX779V/EF0KIH4QQ3deESF6bFmbbjMiYQmTahEh3CZESQlwUQrQ09Yom1jVvguKlgGfJki02BZzFaC8s8pfWOt8//0rF2wGqgJUtIXyXf0JeW4L80ekIH4TCkv7fYumujjSoUr4c7D4vyfhSTf8zZImgLp6d7O5NKfgeexR9Wf5Tr7xV9KqG9gc8NgrZH18akBzJEXnVap+kR2PSnnUq16/for3fkKIJH5sCMV8htsj4GNEse/GI15aYIXIjpWB412iNbwZ3vKZq9TYqbeAZNwwpORSXPtldzEsHfqQwZwXDUwmu3Y5Qssjk71+GuT4SkAJVFG5XmQzbHMaFr79MTQ1NmhZwSC6XZt3nJhvw+UE6Ek5z9XIIwzAwjDFOn3yP/rEIZcEybvaAO0/DiI4yauRacFDkDlJSXLJrquPqFd1C5daZ4HNEgGQv8MbxMNG/HnCteQe5tfuIA15MVH+A3t5eysrKOH9I4+ANg1gMQg6qql38epKMDt0pGVlKOCRsgM1hojTtLAWitA7MI0+ISOhzwhdPoes6L+7cxp0krM/LYvgOAEKDuCJL05CalondScQ6kQH5+wSyJ4bU1PQk7xw8ieJy4cUL9hXgdQOwZ4NKhWLScjVMTw+4QfkHkmamzwQM2bnAkprSSQNpRUbaf2lQLCuAgD9AVVUV0QEF1/JVLKvQ8NrtlG2/QMRmQfV7aX4ZSoFuMGTpQRqYlWc6bpp9/R1JE8wqBxzc7aexKYTD66UnDAQCBB/WCMeLCASDfPvtDhr3h9i7Npc0mMDRQrh3r2dwEjCVvc2XClxZS3OLVtvy60D+wYov9q+His0q0UkrPoeHnBINt3sc7Bp/zWShupbw+iqEDAng1Dd/8Pv9n6+MDMs1s0pf6HZO6MqFh9sdz+RuXWldWA/2mNeavdwO727NIU8rp29ojMhoDqyAqfgUm8pU8XgADDhhhd+OfdV5+/ujx2eYPJtRZvV+J0mrc3gi5p4Q67OKajHXeYgVu/BlgN5uk/vjgyRVaNqrZTIDi8wnN1tTBfCNFW5/dCrcd+jQkVEeRFLQLxQolyCqMDwkG7GF6YStwjSXYzwC99thYrFfzp821EyxX01X5jO7rdx6phwuX4C7h4/13Hv/5PH7DF59gHErCWTm62vcC0P5UO6nps5XU/vyQq3mUff+fdiCYAWSYYiWQhIY/ayDkWOftupm93n9z5Q5gTE+Sde5FCCkhoazyrlzB7MBJ4RdEHQBDqqrnXk1G6wr6p+XV65FP1DA1F0QnW0DmT1NR2YSPW1xxkMpUJM8kRentdWcL1gkaJBhXIJWC1Qq8JB1TmOZ9wjmPirmNw1k5nWGOXwyAP8DrRQ2wm119FIAAAAASUVORK5CYII=",
              style: 'width:7%;height:7%;',
            })
        }
    })
}

 
$(document).ready(function () {
  const $targetSpan = $('span a[href^="game.php?page=galaxy2&galaxy=3"]').parent()

    const $newSpan = $('<span>', { style: 'background: none; cursor: pointer;' })
    const $img = $('<img>', {
      style: 'width: 1.5%;',
      src: 'styles/theme/gow/images/gala.png',
      class: "tooltip",
      'data-tooltip-content': "Найти кометы",
    })

    $newSpan.append($img)
    $targetSpan.after($newSpan)

  const urlParams = new URLSearchParams(window.location.search)
  const galaxy = urlParams.get('galaxy')

  let initialArray
  switch (galaxy) {
    case '1':
      initialArray = array1
      break
    case '2':
      initialArray = array2
      break
    case '3':
      initialArray = array3
      break
    default:
      initialArray = array1
  }

  const uniqueElements = findComets({ initialArray })
  
  function handleClick(cometCoordinates) {
    if (cometCoordinates.length) {
      const baseUrl = `https://${window.location.host}/game.php?page=planetinf`
      const links = cometCoordinates
        .filter(element => {
            return $(`a[data-tooltip-content*="Адрес [${element}]"]`).length > 0 
        })
        .map(element => {
             const [galaxyNumber, system, planet] = element.split(':');
             const url = `${baseUrl}&galaxy=${galaxyNumber}&system=${system}&planet=${planet}`;
            return `<a href="${url}" target="_blank">${element}</a>`;
        })
        
        Swal.fire({
          title: `Обнаружены кометы: ${links.length}`,
          html: `<div style="background-color: #222; padding: 10px; border-radius: 5px;">
                     <p style="color: white;">${links.join('<br>')}</p>
                 </div>`,
          confirmButtonText: 'Close',
          background: '#333',
          stopKeydownPropagation: false,
          keydownListenerCapture: true,
        });
    } else {
        Swal.fire({
          title: 'Комет не обнаружено',
          confirmButtonText: 'Close',
          background: '#333',
        });
    }
  }
  
  $newSpan.on('click', function() {
   handleClick(uniqueElements);
  });
  
  if (uniqueElements) {
    showComets(uniqueElements)
  }
})

  
    // Log array1 to the console
  console.log("Script searchComets loaded");

  window.array1 = array1;
  window.array2 = array2;
  window.array3 = array3;
  window.findComets = findComets;
  window.getFilteredCoordinates = getFilteredCoordinates;
})();