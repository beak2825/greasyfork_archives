// ==UserScript==
// @name         img/show?img
// @description  image cache, image file size<2MB
// @namespace    img_show_img
// @author       Covenant
// @version      1.0
// @license      MIT
// @homepage
// @match        https://i.imgur.com/*
// @icon         data:image/x-icon;base64,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
// @grant        GM_setValue
// @grant        GM_getValue
// @grant        GM_registerMenuCommand
// @grant        GM_setClipboard
// @grant        GM_openInTab
// @connect
// @run-at       document-start
// @noframes
// @downloadURL https://update.greasyfork.org/scripts/469499/imgshowimg.user.js
// @updateURL https://update.greasyfork.org/scripts/469499/imgshowimg.meta.js
// ==/UserScript==
async function fn_clipboard_w(str){
    try{
        await navigator.clipboard.writeText(str);
    }catch(e){alert(e.message);}
    finally{}
}
function fn_url(url){
    let obj_url=new URL(url);
    let params=obj_url.searchParams;
    //let params=new URLSearchParams(obj_url.search);
    return [obj_url,params];
}
//console.log("break");
(function() {
    'use strict';
    let url=fn_url(document.location);
    if(url[0].host.search(new RegExp("i.imgur.com", "i"))==0){
        GM_registerMenuCommand("i.imgur.com copy", () => {
            GM_setClipboard("https://hbl917070.com/img/show?img=https%3A%2F%2Fimgur.com%2F"+url[0].pathname+"&imgw=0&size=12&tc=d6dad6ff&tbt=3&tb=0a0a0aff&tbac=00000019&y=17&txt=%20#.png", "text");
            //GM_openInTab("https://hbl917070.com/img/show?img=https%3A%2F%2Fimgur.com%2F"+url[0].pathname+"&imgw=0&size=12&tc=d6dad6ff&tbt=3&tb=0a0a0aff&tbac=00000019&y=17&txt=%20#.png");
        });
    }
})();