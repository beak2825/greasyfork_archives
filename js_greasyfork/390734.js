// ==UserScript==
// @name         Add renamed hotel to xls SLT
// @namespace    http://tampermonkey.net/
// @version      0.12
// @description  try to take over the world!
// @author       You
// @match        https://cms.sletat.ru/HotelCard.aspx?hotel=*
// @grant        none
// @downloadURL https://update.greasyfork.org/scripts/390734/Add%20renamed%20hotel%20to%20xls%20SLT.user.js
// @updateURL https://update.greasyfork.org/scripts/390734/Add%20renamed%20hotel%20to%20xls%20SLT.meta.js
// ==/UserScript==

(function() {
	'use strict';
function sendHotel() {

	var oldName = htlCard.generalInfo.oldLatinName.val();
	var newName = htlCard.generalInfo.Name.val();
	var country = hotelCountry;
	var cardLink = document.URL;

	if (hotelCountry == '1') { country = 'Абхазия'; } else if (hotelCountry == '2') { country = 'Австралия'; } else if (hotelCountry == '3') { country = 'Австрия'; } else if (hotelCountry == '4') { country = 'Азербайджан'; } else if (hotelCountry == '5') { country = 'Албания'; } else if (hotelCountry == '6') { country = 'Ангилья'; } else if (hotelCountry == '7') { country = 'Андорра'; } else if (hotelCountry == '184') { country = 'Антарктида'; } else if (hotelCountry == '8') { country = 'Антигуа'; } else if (hotelCountry == '9') { country = 'Аргентина'; } else if (hotelCountry == '10') { country = 'Армения'; } else if (hotelCountry == '11') { country = 'Аруба'; } else if (hotelCountry == '12') { country = 'Багамы'; } else if (hotelCountry == '13') { country = 'Бангладеш'; } else if (hotelCountry == '14') { country = 'Барбадос'; } else if (hotelCountry == '15') { country = 'Бахрейн'; } else if (hotelCountry == '16') { country = 'Беларусь'; } else if (hotelCountry == '17') { country = 'Белиз'; } else if (hotelCountry == '18') { country = 'Бельгия'; } else if (hotelCountry == '180') { country = 'Бермудские острова'; } else if (hotelCountry == '19') { country = 'Болгария'; } else if (hotelCountry == '20') { country = 'Боливия'; } else if (hotelCountry == '21') { country = 'Босния и Герцеговина'; } else if (hotelCountry == '22') { country = 'Ботсвана'; } else if (hotelCountry == '23') { country = 'Бразилия'; } else if (hotelCountry == '24') { country = 'Бруней'; } else if (hotelCountry == '25') { country = 'Буркина-Фасо'; } else if (hotelCountry == '173') { country = 'Бурунди'; } else if (hotelCountry == '190') { country = 'Бутан'; } else if (hotelCountry == '26') { country = 'Великобритания'; } else if (hotelCountry == '27') { country = 'Венгрия'; } else if (hotelCountry == '28') { country = 'Венесуэла'; } else if (hotelCountry == '29') { country = 'Вьетнам'; } else if (hotelCountry == '202') { country = 'Гамбия'; } else if (hotelCountry == '154') { country = 'Гана'; } else if (hotelCountry == '30') { country = 'Гваделупа'; } else if (hotelCountry == '31') { country = 'Гватемала'; } else if (hotelCountry == '149') { country = 'Германия'; } else if (hotelCountry == '33') { country = 'Гондурас'; } else if (hotelCountry == '179') { country = 'Гонконг'; } else if (hotelCountry == '34') { country = 'Гренада'; } else if (hotelCountry == '196') { country = 'Гренландия'; } else if (hotelCountry == '35') { country = 'Греция'; } else if (hotelCountry == '36') { country = 'Грузия'; } else if (hotelCountry == '37') { country = 'Дания'; } else if (hotelCountry == '38') { country = 'Джибути'; } else if (hotelCountry == '170') { country = 'Доминика'; } else if (hotelCountry == '39') { country = 'Доминикана'; } else if (hotelCountry == '40') { country = 'Египет'; } else if (hotelCountry == '41') { country = 'Замбия'; } else if (hotelCountry == '42') { country = 'Зимбабве'; } else if (hotelCountry == '43') { country = 'Израиль'; } else if (hotelCountry == '44') { country = 'Индия'; } else if (hotelCountry == '45') { country = 'Индонезия'; } else if (hotelCountry == '46') { country = 'Иордания'; } else if (hotelCountry == '174') { country = 'Ирак'; } else if (hotelCountry == '47') { country = 'Иран'; } else if (hotelCountry == '48') { country = 'Ирландия'; } else if (hotelCountry == '49') { country = 'Исландия'; } else if (hotelCountry == '50') { country = 'Испания'; } else if (hotelCountry == '51') { country = 'Италия'; } else if (hotelCountry == '52') { country = 'Кабо-Верде'; } else if (hotelCountry == '53') { country = 'Казахстан'; } else if (hotelCountry == '54') { country = 'Камбоджа'; } else if (hotelCountry == '167') { country = 'Камерун'; } else if (hotelCountry == '55') { country = 'Канада'; } else if (hotelCountry == '56') { country = 'Катар'; } else if (hotelCountry == '57') { country = 'Кения'; } else if (hotelCountry == '58') { country = 'Кипр'; } else if (hotelCountry == '59') { country = 'Китай'; } else if (hotelCountry == '171') { country = 'Колумбия'; } else if (hotelCountry == '162') { country = 'Коморские Острова'; } else if (hotelCountry == '155') { country = 'Конго'; } else if (hotelCountry == '60') { country = 'Коста-Рика'; } else if (hotelCountry == '61') { country = 'Куба'; } else if (hotelCountry == '62') { country = 'Кыргызcтан'; } else if (hotelCountry == '200') { country = 'Кюрасао'; } else if (hotelCountry == '63') { country = 'Лаос'; } else if (hotelCountry == '64') { country = 'Латвия'; } else if (hotelCountry == '65') { country = 'Ливан'; } else if (hotelCountry == '66') { country = 'Литва'; } else if (hotelCountry == '176') { country = 'Лихтенштейн'; } else if (hotelCountry == '67') { country = 'Люксембург'; } else if (hotelCountry == '68') { country = 'Маврикий'; } else if (hotelCountry == '186') { country = 'Мавритания'; } else if (hotelCountry == '69') { country = 'Мадагаскар'; } else if (hotelCountry == '201') { country = 'Макао'; } else if (hotelCountry == '70') { country = 'Македония'; } else if (hotelCountry == '71') { country = 'Малайзия'; } else if (hotelCountry == '157') { country = 'Мали'; } else if (hotelCountry == '72') { country = 'Мальдивы'; } else if (hotelCountry == '73') { country = 'Мальта'; } else if (hotelCountry == '74') { country = 'Марианские о-ва'; } else if (hotelCountry == '75') { country = 'Марокко'; } else if (hotelCountry == '76') { country = 'Мартиника'; } else if (hotelCountry == '77') { country = 'Мексика'; } else if (hotelCountry == '78') { country = 'Мозамбик'; } else if (hotelCountry == '79') { country = 'Молдавия'; } else if (hotelCountry == '80') { country = 'Монако'; } else if (hotelCountry == '81') { country = 'Монголия'; } else if (hotelCountry == '82') { country = 'Мьянма (Бирма)'; } else if (hotelCountry == '83') { country = 'Намибия'; } else if (hotelCountry == '84') { country = 'Непал'; } else if (hotelCountry == '181') { country = 'Нигерия'; } else if (hotelCountry == '86') { country = 'Нидерланды'; } else if (hotelCountry == '177') { country = 'Никарагуа'; } else if (hotelCountry == '87') { country = 'Новая Зеландия'; } else if (hotelCountry == '88') { country = 'Норвегия'; } else if (hotelCountry == '89') { country = 'о. Кука'; } else if (hotelCountry == '90') { country = 'ОАЭ'; } else if (hotelCountry == '91') { country = 'Оман'; } else if (hotelCountry == '92') { country = 'Пакистан'; } else if (hotelCountry == '172') { country = 'Палау'; } else if (hotelCountry == '93') { country = 'Панама'; } else if (hotelCountry == '185') { country = 'Папуа Новая Гвинея'; } else if (hotelCountry == '95') { country = 'Парагвай'; } else if (hotelCountry == '96') { country = 'Перу'; } else if (hotelCountry == '98') { country = 'Польша'; } else if (hotelCountry == '99') { country = 'Португалия'; } else if (hotelCountry == '100') { country = 'Реюньон'; } else if (hotelCountry == '150') { country = 'Россия'; } else if (hotelCountry == '102') { country = 'Румыния'; } else if (hotelCountry == '178') { country = 'Сан-Марино'; } else if (hotelCountry == '164') { country = 'Сан-Томе и Принсипи'; } else if (hotelCountry == '103') { country = 'Саудовская Аравия'; } else if (hotelCountry == '104') { country = 'Свазиленд'; } else if (hotelCountry == '199') { country = 'Северная Корея'; } else if (hotelCountry == '105') { country = 'Сейшелы'; } else if (hotelCountry == '191') { country = 'Сен-Бартелеми'; } else if (hotelCountry == '158') { country = 'Сенегал'; } else if (hotelCountry == '189') { country = 'Сен-Мартен'; } else if (hotelCountry == '195') { country = 'Сент-Винсент и Гренадины'; } else if (hotelCountry == '194') { country = 'Сент-Китс и Невис'; } else if (hotelCountry == '106') { country = 'Сент-Люсия'; } else if (hotelCountry == '107') { country = 'Сербия'; } else if (hotelCountry == '108') { country = 'Сингапур'; } else if (hotelCountry == '109') { country = 'Сирия'; } else if (hotelCountry == '110') { country = 'Словакия'; } else if (hotelCountry == '111') { country = 'Словения'; } else if (hotelCountry == '159') { country = 'Судан'; } else if (hotelCountry == '112') { country = 'США'; } else if (hotelCountry == '163') { country = 'Сьерра Леоне'; } else if (hotelCountry == '193') { country = 'Таджикистан'; } else if (hotelCountry == '113') { country = 'Таиланд'; } else if (hotelCountry == '114') { country = 'Тайвань'; } else if (hotelCountry == '115') { country = 'Танзания'; } else if (hotelCountry == '116') { country = 'Теркс и Кайкос'; } else if (hotelCountry == '156') { country = 'Того'; } else if (hotelCountry == '117') { country = 'Тунис'; } else if (hotelCountry == '118') { country = 'Туркменистан'; } else if (hotelCountry == '119') { country = 'Турция'; } else if (hotelCountry == '161') { country = 'Уганда'; } else if (hotelCountry == '120') { country = 'Узбекистан'; } else if (hotelCountry == '121') { country = 'Украина'; } else if (hotelCountry == '192') { country = 'Уругвай'; } else if (hotelCountry == '122') { country = 'Фиджи'; } else if (hotelCountry == '123') { country = 'Филиппины'; } else if (hotelCountry == '124') { country = 'Финляндия'; } else if (hotelCountry == '125') { country = 'Франция'; } else if (hotelCountry == '169') { country = 'Французская Полинезия'; } else if (hotelCountry == '126') { country = 'Хорватия'; } else if (hotelCountry == '168') { country = 'ЦАР'; } else if (hotelCountry == '166') { country = 'Чад'; } else if (hotelCountry == '127') { country = 'Черногория'; } else if (hotelCountry == '128') { country = 'Чехия'; } else if (hotelCountry == '129') { country = 'Чили'; } else if (hotelCountry == '130') { country = 'Швейцария'; } else if (hotelCountry == '131') { country = 'Швеция'; } else if (hotelCountry == '197') { country = 'Шпицберген'; } else if (hotelCountry == '132') { country = 'Шри-Ланка'; } else if (hotelCountry == '133') { country = 'Эквадор'; } else if (hotelCountry == '165') { country = 'Эритрея'; } else if (hotelCountry == '134') { country = 'Эстония'; } else if (hotelCountry == '135') { country = 'Эфиопия'; } else if (hotelCountry == '136') { country = 'ЮАР'; } else if (hotelCountry == '137') { country = 'Южная Корея'; } else if (hotelCountry == '138') { country = 'Ямайка'; } else if (hotelCountry == '139') { country = 'Япония'; }

	//последнее старое название отеля
	var arrOldName = oldName.split(' ,', 10);
	oldName = arrOldName[arrOldName.length - 1]

	// замена &
	for (var i = 0; i < 5; i++) {
		oldName = oldName.replace('&', '%26');
		newName = newName.replace('&', '%26');
	}

	var generateLink = 'https://script.google.com/macros/s/AKfycbxNcS9dNiYb0pILCWYeOJNzC5XgS0KsAL54Ry2ljySMZLbAl3I/exec?p1=' + cardLink + '&p2=' + oldName + '&p3=' + newName + '&p4=' + country;
	var app = generateLink,
		output = '',
		xhr = new XMLHttpRequest();
	xhr.open('GET', app);
	xhr.send()

	alert('Отель отправлен в документ')
}

document.querySelector("#GeneralInfo > table > tbody > tr:nth-child(1) > td:nth-child(2)").setAttribute("style", "position: relative;");
var sendHGotelName = document.createElement('div');
sendHGotelName.innerHTML = ("Send");
sendHGotelName.classList.add('button');
sendHGotelName.setAttribute("style", "position: absolute; top: 5px; right: 5px; margin-left: 4px; width: 50px; text-align: center; font: bold 1em Arial, Sans-serif;font-weight: bold;border: 1px solid #ccc;background: #F0F0F0;padding: 3px 5px;color: #4284B0;cursor: pointer; display: inline-block;");
sendHGotelName.onclick = sendHotel;
document.querySelector("#GeneralInfo > table > tbody > tr:nth-child(1) > td:nth-child(2)").appendChild(sendHGotelName);
})();