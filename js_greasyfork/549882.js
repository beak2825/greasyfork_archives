// ==UserScript==
// @name         kim nerede 2
// @namespace    Clevatess
// @version      444
// @description 444
// @author       444
// @match        https://gartic.io/*
// @grant        none
// @downloadURL https://update.greasyfork.org/scripts/549882/kim%20nerede%202.user.js
// @updateURL https://update.greasyfork.org/scripts/549882/kim%20nerede%202.meta.js
// ==/UserScript==
const htmlContent=`<!doctype html><html lang="tr"><head><meta charset="UTF-8"><title>Clevatess</title><script src="https://cdn.tailwindcss.com"></script><style>body{background-color:#1e1e2f;color:#fff;font-family:sans-serif;transition:background-color .3s,color .3s}#searchNick {color: red;}#userList{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:4px;grid-auto-rows:min-content}.card{background:#2c2c3e;color:#fff;width:160px;padding:.5rem;display:flex;flex-direction:column;align-items:center;text-align:center;transition:transform .2s,box-shadow .2s}.card:hover{transform:translateY(-2px);box-shadow:0 6px 12px rgba(0,0,0,.3)}button{background:#2c2c3e;color:#fff;border:1px solid #444;padding:.3rem .6rem;border-radius:.375rem;cursor:pointer;transition:all .3s}button:disabled{opacity:.5;cursor:not-allowed}input[type=text],select{background:#2c2c3e;color:#fff;border:1px solid #444;padding:.3rem;border-radius:.375rem}a.room-link{text-decoration:underline;font-weight:500}a.room-link:hover{opacity:.8}.card img{width:50px;height:50px;border-radius:9999px}#warning429{position:fixed;top:5px;left:50%;transform:translateX(-50%);background:#f55;color:#fff;padding:.5rem 1rem;border-radius:.375rem;font-weight:700;display:none;z-index:10000}</style></head><body class="min-h-screen p-6"><div id="warning429">GeÃ§ici olarak kÄ±sÄ±tlandÄ±n. 30 saniye bekleyeceÄŸiz maalesef...</div><div class="container mx-auto"><h1 class="text-2xl font-bold mb-4 text-center">Clevatess</h1><div class="flex flex-wrap justify-center mb-4 gap-2 items-center"><label>Dil:</label> <select id="languageSelect"></select> <button id="refreshBtn">Yenile</button> <span id="cooldownDisplay" class="font-semibold text-red-400 ml-2"></span></div><div class="flex flex-wrap justify-center gap-4 mb-4 text-center"><div>toplam oda sayÄ±sÄ±: <span id="totalRooms">0</span></div><div>iÅŸlenen odalar: <span id="processedRooms">0</span></div><div>filtreye gÃ¶re gÃ¶rÃ¼nen kiÅŸi sayÄ±sÄ±: <span id="visiblePlayers">0</span></div></div><div class="flex flex-wrap justify-center gap-2 mb-4"><div><label>Filtre:</label> <input type="radio" name="filter" value="all" id="filterAll" checked><label for="filterAll">Hepsi</label> <input type="radio" name="filter" value="avatar" id="filterAvatar"><label for="filterAvatar">Avatar</label> <input type="radio" name="filter" value="foto" id="filterFoto"><label for="filterFoto">Foto</label></div><div><input id="searchNick" placeholder="Nick ara..." style="color:red;">
</div></div><div id="userList"></div></div><script>document.title="Clevatess";
const languageFlags={23:{name:'AzÉ™rbaycanca',flag:'ðŸ‡¦ðŸ‡¿'},45:{name:'Bahasa Indonesia',flag:'ðŸ‡®ðŸ‡©'},11:{name:'ÄŒeÅ¡tina',flag:'ðŸ‡¨ðŸ‡¿'},14:{name:'Deutsch',flag:'ðŸ‡©ðŸ‡ª'},2:{name:'English',flag:'ðŸ‡¬ðŸ‡§'},3:{name:'EspaÃ±ol',flag:'ðŸ‡ªðŸ‡¸'},4:{name:'FranÃ§ais',flag:'ðŸ‡«ðŸ‡·'},6:{name:'Italiano',flag:'ðŸ‡®ðŸ‡¹'},44:{name:'Magyar',flag:'ðŸ‡­ðŸ‡º'},18:{name:'Nederlands',flag:'ðŸ‡³ðŸ‡±'},10:{name:'Polski',flag:'ðŸ‡µðŸ‡±'},1:{name:'PortuguÃªs',flag:'ðŸ‡µðŸ‡¹'},58:{name:'RomÃ¢nÄƒ',flag:'ðŸ‡·ðŸ‡´'},22:{name:'SlovenÄina',flag:'ðŸ‡¸ðŸ‡°'},13:{name:'Tiáº¿ng Viá»‡t',flag:'ðŸ‡»ðŸ‡³'},8:{name:'TÃ¼rkÃ§e',flag:'ðŸ‡¹ðŸ‡·'},21:{name:'Ð±ÑŠÐ»Ð³Ð°Ñ€ÑÐºÐ¸ ÐµÐ·Ð¸Ðº',flag:'ðŸ‡§ðŸ‡¬'},7:{name:'Ð ÑƒÑÑÐºÐ¸Ð¹',flag:'ðŸ‡·ðŸ‡º'},40:{name:'×¢×‘×¨×™×ª',flag:'ðŸ‡®ðŸ‡±'},19:{name:'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©',flag:'ðŸ‡¸ðŸ‡¦'},34:{name:'ÙØ§Ø±Ø³ÛŒ',flag:'ðŸ‡®ðŸ‡·'},12:{name:'à¸ à¸²à¸©à¸²à¹„à¸—à¸¢',flag:'ðŸ‡¹ðŸ‡­'},16:{name:'ä¸­æ–‡ (ç®€åŒ–å­—)',flag:'ðŸ‡¨ðŸ‡³'},9:{name:'ä¸­æ–‡ (è‡ºç£)',flag:'ðŸ‡¹ðŸ‡¼'},17:{name:'ä¸­æ–‡ (é¦™æ¸¯)',flag:'ðŸ‡­ðŸ‡°'},15:{name:'æ—¥æœ¬èªž',flag:'ðŸ‡¯ðŸ‡µ'},20:{name:'í•œêµ­ì–´',flag:'ðŸ‡°ðŸ‡·'},26:{name:'Afrikaans',flag:'ðŸ‡¿ðŸ‡¦'},55:{name:'Bahasa Melayu',flag:'ðŸ‡²ðŸ‡¾'},30:{name:'CatalÃ ',flag:'ðŸ‡ªðŸ‡¸'},31:{name:'Dansk',flag:'ðŸ‡©ðŸ‡°'},33:{name:'Eesti',flag:'ðŸ‡ªðŸ‡ª'},67:{name:'Esperanto',flag:'ðŸ³ï¸'},36:{name:'FÃ¸royskt',flag:'ðŸ‡«ðŸ‡´'},37:{name:'Gaeilge',flag:'ðŸ‡®ðŸ‡ª'},38:{name:'Galego',flag:'ðŸ‡ªðŸ‡¸'},43:{name:'Hrvatski',flag:'ðŸ‡­ðŸ‡·'},46:{name:'Ãslenska',flag:'ðŸ‡®ðŸ‡¸'},52:{name:'LatvieÅ¡u',flag:'ðŸ‡±ðŸ‡»'},50:{name:'LÃ«tzebuergesch',flag:'ðŸ‡±ðŸ‡º'},68:{name:'LietuviÅ³',flag:'ðŸ‡±ðŸ‡¹'},56:{name:'Malti',flag:'ðŸ‡²ðŸ‡¹'},53:{name:'MÐ°ÐºÐµÐ´Ð¾Ð½ÑÐºÐ¸',flag:'ðŸ‡²ðŸ‡°'},65:{name:'Norsk',flag:'ðŸ‡³ðŸ‡´'},61:{name:'Shqip',flag:'ðŸ‡¦ðŸ‡±'},59:{name:'SlovenÅ¡Äina',flag:'ðŸ‡¸ðŸ‡®'},35:{name:'Suomi',flag:'ðŸ‡«ðŸ‡®'},24:{name:'Svenska',flag:'ðŸ‡¸ðŸ‡ª'},62:{name:'TÃ¼rkmen',flag:'ðŸ‡¹ðŸ‡²'},64:{name:'YorÃ¹bÃ¡',flag:'ðŸ‡³ðŸ‡¬'},32:{name:'Î•Î»Î»Î·Î½Î¹ÎºÎ¬',flag:'ðŸ‡¬ðŸ‡·'},27:{name:'Ð‘ÐµÐ»Ð°Ñ€ÑƒÑÐºÐ°Ñ',flag:'ðŸ‡§ðŸ‡¾'},29:{name:'Ð‘Ð¾ÑÐ°Ð½ÑÐºÐ¸',flag:'ðŸ‡§ðŸ‡¦'},54:{name:'ÐœÐ¾Ð½Ð³Ð¾Ð» Ð¥ÑÐ»',flag:'ðŸ‡²ðŸ‡³'},60:{name:'Ð¡Ñ€Ð¿ÑÐºÐ¸',flag:'ðŸ‡·ðŸ‡¸'},63:{name:'Ð£ÐºÑ€Ð°Ñ—Ð½ÑÑŒÐºÐ°',flag:'ðŸ‡ºðŸ‡¦'},49:{name:'ÒšÐ°Ð·Ð°Ò› TÑ–Ð»Ñ–',flag:'ðŸ‡°ðŸ‡¿'},42:{name:'Õ€Õ¡ÕµÕ¥Ö€Õ¥Õ¶',flag:'ðŸ‡¦ðŸ‡²'},41:{name:'à¤¹à¤¿à¤¨à¥à¤¦à¥€',flag:'ðŸ‡®ðŸ‡³'},28:{name:'à¦¬à¦¾à¦‚à¦²à¦¾',flag:'ðŸ‡§ðŸ‡©'},39:{name:'àª—à«àªœàª°àª¾àª¤à«€',flag:'ðŸ‡®ðŸ‡³'},51:{name:'àºžàº²àºªàº²àº¥àº²àº§',flag:'ðŸ‡±ðŸ‡¦'},57:{name:'á€™á€¼á€”á€ºá€™á€¬á€…á€€á€¬á€¸',flag:'ðŸ‡²ðŸ‡²'},47:{name:'áƒ¥áƒáƒ áƒ—áƒ£áƒšáƒ˜',flag:'ðŸ‡¬ðŸ‡ª'},25:{name:'áŠ£áˆ›áˆ­áŠ›',flag:'ðŸ‡ªðŸ‡¹'},48:{name:'áž—áž¶ážŸáž¶ážáŸ’áž˜áŸ‚ážš',flag:'ðŸ‡°ðŸ‡­'},};const languageSelect=document.getElementById('languageSelect');const refreshBtn=document.getElementById('refreshBtn');const cooldownDisplay=document.getElementById('cooldownDisplay');const totalRoomsEl=document.getElementById('totalRooms');const processedRoomsEl=document.getElementById('processedRooms');const visiblePlayersEl=document.getElementById('visiblePlayers');const userList=document.getElementById('userList');const searchNickInput=document.getElementById('searchNick');const filterRadios=document.querySelectorAll('input[name="filter"]');const warningEl=document.getElementById('warning429');let allUsers=[],userCards=new Map(),roomColors=new Map();let socket=null,timeout3s=null,queue=[],processedRooms=0;let cooldownActive=!1;let selectedLang=8;for(const id in languageFlags){const obj=languageFlags[id];const opt=document.createElement('option');opt.value=id;opt.textContent=obj.flag+' '+obj.name;languageSelect.appendChild(opt)}
languageSelect.value=selectedLang;refreshBtn.addEventListener('click',()=>{if(!cooldownActive)startCooldown('refresh');});languageSelect.addEventListener('change',()=>{if(!cooldownActive)startCooldown('language');});function startCooldown(type){cooldownActive=!0;refreshBtn.disabled=!0;languageSelect.disabled=!0;let countdown=10;cooldownDisplay.textContent=countdown;const interval=setInterval(()=>{countdown--;cooldownDisplay.textContent=countdown;if(countdown<=0){clearInterval(interval);cooldownDisplay.textContent='';refreshBtn.disabled=!1;languageSelect.disabled=!1;cooldownActive=!1}},1000);resetAll();setTimeout(()=>{if(type==='language')selectedLang=parseInt(languageSelect.value);fetchRooms().then(()=>processQueue())},1500)}
function resetAll(){if(socket){try{socket.close()}catch(e){}socket=null}
if(timeout3s){clearTimeout(timeout3s);timeout3s=null}
allUsers=[];userCards.clear();roomColors.clear();queue=[];processedRooms=0;userList.innerHTML='';updateStats()}
searchNickInput.addEventListener('input',applyFilters);filterRadios.forEach(r=>r.addEventListener('change',applyFilters));function applyFiltersToCard(user,card){const searchTerm=searchNickInput.value.toLowerCase();const filterValue=document.querySelector('input[name="filter"]:checked').value;const hasFoto=!!user.foto,hasAvatar=!!user.avatar;let visible=!0;if(filterValue==='avatar'&&!hasAvatar)visible=!1;if(filterValue==='foto'&&!hasFoto)visible=!1;if(user.nick&&user.nick.toLowerCase().indexOf(searchTerm)===-1)visible=!1;card.style.display=visible?'flex':'none'}
function applyFilters(){allUsers.forEach(u=>{const c=userCards.get(u.id+'_'+u.roomCode);if(c)applyFiltersToCard(u,c);});updateStats()}
function getRoomColor(code){if(!roomColors.has(code))roomColors.set(code,'hsl('+Math.floor(Math.random()*360)+',70%,50%)');return roomColors.get(code)}
function addUserCard(user,roomCode){user.roomCode=roomCode;allUsers.push(user);const imgSrc=user.foto?user.foto:'https://gartic.io/static/images/avatar/svg/'+user.avatar+'.svg';const card=document.createElement('div');card.className='card';const roomColor=getRoomColor(roomCode);card.innerHTML='<div class="font-semibold text-sm truncate mb-1">'+(user.nick||'Bilinmeyen')+'</div>'+'<div class="flex gap-1 items-center mb-1">'+'<img src="'+imgSrc+'" class="w-12 h-12 rounded-full">'+'<button class="px-1 py-0.5 rounded text-xs">profil fotoÄŸrafÄ±nÄ± aÃ§</button>'+'</div>'+'<div class="flex flex-col gap-1 w-full text-center text-[10px] font-semibold">'+'<a class="room-link" style="color:'+roomColor+'" href="https://gartic.io/'+roomCode+'" target="_blank">'+roomCode+'</a>'+'<a class="room-link" style="color:'+roomColor+'" href="https://gartic.io/'+roomCode+'/viewer" target="_blank">'+roomCode+'/viewer</a>'+'</div>';card.querySelector('button').addEventListener('click',()=>window.open(imgSrc,'_blank'));userList.appendChild(card);userCards.set(user.id+'_'+roomCode,card);applyFiltersToCard(user,card);updateStats()}
function updateStats(){totalRoomsEl.textContent=queue.length+processedRooms;processedRoomsEl.textContent=processedRooms;let visibleCount=0;allUsers.forEach(u=>{const c=userCards.get(u.id+'_'+u.roomCode);if(c&&c.style.display!=='none')visibleCount++});visiblePlayersEl.textContent=visibleCount}
async function fetchRooms(){try{const res=await fetch('https://gartic.io/req/list?search=&language[]='+selectedLang,{credentials:'omit'});if(res.status===429){warningEl.style.display='block';await new Promise(r=>setTimeout(r,30000));warningEl.style.display='none';return fetchRooms()}
const data=await res.json();queue=data.filter(r=>r.quant>0).map(r=>r.code);updateStats()}catch(err){console.error(err)}}
async function processQueue(){if(queue.length===0)return;const nextCode=queue.shift();await new Promise(r=>setTimeout(r,450+Math.random()*300));await connectRoom(nextCode);processedRooms++;updateStats();if(processedRooms%10===0)await new Promise(r=>setTimeout(r,2500));processQueue()}
async function connectRoom(code){let sala;if(code.length===6)sala=code.slice(-4);else if(code.length===5)sala=code.slice(-3);else if(code.length===4)sala=code.slice(-2);else sala=code;try{const r=await fetch('https://gartic.io/server?check=1&v3=1&room='+code,{credentials:'omit'});if(r.status===429){warningEl.style.display='block';console.warn('429 received for room '+code+', waiting 30s...');await new Promise(r=>setTimeout(r,30000));warningEl.style.display='none';return connectRoom(code)}
const x=await r.text();console.log("Server response for",code,"=>",x);const url=new URL(x.trim());const serverOnly=url.hostname;const cParam=url.searchParams.get("c");if(!serverOnly||!cParam){console.warn("Beklenen format deÄŸil:",x);return}
return new Promise(resolve=>{if(socket){socket.close();socket=null}
socket=new WebSocket('wss://'+serverOnly+'/socket.io/?c='+cParam+'&EIO=3&transport=websocket');socket.addEventListener('open',()=>{socket.send('42[12,{"v":20000,"platform":0,"sala":"'+sala+'"}]');timeout3s=setTimeout(()=>{if(socket){socket.close();socket=null}resolve()},3000)});socket.addEventListener('error',()=>{if(socket){socket.close();socket=null}resolve()});socket.addEventListener('message',e=>{if(typeof e.data==='string'&&e.data.startsWith('42')){try{const data=JSON.parse(e.data.slice(2));if(data[0]==='5'){if(timeout3s){clearTimeout(timeout3s);timeout3s=null}
data[5].forEach(u=>addUserCard(u,code));if(socket){socket.close();socket=null}
resolve()}}catch{if(socket){socket.close();socket=null}resolve()}}})})}catch(err){console.error(err)}}
fetchRooms().then(()=>processQueue())</script></body></html>`;const button=document.createElement('button');button.style.width='45px';button.style.height='45px';button.style.position='fixed';button.style.top='10px';button.style.right='120px';button.style.zIndex=9999;button.style.backgroundImage='url("https://tiermaker.com/images/template_images/2022/15541680/fredinas-nightclub-idk-15541680/download-1jpeg.png")';button.style.backgroundSize='cover';button.style.backgroundPosition='center';button.style.border='none';button.style.cursor='pointer';button.title='rev444';button.addEventListener('click',()=>{const newWin=window.open();newWin.document.open();newWin.document.write(htmlContent);newWin.document.close()});document.body.appendChild(button)